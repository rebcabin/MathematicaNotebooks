(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[   1407873,      33480]
NotebookOptionsPosition[   1319364,      32077]
NotebookOutlinePosition[   1320009,      32099]
CellTagsIndexPosition[   1319966,      32096]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Travesties for Logic and for Types", "Title",
 CellChangeTimes->{{3.54858271207988*^9, 3.548582715630885*^9}, {
   3.5486758274795203`*^9, 3.5486758354865203`*^9}, {3.5486818669031096`*^9, 
   3.54868187652511*^9}, {3.841245492423634*^9, 3.841245500413811*^9}, {
   3.841398400663448*^9, 3.841398431377946*^9}, {3.841399866569034*^9, 
   3.841399888000155*^9}, {3.911290193321506*^9, 3.911290194289217*^9}, 
   3.911290391157282*^9, {3.911292116101327*^9, 3.911292118156425*^9}, {
   3.912267798138956*^9, 3.912267810604186*^9}, {3.912543249455318*^9, 
   3.912543258442067*^9}, 3.912601670816621*^9, {3.915050248261401*^9, 
   3.9150502542889023`*^9}, {3.915110138757975*^9, 
   3.915110177409629*^9}},ExpressionUUID->"e69ed4d1-2852-407b-a4d7-\
ebd11ce6da7a"],

Cell["\<\
Brian Beckman
Jan 2024\
\>", "Subtitle",
 CellChangeTimes->{{3.5486756518965206`*^9, 3.5486756585195203`*^9}, {
   3.841157092469059*^9, 3.841157096026097*^9}, 3.841398438220071*^9, {
   3.911255289466833*^9, 3.911255292780459*^9}, {3.912267815593966*^9, 
   3.912267817909073*^9}, {3.915050381588171*^9, 
   3.915050383849716*^9}},ExpressionUUID->"0a45aa99-9a6b-4a8b-87c8-\
96d50b07cda3"],

Cell[CellGroupData[{

Cell["ABSTRACT", "Section",
 CellChangeTimes->{{3.841245701744459*^9, 3.841245702859004*^9}, {
  3.915535641247355*^9, 
  3.9155356436613483`*^9}},ExpressionUUID->"6f10638c-7ff3-4b8f-aaee-\
89dcd0cbfa99"],

Cell["\<\
In an earlier notebook, we exhibited travesties and bidirectional parsing \
tools for algebraic formulas \
(https://community.wolfram.com/groups/-/m/t/3094266). We extend those methods \
to cover two more examples: symbolic logic and programming-language types. \
The algebra example is repeated here for completeness.\
\>", "Text",
 CellChangeTimes->{{3.5486667501641035`*^9, 3.5486667735821266`*^9}, {
   3.54867585112652*^9, 3.5486758845325203`*^9}, {3.5487624386160836`*^9, 
   3.548762445271105*^9}, {3.5490171660471992`*^9, 3.549017172263339*^9}, {
   3.5496191653724756`*^9, 3.5496191657264957`*^9}, 3.5501392120247836`*^9, {
   3.550148837657338*^9, 3.5501488652889185`*^9}, {3.841245515271736*^9, 
   3.841245525936187*^9}, {3.841245678591526*^9, 3.841245756035816*^9}, {
   3.841398416030724*^9, 3.841398420144806*^9}, {3.8413998987858953`*^9, 
   3.841399929610403*^9}, {3.84140012560924*^9, 3.841400134682761*^9}, {
   3.841486326450529*^9, 3.841486423092754*^9}, {3.8414876960590343`*^9, 
   3.841487717931477*^9}, {3.911290036788042*^9, 3.911290056706698*^9}, {
   3.9112921463483343`*^9, 3.911292171362836*^9}, {3.912267906299365*^9, 
   3.912267906760809*^9}, {3.912546844707864*^9, 3.912546894738131*^9}, {
   3.912547108713105*^9, 3.91254718323039*^9}, 3.9126016011560283`*^9, {
   3.912601670847604*^9, 3.912601670878302*^9}, 3.9150505441468267`*^9, {
   3.915050585726287*^9, 3.915050634433065*^9}, {3.9150508412884407`*^9, 
   3.915050847885093*^9}, {3.915053905017859*^9, 3.915053931307077*^9}, {
   3.915054040837186*^9, 3.915054084664626*^9}, {3.915110211038093*^9, 
   3.915110439883452*^9}, 3.915110502151784*^9, {3.915534791313983*^9, 
   3.91553480147051*^9}, {3.915534844437495*^9, 3.9155348934267263`*^9}, {
   3.915534929197647*^9, 3.91553499661201*^9}, 
   3.9155353066733923`*^9},ExpressionUUID->"95b44c1c-d39c-446b-b779-\
f6947d601484"],

Cell["\<\
We illustrate symbolic logic via the famous game, \
\[OpenCurlyDoubleQuote]WFF-n-Proof.\[CloseCurlyDoubleQuote] \
\[OpenCurlyDoubleQuote]WFF\[CloseCurlyDoubleQuote] stands for well-formed \
formula, and the game employs an alternative notation for Boolean logic. \
Physical copies of the WFF-n-Proof manual by Layman Allen \
(https://paw.princeton.edu/memorial/layman-edward-allen-51) are abundant \
online (e.g., https://a.co/d/aiQM1H2). The work is still copyrighted. Digital \
copies are not legally available. In this notebook, I refer to page numbers \
etc. from the 1965 manual without reproducing them verbatim. \
\>", "Text",
 CellChangeTimes->{{3.5486667501641035`*^9, 3.5486667735821266`*^9}, {
   3.54867585112652*^9, 3.5486758845325203`*^9}, {3.5487624386160836`*^9, 
   3.548762445271105*^9}, {3.5490171660471992`*^9, 3.549017172263339*^9}, {
   3.5496191653724756`*^9, 3.5496191657264957`*^9}, 3.5501392120247836`*^9, {
   3.550148837657338*^9, 3.5501488652889185`*^9}, {3.841245515271736*^9, 
   3.841245525936187*^9}, {3.841245678591526*^9, 3.841245756035816*^9}, {
   3.841398416030724*^9, 3.841398420144806*^9}, {3.8413998987858953`*^9, 
   3.841399929610403*^9}, {3.84140012560924*^9, 3.841400134682761*^9}, {
   3.841486326450529*^9, 3.841486423092754*^9}, {3.8414876960590343`*^9, 
   3.841487717931477*^9}, {3.911290036788042*^9, 3.911290056706698*^9}, {
   3.9112921463483343`*^9, 3.911292171362836*^9}, {3.912267906299365*^9, 
   3.912267906760809*^9}, {3.912546844707864*^9, 3.912546894738131*^9}, {
   3.912547108713105*^9, 3.91254718323039*^9}, 3.9126016011560283`*^9, {
   3.912601670847604*^9, 3.912601670878302*^9}, 3.9150505441468267`*^9, {
   3.915050585726287*^9, 3.915050634433065*^9}, {3.9150508412884407`*^9, 
   3.915050847885093*^9}, {3.915053905017859*^9, 3.915053931307077*^9}, {
   3.915054040837186*^9, 3.915054084664626*^9}, {3.915110211038093*^9, 
   3.915110439883452*^9}, 3.915110502151784*^9, {3.915534791313983*^9, 
   3.91553480147051*^9}, {3.915534844437495*^9, 3.9155348934267263`*^9}, {
   3.915534929197647*^9, 3.9155349609656563`*^9}, {3.915535008400962*^9, 
   3.9155350562256002`*^9}, {3.915535092857836*^9, 3.915535112652083*^9}, {
   3.915535237477969*^9, 
   3.915535279608645*^9}},ExpressionUUID->"5f5053e5-85aa-410e-9a35-\
d72179a5c16a"],

Cell[TextData[{
 "We illustrate programming-language types via examples from Benjamin C. \
Pierce\[CloseCurlyQuote]s book, ",
 StyleBox["Types and Programming Languages",
  FontSlant->"Italic"],
 " (https://a.co/d/9ofcYh4). "
}], "Text",
 CellChangeTimes->{{3.5486667501641035`*^9, 3.5486667735821266`*^9}, {
   3.54867585112652*^9, 3.5486758845325203`*^9}, {3.5487624386160836`*^9, 
   3.548762445271105*^9}, {3.5490171660471992`*^9, 3.549017172263339*^9}, {
   3.5496191653724756`*^9, 3.5496191657264957`*^9}, 3.5501392120247836`*^9, {
   3.550148837657338*^9, 3.5501488652889185`*^9}, {3.841245515271736*^9, 
   3.841245525936187*^9}, {3.841245678591526*^9, 3.841245756035816*^9}, {
   3.841398416030724*^9, 3.841398420144806*^9}, {3.8413998987858953`*^9, 
   3.841399929610403*^9}, {3.84140012560924*^9, 3.841400134682761*^9}, {
   3.841486326450529*^9, 3.841486423092754*^9}, {3.8414876960590343`*^9, 
   3.841487717931477*^9}, {3.911290036788042*^9, 3.911290056706698*^9}, {
   3.9112921463483343`*^9, 3.911292171362836*^9}, {3.912267906299365*^9, 
   3.912267906760809*^9}, {3.912546844707864*^9, 3.912546894738131*^9}, {
   3.912547108713105*^9, 3.91254718323039*^9}, 3.9126016011560283`*^9, {
   3.912601670847604*^9, 3.912601670878302*^9}, 3.9150505441468267`*^9, {
   3.915050585726287*^9, 3.915050634433065*^9}, {3.9150508412884407`*^9, 
   3.915050847885093*^9}, {3.915053905017859*^9, 3.915053931307077*^9}, {
   3.915054040837186*^9, 3.915054084664626*^9}, {3.915110211038093*^9, 
   3.915110439883452*^9}, 3.915110502151784*^9, {3.915534791313983*^9, 
   3.91553480147051*^9}, {3.915534844437495*^9, 3.9155348934267263`*^9}, {
   3.915534929197647*^9, 3.9155349474978857`*^9}, 
   3.915535301906814*^9},ExpressionUUID->"aae408a9-9825-40a0-bc06-\
4ddc96b653ca"],

Cell["\<\
In addition to generating travesties and parsing tools, we exhibit abstract \
execution for these domains. We execute well-formed formulas (WFFs) via logic \
programming and execute typed programs via small-step operational semantics.\
\>", "Text",
 CellChangeTimes->{{3.915110521500276*^9, 3.915110653672628*^9}, {
  3.915534973478381*^9, 
  3.915534977770308*^9}},ExpressionUUID->"61aa7330-2248-47d2-a75d-\
8dcae707794c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["PRELIMINARY PACKAGES", "Section",
 CellChangeTimes->{{3.84124565794427*^9, 3.841245665199665*^9}, {
  3.911254204243611*^9, 3.911254208096692*^9}, {3.91125444322156*^9, 
  3.911254448924737*^9}},ExpressionUUID->"279e152e-5e98-4885-a949-\
18c1769e39ee"],

Cell[BoxData[
 RowBox[{"<<", "Utilities`CleanSlate`"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.549536915366044*^9, 3.5495369233915033`*^9}},
 CellLabel->
  "In[276]:=",ExpressionUUID->"2ce88265-27c5-476d-923b-403c937d1655"],

Cell[TextData[{
 "If you like, move the following packages onto your ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " ",
 StyleBox["$Path",
  FontSlant->"Italic"],
 ". The following unevaluatable cell shows where I put them on my system. I \
include copies of these packages here so anyone can just evaluate this \
notebook without installing packages. We don\[CloseCurlyQuote]t explain this \
code, here, we just use it. Close up this chapter so you \
don\[CloseCurlyQuote]t have to look at all this stuff."
}], "Text",
 CellChangeTimes->{{3.841245538638632*^9, 3.841245647324567*^9}, {
  3.84139870846646*^9, 3.8413987116890798`*^9}, {3.841749441285334*^9, 
  3.841749475793593*^9}, {3.911251785926512*^9, 3.911251809937158*^9}, {
  3.911254213855645*^9, 3.9112543003752103`*^9}, {3.911254456176429*^9, 
  3.9112544866868763`*^9}},ExpressionUUID->"83682672-1063-4628-a7ab-\
7413e1b6a2f0"],

Cell[BoxData[{
 RowBox[{"<<", 
  "\"\<~/Dropbox/MMA/Packages/JacquardProlog.m\>\""}], "\[IndentingNewLine]", 
 RowBox[{"<<", "\"\<~/Dropbox/MMA/logic.m\>\""}], "\[IndentingNewLine]", 
 RowBox[{"<<", "\"\<~/Dropbox/MMA/Packages/Jacquard.m\>\""}]}], "Input",
 Evaluatable->False,
 CellChangeTimes->{{3.629505394618649*^9, 3.6295054078237057`*^9}, {
  3.645653564684004*^9, 3.645653570450636*^9}, {3.841153579311688*^9, 
  3.841153624246653*^9}},
 CellLabel->
  "In[276]:=",ExpressionUUID->"1e220022-7398-4bcd-8560-359d94633541"]
}, Open  ]],

Cell[CellGroupData[{

Cell["logic.m", "Section",
 CellChangeTimes->{{3.911251835277182*^9, 
  3.911251838268801*^9}},ExpressionUUID->"4530a9be-c022-45df-a993-\
ab3ea35d6ade"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{":", "Context", ":", " ", "logic`"}], " ", "*)"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{":", "Title", ":", " ", 
    RowBox[{"Logic", " ", "Programming"}]}], " ", "*)"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{":", "Author", ":", " ", 
    RowBox[{
     RowBox[{"Lic", ".", " ", "Ren\[AAcute]n"}], " ", "Cabrera"}]}], " ", 
   "*)"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{":", "Summary", ":", " ", 
    RowBox[{
    "This", " ", "is", " ", "package", " ", "for", " ", "Logic", " ", 
     "Programming", " ", "\n", "    ", "Tested", " ", "under", " ", 
     "Mathematica", " ", "3.0"}]}], " ", "\n", "*)"}]}]], "Code",
 CellLabel->
  "In[277]:=",ExpressionUUID->"45f745d7-f7ee-4d5c-8be4-d2dbb12f22d4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{":", 
    RowBox[{"Package", " ", "Version"}], ":", " ", 
    RowBox[{"1.0", "       ", "December", " ", "2000"}]}], " ", "*)"}], "\n", 
  "\n", 
  RowBox[{"(*", "  ", 
   RowBox[{
    RowBox[{
    "Mathematica", " ", "is", " ", "a", " ", "registered", " ", "trademark", 
     " ", "of", " ", "Wolfram", " ", "Research"}], ",", " ", 
    RowBox[{"Inc", "."}]}], "   ", "*)"}], "\n", "\n", 
  RowBox[{"BeginPackage", "[", " ", "\"\<logic`\>\"", " ", "]"}]}]], "Code",
 CellLabel->
  "In[278]:=",ExpressionUUID->"5c0a8dd4-a050-478e-b000-dbda650924c7"],

Cell[BoxData["\<\"logic`\"\>"], "Output",
 CellChangeTimes->{{3.91125242042068*^9, 3.91125242145071*^9}, {
   3.911254380972396*^9, 3.9112543813462343`*^9}, {3.911254645539892*^9, 
   3.911254645883897*^9}, {3.91129046017253*^9, 3.911290460562927*^9}, 
   3.912268028012871*^9, {3.912546351629364*^9, 3.91254635209441*^9}, {
   3.912589070242482*^9, 3.912589070566407*^9}, {3.9126003498647337`*^9, 
   3.912600350163303*^9}, {3.9126017047760973`*^9, 3.912601705095561*^9}, {
   3.915050870087123*^9, 3.915050870402182*^9}, {3.915535455878645*^9, 
   3.9155354562688103`*^9}},
 CellLabel->
  "Out[278]=",ExpressionUUID->"30ab2d98-1c88-4f40-b836-7f3b382da018"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Question", "::", "usage"}], "     ", "=", " ", 
   "\"\<Question[ Statements, Query, Var]\>\""}], " "}], "\n", 
 RowBox[{
  RowBox[{"AddKnowledge", "::", "usage"}], " ", "=", " ", 
  "\"\<AddKnowledge[ Statements, Rule ]\>\"", " "}]}], "Code",
 CellLabel->
  "In[279]:=",ExpressionUUID->"5d716ec3-b1b8-4560-8776-37a7e6a95d12"],

Cell[BoxData["\<\"Question[ Statements, Query, Var]\"\>"], "Output",
 CellChangeTimes->{{3.911252420423945*^9, 3.911252421454321*^9}, {
   3.911254380975369*^9, 3.911254381349393*^9}, {3.911254645572096*^9, 
   3.911254645886293*^9}, {3.9112904602101517`*^9, 3.911290460573621*^9}, 
   3.912268028016509*^9, {3.912546351638833*^9, 3.912546352104939*^9}, {
   3.9125890702460318`*^9, 3.912589070569112*^9}, {3.912600349868374*^9, 
   3.912600350166247*^9}, {3.912601704787597*^9, 3.912601705098494*^9}, {
   3.915050870090647*^9, 3.915050870405824*^9}, {3.915535455884151*^9, 
   3.9155354562748137`*^9}},
 CellLabel->
  "Out[279]=",ExpressionUUID->"24308a22-ec99-4bd0-b78e-2115f7817e80"],

Cell[BoxData["\<\"AddKnowledge[ Statements, Rule ]\"\>"], "Output",
 CellChangeTimes->{{3.911252420423945*^9, 3.911252421454321*^9}, {
   3.911254380975369*^9, 3.911254381349393*^9}, {3.911254645572096*^9, 
   3.911254645886293*^9}, {3.9112904602101517`*^9, 3.911290460573621*^9}, 
   3.912268028016509*^9, {3.912546351638833*^9, 3.912546352104939*^9}, {
   3.9125890702460318`*^9, 3.912589070569112*^9}, {3.912600349868374*^9, 
   3.912600350166247*^9}, {3.912601704787597*^9, 3.912601705098494*^9}, {
   3.915050870090647*^9, 3.915050870405824*^9}, {3.915535455884151*^9, 
   3.915535456275402*^9}},
 CellLabel->
  "Out[280]=",ExpressionUUID->"5d99f790-9eba-4888-a19f-3adcdfd67156"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}]], "Code",
 CellLabel->
  "In[281]:=",ExpressionUUID->"70a373d6-58e0-41f4-9667-8bbf83c68a76"],

Cell[BoxData["\<\"logic`Private`\"\>"], "Output",
 CellChangeTimes->{{3.911252420437938*^9, 3.9112524214680624`*^9}, {
   3.911254380983081*^9, 3.911254381365373*^9}, {3.911254645575198*^9, 
   3.911254645891246*^9}, {3.911290460222426*^9, 3.911290460577024*^9}, 
   3.912268028026205*^9, {3.91254635164194*^9, 3.912546352107987*^9}, {
   3.912589070254467*^9, 3.91258907057902*^9}, {3.912600349881025*^9, 
   3.912600350173528*^9}, {3.9126017047908373`*^9, 3.91260170510846*^9}, {
   3.915050870100545*^9, 3.91505087041295*^9}, {3.915535455893355*^9, 
   3.9155354562829857`*^9}},
 CellLabel->
  "Out[281]=",ExpressionUUID->"c98209a2-c21c-4b5a-bee3-dda5e9fcd30c"]
}, Open  ]],

Cell["\<\
Question first makes a fresh variable in the Module expression. The \
superficial name of the fresh variable is Answer, but, internally, \
Mathematica makes session-fresh name of the form $479 that is guaranteed not \
to collide with any other variable in this session. \
\>", "Text",ExpressionUUID->"ccdb8890-3d8a-4d10-a70f-0dc2621870ff"],

Cell["\<\
The first argument of the Cases expression is a ReplaceRepeated expression \
(the original was \"ReplaceAll,\" but it did not yield sufficient results). \
It searches the given knowledge base for all terms matching the pattern and \
rewrites them to Answer[X], where X is the declared variable provided by the \
user in the third parameter position of the Question expression. This is the \
input list that Cases will search. Cases then searches the resulting list for \
terms matching Answer[_], that is, Answer[anything], and rewrites the Answers \
to Sequences, stripping off the placeholder name Answer, so that the final \
results just appear in list form.\
\>", "Text",ExpressionUUID->"e4e596fc-7bb7-406e-82cb-60b06068e78a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Question", "[", 
    RowBox[{"Knowledge_", ",", " ", "Patt_", " ", ",", " ", "X_"}], " ", 
    "]"}], " ", ":=", "\n", "  ", 
   RowBox[{"Module", "[", " ", 
    RowBox[{
     RowBox[{"{", "Answer", "}"}], ",", " ", "\n", "    ", 
     RowBox[{
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"Knowledge", " ", "//.", " ", 
         RowBox[{"Patt", " ", "->", " ", 
          RowBox[{"Answer", "[", "X", "]"}]}]}], ",", "\n", "\t  ", 
        RowBox[{"Answer", "[", "_", "]"}]}], "]"}], " ", "/.", " ", 
      RowBox[{"Answer", " ", "->", " ", "Sequence"}]}]}], " ", "]"}]}], 
  ";"}]], "Code",
 CellLabel->
  "In[282]:=",ExpressionUUID->"c182ccde-9376-4f20-80fa-dc5a5637a2fc"],

Cell["\<\
The second form of Question just yields \"True\" or \"False.\" Cabrera's \
original (commented out) was not able to recognize questions of the form \
Question[Knowledge, Statements[ . . . ]], but the following will do.\
\>", "Text",ExpressionUUID->"febc8aec-bd65-415a-9892-805a157bdc94"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Question", "[", 
    RowBox[{"Knowledge_", ",", " ", "Patt_"}], "]"}], " ", ":=", "\n", "  ", 
   RowBox[{
    RowBox[{"Question", "[", 
     RowBox[{"Knowledge", ",", " ", "Patt", ",", " ", 
      RowBox[{"Unique", "[", "]"}]}], "]"}], " ", "=!=", " ", 
    RowBox[{"{", "}"}]}]}], ";"}], "\n", 
 RowBox[{"  ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Cases", "[", 
      RowBox[{"Knowledge", ",", " ", "Patt"}], " ", "]"}], " ", "=!=", " ", 
     RowBox[{"{", "}"}]}], ";"}], "*)"}]}]}], "Code",
 CellLabel->
  "In[283]:=",ExpressionUUID->"de1b7fa3-acc0-4c62-a391-3d64ba46525c"],

Cell["\<\
This implementation of AddKnowledge just brute-forces all implications of the \
rules into the factbase. This is not scaleable. UNDONE: fix\
\>", "Text",ExpressionUUID->"ea361154-181f-4a12-bedd-239727b6fc22"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AddKnowledge", "[", 
    RowBox[{"K_", ",", " ", "R_"}], "]"}], ":=", " ", 
   RowBox[{"Union", "[", 
    RowBox[{"K", ",", " ", 
     RowBox[{"K", " ", "//.", " ", "R"}]}], "]"}]}], ";"}]], "Code",
 CellLabel->
  "In[284]:=",ExpressionUUID->"392e5c30-0fcf-4a34-bb33-71158e62ad02"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"End", "[", "]"}]], "Code",
 CellLabel->
  "In[285]:=",ExpressionUUID->"5b316a92-1275-4a01-a54b-f107c87eb273"],

Cell[BoxData["\<\"logic`Private`\"\>"], "Output",
 CellChangeTimes->{{3.9112524204487*^9, 3.911252421490277*^9}, {
   3.911254381032054*^9, 3.911254381387466*^9}, {3.9112546455949593`*^9, 
   3.911254645903835*^9}, {3.9112904602380867`*^9, 3.911290460591934*^9}, 
   3.912268028042988*^9, {3.912546351657949*^9, 3.9125463521230783`*^9}, {
   3.912589070267542*^9, 3.912589070594427*^9}, {3.912600349895255*^9, 
   3.912600350188618*^9}, {3.9126017048070793`*^9, 3.912601705125085*^9}, {
   3.915050870116569*^9, 3.915050870421483*^9}, {3.915535455912863*^9, 
   3.915535456295813*^9}},
 CellLabel->
  "Out[285]=",ExpressionUUID->"004e7537-cc60-4b1e-834e-683b1cda8a0d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"EndPackage", "[", "]"}]], "Code",
 CellLabel->
  "In[286]:=",ExpressionUUID->"32904070-37d7-4c7e-951d-3a300a56822a"]
}, Closed]],

Cell[CellGroupData[{

Cell["Jacquard.m", "Section",
 CellChangeTimes->{{3.911251932352053*^9, 
  3.911251934588236*^9}},ExpressionUUID->"50f6b680-f159-4cfc-b5a6-\
1b411b2581d4"],

Cell[CellGroupData[{

Cell["Jacquard and JaqSON", "Subsection",ExpressionUUID->"3e003909-6dc1-4231-bb8d-e32278bf5875"],

Cell["Serialized expressions for remote evaluation.", "Text",ExpressionUUID->"e0d0e1ea-ece9-4ee5-bb09-c23d9ed2f8b4"],

Cell["\<\
Brian Beckman
Februrary 2012
with ideas from Avi Bar-Zeev, Erik Meijer, and Savas Parastiditis\
\>", "Text",ExpressionUUID->"9cbec83e-0f13-4051-9fd3-6380779dedc3"],

Cell["\<\
Copyright (c) 2012, Microsoft Corporation

   Licensed under the Apache License, Version 2.0 (the \"License\");
   you may not use this file except in compliance with the License.
   You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE-2.0

   Unless required by applicable law or agreed to in writing, software
   distributed under the License is distributed on an \"AS IS\" BASIS,
   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   See the License for the specific language governing permissions and
   limitations under the License.\
\>", "Text",
 FontColor->RGBColor[
  0, 0, 1],ExpressionUUID->"09e028ad-842a-4d3d-bf41-ac651a49d51f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Public Interface", "Subsection",ExpressionUUID->"7e917cd6-ed45-4b15-9ad1-6ac57c27b04b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Mathematica", " ", "Package"}], " ", "*)"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Created", " ", "by", " ", "the", " ", "Wolfram", " ", "Workbench", " ", 
     "Mar", " ", "8"}], ",", " ", "2012"}], " ", "*)"}], "\n", "\n", 
  RowBox[{"(*", 
   RowBox[{"BeginPackage", "[", 
    RowBox[{"\"\<Jacquard`\>\"", ",", " ", 
     RowBox[{"{", 
      RowBox[{"\"\<JLink`\>\"", ",", " ", "\"\<MiniData`\>\""}], "}"}]}], 
    "]"}], "*)"}], "\n", 
  RowBox[{
   RowBox[{"BeginPackage", "[", 
    RowBox[{"\"\<Jacquard`\>\"", ",", " ", 
     RowBox[{"{", "\"\<JLink`\>\"", "}"}]}], "]"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Exported", " ", "symbols", " ", "added", " ", "here", " ", "with", " ", 
     RowBox[{"SymbolName", "::", "usage"}]}], " ", "*)"}], " ", "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"gridExpression", "::", "usage"}], " ", "=", " ", 
     "\"\<Displays expressions in a hierarchical grid.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"gridCaptive", "::", "usage"}], " ", "=", " ", 
     "\"\<Displays captive expressions in a hierarchical grid.\>\""}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"gridCaptive2", "::", "usage"}], " ", "=", " ", 
     "\"\<Displays captive expressions in a hierarchical grid.\>\""}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"gridRules", "::", "usage"}], " ", "=", " ", 
     "\"\<Displays Lists of Rules and Lists of Lists of Rules in a \
hierarchical grid.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"traceView2", "::", "usage"}], " ", "=", " ", 
     "\"\<Presents Cascading OpenerViews of an expression trace.\>\""}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"traceView4", "::", "usage"}], " ", "=", " ", 
     "\"\<Presents interactive, button-driven view of an \
expression-evaluation trace.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"traceView5", "::", "usage"}], " ", "=", " ", 
     "\"\<Presents an abbreviated button-driven view of an \
expression-evaluation trace.\>\""}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolQ", "::", "usage"}], " ", "=", " ", 
     "\"\<Tests whether its argument is a Symbol\>\""}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"KvpQ", "::", "usage"}], " ", "=", " ", 
     "\"\<Tests whether its argument is a KVPair or KVP, that is, a list of \
two values, the first of which is a string or symbol Key.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"KvpsQ", "::", "usage"}], " ", "=", " ", 
     "\"\<Tests whether its argument is an association list: that is, a list \
of key-value pairs where no key appears more than once.\>\""}], ";"}], "\n", 
   "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"RulesQ", "::", "usage"}], " ", "=", " ", 
     "\"\<Tests whether its argument is a list of Rules, which is the \
Import/Export preferred representation for key-value pairs (the analog to \
'lookup' for rules is just 'Replace.')\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"RulessQ", "::", "usage"}], " ", "=", " ", 
     "\"\<Tests whether its argument is a list of list of Rules, which is the \
preferred representation for argument lists.\>\""}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Args", "::", "usage"}], " ", "=", " ", 
     "\"\<Produces all the arguments of a composite expression; counterpoint \
to built-in Head.\>\""}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"rulesFromExpression", "::", "usage"}], " ", "=", " ", 
     "\"\<Documentation TODO\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"rulesFromHeldExpression", "::", "usage"}], " ", "=", " ", 
     "\"\<Documentation TODO\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"rulesFromEvaluatableHeldExpression", "::", "usage"}], " ", "=", 
     " ", "\"\<Documentation TODO\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"expressionFromRules", "::", "usage"}], " ", "=", " ", 
     "\"\<Documentation TODO\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"stringifiedExpressionFromRules", "::", "usage"}], " ", "=", 
     " ", "\"\<Documentation TODO\>\""}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"jsonStringFromExpression", "::", "usage"}], " ", "=", " ", 
     "\"\<jsonStringFromExpression[expr]\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"jsonStringFromHeldExpression", "::", "usage"}], " ", "=", " ", 
     "\"\<jsonStringFromHeldExpression[expr]\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"expressionFromJsonString", "::", "usage"}], " ", "=", " ", 
     "\"\<expressionFromJsonString[str]\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"stringifiedExpressionFromJsonString", "::", "usage"}], " ", "=",
      " ", "\"\<stringifiedExpressionFromJsonString[str]\>\""}], ";"}], "\n", 
   "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"jacquardPostRules", "::", "usage"}], " ", "=", " ", 
     "\"\<jacquardPostRules[rules, importer, url]\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"jacquardPostExpression", "::", "usage"}], " ", "=", " ", 
     "\"\<jacquardPostRules[rules, importer, url]\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"jacquardEvalExpression", "::", "usage"}], " ", "=", " ", 
     "\"\<jacquardPostExpression[expr, importer, url]\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"jacquardEvalHeldExpression", "::", "usage"}], " ", "=", " ", 
     "\"\<jacquardEvalHeldExpression[expr, importer, url]\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"jacquardEvalEvaluatableHeldExpression", "::", "usage"}], " ", 
     "=", " ", "\"\<jacquardEvalHeldExpression[expr, importer, url]\>\""}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"jacquardStringifiedEvalHeldExpression", "::", "usage"}], " ", 
     "=", " ", 
     "\"\<jacquardStringifiedEvalHeldExpression[expr, importer, url]\>\""}], 
    ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"During", " ", "Development"}], ",", " ", 
     RowBox[{"keep", " ", "these", " ", "symbols", " ", 
      RowBox[{"public", ".", "  ", "Pick"}], " ", "which", " ", "ones", "\n", 
      "   ", "to", " ", "make", " ", "permanently", " ", "public", " ", 
      RowBox[{"later", "."}]}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"insertCommaSeparators", "::", "usage"}], " ", "=", " ", 
     "\"\<Temporary.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"number2", "::", "usage"}], " ", "=", " ", 
     "\"\<Temporary.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"string2", "::", "usage"}], " ", "=", " ", 
     "\"\<Temporary.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"symbol2", "::", "usage"}], " ", "=", " ", 
     "\"\<Temporary.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"dpyCaptive2", "::", "usage"}], " ", "=", " ", 
     "\"\<Temporary.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"prefixes", "::", "usage"}], " ", "=", " ", 
     "\"\<Temporary.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"postfixes", "::", "usage"}], " ", "=", " ", 
     "\"\<Temporary.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"splits", "::", "usage"}], " ", "=", " ", "\"\<Temporary.\>\""}],
     ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"flat1", "::", "usage"}], " ", "=", " ", "\"\<Temporary.\>\""}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Pluck", "::", "usage"}], " ", "=", " ", 
     "\"\<Pluck[n] is a Function that produces the n-th Part of its \
input.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"SelectMany", "::", "usage"}], " ", "=", " ", 
     "\"\<SelectMany[list, listFromElement]\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Zip", "::", "usage"}], " ", "=", " ", 
     "\"\<Zip[list1, list2, itemFromPair]\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ZipMany", "::", "usage"}], " ", "=", " ", 
     "\"\<ZipMany[list1, list2, listFromPair]\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"captive", "::", "usage"}], " ", "=", " ", 
     "\"\<Temporary.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"captive2", "::", "usage"}], " ", "=", " ", 
     "\"\<Temporary.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"RealQ", "::", "usage"}], " ", "=", " ", "\"\<Temporary.\>\""}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ComplexQ", "::", "usage"}], " ", "=", " ", 
     "\"\<Temporary.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"RationalQ", "::", "usage"}], " ", "=", " ", 
     "\"\<Temporary.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"numericSubtype", "::", "usage"}], " ", "=", " ", 
     "\"\<Temporary.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"pairsQ", "::", "usage"}], " ", "=", " ", "\"\<Temporary.\>\""}],
     ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"keys", "::", "usage"}], " ", "=", " ", "\"\<Temporary.\>\""}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"values", "::", "usage"}], " ", "=", " ", "\"\<Temporary.\>\""}],
     ";"}]}]}]], "Code",
 CellLabel->
  "In[287]:=",ExpressionUUID->"bbf0a4e9-f04a-4cf8-9255-65f68f7c4b51"],

Cell[BoxData["\<\"Jacquard`\"\>"], "Output",
 CellChangeTimes->{{3.911252420463434*^9, 3.911252421506283*^9}, {
   3.91125438105021*^9, 3.911254381392432*^9}, {3.911254645608398*^9, 
   3.911254645916486*^9}, {3.91129046025438*^9, 3.911290460607449*^9}, 
   3.912268028053747*^9, {3.912546351673561*^9, 3.912546352134307*^9}, {
   3.912589070278297*^9, 3.912589070606277*^9}, {3.912600349900218*^9, 
   3.912600350199449*^9}, {3.912601704812088*^9, 3.912601705138986*^9}, {
   3.915050870125964*^9, 3.915050870431027*^9}, {3.9155354559257193`*^9, 
   3.9155354563089857`*^9}},
 CellLabel->
  "Out[287]=",ExpressionUUID->"9e656021-a4ca-41c5-b409-c6db8ff83b2e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], "\n", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Implementation", " ", "of", " ", "the", " ", "package"}], " ", 
   "*)"}]}]}], "Code",
 CellLabel->
  "In[338]:=",ExpressionUUID->"9c5b7e61-7f6e-4168-98ab-efe6d40abe70"],

Cell[BoxData["\<\"Jacquard`Private`\"\>"], "Output",
 CellChangeTimes->{{3.911252420472388*^9, 3.911252421509484*^9}, {
   3.911254381065897*^9, 3.9112543813949327`*^9}, {3.911254645615882*^9, 
   3.911254645923902*^9}, {3.91129046026213*^9, 3.911290460617468*^9}, 
   3.91226802805684*^9, {3.912546351675963*^9, 3.912546352145319*^9}, {
   3.912589070286002*^9, 3.9125890706134043`*^9}, {3.912600349906547*^9, 
   3.912600350202265*^9}, {3.912601704818648*^9, 3.912601705141583*^9}, {
   3.915050870129239*^9, 3.915050870437132*^9}, {3.915535455928396*^9, 
   3.915535456311475*^9}},
 CellLabel->
  "Out[338]=",ExpressionUUID->"e1d1f272-7df6-48b0-9dff-91d9c468da67"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Visualization and Debugging Definitions", "Subsection",ExpressionUUID->"a009f09d-020b-4026-b747-def03fad83e9"],

Cell[CellGroupData[{

Cell["gridRules[ rules ]", "Subsubsection",ExpressionUUID->"dace2c55-db13-4322-b6f5-ddeb87e09e9e"],

Cell["\<\
Display rules generated from expressions and round-tripped through JSON. \
Update to handle Rule-Delayed.\
\>", "Text",ExpressionUUID->"1b3a83a6-8624-469e-89ab-9b41c9ee02ce"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"gridRules", ",", "fopts"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "allAreRulesQ", ",", "noneAreAtomsQ", ",", "noneAreAtomsOrListsQ"}], 
    "]"}], ";"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "A", " ", "\"\<HoldAll\>\"", " ", "version", " ", "of", " ", "the", " ", 
     "following"}], ",", " ", 
    RowBox[{"with", " ", "\"\<Unevaluated\>\"", " ", "everywhere"}], ",", " ", 
    RowBox[{"may", " ", "be", " ", 
     RowBox[{"required", "."}]}]}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"noneAreAtomsQ", "[", "candidates_List", "]"}], ":=", 
   RowBox[{"And", "@@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Not", "[", 
        RowBox[{"AtomQ", "@", "#"}], "]"}], "&"}], "/@", "candidates"}], 
     ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"noneAreAtomsOrListsQ", "[", "candidates_List", "]"}], ":=", 
  RowBox[{"And", "@@", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Not", "[", 
        RowBox[{
         RowBox[{"AtomQ", "@", "#"}], "||", 
         RowBox[{"ListQ", "@", "#"}]}], "]"}], ")"}], "&"}], "/@", 
     "candidates"}], ")"}]}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"allAreRulesQ", "[", "candidates_List", "]"}], ":=", 
   RowBox[{"And", "@@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"h", "=", 
           RowBox[{"Head", "@", "#"}]}], "}"}], ",", 
         RowBox[{
          RowBox[{"h", "===", "Rule"}], "||", 
          RowBox[{"h", "===", "RuleDelayed"}]}]}], "]"}], "&"}], "/@", 
      "candidates"}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"fopts", "[", 
    RowBox[{"fcolor_", ",", "bcolor_"}], "]"}], ":=", 
   RowBox[{"Sequence", "[", 
    RowBox[{
     RowBox[{"Frame", " ", "->", " ", "All"}], ",", 
     RowBox[{"Alignment", " ", "->", " ", "Left"}], ",", 
     RowBox[{"FrameStyle", " ", "->", " ", "fcolor"}], ",", "\n", 
     RowBox[{"Background", " ", "->", " ", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"LightOrange", ",", " ", 
         RowBox[{"{", "bcolor", "}"}]}], "}"}], "}"}]}]}], "]"}]}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"gridRules", "[", 
     RowBox[{"Rule", "[", 
      RowBox[{"key_", ",", " ", "val_"}], "]"}], "]"}], ":=", "\n", 
    RowBox[{"Grid", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{
           RowBox[{"gridRules", "@", "key"}], ",", "Bold", ",", "Black"}], 
          "]"}], ",", 
         RowBox[{"Style", "[", 
          RowBox[{
           RowBox[{"gridRules", " ", "@", " ", "val"}], ",", "Bold", ",", " ",
            "Blue"}], "]"}]}], "}"}], "}"}], ",", "\n", 
      RowBox[{"fopts", "[", 
       RowBox[{"Blue", ",", "LightYellow"}], "]"}]}], "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"gridRules", "[", 
     RowBox[{"RuleDelayed", "[", 
      RowBox[{"key_", ",", " ", "val_"}], "]"}], "]"}], ":=", "\n", 
    RowBox[{"Grid", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{
           RowBox[{"gridRules", "@", "key"}], ",", "Bold", ",", "Black"}], 
          "]"}], ",", 
         RowBox[{"Style", "[", 
          RowBox[{
           RowBox[{"gridRules", " ", "@", " ", "val"}], ",", "Bold", ",", " ",
            "Red"}], "]"}]}], "}"}], "}"}], ",", "\n", 
      RowBox[{"fopts", "[", 
       RowBox[{"Red", ",", "LightYellow"}], "]"}]}], "]"}]}], ";"}], "\n", 
  "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Put", " ", "lists", " ", "of", " ", "non"}], "-", 
     RowBox[{
     "atoms", " ", "vertically", " ", "and", " ", "joinGrids", " ", "them", 
      " ", "up"}]}], ",", " ", 
    RowBox[{"removing", " ", "one", " ", "level", " ", "of", " ", 
     RowBox[{"nesting", "."}]}]}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"gridRules", "[", 
     RowBox[{"exprs_List", "?", "noneAreAtomsOrListsQ"}], "]"}], ":=", "\n", 
    RowBox[{"Grid", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"joinGrids", "@", 
        RowBox[{"Transpose", "@", 
         RowBox[{"{", 
          RowBox[{"gridRules", " ", "/@", " ", "exprs"}], "}"}]}]}], ")"}], 
      ",", "\n", 
      RowBox[{"Frame", "->", "All"}], ",", 
      RowBox[{"FrameStyle", "->", 
       RowBox[{"Darker", "[", "Green", "]"}]}], ",", 
      RowBox[{"Alignment", "->", "Left"}], ",", 
      RowBox[{"Background", "->", "LightGreen"}]}], "]"}]}], ";"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Put", " ", "other", " ", "lists", " ", "vertically", " ", "but", " ", 
    RowBox[{"DON", "'"}], "T", " ", "joinGrids", " ", "them", " ", 
    RowBox[{"up", "."}]}], " ", "*)"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"gridRules", "[", "exprs_List", "]"}], ":=", "\n", 
    RowBox[{"Grid", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{"gridRules", " ", "/@", " ", "exprs"}], "}"}]}], ")"}], ",", 
      "\n", 
      RowBox[{"Frame", "->", "All"}], ",", 
      RowBox[{"FrameStyle", "->", 
       RowBox[{"Darker", "[", "Green", "]"}]}], ",", 
      RowBox[{"Alignment", "->", "Left"}], ",", 
      RowBox[{"Background", "->", "LightGreen"}]}], "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"gridRules", "[", 
     RowBox[{"h_", "[", "parts___", "]"}], "]"}], ":=", "\n", 
    RowBox[{"Grid", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Style", "[", 
          RowBox[{
           RowBox[{"gridRules", "@", "h"}], ",", "Bold", ",", " ", 
           RowBox[{"Darker", "[", "Purple", "]"}]}], "]"}], "}"}], "~", 
        "Join", "~", 
        RowBox[{"(", 
         RowBox[{"gridRules", " ", "/@", " ", 
          RowBox[{"{", "parts", "}"}]}], ")"}]}], "}"}], ",", "\n", 
      RowBox[{"fopts", "[", 
       RowBox[{"Black", ",", "LightGreen"}], "]"}]}], "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"gridRules", "[", 
     RowBox[{"any_", "?", "StringQ"}], "]"}], ":=", 
    RowBox[{"Style", "[", 
     RowBox[{
      RowBox[{"Grid", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", "any", "}"}], "}"}], ",", 
        RowBox[{"Alignment", "->", "Left"}]}], "]"}], ",", "Bold", ",", 
      RowBox[{"Darker", "[", "Red", "]"}]}], "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"gridRules", "[", 
     RowBox[{"any_", "?", "AtomQ"}], "]"}], ":=", 
    RowBox[{"Style", "[", 
     RowBox[{
      RowBox[{"Grid", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", "any", "}"}], "}"}], ",", 
        RowBox[{"Alignment", "->", "Left"}]}], "]"}], ",", "Bold"}], "]"}]}], 
   ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"gridRules", "[", "any_", "]"}], ":=", 
    RowBox[{"Grid", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"{", "any", "}"}], "}"}], ",", 
      RowBox[{"Alignment", "->", "Left"}]}], "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "joinGrids", "]"}], ";"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Arbitrarily", " ", "choose", " ", "the", " ", "first", " ", "of", " ", 
     "multiple", " ", "option", " ", "tails", " ", "z1"}], ",", " ", "z2", 
    ",", " ", 
    RowBox[{"...", " ", "."}]}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"joinGrids", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Grid", "[", 
        RowBox[{
         RowBox[{"{", "xs__", "}"}], ",", "z1___"}], "]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Grid", "[", 
        RowBox[{
         RowBox[{"{", "ys__", "}"}], ",", "z2___"}], "]"}], "}"}]}], "}"}], 
    "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"Grid", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"xs", ",", "ys"}], "}"}], ",", "z1"}], "]"}], "}"}], "}"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"joinGrids", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Grid", "[", 
        RowBox[{
         RowBox[{"{", "xs__", "}"}], ",", "z1___"}], "]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Grid", "[", 
        RowBox[{
         RowBox[{"{", "ys__", "}"}], ",", "z2___"}], "]"}], "}"}], ",", " ", 
      "k__"}], "}"}], "]"}], ":=", 
   RowBox[{"joinGrids", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Grid", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"xs", ",", "ys"}], "}"}], ",", "z1"}], "]"}], "}"}], ",", 
      "k"}], "}"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"joinGrids", "[", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"Grid", "[", "xs___", "]"}], "}"}], "}"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"Grid", "[", "xs", "]"}], "}"}], "}"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"joinGrids", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Style", "[", 
        RowBox[{
         RowBox[{"Grid", "[", 
          RowBox[{
           RowBox[{"{", "xs__", "}"}], ",", "z1___"}], "]"}], ",", 
         "sty1___"}], "]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Style", "[", 
        RowBox[{
         RowBox[{"Grid", "[", 
          RowBox[{
           RowBox[{"{", "ys__", "}"}], ",", "z2___"}], "]"}], ",", 
         "sty2___"}], "]"}], "}"}]}], "}"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{"Grid", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"xs", ",", "ys"}], "}"}], ",", "z1"}], "]"}], ",", "sty1"}],
       "]"}], "}"}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"joinGrids", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"Grid", "[", 
           RowBox[{
            RowBox[{"{", "xs__", "}"}], ",", "z1___"}], "]"}], ",", 
          "sty1___"}], "]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"Grid", "[", 
           RowBox[{
            RowBox[{"{", "ys__", "}"}], ",", "z2___"}], "]"}], ",", 
          "sty2___"}], "]"}], "}"}], ",", " ", "k__"}], "}"}], "]"}], ":=", 
    RowBox[{"joinGrids", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"Grid", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"xs", ",", "ys"}], "}"}], ",", "z1"}], "]"}], ",", 
          "sty1"}], "]"}], "}"}], ",", "k"}], "}"}], "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"joinGrids", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Style", "[", 
        RowBox[{
         RowBox[{"Grid", "[", 
          RowBox[{
           RowBox[{"{", "xs__", "}"}], ",", "z1___"}], "]"}], ",", 
         "sty1___"}], "]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Grid", "[", 
        RowBox[{
         RowBox[{"{", "ys__", "}"}], ",", "z2___"}], "]"}], "}"}]}], "}"}], 
    "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{"Grid", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"xs", ",", "ys"}], "}"}], ",", "z1"}], "]"}], ",", "sty1"}],
       "]"}], "}"}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"joinGrids", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"Grid", "[", 
           RowBox[{
            RowBox[{"{", "xs__", "}"}], ",", "z1___"}], "]"}], ",", 
          "sty1___"}], "]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Grid", "[", 
         RowBox[{
          RowBox[{"{", "ys__", "}"}], ",", "z2___"}], "]"}], "}"}], ",", " ", 
       "k__"}], "}"}], "]"}], ":=", 
    RowBox[{"joinGrids", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"Grid", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"xs", ",", "ys"}], "}"}], ",", "z1"}], "]"}], ",", 
          "sty1"}], "]"}], "}"}], ",", "k"}], "}"}], "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"joinGrids", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Grid", "[", 
        RowBox[{
         RowBox[{"{", "xs__", "}"}], ",", "z1___"}], "]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Style", "[", 
        RowBox[{
         RowBox[{"Grid", "[", 
          RowBox[{
           RowBox[{"{", "ys__", "}"}], ",", "z2___"}], "]"}], ",", 
         "sty2___"}], "]"}], "}"}]}], "}"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{"Grid", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"xs", ",", "ys"}], "}"}], ",", "z1"}], "]"}], ",", "sty2"}],
       "]"}], "}"}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"joinGrids", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Grid", "[", 
         RowBox[{
          RowBox[{"{", "xs__", "}"}], ",", "z1___"}], "]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"Grid", "[", 
           RowBox[{
            RowBox[{"{", "ys__", "}"}], ",", "z2___"}], "]"}], ",", 
          "sty2___"}], "]"}], "}"}], ",", " ", "k__"}], "}"}], "]"}], ":=", 
    RowBox[{"joinGrids", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"Grid", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"xs", ",", "ys"}], "}"}], ",", "z1"}], "]"}], ",", 
          "sty2"}], "]"}], "}"}], ",", "k"}], "}"}], "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"joinGrids", "[", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"Style", "[", 
        RowBox[{
         RowBox[{"Grid", "[", "xs___", "]"}], ",", "sty___"}], "]"}], "}"}], 
      "}"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"Style", "[", 
       RowBox[{
        RowBox[{"Grid", "[", "xs", "]"}], ",", "sty"}], "]"}], "}"}], "}"}]}],
    ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"joinGrids", "[", 
    RowBox[{"{", "}"}], "]"}], ":=", 
   RowBox[{"{", "}"}]}], ";"}]}], "Code",
 CellLabel->
  "In[339]:=",ExpressionUUID->"9ac91e56-726a-499e-bd0e-5d168452161f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Private Display (dpy) Definitions", "Subsection",ExpressionUUID->"3d3054f8-3af6-4e80-a38d-ec9db800363b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dpyNullary", "[", "ex_", "]"}], " ", ":=", "\n", "  ", 
   RowBox[{"Grid", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"ex", ",", " ", "\"\<\>\""}], "}"}], "}"}], ",", "\n", "   ", 
     RowBox[{"Frame", "      ", "->", " ", 
      RowBox[{"{", 
       RowBox[{"All", ",", "False"}], "}"}]}], ",", "\n", "   ", 
     RowBox[{"Alignment", "  ", "->", " ", "Left"}], ",", "\n", "   ", 
     RowBox[{"Background", " ", "->", " ", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"LightOrange", ",", 
         RowBox[{"{", "LightYellow", "}"}]}], "}"}], "}"}]}]}], "]"}]}], 
  ";"}]], "Code",
 CellLabel->
  "In[365]:=",ExpressionUUID->"ae303bdb-2661-4de4-bfcd-24562b7fc12e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dpyMultiary", "[", 
    RowBox[{"key_", ",", " ", "vals_"}], "]"}], " ", ":=", "\n", "   ", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"c", " ", "=", " ", 
       RowBox[{"Length", " ", "@", " ", "vals"}]}], "}"}], ",", "\n", "    ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "\n", "      ", 
        RowBox[{
         RowBox[{"spans", " ", "=", " ", 
          RowBox[{"Table", "[", 
           RowBox[{"\"\<\>\"", ",", " ", 
            RowBox[{"{", "c", "}"}]}], "]"}]}], ",", "\n", "      ", 
         RowBox[{"slot", "  ", "=", " ", 
          RowBox[{"Floor", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "+", "c"}], ")"}], "/", "2"}], "]"}]}]}], "}"}], 
       ",", "\n", "     ", 
       RowBox[{
        RowBox[{
         RowBox[{"spans", "[", 
          RowBox[{"[", "slot", "]"}], "]"}], " ", "=", " ", "key"}], ";", 
        "\n", "     ", 
        RowBox[{"Grid", "[", 
         RowBox[{
          RowBox[{"MapThread", "[", 
           RowBox[{"List", ",", 
            RowBox[{"{", 
             RowBox[{"spans", ",", " ", "vals"}], "}"}]}], "]"}], ",", "\n", 
          "       ", 
          RowBox[{"Frame", "      ", "->", " ", 
           RowBox[{"{", 
            RowBox[{"All", ",", "False"}], "}"}]}], ",", "\n", "       ", 
          RowBox[{"Alignment", "  ", "->", " ", "Left"}], ",", "\n", 
          "       ", 
          RowBox[{"Background", " ", "->", " ", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"LightOrange", ",", 
              RowBox[{"{", "LightGreen", "}"}]}], "}"}], "}"}]}]}], "]"}]}]}],
       "\n", "      ", "]"}]}], "]"}]}], ";"}]], "Code",
 CellLabel->
  "In[366]:=",ExpressionUUID->"35a64258-27db-44af-b820-1ae215a037e5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dpyAtom", "[", "ex_", "]"}], " ", ":=", " ", "\n", "  ", 
   RowBox[{"Grid", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"Style", "[", 
        RowBox[{"ex", ",", "Bold"}], "]"}], "}"}], "}"}], ",", "\n", "   ", 
     RowBox[{"Frame", "      ", "->", " ", "All"}], ",", "\n", "   ", 
     RowBox[{"Alignment", "  ", "->", " ", "Left"}], ",", "\n", "   ", 
     RowBox[{"Background", " ", "->", "\n", "     ", 
      RowBox[{"Switch", "[", 
       RowBox[{
        RowBox[{"Head", " ", "@", " ", "ex"}], ",", "\n", "       ", "String",
         ",", "   ", "LightYellow", ",", "\n", "       ", "Symbol", ",", 
        "   ", "LightPurple", ",", "\n", "       ", "Integer", ",", "  ", 
        "LightBlue", ",", "\n", "       ", "Real", ",", "     ", "LightBlue", 
        ",", "\n", "       ", "Rational", ",", " ", "LightBlue", ",", "\n", 
        "       ", "Complex", ",", "  ", "LightBlue", ",", "\n", "       ", 
        "_", ",", "        ", "Red"}], "]"}]}]}], "]"}]}], ";"}]], "Code",
 CellLabel->
  "In[367]:=",ExpressionUUID->"7587407d-b49d-472f-be4e-dde66545014c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dpyQuotedAtom", "[", 
    RowBox[{"number2", "[", "ex_", "]"}], "]"}], " ", ":=", " ", "\n", "  ", 
   RowBox[{"Grid", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"Style", "[", 
        RowBox[{"ex", ",", "Bold", ",", "Blue"}], "]"}], "}"}], "}"}], ",", 
     "\n", "   ", 
     RowBox[{"Frame", "      ", "->", " ", "All"}], ",", "\n", "   ", 
     RowBox[{"Alignment", "  ", "->", " ", "Left"}], ",", "\n", "   ", 
     RowBox[{"Background", " ", "->", " ", "LightBlue"}]}], "]"}]}], 
  ";"}]], "Code",
 CellLabel->
  "In[368]:=",ExpressionUUID->"07cf428c-b860-4321-adce-c1128842c2fb"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dpyQuotedAtom", "[", 
    RowBox[{"string2", "[", "ex_", "]"}], "]"}], " ", ":=", " ", "\n", "  ", 
   RowBox[{"Grid", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"Style", "[", 
        RowBox[{"ex", ",", "Bold", ",", "Green"}], "]"}], "}"}], "}"}], ",", 
     "\n", "   ", 
     RowBox[{"Frame", "      ", "->", " ", "All"}], ",", "\n", "   ", 
     RowBox[{"Alignment", "  ", "->", " ", "Left"}], ",", "\n", "   ", 
     RowBox[{"Background", " ", "->", " ", "LightYellow"}]}], "]"}]}], 
  ";"}]], "Code",
 CellLabel->
  "In[369]:=",ExpressionUUID->"fc388fc0-a00c-440a-99b1-5067aef624e9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dpyQuotedAtom", "[", 
    RowBox[{"symbol2", "[", "ex_", "]"}], "]"}], " ", ":=", " ", "\n", "  ", 
   RowBox[{"Grid", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"Style", "[", 
        RowBox[{"ex", ",", "Bold", ",", "Purple"}], "]"}], "}"}], "}"}], ",", 
     "\n", "   ", 
     RowBox[{"Frame", "      ", "->", " ", "All"}], ",", "\n", "   ", 
     RowBox[{"Alignment", "  ", "->", " ", "Left"}], ",", "\n", "   ", 
     RowBox[{"Background", " ", "->", " ", "LightPurple"}]}], "]"}]}], 
  ";"}]], "Code",
 CellLabel->
  "In[370]:=",ExpressionUUID->"8eadd198-9e72-4167-be55-6c0e5e59e197"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dpyEmpty", "[", "]"}], " ", ":=", "\n", "  ", 
   RowBox[{"Grid", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "}"}], "}"}], ",", "\n", "   ", 
     RowBox[{"Frame", "      ", "->", " ", "All"}], ",", "\n", "   ", 
     RowBox[{"Alignment", "  ", "->", " ", "Left"}], ",", "\n", "   ", 
     RowBox[{"Background", " ", "->", " ", "White"}]}], "]"}]}], 
  ";"}]], "Code",
 CellLabel->
  "In[371]:=",ExpressionUUID->"ed06b9e4-5c49-407f-bb78-22dd08d5541e"],

Cell[CellGroupData[{

Cell["gridExpression[ expr ]", "Subsubsection",ExpressionUUID->"5befc0ce-e774-46a6-99c9-a467644aa361"],

Cell["Display a gridded representation of an expression.", "Text",ExpressionUUID->"c9a01d63-2d96-40c1-b37b-92cd0466e79e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"gridExpression", "[", 
    RowBox[{"ex_", "[", "]"}], "]"}], "        ", ":=", " ", 
   RowBox[{"dpyNullary", "[", 
    RowBox[{"gridExpression", " ", "@", " ", "ex"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"gridExpression", "[", 
    RowBox[{"ex_", "[", "parts__", "]"}], "]"}], " ", ":=", " ", 
   RowBox[{"dpyMultiary", "[", 
    RowBox[{
     RowBox[{"gridExpression", " ", "@", " ", "ex"}], ",", " ", 
     RowBox[{"gridExpression", " ", "/@", " ", 
      RowBox[{"{", "parts", "}"}]}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"gridExpression", "[", 
    RowBox[{"ex_", "?", "AtomQ"}], "]"}], "    ", ":=", " ", 
   RowBox[{"dpyAtom", "[", "ex", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"gridExpression", "[", "x___", "]"}], "         ", ":=", " ", 
   RowBox[{"Throw", "[", 
    RowBox[{"{", "x", "}"}], "]"}]}], ";"}]}], "Code",
 CellLabel->
  "In[372]:=",ExpressionUUID->"9ee7a5d6-c383-4334-b6c0-8cbc16b2b85d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["gridCaptive[ expr ]", "Subsubsection",ExpressionUUID->"9c0fd9c5-a913-4966-baac-1f0044cb2c11"],

Cell["\<\
Display a gridded representation of a captive (quoted) expression.\
\>", "Text",ExpressionUUID->"263d1904-7ac0-4b51-9c3b-ea18fa23d38a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SetAttributes", "[", 
    RowBox[{"gridCaptive", ",", " ", "HoldAllComplete"}], "]"}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"dpyCaptive", "[", 
    RowBox[{"{", "ex_", "}"}], "]"}], "      ", ":=", " ", 
   RowBox[{"dpyNullary", "[", 
    RowBox[{"dpyCaptive", " ", "@", " ", "ex"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"dpyCaptive", "[", 
    RowBox[{"{", 
     RowBox[{"a_", ",", " ", "as__"}], "}"}], "]"}], " ", ":=", " ", 
   RowBox[{"dpyMultiary", "[", 
    RowBox[{
     RowBox[{"dpyCaptive", " ", "@", " ", "a"}], ",", " ", 
     RowBox[{"dpyCaptive", " ", "/@", " ", 
      RowBox[{"{", "as", "}"}]}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"dpyCaptive", "[", 
    RowBox[{"ex_", "?", "AtomQ"}], "]"}], "  ", ":=", " ", 
   RowBox[{"dpyAtom", "[", "ex", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"dpyCaptive", "[", "x___", "]"}], "       ", ":=", " ", 
    RowBox[{"Throw", "[", 
     RowBox[{"Unevaluated", " ", "@", " ", 
      RowBox[{"{", "x", "}"}]}], "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"gridCaptive", "[", "expr_", "]"}], ":=", " ", 
   RowBox[{"dpyCaptive", " ", "@", " ", 
    RowBox[{"captive", " ", "@", " ", "expr"}]}]}], ";"}]}], "Code",
 CellLabel->
  "In[376]:=",ExpressionUUID->"a2d2c523-83ec-441c-8928-e17cba49756e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["captive2", "Subsubsection",ExpressionUUID->"d1fdf8ac-d64a-4841-ba11-bacbfacd8acb"],

Cell["TODO: deprecate the old captive", "Text",ExpressionUUID->"739e8507-efcc-4463-a864-decd2450d96a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"captive2", ",", " ", "HoldAllComplete"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"captive2", "[", 
   RowBox[{"expr_", " ", "/;", " ", 
    RowBox[{"NumberQ", " ", "@", " ", 
     RowBox[{"Unevaluated", " ", "@", " ", "expr"}]}]}], "]"}], "           ",
   ":=", " ", 
  RowBox[{"number2", "[", 
   RowBox[{"ToString", "[", "expr", "]"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"captive2", "[", 
   RowBox[{"expr_", " ", "/;", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Head", " ", "@", " ", 
       RowBox[{"Unevaluated", " ", "@", " ", "expr"}]}], " ", "===", " ", 
      "Symbol"}], ")"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"symbol2", "[", 
   RowBox[{"ToString", " ", "@", " ", 
    RowBox[{"Unevaluated", " ", "@", " ", "expr"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"captive2", "[", 
   RowBox[{"expr_", " ", "/;", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Head", " ", "@", " ", 
       RowBox[{"Unevaluated", " ", "@", " ", "expr"}]}], " ", "===", " ", 
      "String"}], ")"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"string2", "[", 
   RowBox[{
   "\"\<\\\"\>\"", " ", "<>", " ", "expr", " ", "<>", " ", "\"\<\\\"\>\""}], 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{"captive2", "[", 
   RowBox[{"head_", "[", "parts___", "]"}], "]"}], " ", ":=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"captive2", " ", "@", " ", "head"}], ",", " ", 
    RowBox[{"captive2", " ", "/@", " ", 
     RowBox[{"Unevaluated", " ", "@", " ", 
      RowBox[{"{", "parts", "}"}]}]}]}], "}"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"captive2", "[", "x___", "]"}], "           ", ":=", " ", 
   RowBox[{"Throw", " ", "@", " ", 
    RowBox[{"{", "x", "}"}]}]}], ";"}]}], "Code",
 CellLabel->
  "In[382]:=",ExpressionUUID->"b672afe7-5d90-4bf2-b6e3-c357bd245b96"]
}, Open  ]],

Cell[CellGroupData[{

Cell["gridCaptive2[ expr ]", "Subsubsection",ExpressionUUID->"c7e594a6-5748-4205-a233-b88c5174282e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SetAttributes", "[", 
    RowBox[{"gridCaptive2", ",", " ", "HoldAllComplete"}], "]"}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"dpyCaptive2", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"symbol2", "[", "\"\<List\>\"", "]"}], ",", " ", 
      RowBox[{"{", "}"}]}], "}"}], "]"}], " ", ":=", " ", 
   RowBox[{"dpyEmpty", "[", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"dpyCaptive2", "[", 
    RowBox[{"{", 
     RowBox[{"ex_", ",", " ", 
      RowBox[{"{", "}"}]}], "}"}], "]"}], "             ", ":=", " ", 
   RowBox[{"dpyNullary", "[", 
    RowBox[{"dpyCaptive2", " ", "@", " ", "ex"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"dpyCaptive2", "[", 
    RowBox[{"{", 
     RowBox[{"a_", ",", " ", 
      RowBox[{"{", "as__", "}"}]}], "}"}], "]"}], "          ", ":=", " ", 
   RowBox[{"dpyMultiary", "[", 
    RowBox[{
     RowBox[{"dpyCaptive2", " ", "@", " ", "a"}], ",", " ", 
     RowBox[{"dpyCaptive2", " ", "/@", " ", 
      RowBox[{"{", "as", "}"}]}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"dpyCaptive2", "[", 
    RowBox[{"number2", "[", "ex_", "]"}], "]"}], "          ", ":=", " ", 
   RowBox[{"dpyQuotedAtom", "[", 
    RowBox[{"number2", "[", "ex", "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"dpyCaptive2", "[", 
    RowBox[{"string2", "[", "ex_", "]"}], "]"}], "          ", ":=", " ", 
   RowBox[{"dpyQuotedAtom", "[", 
    RowBox[{"string2", "[", "ex", "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"dpyCaptive2", "[", 
    RowBox[{"symbol2", "[", "ex_", "]"}], "]"}], "          ", ":=", " ", 
   RowBox[{"dpyQuotedAtom", "[", 
    RowBox[{"symbol2", "[", "ex", "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"dpyCaptive2", "[", "x___", "]"}], "                  ", ":=", 
    " ", 
    RowBox[{"Throw", "[", 
     RowBox[{"Unevaluated", " ", "@", " ", 
      RowBox[{"{", "x", "}"}]}], "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"gridCaptive2", "[", "expr_", "]"}], " ", ":=", " ", 
   RowBox[{"dpyCaptive2", " ", "@", " ", 
    RowBox[{"captive2", " ", "@", " ", "expr"}]}]}], ";"}]}], "Code",
 CellLabel->
  "In[388]:=",ExpressionUUID->"e7cf3aab-01a3-4c0c-9e0c-502203a41e0b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["traceView2[ expr ]", "Subsubsection",ExpressionUUID->"24057c45-9180-4c4e-a65e-4f2bf963d51d"],

Cell["\<\
Display an interactive visualization of the trace of the evaluation of an \
expression. \
\>", "Text",ExpressionUUID->"a56a31bc-d208-42a3-8edf-70ae3f7eaa42"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"traceView2", "[", "expr_", "]"}], ":=", 
  RowBox[{"Module", "[", "\n", "  ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"steps", "=", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"stack", "=", 
       RowBox[{"{", "}"}]}], ",", "pre", ",", "post", ",", "show", ",", 
      "dynamic"}], "}"}], ",", "\n", "  ", 
    RowBox[{
     RowBox[{
      RowBox[{"pre", "[", "e_", "]"}], ":=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"stack", "=", 
         RowBox[{"{", 
          RowBox[{"steps", ",", "stack"}], "}"}]}], ";", 
        RowBox[{"steps", "=", 
         RowBox[{"{", "}"}]}]}], ")"}]}], ";", "\n", "  ", 
     RowBox[{
      RowBox[{"post", "[", 
       RowBox[{"e_", ",", "r_"}], "]"}], ":=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"steps", "=", 
         RowBox[{
          RowBox[{"First", "@", "stack"}], "~", "Join", "~", 
          RowBox[{"{", 
           RowBox[{"show", "[", 
            RowBox[{"e", ",", 
             RowBox[{"HoldForm", "[", "r", "]"}], ",", "steps"}], "]"}], 
           "}"}]}]}], ";", 
        RowBox[{"stack", "=", 
         RowBox[{"stack", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}]}], ";", "\n", "  ", 
     RowBox[{"SetAttributes", "[", 
      RowBox[{"post", ",", "HoldAllComplete"}], "]"}], ";", "\n", "  ", 
     RowBox[{
      RowBox[{"show", "[", 
       RowBox[{"e_", ",", "r_", ",", "steps_"}], "]"}], ":=", 
      RowBox[{"Grid", "[", "\n", "    ", 
       RowBox[{
        RowBox[{"steps", "/.", 
         RowBox[{"{", "\n", "      ", 
          RowBox[{
           RowBox[{
            RowBox[{"{", "}"}], "->", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"\"\<Expr  \>\"", ",", 
               RowBox[{"Row", "[", 
                RowBox[{"{", 
                 RowBox[{"e", ",", "\"\< \>\"", ",", 
                  RowBox[{"Style", "[", 
                   RowBox[{"\"\<inert\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{"Italic", ",", "Small"}], "}"}]}], "]"}]}], "}"}],
                 "]"}]}], "}"}], "}"}]}], ",", "\n", "      ", 
           RowBox[{"_", "->", 
            RowBox[{"{", "\n", "        ", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\"\<Expr  \>\"", ",", "e"}], "}"}], ",", "\n", 
              "        ", 
              RowBox[{"{", 
               RowBox[{"\"\<Steps\>\"", ",", 
                RowBox[{"steps", "/.", 
                 RowBox[{"{", "\n", "          ", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", "}"}], "->", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<no definitions apply\>\"", ",", "Italic"}], 
                    "]"}]}], ",", "\n", "          ", 
                   RowBox[{"_", ":>", 
                    RowBox[{"OpenerView", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Length", "@", "steps"}], ",", 
                    RowBox[{"dynamic", "@", 
                    RowBox[{"Column", "[", "steps", "]"}]}]}], "}"}], 
                    "]"}]}]}], "}"}]}]}], "}"}], ",", "\n", "        ", 
              RowBox[{"{", 
               RowBox[{"\"\<Result\>\"", ",", "r"}], "}"}]}], "}"}]}]}], 
          "}"}]}], ",", "\n", "      ", 
        RowBox[{"Alignment", "->", "Left"}], ",", "\n", "      ", 
        RowBox[{"Frame", "->", "All"}], ",", "\n", "      ", 
        RowBox[{"Background", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "LightCyan", "}"}], ",", "None"}], "}"}]}]}], "]"}]}],
      ";", "\n", "    ", 
     RowBox[{"TraceScan", "[", 
      RowBox[{"pre", ",", "expr", ",", "___", ",", "post"}], "]"}], ";", "\n",
      "    ", 
     RowBox[{"Deploy", "@", 
      RowBox[{"Pane", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"steps", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "/.", 
         RowBox[{"dynamic", "->", "Dynamic"}]}], ",", 
        RowBox[{"ImageSize", "->", "10000"}]}], "]"}]}]}]}], "]"}]}], "\n", 
 RowBox[{"SetAttributes", "[", 
  RowBox[{"traceView2", ",", 
   RowBox[{"{", "HoldAllComplete", "}"}]}], "]"}]}], "Code",
 CellLabel->
  "In[397]:=",ExpressionUUID->"a917f8bd-b942-4fef-bef1-e7e2d75f9555"]
}, Open  ]],

Cell[CellGroupData[{

Cell["traceView4[ expr ]", "Subsubsection",ExpressionUUID->"ff896531-5212-437b-a0cb-d9cf42549c49"],

Cell["\<\
Display a compact interactive visualization of the trace of the evaluation of \
an expression.\
\>", "Text",ExpressionUUID->"64d07adf-fe0e-4a95-bb82-2ef045a1d2db"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"traceView4", "[", "expr_", "]"}], ":=", 
  RowBox[{"Module", "[", "\n", "  ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"steps", "=", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"stack", "=", 
       RowBox[{"{", "}"}]}], ",", "pre", ",", "post"}], "}"}], ",", "\n", 
    "  ", 
    RowBox[{
     RowBox[{
      RowBox[{"pre", "[", "e_", "]"}], ":=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"stack", "=", 
         RowBox[{"{", 
          RowBox[{"steps", ",", "stack"}], "}"}]}], ";", 
        RowBox[{"steps", "=", 
         RowBox[{"{", "}"}]}]}], ")"}]}], ";", "\n", "  ", 
     RowBox[{
      RowBox[{"post", "[", 
       RowBox[{"e_", ",", "r_"}], "]"}], ":=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"steps", "=", 
         RowBox[{
          RowBox[{"First", "@", "stack"}], "~", "Join", "~", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"e", ",", "steps", ",", 
             RowBox[{"HoldForm", "[", "r", "]"}]}], "}"}], "}"}]}]}], ";", 
        RowBox[{"stack", "=", 
         RowBox[{"stack", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}]}], ";", "\n", "  ", 
     RowBox[{"SetAttributes", "[", 
      RowBox[{"post", ",", "HoldAllComplete"}], "]"}], ";", "\n", "  ", 
     RowBox[{"TraceScan", "[", 
      RowBox[{"pre", ",", "expr", ",", "___", ",", "post"}], "]"}], ";", "\n",
      "  ", 
     RowBox[{"DynamicModule", "[", "\n", "    ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "focus", ",", "show", ",", "substep", ",", "enter", ",", "exit"}], 
        "}"}], ",", "\n", "    ", 
       RowBox[{
        RowBox[{"focus", "=", "steps"}], ";", "\n", "    ", 
        RowBox[{
         RowBox[{"substep", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"e_", ",", 
             RowBox[{"{", "}"}], ",", "_"}], "}"}], ",", "_"}], "]"}], ":=", 
         RowBox[{"{", 
          RowBox[{"Null", ",", "e", ",", 
           RowBox[{"Style", "[", 
            RowBox[{"\"\<inert\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"Italic", ",", "Small"}], "}"}]}], "]"}]}], "}"}]}], 
        ";", "\n", "    ", 
        RowBox[{
         RowBox[{"substep", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"e_", ",", "_", ",", "r_"}], "}"}], ",", "p_"}], "]"}], ":=", 
         RowBox[{"{", "\n", "      ", 
          RowBox[{
           RowBox[{"Button", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"\"\<show\>\"", ",", "Small"}], "]"}], ",", 
             RowBox[{"enter", "[", "p", "]"}]}], "]"}], ",", "\n", "      ", 
           "e", ",", "\n", "      ", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"Row", "[", 
              RowBox[{"{", 
               RowBox[{"\"\<-> \>\"", ",", "r"}], "}"}], "]"}], ",", 
             "Small"}], "]"}]}], "}"}]}], ";", "\n", "    ", 
        RowBox[{
         RowBox[{"enter", "[", 
          RowBox[{"{", "p_", "}"}], "]"}], ":=", 
         RowBox[{"PrependTo", "[", 
          RowBox[{"focus", ",", 
           RowBox[{"focus", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2", ",", "p"}], "]"}], "]"}]}], "]"}]}], ";", 
        "\n", "    ", 
        RowBox[{
         RowBox[{"exit", "[", "]"}], ":=", 
         RowBox[{"focus", "=", 
          RowBox[{"Drop", "[", 
           RowBox[{"focus", ",", "1"}], "]"}]}]}], ";", "\n", "    ", 
        RowBox[{
         RowBox[{"show", "[", 
          RowBox[{"{", 
           RowBox[{"e_", ",", "s_", ",", "r_"}], "}"}], "]"}], ":=", 
         RowBox[{"Column", "[", 
          RowBox[{"{", "\n", "      ", 
           RowBox[{"Grid", "[", 
            RowBox[{
             RowBox[{"{", "\n", "        ", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"\"\<Expression\>\"", ",", 
                 RowBox[{"Column", "@", 
                  RowBox[{"Reverse", "@", 
                   RowBox[{"focus", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}]}], "}"}], ",",
                "\n", "        ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Column", "[", 
                  RowBox[{"{", "\n", "          ", 
                   RowBox[{"\"\<Steps\>\"", ",", "\n", "          ", 
                    RowBox[{"focus", "/.", 
                    RowBox[{"{", "\n", "            ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", "_", "}"}], ":>", 
                    RowBox[{"Sequence", "[", "]"}]}], ",", "\n", 
                    "            ", 
                    RowBox[{"_", ":>", 
                    RowBox[{"Button", "[", 
                    RowBox[{"\"\<Back\>\"", ",", 
                    RowBox[{"exit", "[", "]"}], ",", 
                    RowBox[{"ImageSize", "->", "Automatic"}]}], "]"}]}]}], 
                    "}"}]}]}], "}"}], "]"}], ",", "\n", "         ", 
                 RowBox[{"Grid", "[", 
                  RowBox[{
                   RowBox[{"MapIndexed", "[", 
                    RowBox[{"substep", ",", "s"}], "]"}], ",", 
                   RowBox[{"Alignment", "->", "Left"}]}], "]"}]}], "}"}], ",",
                "\n", "\t\t", 
               RowBox[{"{", 
                RowBox[{"\"\<Result\>\"", ",", 
                 RowBox[{"Column", "@", 
                  RowBox[{"focus", "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "3"}], "]"}], "]"}]}]}], "}"}]}], 
              "}"}], ",", "\n", "       ", 
             RowBox[{"Alignment", "->", "Left"}], ",", "\n", "       ", 
             RowBox[{"Frame", "->", "All"}], ",", "\n", "       ", 
             RowBox[{"Background", "->", 
              RowBox[{"{", 
               RowBox[{"{", "LightCyan", "}"}], "}"}]}]}], "]"}], "\n", 
           "     ", "}"}], "]"}]}], ";", "\n", "   ", 
        RowBox[{"Dynamic", "@", 
         RowBox[{"show", "@", 
          RowBox[{"focus", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}]}]}], "\n", "  ", "]"}]}]}], 
   "]"}]}], "\n", 
 RowBox[{"SetAttributes", "[", 
  RowBox[{"traceView4", ",", 
   RowBox[{"{", "HoldAllComplete", "}"}]}], "]"}]}], "Code",
 CellLabel->
  "In[399]:=",ExpressionUUID->"826a3a28-93fd-49af-9d61-e096bcf92b04"]
}, Open  ]],

Cell[CellGroupData[{

Cell["traceView5[ expr ]", "Subsubsection",ExpressionUUID->"6fa12b92-2657-489d-9b90-983db24ebb7f"],

Cell["\<\
Display an alternative compact interactive visualization of the trace of the \
evaluation of an expression.\
\>", "Text",ExpressionUUID->"e8beeadd-35b5-433d-ac33-1a3a3b99a170"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"traceView5", ",", "HoldFirst"}], "]"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"traceView5", "[", 
   RowBox[{"e_", ",", "s___", ",", 
    RowBox[{"opts", ":", 
     RowBox[{"OptionsPattern", "[", "Trace", "]"}]}]}], "]"}], ":=", "\n", 
  "  ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "show2", "}"}], ",", "\n", "  ", 
    RowBox[{
     RowBox[{
      RowBox[{"show2", "[", 
       RowBox[{"{", 
        RowBox[{"expr_", ",", "steps__"}], "}"}], "]"}], ":=", 
      RowBox[{"OpenerView", "[", 
       RowBox[{"{", 
        RowBox[{"expr", ",", 
         RowBox[{"Column", "[", 
          RowBox[{"show2", "/@", 
           RowBox[{"{", "steps", "}"}]}], "]"}]}], "}"}], "]"}]}], ";", "\n", 
     "  ", 
     RowBox[{
      RowBox[{"show2", "[", 
       RowBox[{"{", 
        RowBox[{"HoldForm", "[", "x_", "]"}], "}"}], "]"}], ":=", 
      RowBox[{"Row", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Opener", "[", 
          RowBox[{"True", ",", 
           RowBox[{"Enabled", "->", "False"}]}], "]"}], ",", 
         RowBox[{"HoldForm", "[", "x", "]"}]}], "}"}], "]"}]}], ";", "\n", 
     "  ", 
     RowBox[{
      RowBox[{"show2", "[", 
       RowBox[{"HoldForm", "[", "x_", "]"}], "]"}], ":=", 
      RowBox[{"HoldForm", "[", "x", "]"}]}], ";", "\n", "  ", 
     RowBox[{"show2", "[", 
      RowBox[{"Trace", "[", 
       RowBox[{
        RowBox[{"Unevaluated", "[", "e", "]"}], ",", "s", ",", "opts", ",", 
        RowBox[{"TraceOriginal", "->", "True"}]}], "]"}], "]"}]}]}], 
   "]"}]}]}], "Code",
 CellLabel->
  "In[401]:=",ExpressionUUID->"b459918a-b059-4568-9bcd-814c0008c712"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Predicates and Helpers", "Subsection",ExpressionUUID->"46263ad1-ddba-4426-8571-c4e99c40db3a"],

Cell[CellGroupData[{

Cell["KvpQ[ list ]", "Subsubsection",ExpressionUUID->"33cf2e0d-d4ac-427c-a479-06d544c2ded2"],

Cell["\<\
Something is a Kvp (key-value pair) if it matches the pattern of a list of \
two items, the first of which is either a string or a symbol.\
\>", "Text",ExpressionUUID->"610550a7-9fa5-48a2-be36-42157d33af76"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"KvpQ", "[", "kvp_List", "]"}], " ", ":=", " ", 
   RowBox[{"MatchQ", "[", 
    RowBox[{"kvp", ",", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"_Symbol", ",", " ", "_"}], "}"}], " ", "|", " ", 
      RowBox[{"{", 
       RowBox[{"_String", ",", " ", "_"}], "}"}]}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"KvpQ", "[", "___", "]"}], " ", "=", " ", "False"}], 
  ";"}]}], "Code",
 CellLabel->
  "In[403]:=",ExpressionUUID->"02043997-233a-4ff2-af7e-6048f6b0d8d8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["pairsQ[ list ]", "Subsubsection",ExpressionUUID->"f6d6e1c0-d5cf-4f99-b910-d03582e0afc5"],

Cell["\<\
Something is a list of pairs if it is a list and every element is a pair.\
\>", "Text",ExpressionUUID->"e218cf59-ec63-44c1-8eec-9b03f9f9c09d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"pairsQ", "[", "list_List", "]"}], " ", ":=", " ", 
   RowBox[{"And", " ", "@@", " ", 
    RowBox[{"(", 
     RowBox[{"KvpQ", " ", "/@", " ", "list"}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"pairsQ", "[", "___", "]"}], " ", "=", " ", "False"}], 
  ";"}]}], "Code",
 CellLabel->
  "In[405]:=",ExpressionUUID->"56b79bd5-a23f-48dc-b4d5-699c8c30cd3f"],

Cell["\<\
To fetch the keys from a list, map a function that takes the first part of \
every element over the list. Here, we don't need the presumably expensive \
check of ?pairsQ on the argument, just the cheap check of List, since this is \
an internal function.\
\>", "Text",ExpressionUUID->"4815a298-4c6b-4a9e-b2fd-fd0f491b406a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["keys[ list ]", "Subsubsection",ExpressionUUID->"0f7ac5d8-7068-4e62-a0eb-bb2edb7bbb4c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"keys", "[", "list_List", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"#", "[", 
      RowBox[{"[", "1", "]"}], "]"}], " ", "&"}], " ", "/@", " ", "list"}]}], 
  ";"}]], "Code",
 CellLabel->
  "In[407]:=",ExpressionUUID->"49946210-c585-4b90-9a10-2c64c9760acc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"keysUniqueQ", "[", "list_List", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"Length", "@", 
     RowBox[{"Union", "@", 
      RowBox[{"keys", "@", "list"}]}]}], " ", "===", " ", 
    RowBox[{"Length", "@", 
     RowBox[{"keys", "@", "list"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"keysUniqueQ", "[", "___", "]"}], " ", "=", " ", "False"}], 
  ";"}]}], "Code",
 CellLabel->
  "In[408]:=",ExpressionUUID->"c3232d3d-0d58-402f-95be-ff32ba0f3730"],

Cell["\<\
To fetch the values, map a function that picks the second element from each \
internal kvp.\
\>", "Text",ExpressionUUID->"06c58083-4b34-4b11-8273-7d366c6dd61f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["values[ list ]", "Subsubsection",ExpressionUUID->"2b6b980c-8e9c-4133-b9ba-78b7443c14f5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"values", "[", "list_List", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"#", "[", 
     RowBox[{"[", "2", "]"}], "]"}], " ", "&"}], " ", "/@", " ", 
   "list"}]}]], "Code",
 CellLabel->
  "In[410]:=",ExpressionUUID->"a4219dca-5ba2-4cf3-b534-102716fd015d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["KvpsQ[ list ]", "Subsubsection",ExpressionUUID->"9f965e8e-bef6-47ea-9da0-8a4275469fa3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"KvpsQ", "[", 
    RowBox[{"list_", "?", "pairsQ"}], "]"}], " ", ":=", " ", 
   RowBox[{"keysUniqueQ", "@", "list"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"KvpsQ", "[", "___", "]"}], " ", "=", " ", "False"}], 
  ";"}]}], "Code",
 CellLabel->
  "In[411]:=",ExpressionUUID->"488a84dc-3614-4700-8bb7-321faa177540"]
}, Open  ]],

Cell[CellGroupData[{

Cell["SymbolQ[ symbol ]", "Subsubsection",ExpressionUUID->"0d9b5c56-3da7-4a45-a274-4db66500f516"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SymbolQ", "[", "x_Symbol", "]"}], " ", "=", " ", "True"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SymbolQ", "[", "___", "]"}], " ", "=", " ", "False"}], 
  ";"}]}], "Code",
 CellLabel->
  "In[413]:=",ExpressionUUID->"66c532e1-d2bc-4d59-bdd5-b87504f14f62"]
}, Open  ]],

Cell[CellGroupData[{

Cell["RulesQ[ list ]", "Subsubsection",ExpressionUUID->"120510c5-ca36-4ded-9ec4-f7ae137f3000"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RulesQ", "[", "vs_List", "]"}], " ", ":=", " ", 
   RowBox[{"And", " ", "@@", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"MatchQ", "[", 
        RowBox[{"#", ",", " ", 
         RowBox[{"Rule", "[", 
          RowBox[{"_", ",", " ", "_"}], "]"}]}], "]"}], " ", "&"}], " ", "/@",
       " ", "vs"}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"RulesQ", "[", "___", "]"}], " ", "=", " ", "False"}], 
  ";"}]}], "Code",
 CellLabel->
  "In[415]:=",ExpressionUUID->"2159909d-bf03-4c85-916e-de51a30770ba"]
}, Open  ]],

Cell[CellGroupData[{

Cell["RulessQ[ lists ]", "Subsubsection",ExpressionUUID->"f692d81d-4cfc-4bf5-ac76-19b50e488124"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RulessQ", "[", "vss_List", "]"}], " ", ":=", " ", 
   RowBox[{"And", " ", "@@", " ", 
    RowBox[{"(", 
     RowBox[{"RulesQ", " ", "/@", " ", "vss"}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"RulessQ", "[", "___", "]"}], " ", "=", " ", "False"}], 
  ";"}]}], "Code",
 CellLabel->
  "In[417]:=",ExpressionUUID->"f9c7aa01-52bd-443a-8a62-c4f21f117eb9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Args[ list ]", "Subsubsection",ExpressionUUID->"4fb81854-8969-445c-a63c-cdeedec25e50"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Args", "[", "e_", "]"}], " ", ":=", " ", 
   RowBox[{"Level", "[", 
    RowBox[{"e", ",", " ", "1"}], "]"}]}], ";"}]], "Code",
 CellLabel->
  "In[419]:=",ExpressionUUID->"597c9a7b-cb85-4aac-af12-d964b5771945"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["LinqSim", "Subsection",ExpressionUUID->"a2c17488-cfe3-4d95-91da-7c91a822d51e"],

Cell["TODO: generalize these to arbitrary heads, not just to lists", "Text",ExpressionUUID->"598bf210-0202-43e0-8e88-084e8a5c1174"],

Cell[CellGroupData[{

Cell["Pluck[ n ]", "Subsubsection",ExpressionUUID->"65e30f49-b0a2-4c7a-bd29-3d04929b1c09"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Pluck", "[", "n_", "]"}], " ", ":=", " ", 
   RowBox[{"Function", "[", 
    RowBox[{"item", ",", " ", 
     RowBox[{"item", "[", 
      RowBox[{"[", "n", "]"}], "]"}]}], "]"}]}], ";"}]], "Code",
 CellLabel->
  "In[420]:=",ExpressionUUID->"e3dd561a-b447-4bb4-a399-2c105b3a4e57"]
}, Open  ]],

Cell[CellGroupData[{

Cell["flat1[ list ]", "Subsubsection",ExpressionUUID->"f0cc4ca9-a706-43bd-a13a-2e5b86139b8f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"flat1", " ", "=", " ", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{"#", ",", " ", "1"}], "]"}], " ", "&"}]}], ";"}]], "Code",
 CellLabel->
  "In[421]:=",ExpressionUUID->"53f0deae-1003-463e-baaa-5e598a7b4f74"]
}, Open  ]],

Cell[CellGroupData[{

Cell["SelectMany[ lists, func ]", "Subsubsection",ExpressionUUID->"ee76c6c6-37a4-4190-bd28-78159af347e5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SelectMany", "[", 
    RowBox[{"list_", ",", " ", "func_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{"func", ",", " ", "list"}], "]"}], " ", "//", " ", "flat1"}]}], 
  ";"}]], "Code",
 CellLabel->
  "In[422]:=",ExpressionUUID->"8c419a34-3cfc-43b5-84ea-5ee55cbbdbfa"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Zip[ list1, list2, itemFromPair ]", "Subsubsection",ExpressionUUID->"9095b6ca-e686-4182-bdac-27318a063c4b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Zip", "[", 
   RowBox[{"list1_List", ",", " ", "list2_List", ",", " ", 
    RowBox[{"func_", ":", "List"}]}], "]"}], ":=", "\n", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"len", " ", "=", " ", 
      RowBox[{"Min", "[", 
       RowBox[{
        RowBox[{"Length", " ", "@", " ", "list1"}], ",", " ", 
        RowBox[{"Length", " ", "@", " ", "list2"}]}], "]"}]}], "}"}], ",", 
    "\n", "  ", 
    RowBox[{"MapThread", "[", 
     RowBox[{"func", ",", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Take", "[", 
         RowBox[{"#", ",", "len"}], "]"}], "&"}], " ", "/@", " ", 
       RowBox[{"{", 
        RowBox[{"list1", ",", " ", "list2"}], "}"}]}]}], "]"}]}], 
   "]"}]}]], "Code",
 CellLabel->
  "In[423]:=",ExpressionUUID->"da090593-ae5d-42db-9bdf-f1e77c5b8eb1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["ZipMany[list1, list2, listFromPair]", "Subsubsection",ExpressionUUID->"1047390f-e80e-4ca9-a1aa-9529dbbb1fd4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ZipMany", " ", "=", " ", 
  RowBox[{"Composition", "[", 
   RowBox[{"flat1", ",", " ", "Zip"}], "]"}]}]], "Code",
 CellLabel->
  "In[424]:=",ExpressionUUID->"774130da-2a55-4280-882a-b668cd1700a9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Flatten", "[", 
    RowBox[{"#1", ",", "1"}], "]"}], "&"}], "@*", "Zip"}]], "Output",
 CellChangeTimes->{{3.9112524205500503`*^9, 3.911252421588769*^9}, {
   3.911254381141556*^9, 3.9112543814912167`*^9}, {3.911254645691099*^9, 
   3.911254646002416*^9}, {3.911290460336219*^9, 3.911290460691904*^9}, 
   3.912268028133898*^9, {3.912546351834734*^9, 3.9125463522417803`*^9}, {
   3.912589070376083*^9, 3.912589070692068*^9}, {3.9126003499828777`*^9, 
   3.912600350269436*^9}, {3.9126017048976*^9, 3.912601705218226*^9}, {
   3.915050870204039*^9, 3.915050870511878*^9}, {3.915535456024254*^9, 
   3.915535456386145*^9}},
 CellLabel->
  "Out[424]=",ExpressionUUID->"fb47bf13-1a44-4a50-9eba-35e370c4a302"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["prefixes[ hd [ list___ ] ]", "Subsubsection",ExpressionUUID->"1a8c3e9f-c007-417c-94b4-788803312b41"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"prefixes", "[", 
     RowBox[{"acc_", ",", " ", 
      RowBox[{"{", "}"}]}], "]"}], " ", ":=", " ", "acc"}], ";", "\n", 
   RowBox[{
    RowBox[{"prefixes", "[", 
     RowBox[{"acc_", ",", " ", 
      RowBox[{"{", 
       RowBox[{"f_", ",", " ", "r___"}], "}"}]}], "]"}], " ", ":=", "\n", 
    "  ", 
    RowBox[{"Join", "[", 
     RowBox[{"acc", ",", "\n", "    ", 
      RowBox[{"prefixes", "[", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Append", "[", 
            RowBox[{"#", ",", " ", "f"}], "]"}], "&"}], ",", " ", "acc"}], 
         "]"}], ",", " ", 
        RowBox[{"{", "r", "}"}]}], "]"}]}], "]"}]}], ";", "\n", 
   RowBox[{
    RowBox[{"prefixes", "[", "list_List", "]"}], " ", ":=", " ", 
    RowBox[{"prefixes", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"{", "}"}], "}"}], ",", " ", "list"}], "]"}]}], ";"}], 
  "*)"}]], "Code",
 CellLabel->
  "In[425]:=",ExpressionUUID->"89b44096-01e0-486b-b576-15e4c3b58db5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"prefixes", "[", 
    RowBox[{"hd_", "[", "list___", "]"}], "]"}], " ", ":=", " ", "\n", "  ", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{"Function", "[", 
      RowBox[{"sub", ",", " ", 
       RowBox[{"hd", " ", "@@", " ", 
        RowBox[{"Take", "[", 
         RowBox[{
          RowBox[{"{", "list", "}"}], ",", " ", "sub"}], "]"}]}]}], "]"}], 
     ",", "\n", "  ", 
     RowBox[{"Range", "[", 
      RowBox[{"0", ",", " ", 
       RowBox[{"Length", "[", 
        RowBox[{"{", "list", "}"}], "]"}]}], "]"}]}], "]"}]}], ";"}]], "Code",
 CellLabel->
  "In[426]:=",ExpressionUUID->"90465746-6595-4544-a1eb-e341aa572c85"]
}, Open  ]],

Cell[CellGroupData[{

Cell["postfixes[ hd [ list___ ] ]", "Subsubsection",ExpressionUUID->"035e76b0-94c0-402f-a231-5645d3ce32c7"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"postfixes", "[", 
     RowBox[{"acc_", ",", " ", 
      RowBox[{"{", "}"}]}], "]"}], " ", ":=", " ", "acc"}], ";", "\n", 
   RowBox[{
    RowBox[{"postfixes", "[", 
     RowBox[{"acc_", ",", " ", 
      RowBox[{"{", 
       RowBox[{"h___", ",", " ", "l_"}], "}"}]}], "]"}], " ", ":=", "\n", 
    "  ", 
    RowBox[{"Join", "[", 
     RowBox[{"acc", ",", "\n", "    ", 
      RowBox[{"postfixes", "[", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Prepend", "[", 
            RowBox[{"#", ",", "l"}], "]"}], "&"}], ",", " ", "acc"}], "]"}], 
        ",", " ", 
        RowBox[{"{", "h", "}"}]}], "]"}]}], "]"}]}], ";", "\n", 
   RowBox[{
    RowBox[{"postfixes", "[", "list_List", "]"}], " ", ":=", " ", 
    RowBox[{"Reverse", " ", "@", " ", 
     RowBox[{"postfixes", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", "}"}], "}"}], ",", " ", "list"}], "]"}]}]}], ";"}], 
  "*)"}]], "Code",
 CellLabel->
  "In[427]:=",ExpressionUUID->"25f43776-7a4f-4b0e-9ea6-600d38c889a1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"postfixes", "[", 
    RowBox[{"hd_", "[", "list___", "]"}], "]"}], " ", ":=", "\n", "  ", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"len", " ", "=", " ", 
       RowBox[{"Length", "[", 
        RowBox[{"{", "list", "}"}], "]"}]}], "}"}], ",", "\n", "    ", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{"Function", "[", 
        RowBox[{"sub", ",", " ", 
         RowBox[{"hd", " ", "@@", " ", 
          RowBox[{"Take", "[", 
           RowBox[{
            RowBox[{"{", "list", "}"}], ",", " ", 
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{"len", "-", "sub"}], ")"}]}]}], "]"}]}]}], "]"}], ",", 
       "\n", "    ", 
       RowBox[{"Range", "[", 
        RowBox[{"0", ",", " ", "len"}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}]], "Code",
 CellLabel->
  "In[428]:=",ExpressionUUID->"477bcb51-cfd2-4495-9d86-ba5849529d56"]
}, Open  ]],

Cell[CellGroupData[{

Cell["splits[ list ]", "Subsubsection",ExpressionUUID->"6de63c0a-4ffd-45a0-bbf2-97a669e5cac7"],

Cell["\<\
TODO: a \"cute\" implementation is ReplaceList[list_List, \
{xs___,ys___}->{{xs},{ys}}]. Assess it for perf\
\>", "Text",ExpressionUUID->"67617f14-0411-463f-9d78-b50f4bd07c1d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"splits", "[", "list_List", "]"}], " ", ":=", " ", 
  RowBox[{"Zip", "[", 
   RowBox[{
    RowBox[{"prefixes", " ", "@", " ", "list"}], ",", " ", 
    RowBox[{"postfixes", " ", "@", " ", "list"}]}], "]"}]}]], "Code",
 CellLabel->
  "In[429]:=",ExpressionUUID->"f4b84fe8-4c79-4185-a7f1-c193fe6772c8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["permutations[ list ]", "Subsubsection",ExpressionUUID->"86b8e9dc-18c6-464d-b23a-f1c855c15aae"],

Cell["TODO: make this work for arbitrary heads.", "Text",ExpressionUUID->"535115cb-8379-43e2-8f1c-0e7904c599ba"],

Cell["\<\
TODO: Consider this variation from the Haskell prelude:

-- | The 'permutations' function returns the list of all permutations of the \
argument.
--
-- > permutations \"abc\" == [\"abc\",\"bac\",\"cba\",\"bca\",\"cab\",\"acb\"]
permutations            :: [a] -> [[a]]
permutations xs0        =  xs0 : perms xs0 []
  where
    perms []     _  = []
    perms (t:ts) is = foldr interleave (perms ts (t:is)) (permutations is)
      where interleave    xs     r = let (_,zs) = interleave' id xs r in zs
            interleave' _ []     r = (ts, r)
            interleave' f (y:ys) r = let (us,zs) = interleave' (f . (y:)) ys r
                                     in  (y:us, f (t:y:us) : zs)\
\>", "Text",ExpressionUUID->"0a3aa4ca-05d6-4e50-be19-a613e74c726d"],

Cell[TextData[{
 "NOTE: this is for ILLUSTRATION only; the built-in ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " Permutations is MUCH more efficient."
}], "Text",ExpressionUUID->"2ee40c92-fcc5-472c-a94a-503d9f7a7f28"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"permutations", "[", 
    RowBox[{"{", "}"}], "]"}], " ", ":=", " ", 
   RowBox[{"{", 
    RowBox[{"{", "}"}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"permutations", "[", 
   RowBox[{"{", "args__", "}"}], "]"}], ":=", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"Flatten", "-", 
    RowBox[{"1", " ", "of", " ", "Map", " ", "is", " ", "SelectMany"}]}], " ",
    "*)"}], "\n", " ", 
  RowBox[{"Flatten", "[", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{"Function", "[", 
       RowBox[{"pos", ",", "\n", " ", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", "\n", "   ", 
           RowBox[{
            RowBox[{"elt", "=", 
             RowBox[{
              RowBox[{"{", "args", "}"}], "[", 
              RowBox[{"[", "pos", "]"}], "]"}]}], ",", "\n", "   ", 
            RowBox[{"rest", "=", 
             RowBox[{"Delete", "[", 
              RowBox[{
               RowBox[{"{", "args", "}"}], ",", " ", "pos"}], "]"}]}]}], 
           "}"}], ",", "\n", "  ", 
          RowBox[{"Map", "[", "\n", "   ", 
           RowBox[{
            RowBox[{"Function", "[", 
             RowBox[{"perm", ",", " ", 
              RowBox[{"Prepend", "[", 
               RowBox[{"perm", ",", " ", "elt"}], "]"}]}], "]"}], ",", "\n", 
            "   ", 
            RowBox[{"permutations", "[", "rest", "]"}]}], "]"}]}], "]"}]}], 
       "]"}], ",", "\n", "  ", 
      RowBox[{"Range", "[", 
       RowBox[{"Length", "[", 
        RowBox[{"{", "args", "}"}], "]"}], "]"}]}], "]"}], ",", "\n", " ", 
    "1"}], "]"}]}]}], "Code",
 CellLabel->
  "In[430]:=",ExpressionUUID->"14063c84-a90b-4a73-8ad7-82f2a12b99ec"]
}, Open  ]]
}, Open  ]],

Cell["Quotes and Unquotes", "Subsection",ExpressionUUID->"07c64c2f-40d7-4221-9cf6-8682dd90c0b6"],

Cell[CellGroupData[{

Cell["Numerical Subtypes", "Subsection",ExpressionUUID->"ab3f2eb0-f9f7-4fd5-a141-f24d1b08e415"],

Cell[CellGroupData[{

Cell["RealQ[ x ]", "Subsubsection",ExpressionUUID->"e43ea9f6-0401-436b-a2b8-46fcdc03a98a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RealQ", "[", "x_Real", "]"}], " ", ":=", " ", "True"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"RealQ", "[", "___", "]"}], " ", ":=", " ", "False"}], 
  ";"}]}], "Code",
 CellLabel->
  "In[432]:=",ExpressionUUID->"c4297c05-4376-4173-a9b7-408421132848"]
}, Open  ]],

Cell[CellGroupData[{

Cell["RationalQ[ x ]", "Subsubsection",ExpressionUUID->"a07d77cb-e5f4-4f48-8b5a-5358726a499d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RationalQ", "[", "x_Rational", "]"}], " ", ":=", " ", "True"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"RationalQ", "[", "___", "]"}], " ", ":=", " ", "False"}], 
  ";"}]}], "Code",
 CellLabel->
  "In[434]:=",ExpressionUUID->"d69fe4f4-8d7b-4e5e-b408-28e816d9ceef"]
}, Open  ]],

Cell[CellGroupData[{

Cell["ComplexQ[ x ]", "Subsubsection",ExpressionUUID->"b10faf00-874e-41bb-b557-2a5a01a01cbe"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ComplexQ", "[", "x_Complex", "]"}], " ", ":=", " ", "True"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ComplexQ", "[", "___", "]"}], " ", ":=", " ", "False"}], 
  ";"}]}], "Code",
 CellLabel->
  "In[436]:=",ExpressionUUID->"656f411a-9077-4834-af21-a4a596804243"]
}, Open  ]],

Cell[CellGroupData[{

Cell["numericSubtype[ x ]", "Subsubsection",ExpressionUUID->"ba6d866b-504e-49db-9a30-df2065584969"],

Cell[BoxData[
 RowBox[{
  RowBox[{"numericSubtype", "[", 
   RowBox[{"x_", "?", "NumberQ"}], "]"}], " ", ":=", "\n", "\t", 
  RowBox[{"Switch", "[", 
   RowBox[{
   "x", ",", "\n", "\t\t", "_Integer", ",", "  ", "\"\<Integer\>\"", ",", 
    "\n", "\t\t", "_Real", ",", "     ", "\"\<Real\>\"", ",", "\n", "\t\t", 
    "_Rational", ",", " ", "\"\<Rational\>\"", ",", "\n", "\t\t", "_Complex", 
    ",", "  ", "\"\<Complex\>\""}], "]"}]}]], "Code",
 CellLabel->
  "In[438]:=",ExpressionUUID->"23f3c509-fbd5-44cf-a831-83b1249b59da"]
}, Open  ]],

Cell[CellGroupData[{

Cell["rulesFromExpression[ expr ]", "Subsubsection",ExpressionUUID->"b91a0667-cb08-4981-a962-a40c4200e2ad"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"rulesFromExpression", "[", 
   RowBox[{"expr_", "?", "NumberQ"}], "]"}], " ", ":=", " ", 
  RowBox[{"{", "\n", "\t", 
   RowBox[{"\"\<number\>\"", " ", "->", " ", 
    RowBox[{"{", "  ", 
     RowBox[{
      RowBox[{"\"\<subtype\>\"", " ", "->", " ", 
       RowBox[{"numericSubtype", " ", "@", " ", "expr"}]}], ",", "\n", 
      "                   ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "InputForm", " ", "reliable", " ", "for", " ", "roundtripping", " ", 
        "Rational"}], " ", "*)"}], "\n", "                   ", 
      RowBox[{"\"\<value\>\"", " ", "->", " ", 
       RowBox[{"ToString", " ", "@", " ", 
        RowBox[{"InputForm", " ", "@", " ", "expr"}]}]}]}], " ", "}"}]}], " ",
    "}"}]}], "\n", 
 RowBox[{
  RowBox[{"rulesFromExpression", "[", "expr_Symbol", "]"}], " ", ":=", " ", 
  RowBox[{"{", 
   RowBox[{"\"\<symbol\>\"", " ", "->", " ", 
    RowBox[{"ToString", " ", "@", " ", "expr"}]}], "}"}]}], "\n", 
 RowBox[{
  RowBox[{"rulesFromExpression", "[", "expr_String", "]"}], " ", ":=", " ", 
  RowBox[{"{", 
   RowBox[{"\"\<string\>\"", " ", "->", " ", 
    RowBox[{"ToString", " ", "@", " ", "expr"}]}], "}"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"rulesFromExpression", "[", 
    RowBox[{"head_", "[", "parts___", "]"}], "]"}], " ", ":=", " ", 
   RowBox[{"{", "\n", "\t", 
    RowBox[{
     RowBox[{"\"\<head\>\"", "   ", "->", " ", 
      RowBox[{"rulesFromExpression", "  ", "@", " ", "head"}]}], ",", " ", 
     "\n", "\t", 
     RowBox[{"\"\<parts\>\"", "  ", "->", " ", 
      RowBox[{"rulesFromExpression", " ", "/@", " ", 
       RowBox[{"{", "parts", "}"}]}]}]}], "}"}]}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"rulesFromExpression", "[", "x___", "]"}], " ", ":=", " ", 
   RowBox[{"Throw", "[", 
    RowBox[{"{", "x", "}"}], "]"}]}], ";"}]}], "Code",
 CellLabel->
  "In[439]:=",ExpressionUUID->"15710599-fccc-4125-adcb-a2344f902993"]
}, Open  ]],

Cell[CellGroupData[{

Cell["jsonStringFromExpression[ expr ]", "Subsubsection",ExpressionUUID->"779ea5ac-4c09-406d-b00e-25cdf5a92d18"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"jsonStringFromExpression", "[", "expr_", "]"}], " ", ":=", "\n", 
   "  ", 
   RowBox[{
    RowBox[{"ExportString", "[", 
     RowBox[{
      RowBox[{"rulesFromExpression", "[", "expr", "]"}], ",", " ", 
      "\"\<JSON\>\""}], "]"}], " ", "//", " ", "\n", "    ", 
    RowBox[{
     RowBox[{"StringReplace", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Whitespace", "->", "\"\<\>\""}]}], "]"}], "&"}]}]}], 
  ";"}]], "Code",
 CellLabel->
  "In[444]:=",ExpressionUUID->"1b2b0eca-9614-4779-9350-9a597f3af8cc"]
}, Open  ]],

Cell[CellGroupData[{

Cell["expressionFromRules[ expr ]", "Subsubsection",ExpressionUUID->"64f384e7-d84e-47cc-9a3b-21d0e678b3a8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"expressionFromRules", "[", 
    RowBox[{"{", 
     RowBox[{"___", ",", " ", 
      RowBox[{"\"\<symbol\>\"", " ", "->", " ", "sym_"}], ",", " ", "___"}], 
     "}"}], "]"}], " ", ":=", " ", 
   RowBox[{"ToExpression", " ", "@", " ", "sym"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"expressionFromRules", "[", 
    RowBox[{"{", 
     RowBox[{"___", ",", " ", 
      RowBox[{"\"\<string\>\"", " ", "->", " ", "str_"}], ",", " ", "___"}], 
     "}"}], "]"}], " ", ":=", " ", 
   RowBox[{"ToExpression", " ", "@", " ", "str"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"expressionFromRules", "[", 
    RowBox[{"{", 
     RowBox[{"___", ",", " ", 
      RowBox[{"\"\<number\>\"", " ", "->", " ", "val_"}], ",", " ", "___"}], 
     "}"}], "]"}], " ", ":=", " ", 
   RowBox[{"ToExpression", " ", "@", " ", 
    RowBox[{"(", 
     RowBox[{"\"\<value\>\"", " ", "/.", " ", "val"}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"expressionFromRules", "[", "rules_", "]"}], " ", ":=", " ", "\n",
     "\t", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"MatchQ", "[", 
       RowBox[{"rules", ",", 
        RowBox[{"{", 
         RowBox[{"___", ",", 
          RowBox[{"\"\<parts\>\"", "->", "_"}], ",", "___"}], "}"}]}], "]"}], 
      ",", "\n", "      ", 
      RowBox[{"Apply", "[", "\n", "        ", 
       RowBox[{
        RowBox[{"expressionFromRules", "  ", "@", " ", 
         RowBox[{"(", 
          RowBox[{"\"\<head\>\"", " ", "/.", " ", "rules"}], ")"}]}], ",", 
        "\n", "        ", 
        RowBox[{"expressionFromRules", " ", "/@", " ", 
         RowBox[{"(", 
          RowBox[{"\"\<parts\>\"", " ", "/.", " ", "rules"}], ")"}]}]}], 
       "]"}], ",", "\n", "      ", 
      RowBox[{"Throw", "[", "rules", "]"}]}], "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"expressionFromRules", "[", "x___", "]"}], " ", ":=", " ", 
   RowBox[{"Throw", "[", 
    RowBox[{"{", "x", "}"}], "]"}]}], ";"}]}], "Code",
 CellLabel->
  "In[445]:=",ExpressionUUID->"f7f832b3-d4cf-4895-ad75-e75da95ad9bb"]
}, Open  ]],

Cell[CellGroupData[{

Cell["stringifiedExpressionFromRules[ expr ]", "Subsubsection",ExpressionUUID->"06cb47e4-942d-4e8d-8a2b-dd9d43216abd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"insertCommaSeparators", "[", "ss_List", "]"}], " ", ":=", " ", 
    RowBox[{"StringJoin", " ", "@@", " ", 
     RowBox[{"Riffle", "[", 
      RowBox[{"ss", ",", " ", "\"\<, \>\""}], "]"}]}]}], ";"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"result", " ", "=", " ", "\"\<\>\""}], "}"}], ",", "\n", 
      "\t\t", 
      RowBox[{
       RowBox[{"MapIndexed", "[", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"string", ",", " ", "part"}], "}"}], ",", "\n", 
           "\t\t\t\t", 
           RowBox[{"result", " ", "=", " ", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"part", "[", 
                RowBox[{"[", "1", "]"}], "]"}], " ", ">", " ", "1"}], ",", 
              "\n", "\t\t\t\t\t", 
              RowBox[{
              "result", " ", "<>", " ", "\"\<, \>\"", " ", "<>", " ", 
               "string"}], ",", "\n", "\t\t\t\t\t", 
              RowBox[{"result", " ", "<>", " ", "string"}]}], "]"}]}]}], 
          "]"}], ",", "\n", "\t\t\t", "ss"}], "]"}], ";", "\n", "\t\t", 
       "result"}]}], "]"}], ";"}], " ", "*)"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"insertCommaSeparators", "[", "x___", "]"}], " ", ":=", " ", 
   RowBox[{"Throw", "[", 
    RowBox[{"{", "x", "}"}], "]"}]}], ";"}]}], "Code",
 CellLabel->
  "In[450]:=",ExpressionUUID->"a9b4d18e-789d-48ad-bd8e-c6d8daf427e4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"stringifiedExpressionFromRules", "[", 
    RowBox[{"{", 
     RowBox[{"___", ",", " ", 
      RowBox[{"\"\<symbol\>\"", " ", "->", " ", "sym_"}], ",", " ", "___"}], 
     "}"}], "]"}], " ", ":=", " ", "sym"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"stringifiedExpressionFromRules", "[", 
    RowBox[{"{", 
     RowBox[{"___", ",", " ", 
      RowBox[{"\"\<string\>\"", " ", "->", " ", "str_"}], ",", " ", "___"}], 
     "}"}], "]"}], " ", ":=", " ", 
   RowBox[{
   "\"\<\\\"\>\"", " ", "<>", " ", "str", " ", "<>", " ", "\"\<\\\"\>\""}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"stringifiedExpressionFromRules", "[", 
   RowBox[{"{", 
    RowBox[{"___", ",", " ", 
     RowBox[{"\"\<number\>\"", " ", "->", " ", "val_"}], ",", " ", "___"}], 
    "}"}], "]"}], " ", ":=", " ", "\n", "\t", 
  RowBox[{"Switch", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"\"\<subtype\>\"", " ", "/.", " ", "val"}], ")"}], ",", "\n", 
    "\t\t", "\"\<Integer\>\"", ",", " ", 
    RowBox[{"(", 
     RowBox[{"\"\<value\>\"", " ", "/.", " ", "val"}], ")"}], ",", "\n", 
    "\t\t", "\"\<Real\>\"", ",", "    ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"\"\<value\>\"", " ", "/.", " ", "val"}], ")"}], " ", "<>", 
     " ", "\"\<`\>\""}], ",", "\n", "\t\t", "\"\<Complex\>\"", ",", " ", "\n",
     "\t\t\t", 
    RowBox[{
     RowBox[{"Quiet", " ", "@", " ", 
      RowBox[{"StringReplace", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\"\<value\>\"", " ", "/.", " ", "val"}], ")"}], ",", "\n", 
        "\t\t\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"p", ":", "NumberString"}], ")"}], " ", "~~", " ", 
          "\"\< + \>\"", " ", "~~", " ", 
          RowBox[{"(", 
           RowBox[{"q", ":", "NumberString"}], ")"}], " ", "~~", " ", 
          "\"\<*I\>\""}], " ", "->", "\n", "\t\t\t\t", 
         RowBox[{
         "\"\<Complex[\>\"", " ", "<>", " ", "p", " ", "<>", " ", 
          "\"\<, \>\"", " ", "<>", " ", "q", " ", "<>", " ", 
          "\"\<]\>\""}]}]}], " ", "]"}]}], " ", "//", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"Quiet", " ", "@", " ", 
       RowBox[{"StringReplace", "[", 
        RowBox[{"#", ",", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p", ":", 
             RowBox[{"DigitCharacter", "..."}]}], ")"}], " ", "~~", " ", 
           "\"\<.\>\"", " ", "~~", " ", 
           RowBox[{"(", 
            RowBox[{"q", ":", 
             RowBox[{"DigitCharacter", ".."}]}], ")"}]}], " ", "->", " ", 
          "\n", "\t\t\t\t", 
          RowBox[{
          "p", " ", "<>", " ", "\"\<.\>\"", " ", "<>", " ", "q", " ", "<>", 
           " ", "\"\<`\>\""}]}]}], "]"}]}], " ", "&"}]}], ",", "\n", "\t\t", 
    "_", ",", "         ", 
    RowBox[{"Throw", "[", 
     RowBox[{"{", "val", "}"}], "]"}]}], "\n", "\t\t", "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"stringifiedExpressionFromRules", "[", "rules_", "]"}], " ", ":=",
     " ", "\n", "\t", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"MatchQ", "[", 
       RowBox[{"rules", ",", 
        RowBox[{"{", 
         RowBox[{"___", ",", " ", 
          RowBox[{"\"\<parts\>\"", " ", "->", " ", "_"}], ",", " ", "___"}], 
         "}"}]}], "]"}], ",", "\n", "      ", 
      RowBox[{
       RowBox[{"stringifiedExpressionFromRules", "  ", "@", " ", 
        RowBox[{"(", 
         RowBox[{"\"\<head\>\"", " ", "/.", " ", "rules"}], ")"}]}], " ", "<>",
        " ", "\"\<[\>\"", " ", "<>", "\n", "      ", 
       RowBox[{"insertCommaSeparators", " ", "[", "\n", "\t\t", 
        RowBox[{"stringifiedExpressionFromRules", " ", "/@", " ", 
         RowBox[{"(", 
          RowBox[{"\"\<parts\>\"", " ", "/.", " ", "rules"}], ")"}]}], " ", 
        "]"}], " ", "<>", " ", "\"\<]\>\""}], ",", "\n", "      ", 
      RowBox[{"Throw", "[", "rules", "]"}]}], "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"stringifiedExpressionFromRules", "[", "x___", "]"}], " ", ":=", 
   " ", 
   RowBox[{"Throw", "[", 
    RowBox[{"{", "x", "}"}], "]"}]}], ";"}]}], "Code",
 CellLabel->
  "In[452]:=",ExpressionUUID->"51405276-84f9-4b73-ba1b-98506edef722"]
}, Open  ]],

Cell[CellGroupData[{

Cell["rulesFromEvaluatableHeldExpression[ expr ]", "Subsubsection",ExpressionUUID->"aa8ce791-0606-40d4-a073-6cbe6e7523f6"],

Cell["\<\
Allows call of Evaluate inside the expression. Differs from \
\"rulesFromHeldExpression\" only in the Attributes -- \
rulesFromEvaluatableHeldExpression is HoldAll; rulesFromHeldExpression is \
HoldAllComplete. \
\>", "Text",ExpressionUUID->"e0495811-9f7a-43e8-bd85-f47240250a40"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SetAttributes", "[", 
    RowBox[{"rulesFromEvaluatableHeldExpression", ",", " ", "HoldAll"}], 
    "]"}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"rulesFromEvaluatableHeldExpression", "[", 
   RowBox[{"expr_", " ", "/;", " ", 
    RowBox[{"NumberQ", " ", "@", " ", 
     RowBox[{"Unevaluated", " ", "@", " ", "expr"}]}]}], "]"}], " ", ":=", 
  " ", "\n", "\t", 
  RowBox[{"rulesFromExpression", "[", "expr", "]"}]}], "\n", 
 RowBox[{
  RowBox[{"rulesFromEvaluatableHeldExpression", "[", 
   RowBox[{"expr_", " ", "/;", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Head", " ", "@", " ", 
        RowBox[{"Unevaluated", " ", "@", " ", "expr"}]}], " ", "===", " ", 
       "Symbol"}], " ", "&&", " ", 
      RowBox[{
       RowBox[{"AtomQ", " ", "@", " ", 
        RowBox[{"Unevaluated", " ", "@", " ", "expr"}]}], " ", "===", " ", 
       "True"}]}], ")"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"{", "\n", "\t", 
   RowBox[{"\"\<symbol\>\"", " ", "->", " ", 
    RowBox[{"ToString", " ", "@", " ", 
     RowBox[{"Unevaluated", " ", "@", " ", "expr"}]}]}], "}"}]}], "\n", 
 RowBox[{
  RowBox[{"rulesFromEvaluatableHeldExpression", "[", 
   RowBox[{"expr_", " ", "/;", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Head", " ", "@", " ", 
       RowBox[{"Unevaluated", " ", "@", " ", "expr"}]}], " ", "===", " ", 
      "String"}], ")"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"{", "\n", "\t", 
   RowBox[{"\"\<string\>\"", " ", "->", " ", 
    RowBox[{"ToString", " ", "@", " ", 
     RowBox[{"Unevaluated", " ", "@", " ", "expr"}]}]}], "}"}]}], "\n", 
 RowBox[{
  RowBox[{"rulesFromEvaluatableHeldExpression", "[", 
   RowBox[{"head_", "[", "parts___", "]"}], "]"}], " ", ":=", " ", 
  RowBox[{"{", "\n", "\t", 
   RowBox[{
    RowBox[{"\"\<head\>\"", "  ", "->", " ", 
     RowBox[{"rulesFromEvaluatableHeldExpression", "  ", "@", " ", "head"}]}],
     ",", " ", "\n", "\t", 
    RowBox[{"\"\<parts\>\"", " ", "->", " ", 
     RowBox[{"rulesFromEvaluatableHeldExpression", " ", "/@", " ", 
      RowBox[{"Unevaluated", " ", "@", " ", 
       RowBox[{"{", "parts", "}"}]}]}]}]}], "}"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"rulesFromEvaluatableHeldExpression", "[", "x___", "]"}], " ", ":=",
    " ", 
   RowBox[{"Throw", " ", "@", " ", 
    RowBox[{"{", "x", "}"}]}]}], ";"}]}], "Code",
 CellLabel->
  "In[457]:=",ExpressionUUID->"306d768b-d6cb-46d8-81b8-75939009aa0f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["rulesFromHeldExpression[ expr ]", "Subsubsection",ExpressionUUID->"121290ff-9d40-49c7-ac1e-5f7c1a0d52b5"],

Cell["\<\
Applies maximal quoting to input expressions. Will even quote calls of \
\"Evaluate\". \
\>", "Text",ExpressionUUID->"f2fceb92-150f-4cae-8745-4bbae8620deb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SetAttributes", "[", 
    RowBox[{"rulesFromHeldExpression", ",", " ", "HoldAllComplete"}], "]"}], 
   ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"rulesFromHeldExpression", "[", 
   RowBox[{"expr_", " ", "/;", " ", 
    RowBox[{"NumberQ", " ", "@", " ", 
     RowBox[{"Unevaluated", " ", "@", " ", "expr"}]}]}], "]"}], " ", ":=", 
  " ", "\n", "\t", 
  RowBox[{"rulesFromExpression", "[", "expr", "]"}]}], "\n", 
 RowBox[{
  RowBox[{"rulesFromHeldExpression", "[", 
   RowBox[{"expr_", " ", "/;", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Head", " ", "@", " ", 
        RowBox[{"Unevaluated", " ", "@", " ", "expr"}]}], " ", "===", " ", 
       "Symbol"}], " ", "&&", " ", 
      RowBox[{
       RowBox[{"AtomQ", " ", "@", " ", 
        RowBox[{"Unevaluated", " ", "@", " ", "expr"}]}], " ", "===", " ", 
       "True"}]}], ")"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"{", "\n", "\t", 
   RowBox[{"\"\<symbol\>\"", " ", "->", " ", 
    RowBox[{"ToString", " ", "@", " ", 
     RowBox[{"Unevaluated", " ", "@", " ", "expr"}]}]}], "}"}]}], "\n", 
 RowBox[{
  RowBox[{"rulesFromHeldExpression", "[", 
   RowBox[{"expr_", " ", "/;", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Head", " ", "@", " ", 
       RowBox[{"Unevaluated", " ", "@", " ", "expr"}]}], " ", "===", " ", 
      "String"}], ")"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"{", "\n", "\t", 
   RowBox[{"\"\<string\>\"", " ", "->", " ", 
    RowBox[{"ToString", " ", "@", " ", 
     RowBox[{"Unevaluated", " ", "@", " ", "expr"}]}]}], "}"}]}], "\n", 
 RowBox[{
  RowBox[{"rulesFromHeldExpression", "[", 
   RowBox[{"head_", "[", "parts___", "]"}], "]"}], " ", ":=", " ", 
  RowBox[{"{", "\n", "\t", 
   RowBox[{
    RowBox[{"\"\<head\>\"", "  ", "->", " ", 
     RowBox[{"rulesFromHeldExpression", "  ", "@", " ", "head"}]}], ",", " ", 
    "\n", "\t", 
    RowBox[{"\"\<parts\>\"", " ", "->", " ", 
     RowBox[{"rulesFromHeldExpression", " ", "/@", " ", 
      RowBox[{"Unevaluated", " ", "@", " ", 
       RowBox[{"{", "parts", "}"}]}]}]}]}], "}"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"rulesFromHeldExpression", "[", "x___", "]"}], " ", ":=", " ", 
   RowBox[{"Throw", " ", "@", " ", 
    RowBox[{"{", "x", "}"}]}]}], ";"}]}], "Code",
 CellLabel->
  "In[463]:=",ExpressionUUID->"76578a01-67bb-459c-a9c0-7256955da92e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["jsonStringFromHeldExpression[ expr ]", "Subsubsection",ExpressionUUID->"b085029e-bd6f-4762-aa80-0ba04e001886"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SetAttributes", "[", 
    RowBox[{"jsonStringFromHeldExpression", ",", " ", "HoldAllComplete"}], 
    "]"}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"jsonStringFromHeldExpression", "[", "expr_", "]"}], " ", ":=", 
   "\n", "  ", 
   RowBox[{
    RowBox[{"ExportString", "[", 
     RowBox[{
      RowBox[{"rulesFromHeldExpression", "[", "expr", "]"}], ",", " ", 
      "\"\<JSON\>\""}], "]"}], " ", "//", " ", "\n", "    ", 
    RowBox[{
     RowBox[{"StringReplace", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Whitespace", "->", "\"\<\>\""}]}], "]"}], "&"}]}]}], 
  ";"}]}], "Code",
 CellLabel->
  "In[469]:=",ExpressionUUID->"1464075a-b52f-488d-b2ee-8b8007e60ea7"]
}, Open  ]],

Cell[CellGroupData[{

Cell["expressionFromJsonString[ str ]", "Subsubsection",ExpressionUUID->"f5a43370-15b8-42e3-8ec9-45887a4198f8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"expressionFromJsonString", "[", "str_String", "]"}], " ", ":=", 
   "\n", "  ", 
   RowBox[{"expressionFromRules", " ", "@", " ", 
    RowBox[{"ImportString", "[", 
     RowBox[{"str", ",", " ", "\"\<JSON\>\""}], "]"}]}]}], ";"}]], "Code",
 CellLabel->
  "In[471]:=",ExpressionUUID->"477e72ca-3b01-482f-9aa3-87f5ec426a04"]
}, Open  ]],

Cell[CellGroupData[{

Cell["captive[ expr ] \[LongDash] a direct mapping to S-expressions", \
"Subsubsection",
 CellChangeTimes->{
  3.911290425252906*^9},ExpressionUUID->"2cc45493-c126-409b-8901-\
bd244cd50da9"],

Cell["Less verbose output", "Text",ExpressionUUID->"cdc8f236-b4b7-4ee2-aa45-2c3749289d76"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SetAttributes", "[", 
    RowBox[{"captive", ",", " ", "HoldAll"}], "]"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"NOT", " ", "HoldAllComplete"}], " ", "*)"}]}]], "Code",
 CellLabel->
  "In[472]:=",ExpressionUUID->"57eea2b1-aca1-4f71-9323-23c932632e23"],

Cell["Rules for Atoms", "Text",ExpressionUUID->"74b070ab-3112-4f2a-99d3-a20723991b47"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"captive", "[", 
     RowBox[{"expr_", " ", "/;", " ", 
      RowBox[{"AtomQ", " ", "@", " ", 
       RowBox[{"Unevaluated", " ", "@", " ", "expr"}]}]}], "]"}], " ", ":=", 
    " ", "\n", "  ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"Quiet", "[", 
       RowBox[{"ValueQ", " ", "@", " ", "expr"}], "]"}], ",", " ", 
      RowBox[{"captive", " ", "@", " ", 
       RowBox[{"Evaluate", " ", "@", " ", "expr"}]}], ",", " ", "expr"}], 
     "]"}]}], ";"}], " "}]], "Code",
 CellLabel->
  "In[473]:=",ExpressionUUID->"01f4f13e-882d-4e72-a3fa-5442cd7291ee"],

Cell["Rules for non-Atoms", "Text",ExpressionUUID->"88c2a0f7-8e22-4bf7-aa43-61161e0ef262"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"captive", "[", 
   RowBox[{"head_", "[", "parts___", "]"}], "]"}], " ", ":=", " ", "\n", "  ", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"captive", " ", "@", " ", "head"}], "}"}], " ", "~", "Join", "~", 
   " ", 
   RowBox[{"(", 
    RowBox[{"captive", " ", "/@", " ", 
     RowBox[{"(", 
      RowBox[{"Unevaluated", " ", "@", " ", 
       RowBox[{"{", "parts", "}"}]}], ")"}]}], ")"}]}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"captive", "[", "x___", "]"}], " ", ":=", " ", 
   RowBox[{"Throw", "[", 
    RowBox[{"{", "x", "}"}], "]"}]}], ";"}]}], "Code",
 CellLabel->
  "In[474]:=",ExpressionUUID->"0d0f910a-85bf-4510-b6dd-0536f21fb131"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
jaqCaptive[ expr ] \[LongDash] TODO: a 
more Jacquard-ish captive\
\>", "Subsubsection",
 CellChangeTimes->{
  3.911290412560747*^9},ExpressionUUID->"e048f0f5-245a-4b3c-81c5-\
0fd2b13137c5"],

Cell["Less verbose output", "Text",ExpressionUUID->"044ea3d0-29d1-4de3-ad82-789d17be06f5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SetAttributes", "[", 
    RowBox[{"jaqCaptive", ",", " ", "HoldAll"}], "]"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"NOT", " ", "HoldAllComplete"}], " ", "*)"}]}]], "Code",
 CellLabel->
  "In[476]:=",ExpressionUUID->"9023e997-46f8-4347-ac17-48ee847bb478"],

Cell["Rules for Atoms", "Text",ExpressionUUID->"f46658da-1596-4c34-a8e5-d73c13d61800"],

Cell[BoxData[
 RowBox[{
  RowBox[{"jaqCaptive", "[", 
   RowBox[{"expr_", " ", "/;", " ", 
    RowBox[{"AtomQ", " ", "@", " ", 
     RowBox[{"Unevaluated", " ", "@", " ", "expr"}]}]}], "]"}], " ", ":=", 
  " ", "\n", "  ", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"Quiet", "[", 
     RowBox[{"ValueQ", " ", "@", " ", "expr"}], "]"}], ",", " ", 
    RowBox[{"captive", " ", "@", " ", 
     RowBox[{"Evaluate", " ", "@", " ", "expr"}]}], ",", " ", "expr"}], 
   "]"}]}]], "Code",
 CellLabel->
  "In[477]:=",ExpressionUUID->"33a319ac-0141-4410-90e5-f7771a9fd9ed"],

Cell["Rules for non-Atoms", "Text",ExpressionUUID->"dc53ce3a-6dea-4a1c-a1a4-1cded0fda1f2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"jaqCaptive", "[", 
   RowBox[{"head_", "[", "parts___", "]"}], "]"}], " ", ":=", " ", "\n", "  ", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"jaqCaptive", " ", "@", " ", "head"}], "}"}], " ", "~", "Join", 
   "~", " ", 
   RowBox[{"(", 
    RowBox[{"jaqCaptive", " ", "/@", " ", 
     RowBox[{"(", 
      RowBox[{"Unevaluated", " ", "@", " ", 
       RowBox[{"{", "parts", "}"}]}], ")"}]}], ")"}]}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"jaqCaptive", "[", "x___", "]"}], " ", ":=", " ", 
   RowBox[{"Throw", "[", 
    RowBox[{"{", "x", "}"}], "]"}]}], ";"}]}], "Code",
 CellLabel->
  "In[478]:=",ExpressionUUID->"39dfff29-299f-438c-af3f-8c3250f1ec3b"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["HTTP Post Interfaces", "Subsection",ExpressionUUID->"c519b766-fcd6-4f21-b960-4d48feeeeceb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"jacquardPostExpression", ",", " ", "HoldFirst"}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"jacquardPostExpression", "[", "\n", "    ", 
   RowBox[{"request_", ",", "\n", "    ", 
    RowBox[{"importer_", ":", "expressionFromRules"}], ",", "\n", "    ", 
    RowBox[{"url_", ":", " ", "\"\<http://127.0.0.1:5000/jacquard\>\""}]}], 
   "\n", "]"}], " ", ":=", "\n", "  ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\n", "      ", 
     RowBox[{
     "requestExprString", ",", "\n", "      ", "client", ",", " ", "method", 
      ",", "\n", "      ", "entity", ",", " ", "responseCode", ",", " ", 
      "response", ",", "\n", "      ", "responseRules", ",", " ", 
      "responseExpression"}], "}"}], ",", "\n", "    ", 
    RowBox[{"JavaBlock", "[", "\n", "      ", 
     RowBox[{
      RowBox[{"requestExprString", " ", "=", " ", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"Unevaluated", "[", "request", "]"}], ",", " ", 
         "InputForm"}], "]"}]}], ";", "\n", "      ", 
      RowBox[{"Print", "[", "requestExprString", "]"}], ";", "\n", "      ", 
      RowBox[{"client", "=", 
       RowBox[{
       "JavaNew", "[", "\n", "        ", 
        "\"\<org.apache.commons.httpclient.HttpClient\>\"", "]"}]}], ";", 
      "\n", "      ", 
      RowBox[{"method", "=", 
       RowBox[{"JavaNew", "[", "\n", "        ", 
        RowBox[{
        "\"\<org.apache.commons.httpclient.methods.PostMethod\>\"", ",", 
         "url"}], "]"}]}], ";", "\n", "      ", 
      RowBox[{"entity", "=", 
       RowBox[{"JavaNew", "[", "\n", "        ", 
        RowBox[{
        "\"\<org.apache.commons.httpclient.methods.StringRequestEntity\>\"", 
         ",", "\n", "        ", "requestExprString"}], "]"}]}], ";", "\n", 
      "      ", 
      RowBox[{"method", " ", "@", " ", 
       RowBox[{"setRequestHeader", "[", 
        RowBox[{"\"\<Content-Type\>\"", ",", " ", "\"\<text/plain\>\""}], 
        "]"}]}], ";", "\n", "      ", 
      RowBox[{"method", " ", "@", " ", 
       RowBox[{"setRequestEntity", "[", "entity", "]"}]}], ";", "\n", 
      "      ", 
      RowBox[{"responseCode", "=", 
       RowBox[{"client", " ", "@", " ", 
        RowBox[{"executeMethod", "[", "method", "]"}]}]}], ";", "\n", 
      "      ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"responseCode", " ", "===", " ", "200"}], ",", "\n", 
        "        ", 
        RowBox[{"(*", " ", "then", " ", "*)"}], "\n", "        ", 
        RowBox[{
         RowBox[{"response", " ", "=", " ", 
          RowBox[{"method", " ", "@", " ", 
           RowBox[{"getResponseBodyAsString", "[", "]"}]}]}], ";", "\n", 
         "        ", 
         RowBox[{"responseRules", " ", "=", " ", 
          RowBox[{"ImportString", "[", 
           RowBox[{"response", ",", "\"\<JSON\>\""}], "]"}]}], ";", "\n", 
         "        ", 
         RowBox[{"responseExpression", " ", "=", " ", 
          RowBox[{"importer", " ", "@", " ", "responseRules"}]}]}], ",", "\n",
         "        ", 
        RowBox[{"(*", " ", "else", " ", "*)"}], "\n", "        ", 
        RowBox[{
         RowBox[{"Message", "[", "\n", "          ", 
          RowBox[{
           RowBox[{"jacquardPostRules", "::", "httperr"}], ",", "\n", 
           "          ", "responseCode"}], "]"}], ";", "\n", "          ", 
         "$Failed"}]}], "\n", "        ", "]"}]}], "]"}]}], "]"}]}]}], "Code",
 CellLabel->
  "In[480]:=",ExpressionUUID->"51550212-b5de-4a85-bd26-fed049b702d9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"jacquardPostRules", "[", "\n", "    ", 
   RowBox[{"request_", ",", "\n", "    ", 
    RowBox[{"importer_", ":", "expressionFromRules"}], ",", "\n", "    ", 
    RowBox[{"url_", ":", " ", "\"\<http://127.0.0.1:5000/jacquard\>\""}]}], 
   "\n", "]"}], " ", ":=", "\n", "  ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\n", "      ", 
     RowBox[{
     "requestJsonString", ",", "\n", "      ", "client", ",", " ", "method", 
      ",", "\n", "      ", "entity", ",", " ", "responseCode", ",", " ", 
      "response", ",", "\n", "      ", "responseRules", ",", " ", 
      "responseExpression"}], "}"}], ",", "\n", "    ", 
    RowBox[{"JavaBlock", "[", "\n", "      ", 
     RowBox[{
      RowBox[{"requestJsonString", "=", 
       RowBox[{"ExportString", "[", 
        RowBox[{"request", ",", "\"\<JSON\>\""}], "]"}]}], ";", "\n", 
      "      ", 
      RowBox[{"client", "=", 
       RowBox[{
       "JavaNew", "[", "\n", "        ", 
        "\"\<org.apache.commons.httpclient.HttpClient\>\"", "]"}]}], ";", 
      "\n", "      ", 
      RowBox[{"method", "=", 
       RowBox[{"JavaNew", "[", "\n", "        ", 
        RowBox[{
        "\"\<org.apache.commons.httpclient.methods.PostMethod\>\"", ",", 
         "url"}], "]"}]}], ";", "\n", "      ", 
      RowBox[{"entity", "=", 
       RowBox[{"JavaNew", "[", "\n", "        ", 
        RowBox[{
        "\"\<org.apache.commons.httpclient.methods.StringRequestEntity\>\"", 
         ",", "\n", "        ", "requestJsonString"}], "]"}]}], ";", "\n", 
      "      ", 
      RowBox[{"method", " ", "@", " ", 
       RowBox[{"setRequestHeader", "[", 
        RowBox[{
        "\"\<Content-Type\>\"", ",", " ", "\"\<application/json\>\""}], 
        "]"}]}], ";", "\n", "      ", 
      RowBox[{"method", " ", "@", " ", 
       RowBox[{"setRequestEntity", "[", "entity", "]"}]}], ";", "\n", 
      "      ", 
      RowBox[{"responseCode", "=", 
       RowBox[{"client", " ", "@", " ", 
        RowBox[{"executeMethod", "[", "method", "]"}]}]}], ";", "\n", 
      "      ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"responseCode", " ", "===", " ", "200"}], ",", "\n", 
        "        ", 
        RowBox[{"(*", " ", "then", " ", "*)"}], "\n", "        ", 
        RowBox[{
         RowBox[{"response", " ", "=", " ", 
          RowBox[{"method", " ", "@", " ", 
           RowBox[{"getResponseBodyAsString", "[", "]"}]}]}], ";", "\n", 
         "        ", 
         RowBox[{"responseRules", " ", "=", " ", 
          RowBox[{"ImportString", "[", 
           RowBox[{"response", ",", "\"\<JSON\>\""}], "]"}]}], ";", "\n", 
         "        ", 
         RowBox[{"responseExpression", " ", "=", " ", 
          RowBox[{"importer", " ", "@", " ", "responseRules"}]}]}], ",", "\n",
         "        ", 
        RowBox[{"(*", " ", "else", " ", "*)"}], "\n", "        ", 
        RowBox[{
         RowBox[{"Message", "[", "\n", "          ", 
          RowBox[{
           RowBox[{"jacquardPostRules", "::", "httperr"}], ",", "\n", 
           "          ", "responseCode"}], "]"}], ";", "\n", "          ", 
         "$Failed"}]}], "\n", "        ", "]"}]}], "]"}]}], "]"}]}]], "Code",
 CellLabel->
  "In[482]:=",ExpressionUUID->"7ebffded-c1ff-4f56-a44b-d2ffcb061ea1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"jacquardEvalExpression", "[", "\n", "    ", 
    RowBox[{"requestExpr_", ",", "\n", "    ", 
     RowBox[{"importer_", ":", "expressionFromRules"}], ",", "\n", "    ", 
     RowBox[{"url_", ":", " ", "\"\<http://127.0.0.1:5000/jacquard\>\""}]}], 
    "]"}], " ", ":=", "\n", "  ", 
   RowBox[{"jacquardPostRules", "[", 
    RowBox[{
     RowBox[{"rulesFromExpression", " ", "@", " ", "requestExpr"}], ",", " ", 
     "importer", ",", " ", "url"}], "]"}]}], ";"}]], "Code",
 CellLabel->
  "In[483]:=",ExpressionUUID->"d2e5cf96-63d1-445d-b7fe-b10041eb290c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"jacquardEvalHeldExpression", ",", "HoldAllComplete"}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"jacquardEvalHeldExpression", "[", "\n", "    ", 
    RowBox[{"requestExpr_", ",", "\n", "    ", 
     RowBox[{"importer_", ":", "expressionFromRules"}], ",", "\n", "    ", 
     RowBox[{"url_", ":", " ", "\"\<http://127.0.0.1:5000/jacquard\>\""}]}], 
    "]"}], " ", ":=", "\n", "  ", 
   RowBox[{"jacquardPostRules", "[", 
    RowBox[{
     RowBox[{"rulesFromHeldExpression", "[", "requestExpr", "]"}], ",", " ", 
     "importer", ",", " ", "url"}], "]"}]}], ";"}]}], "Code",
 CellLabel->
  "In[484]:=",ExpressionUUID->"1d170215-7ab6-4159-aa6e-9ee878f0a4ad"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "jacquardEvalEvaluatableHeldExpression", "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"jacquardEvalEvaluatableHeldExpression", ",", "HoldAllComplete"}], 
   "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"jacquardEvalEvaluatableHeldExpression", "[", "\n", "    ", 
    RowBox[{"requestExpr_", ",", "\n", "    ", 
     RowBox[{"importer_", ":", "expressionFromRules"}], ",", "\n", "    ", 
     RowBox[{"url_", ":", " ", "\"\<http://127.0.0.1:5000/jacquard\>\""}]}], 
    "]"}], " ", ":=", "\n", "  ", 
   RowBox[{"jacquardPostRules", "[", 
    RowBox[{
     RowBox[{"rulesFromEvaluatableHeldExpression", "[", "requestExpr", "]"}], 
     ",", " ", "importer", ",", " ", "url"}], "]"}]}], ";"}]}], "Code",
 CellLabel->
  "In[486]:=",ExpressionUUID->"529a0009-0cb0-402e-a6a5-79cd3fa60a68"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"jacquardStringifiedEvalHeldExpression", ",", "HoldAllComplete"}], 
   "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"jacquardStringifiedEvalHeldExpression", "[", "\n", "    ", 
    RowBox[{"requestExpr_", ",", "\n", "    ", 
     RowBox[{"url_", ":", "\"\<http://127.0.0.1:5000/jacquard\>\""}]}], "]"}],
    " ", ":=", "\n", "  ", 
   RowBox[{"jacquardPostRules", "[", 
    RowBox[{
     RowBox[{"rulesFromHeldExpression", "[", "requestExpr", "]"}], ",", " ", 
     "stringifiedExpressionFromRules", ",", " ", "url"}], "]"}]}], 
  ";"}]}], "Code",
 CellLabel->
  "In[489]:=",ExpressionUUID->"05c30c5e-d804-498c-8ca7-82201b500ba9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["The Ends", "Subsection",ExpressionUUID->"8c5ddae0-b0cf-4bc5-ac71-417c0d3d0505"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"End", "[", "]"}], ";"}], 
  RowBox[{"(*", " ", "Private", " ", "*)"}]}]], "Code",
 CellLabel->
  "In[491]:=",ExpressionUUID->"459f5e5f-5bd3-47e1-ae7c-c309ca659771"],

Cell[BoxData[
 RowBox[{
  RowBox[{"EndPackage", "[", "]"}], ";"}]], "Code",
 CellLabel->
  "In[492]:=",ExpressionUUID->"3eef6b0e-c01f-407f-86c5-160f66e0a549"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["JacquardProlog.m", "Section",
 CellChangeTimes->{{3.91125232843219*^9, 
  3.911252332818372*^9}},ExpressionUUID->"848f5fa1-8468-4e79-a18e-\
1fcd555481bc"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Mathematica", " ", "Package"}], " ", "*)"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"original", " ", "by", " ", "Tudor", " ", 
    RowBox[{"Jabelean", ":", " ", 
     RowBox[{
      RowBox[{"search", " ", "Mma"}], "-", 
      RowBox[{"Prolog_Tudor", " ", "_", " ", "15"}], "-", "Jan", "-", 
      RowBox[{"2011.", "nb"}]}]}]}], " ", "*)"}], "\n", "\n", 
  RowBox[{
   RowBox[{"BeginPackage", "[", "\"\<JacquardProlog`\>\"", "]"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Exported", " ", "symbols", " ", "added", " ", "here", " ", "with", " ", 
     RowBox[{"SymbolName", "::", "usage"}]}], " ", "*)"}], "  ", "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"OccursIn", "::", "usage"}], " ", "=", " ", 
     "\"\<QccursIn[elem, expr]: Element occurs in expression.\>\""}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Substituted", "::", "usage"}], " ", "=", " ", 
     "\"\<Substituted[expr, substitution]: Apply substitution to the \
expression.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"SubstitutedTerms", "::", "usage"}], " ", "=", " ", 
     "\"\<SubstitutedTerms[{var[v] -> term, ...}, substitution]: Apply the \
substitution to all terms in the list of replacements and drop identity \
replacements.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"DroppedVars", "::", "usage"}], " ", "=", " ", 
     "\"\<DroppedVars[replacements1, replacements2]: Drop from replacements2 \
every replacement whose variable is also in replacements1.\>\""}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Composed", "::", "usage"}], " ", "=", " ", 
     "\"\<Composed[subst1, subst2]: Produces the composition of two \
substitutions.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"MGU", "::", "usage"}], " ", "=", " ", 
     "\"\<MGU[expr1, expr2]: Produces the most general unifier of the two \
expressions as a list of replacement rules.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"FreshVars", "::", "usage"}], " ", "=", " ", 
     "\"\<FreshVars[expr]: Replace vars in expr with fresh vars\>\""}], ";"}],
    "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"FreshRules", "::", "usage"}], " ", "=", " ", 
     "\"\<FreshRules[expr]: Scan expr for vars and make replacement rules for \
them.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"VarToFreshRule", "::", "usage"}], " ", "=", " ", 
     "\"\<VarToFreshRule[var[v]]: Produce a rule to replace var[v] with a \
fresh symbol\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"SelectedRules", "::", "usage"}], " ", "=", " ", 
     "\"\<SelectedRules[rules, vars]: Filter the rules, keeping only those \
that contain some var in vars.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"VarsOfSubst", "::", "usage"}], " ", "=", " ", 
     "\"\<VarsOfSubst[subst]: Produce a list of vars in the subst (list of \
replacement rules)\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Vars", "::", "usage"}], " ", "=", " ", 
     "\"\<Vars[expr]: Produce the dedup'ed set of vars in the expr\>\""}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Transition", "::", "usage"}], " ", "=", " ", 
     "\"\<Transition[st[{questions, ...}, substs, vars, depth], rl[{premises, \
...}, goal]: Produces a single rule transition recorded in the state st[...].\
\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"MultiMatch", "::", "usage"}], " ", "=", " ", 
     "\"\<MultiMatch[st[{questions, ...}, substs, vars, depth], \
knowledgeBase], Find all matches between the questions and the rules in the \
given knowledgebase and apply the given state transition.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"MultiTransition", "::", "usage"}], " ", "=", " ", 
     "\"\<MultiTransition[st[{questions, ...}, substs, vars, depth], \
knowledgeBase, maxDepth:5], Find all matches between the questions and the \
rules in the given knowledgebase with a search depth less than the given \
maximum and apply the given state transition.\>\""}], ";"}], "\t", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"JacQuery", "::", "usage"}], " ", "=", " ", "\"\<TODO\>\""}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"StateQuery", "::", "usage"}], " ", "=", " ", "\"\<TODO\>\""}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Solutions", "::", "usage"}], " ", "=", " ", 
     "\"\<Solutions[question, KB, maxDepth:5]\>\""}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"var", "::", "usage"}], " ", "=", " ", 
     "\"\<var: head for prolog variables.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"st", "::", "usage"}], "  ", "=", " ", 
     "\"\<st: head for prolog states.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"rl", "::", "usage"}], "  ", "=", " ", 
     "\"\<rl: head for prolog rules and facts.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"$Fail", "::", "usage"}], " ", "=", " ", 
     "\"\<Prolog-specific unique failure value.\>\""}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"testtest", "::", "usage"}], " ", "=", " ", 
     "\"\<Temporary.\>\""}], ";"}], "\n", "\n", 
   RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"Begin", " ", "Private", " ", "Context"}], " ", "*)"}], " ", 
   "\n"}]}]], "Code",
 CellLabel->
  "In[493]:=",ExpressionUUID->"bafc37bc-6e78-4ae2-9c98-37927a46eba2"],

Cell[BoxData["\<\"JacquardProlog`\"\>"], "Output",
 CellChangeTimes->{{3.911252420642097*^9, 3.9112524216772194`*^9}, {
   3.91125438122262*^9, 3.911254381572633*^9}, {3.91125464576591*^9, 
   3.911254646081558*^9}, {3.911290460417418*^9, 3.9112904607725554`*^9}, 
   3.912268028206127*^9, {3.912546351929783*^9, 3.912546352311543*^9}, {
   3.912589070450733*^9, 3.912589070784773*^9}, {3.912600350060112*^9, 
   3.91260035033646*^9}, {3.912601704987661*^9, 3.912601705291223*^9}, {
   3.915050870283935*^9, 3.91505087058936*^9}, {3.9155354561302223`*^9, 
   3.915535456461879*^9}},
 CellLabel->
  "Out[493]=",ExpressionUUID->"66e6d699-273d-4d9c-aedd-32b896da5f8e"],

Cell[BoxData["\<\"JacquardProlog`Private`\"\>"], "Output",
 CellChangeTimes->{{3.911252420642097*^9, 3.9112524216772194`*^9}, {
   3.91125438122262*^9, 3.911254381572633*^9}, {3.91125464576591*^9, 
   3.911254646081558*^9}, {3.911290460417418*^9, 3.9112904607725554`*^9}, 
   3.912268028206127*^9, {3.912546351929783*^9, 3.912546352311543*^9}, {
   3.912589070450733*^9, 3.912589070784773*^9}, {3.912600350060112*^9, 
   3.91260035033646*^9}, {3.912601704987661*^9, 3.912601705291223*^9}, {
   3.915050870283935*^9, 3.91505087058936*^9}, {3.9155354561302223`*^9, 
   3.915535456462592*^9}},
 CellLabel->
  "Out[517]=",ExpressionUUID->"67861fa6-2769-4d1e-b5f4-858182c76f3f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["OccursIn", "Subsection",ExpressionUUID->"399e4ade-a969-45da-ab3a-5615072ef3c2"],

Cell["Example: OccursIn[x, bro[x, y]]", "Text",ExpressionUUID->"c0051b6c-fe97-4b09-abcd-de3bc5916e1e"],

Cell["Counterexample: OccursIn[x, sis[a, b]]", "Text",ExpressionUUID->"d7a8cc17-8e75-4227-aa5d-516d4398e27a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"OccursIn", "[", 
    RowBox[{"elem_", ",", " ", "expr_"}], "]"}], " ", ":=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"{", "}"}], " ", "=!=", " ", 
     RowBox[{"Cases", "[", 
      RowBox[{
       RowBox[{"{", "expr", "}"}], ",", " ", "elem", ",", " ", "Infinity"}], 
      "]"}]}], ")"}]}], ";"}]], "Code",
 CellLabel->
  "In[518]:=",ExpressionUUID->"9277348a-d098-4e81-80db-2121577778ac"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Substituted", "Subsection",ExpressionUUID->"9c063747-0019-4898-b04f-387feb691b33"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Substituted", "[", 
    RowBox[{"expr_", ",", " ", "subst_"}], "]"}], " ", ":=", " ", 
   RowBox[{"expr", " ", "/.", " ", "subst"}]}], ";"}]], "Code",
 CellLabel->
  "In[519]:=",ExpressionUUID->"f54d8663-9003-4102-abe7-240e8195613c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["SubstitutedTerms", "Subsection",ExpressionUUID->"bacedb08-e20a-4b0b-b146-84051c8daafd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SubstitutedTerms", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", " ", "subst_"}], "]"}], " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"SubstitutedTerms", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"var", "[", "v_", "]"}], " ", "->", " ", "term_"}], ",", " ", 
      "rest___"}], "}"}], ",", " ", "subst_"}], "]"}], " ", ":=", "\n", 
  "    ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"firstTerm", ",", " ", "restTerms"}], "}"}], ",", "\n", "      ", 
    RowBox[{
     RowBox[{"firstTerm", " ", "=", " ", 
      RowBox[{"Substituted", "[", 
       RowBox[{"term", ",", " ", "subst"}], "]"}]}], ";", "\n", "      ", 
     RowBox[{"restTerms", " ", "=", " ", 
      RowBox[{"SubstitutedTerms", "[", 
       RowBox[{
        RowBox[{"{", "rest", "}"}], ",", " ", "subst"}], "]"}]}], ";", "\n", 
     "      ", 
     RowBox[{"If", "[", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"var", "[", "v", "]"}], " ", "===", " ", "firstTerm"}], ",", 
       "\n", "          ", "restTerms", ",", "\n", "          ", 
       RowBox[{"Prepend", "[", 
        RowBox[{"restTerms", ",", " ", 
         RowBox[{
          RowBox[{"var", "[", "v", "]"}], " ", "->", " ", "firstTerm"}]}], 
        "]"}]}], "\n", "      ", "]"}]}]}], "\n", "    ", "]"}]}]}], "Code",
 CellLabel->
  "In[520]:=",ExpressionUUID->"35a8caee-ae3e-4376-9d4c-b1ada8a279cc"]
}, Open  ]],

Cell[CellGroupData[{

Cell["DroppedVars", "Subsection",ExpressionUUID->"9d317536-3b41-41ff-9586-5e65686069ff"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DroppedVars", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", " ", "subst_"}], "]"}], " ", ":=", " ", 
   "subst"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"DroppedVars", "[", "\n", "  ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"var", "[", "v_", "]"}], " ", "->", " ", "term1_"}], ",", " ",
        "repls1rest___"}], "}"}], ",", "\n", "  ", 
     RowBox[{"{", 
      RowBox[{"repls2pre___", ",", " ", 
       RowBox[{
        RowBox[{"var", "[", "v_", "]"}], " ", "->", " ", "term2_"}], ",", " ",
        "repls2post___"}], "}"}]}], " ", "]"}], " ", ":=", "\n", "    ", 
   RowBox[{"DroppedVars", "[", 
    RowBox[{
     RowBox[{"{", "repls1rest", "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"repls2pre", ",", " ", "repls2post"}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"DroppedVars", "[", "\n", "  ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"var", "[", "v_", "]"}], " ", "->", " ", "term1_"}], ",", " ",
        "repls1rest___"}], "}"}], ",", " ", "repls2_"}], " ", "]"}], " ", ":=",
    "\n", "    ", 
   RowBox[{"DroppedVars", "[", 
    RowBox[{
     RowBox[{"{", "repls1rest", "}"}], ",", " ", "repls2"}], "]"}]}], 
  ";"}]}], "Code",
 CellLabel->
  "In[522]:=",ExpressionUUID->"37123f02-9bbe-4002-a42a-667d3e165727"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Composed", "Subsection",ExpressionUUID->"c24a2d98-84b4-4028-8a82-b8294029608c"],

Cell["\<\
To compose two substitutions Subscript[\[Sigma], 1] and Subscript[\[Sigma], \
2]:\
\>", "Text",ExpressionUUID->"65a97c36-5497-4ea9-a3ae-543c13bf89f1"],

Cell["\<\
Let Subscript[\[Sigma], 1]={Subscript[x, 1]:>Subscript[T, 1],Subscript[x, \
2]:>Subscript[T, 2],...,Subscript[x, m]:>Subscript[T, m]} , \
Subscript[\[Sigma], 2]={Subscript[y, 1]:>Subscript[S, 1],Subscript[y, \
2]:>Subscript[S, 2],...,Subscript[y, n]:>Subscript[S, n]} \
\>", "Text",ExpressionUUID->"c986234b-f192-42ae-b213-034683d4a651"],

Cell["Compute Subscript[\[Sigma], 1]\[SmallCircle]Subscript[\[Sigma], 2]. ", \
"Text",ExpressionUUID->"e4ab0f98-597f-4558-a008-7b479d95beb1"],

Cell["\<\
Apply Subscript[\[Sigma], 2] to every term Subscript[T, i] in Subscript[\
\[Sigma], 1] and delete every identity replacement (optimization), obtaining \
substitution Subscript[\[Theta], 1]. \
\>", "Text",ExpressionUUID->"8201bbd3-40e9-4624-ae1a-948380c1e6d7"],

Cell["\<\
Drop from Subscript[\[Sigma], 2] every replacement Subscript[y, \
j]:>Subscript[S, j] whose variable Subscript[y, j] is a variable in \
Subscript[\[Sigma], 1], obtaining Subscript[\[Theta], 2].\
\>", "Text",ExpressionUUID->"038c5fa6-c526-4029-a561-2331c72a6718"],

Cell["Result is Subscript[\[Theta], 1]\[Union]Subscript[\[Theta], 2]", "Text",ExpressionUUID->"5710e4e6-ec9c-4692-a9a6-34b5f7d03b88"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Composed", "[", 
    RowBox[{"subst1_", ",", " ", "subst2_"}], "]"}], " ", ":=", "\n", "    ", 
   RowBox[{"Join", "[", "\n", "      ", 
    RowBox[{
     RowBox[{"SubstitutedTerms", "[", 
      RowBox[{"subst1", ",", " ", "subst2"}], "]"}], ",", " ", "\n", "      ", 
     RowBox[{"DroppedVars", "[", 
      RowBox[{"subst1", ",", " ", "subst2"}], "]"}]}], " ", "]"}]}], 
  ";"}]], "Code",
 CellLabel->
  "In[525]:=",ExpressionUUID->"b3a088a6-e59c-4d3f-8449-655ae92a132f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["MGU: Most General Unifier", "Subsection",ExpressionUUID->"c1e391ce-5a86-40fe-b27b-a3e8422d8eec"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MGU", "[", 
     RowBox[{"expr_", ",", " ", "expr_"}], "]"}], " ", ":=", " ", 
    RowBox[{"{", "}"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MGU", "[", 
     RowBox[{
      RowBox[{"var", "[", "v_", "]"}], ",", " ", "expr_"}], "]"}], " ", ":=", 
    "\n", "  ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"OccursIn", "[", 
       RowBox[{"v", ",", " ", "expr"}], "]"}], ",", " ", "$Fail", ",", "\n", 
      "    ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"var", "[", "v", "]"}], " ", "->", " ", "expr"}], "}"}]}], 
     "]"}]}], ";"}], "\n", "\t"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MGU", "[", 
     RowBox[{"expr_", ",", " ", 
      RowBox[{"var", "[", "v_", "]"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"MGU", "[", 
     RowBox[{
      RowBox[{"var", "[", "v", "]"}], ",", " ", "expr"}], "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MGU", "[", 
     RowBox[{
      RowBox[{"f_", "[", 
       RowBox[{"expr1_", ",", " ", "exprSeq1___"}], "]"}], ",", " ", 
      RowBox[{"f_", "[", 
       RowBox[{"expr2_", ",", " ", "exprSeq2___"}], "]"}]}], "]"}], " ", ":=",
     "\n", "  ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"subst", ",", " ", "newSubst"}], "}"}], ",", "\n", "    ", 
      RowBox[{
       RowBox[{"subst", " ", "=", " ", 
        RowBox[{"MGU", "[", 
         RowBox[{"expr1", ",", " ", "expr2"}], "]"}]}], ";", " ", "\n", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<MGU subst: \>\"", ",", "subst"}], "]"}], ";"}], " ", 
        "*)"}], "\n", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"subst", " ", "===", " ", "$Fail"}], ",", " ", "$Fail", ",", 
         "\n", "\t  ", 
         RowBox[{
          RowBox[{"newSubst", " ", "=", " ", 
           RowBox[{"MGU", "[", "\n", "\t    ", 
            RowBox[{
             RowBox[{"Substituted", "[", 
              RowBox[{
               RowBox[{"f", "[", "exprSeq1", "]"}], ",", " ", "subst"}], 
              "]"}], ",", " ", "\n", "\t\t", 
             RowBox[{"Substituted", "[", 
              RowBox[{
               RowBox[{"f", "[", "exprSeq2", "]"}], ",", " ", "subst"}], 
              "]"}]}], "]"}]}], ";", "\n", "    ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"newSubst", " ", "===", " ", "$Fail"}], ",", " ", "$Fail",
             ",", "\n", "      ", 
            RowBox[{"Composed", "[", 
             RowBox[{"subst", ",", " ", "newSubst"}], "]"}]}], "]"}]}]}], 
        "]"}]}]}], " ", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MGU", "[", 
    RowBox[{"expr1_", ",", " ", "expr2_"}], "]"}], " ", ":=", " ", "$Fail"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MGU", "[", "exprSeq___", "]"}], " ", ":=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Wrong args to MGU: \>\"", ",", " ", 
       RowBox[{"{", "exprSeq", "}"}]}], "]"}], ";", " ", 
     RowBox[{"Abort", "[", "]"}]}], ")"}]}], ";"}]}], "Code",
 CellLabel->
  "In[526]:=",ExpressionUUID->"30f0f903-6c82-4dd9-8905-d72c040f6b5e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["FreshVars", "Subsection",ExpressionUUID->"82daccf0-6e70-4785-9a6e-c7acecd20906"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FreshVars", "[", "expr_", "]"}], " ", ":=", " ", 
   RowBox[{"expr", " ", "/.", " ", 
    RowBox[{"FreshRules", "[", "expr", "]"}]}]}], ";"}]], "Code",
 CellLabel->
  "In[532]:=",ExpressionUUID->"d2d45997-663e-42ac-9a4e-d4eac50cb351"]
}, Open  ]],

Cell[CellGroupData[{

Cell["FreshRules", "Subsection",ExpressionUUID->"3c18b113-398d-4584-8e78-53b9f51516bf"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FreshRules", "[", "expr_", "]"}], " ", ":=", " ", 
   RowBox[{"Map", "[", 
    RowBox[{"VarToFreshRule", ",", " ", 
     RowBox[{"Vars", "[", "expr", "]"}]}], "]"}]}], ";"}]], "Code",
 CellLabel->
  "In[533]:=",ExpressionUUID->"08f8d2ef-d9cf-4809-9ef0-e7d7f90477af"]
}, Open  ]],

Cell[CellGroupData[{

Cell["VarToFreshRule", "Subsection",ExpressionUUID->"36cfb484-1b22-4f35-8773-46002b3a485f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"VarToFreshRule", "[", 
    RowBox[{"var", "[", "v_", "]"}], "]"}], " ", ":=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"var", "[", "v", "]"}], " ", "->", " ", 
     RowBox[{"var", "[", 
      RowBox[{"Unique", "[", "v", "]"}], "]"}]}], ")"}]}], ";"}]], "Code",
 CellLabel->
  "In[534]:=",ExpressionUUID->"10657cfd-8e75-4482-ac07-dc00d7da624d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["SelectedRules", "Subsection",ExpressionUUID->"12ad9100-ddf6-41a5-b117-72237be06fe0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SelectedRules", "[", 
    RowBox[{"rules_", ",", " ", "vars_"}], "]"}], " ", ":=", "\n", "  ", 
   RowBox[{"Cases", "[", 
    RowBox[{"rules", ",", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"var", "[", "v_", "]"}], " ", "->", " ", "_"}], ")"}], " ", "/;",
       " ", 
      RowBox[{"OccursIn", "[", 
       RowBox[{
        RowBox[{"var", "[", "v", "]"}], ",", " ", "vars"}], "]"}]}]}], 
    "]"}]}], ";"}]], "Code",
 CellLabel->
  "In[535]:=",ExpressionUUID->"b5bfef87-16c4-477f-be6a-a6f405e62f1b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["VarsOfSubst", "Subsection",ExpressionUUID->"7c256164-75ad-4afb-aa2c-761dcd965841"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"VarsOfSubst", "[", "substs_", "]"}], " ", ":=", " ", 
   RowBox[{"Cases", "[", 
    RowBox[{"substs", ",", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"var", "[", "v_", "]"}], " ", "->", " ", "_"}], ")"}], " ", "->",
       " ", 
      RowBox[{"var", "[", "v", "]"}]}]}], "]"}]}], ";"}]], "Code",
 CellLabel->
  "In[536]:=",ExpressionUUID->"b077585e-59d9-4d26-a0f1-3ae9854fea54"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Vars", "Subsection",ExpressionUUID->"981b795d-ccf9-4c33-9557-835bc2c16c89"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Vars", "[", "expr_", "]"}], " ", ":=", " ", 
   RowBox[{"Union", "[", 
    RowBox[{"Cases", "[", 
     RowBox[{
      RowBox[{"{", "expr", "}"}], ",", " ", 
      RowBox[{"var", "[", "v_", "]"}], ",", " ", "Infinity"}], "]"}], "]"}]}],
   ";"}]], "Code",
 CellLabel->
  "In[537]:=",ExpressionUUID->"f0863c79-7778-4265-9776-fdf38b0798e5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Transition", "Subsection",ExpressionUUID->"aa989be7-0b76-49d1-ae11-4d635c424692"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Transition", "[", "\n", "    ", 
    RowBox[{
     RowBox[{"st", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"quest_", ",", " ", "quests___"}], "}"}], ",", " ", "subst_", 
       ",", " ", "vars_", ",", " ", "depth_"}], "]"}], ",", "\n", "    ", 
     RowBox[{"rl", "[", 
      RowBox[{
       RowBox[{"{", "premises___", "}"}], ",", " ", "goal_"}], "]"}]}], "]"}],
    " ", ":=", "\n", "  ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"newSubst", " ", "=", " ", 
       RowBox[{"MGU", "[", 
        RowBox[{"quest", ",", " ", "goal"}], "]"}]}], "}"}], ",", "\n", 
     "    ", 
     RowBox[{"st", "[", "\n", "\t  ", 
      RowBox[{
       RowBox[{"Substituted", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"premises", ",", " ", "quests"}], "}"}], ",", " ", 
         "newSubst"}], "]"}], ",", "\n", "\t  ", 
       RowBox[{"(*", " ", 
        RowBox[{"Composed", "[", 
         RowBox[{"subst", ",", " ", "newSubst"}], "]"}], " ", "*)"}], "\n", 
       "\t  ", 
       RowBox[{"SelectedRules", "[", 
        RowBox[{
         RowBox[{"Composed", "[", 
          RowBox[{"subst", ",", " ", "newSubst"}], "]"}], ",", " ", "vars"}], 
        "]"}], ",", "\n", "\t  ", 
       RowBox[{"(*", " ", 
        RowBox[{"SelectedRules", "[", 
         RowBox[{
          RowBox[{"Composed", "[", 
           RowBox[{"subst", ",", " ", "newSubst"}], "]"}], ",", " ", 
          RowBox[{"Union", "[", 
           RowBox[{"vars", ",", " ", 
            RowBox[{"VarsOfSubst", "[", "newSubst", "]"}]}], "]"}]}], "]"}], 
        " ", "*)"}], "\n", "\t  ", "vars", ",", " ", "\n", "\t  ", 
       RowBox[{"depth", " ", "+", " ", "1"}]}], "\n", "\t", "]"}]}], "\n", 
    "  ", "]"}]}], ";"}]], "Code",
 CellLabel->
  "In[538]:=",ExpressionUUID->"003f7cf0-1b94-4f84-b3a6-6a14753e4a97"]
}, Open  ]],

Cell[CellGroupData[{

Cell["MultiMatch", "Subsection",ExpressionUUID->"e01cdeb1-121a-4789-a5a5-2f5f329f3d5d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MultiMatch", "[", 
    RowBox[{
     RowBox[{"st", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"quest_", ",", " ", "quests___"}], "}"}], ",", " ", "subst_", 
       ",", " ", "vars_", ",", " ", "depth_"}], "]"}], ",", " ", "kb_"}], 
    "]"}], " ", ":=", "\n", "  ", 
   RowBox[{"Cases", "[", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{"FreshVars", ",", " ", "kb"}], "]"}], ",", "\n", "   ", 
     RowBox[{
      RowBox[{
       RowBox[{"rl", "[", 
        RowBox[{
         RowBox[{"{", "premises___", "}"}], ",", " ", "goal_"}], "]"}], " ", "/;",
        " ", 
       RowBox[{"(", 
        RowBox[{"$Fail", " ", "=!=", " ", 
         RowBox[{"MGU", "[", 
          RowBox[{"quest", ",", " ", "goal"}], "]"}]}], ")"}]}], " ", ":>", 
      "\n", "    ", 
      RowBox[{"Transition", "[", "\n", "     ", 
       RowBox[{
        RowBox[{"st", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"quest", ",", " ", "quests"}], "}"}], ",", " ", "subst", 
          ",", " ", "vars", ",", " ", "depth"}], "]"}], ",", "\n", "     ", 
        RowBox[{"rl", "[", 
         RowBox[{
          RowBox[{"{", "premises", "}"}], ",", " ", "goal"}], "]"}]}], 
       "]"}]}]}], "]"}]}], ";"}]], "Code",
 CellLabel->
  "In[539]:=",ExpressionUUID->"b8ecad00-fd96-4e61-adc3-90f6359a28bd"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Multitransition", "Subsection",ExpressionUUID->"5eaa4588-8ade-4135-97df-e8a3a6a09225"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MultiTransition", "[", 
    RowBox[{
     RowBox[{"st", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", " ", "args___"}], "]"}], ",", " ", "kb_", ",",
      " ", 
     RowBox[{"maxDepth_", ":", "5"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"st", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", " ", "args"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MultiTransition", "[", 
     RowBox[{
      RowBox[{"st", "[", 
       RowBox[{"args__", ",", " ", "depth_"}], "]"}], ",", " ", "kb_", ",", 
      " ", 
      RowBox[{"maxDepth_", ":", "5"}]}], "]"}], " ", "/;", " ", 
    RowBox[{"(", 
     RowBox[{"depth", " ", ">", " ", "maxDepth"}], ")"}]}], " ", ":=", " ", 
   RowBox[{"st", "[", 
    RowBox[{"args", ",", " ", "depth"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"MultiTransition", "[", 
   RowBox[{"state_", ",", " ", "kb_", ",", " ", 
    RowBox[{"maxDepth_", ":", "5"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"MultiMatch", "[", 
   RowBox[{"state", ",", " ", "kb"}], "]"}]}]}], "Code",
 CellLabel->
  "In[540]:=",ExpressionUUID->"f4b5d965-e0e6-4012-b0e6-3d74ae415cf4"]
}, Open  ]],

Cell[CellGroupData[{

Cell["JacQuery", "Subsection",ExpressionUUID->"4ea2a31e-5ed8-4f4c-bd0e-aa4a661dcbfe"],

Cell["\<\
The old \"Query\" here collides with the new \"Query\" built-in (MMA 12.2), \
so I just rename it.\
\>", "Text",ExpressionUUID->"85dc289b-981f-4787-8fce-5c3bccf008de"],

Cell[BoxData[
 RowBox[{
  RowBox[{"JacQuery", "[", 
   RowBox[{"question_", ",", " ", "kb_", ",", " ", 
    RowBox[{"maxDepth_", ":", "5"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"StateQuery", "[", 
   RowBox[{
    RowBox[{"st", "[", 
     RowBox[{
      RowBox[{"{", "question", "}"}], ",", " ", 
      RowBox[{"{", "}"}], ",", " ", 
      RowBox[{"Vars", "[", "question", "]"}], ",", " ", "0"}], "]"}], ",", 
    " ", "kb", ",", " ", "maxDepth"}], "]"}]}]], "Code",
 CellLabel->
  "In[543]:=",ExpressionUUID->"1f590c99-e473-4d62-a4ef-aafbd05f3fe5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["StateQuery", "Subsection",ExpressionUUID->"bcf33d24-752b-4708-9376-25f466f7ffe3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"StateQuery", "[", 
   RowBox[{"state_", ",", " ", "kb_", ",", " ", 
    RowBox[{"maxDepth_", ":", "5"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"state", " ", "//.", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"st", "[", "args__", "]"}], " ", ":>", " ", 
     RowBox[{"MultiTransition", "[", 
      RowBox[{
       RowBox[{"st", "[", "args", "]"}], ",", " ", "kb", ",", " ", 
       "maxDepth"}], "]"}]}], "}"}]}]}]], "Code",
 CellLabel->
  "In[544]:=",ExpressionUUID->"8978f440-6f28-4a2f-99a4-52570e9d0a01"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Solutions", "Subsection",ExpressionUUID->"3d1e14a7-6e80-46ff-80f1-f0b057331b77"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Solutions", "[", 
   RowBox[{
    RowBox[{"And", "[", "questions__", "]"}], ",", "kb_", ",", 
    RowBox[{"maxDepth_", ":", "5"}]}], "]"}], " ", ":=", "\n", "  ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Print", "[", "questions", "]"}], ";", "\n", "   ", 
    RowBox[{"Print", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Solutions", "[", 
        RowBox[{"#", ",", "kb", ",", "maxDepth"}], "]"}], "&"}], "/@", 
      "questions"}], "]"}], ";", "\n", "    ", 
    RowBox[{
     RowBox[{
      RowBox[{"Intersection", " ", "@@", "\n", "    ", 
       RowBox[{"Solutions", "[", 
        RowBox[{"#", ",", " ", "kb", ",", " ", "maxDepth"}], "]"}]}], "&"}], "/@",
      "\n", "    ", "questions"}]}], ")"}]}]], "Code",
 CellLabel->
  "In[545]:=",ExpressionUUID->"c74855b7-d881-472f-afb2-ab152cb2953f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Solutions", "[", 
   RowBox[{"question_", ",", " ", "kb_", ",", " ", 
    RowBox[{"maxDepth_", ":", "5"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Union", "[", "\n", "  ", 
   RowBox[{"Cases", "[", "\n", "    ", 
    RowBox[{
     RowBox[{"JacQuery", "[", 
      RowBox[{"question", ",", " ", "kb", ",", " ", "maxDepth"}], "]"}], ",", 
     " ", "\n", "    ", 
     RowBox[{
      RowBox[{"st", "[", 
       RowBox[{
        RowBox[{"{", "}"}], ",", " ", "subst_", ",", " ", "__"}], "]"}], " ", 
      "->", " ", "subst"}], ",", "\n", "    ", "Infinity"}], "]"}], 
   "]"}]}]], "Code",
 CellLabel->
  "In[546]:=",ExpressionUUID->"939a355c-645a-44b6-926a-0e78ee7d4cb7"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Auxiliary Definitions", "Subsection",
 CellChangeTimes->{
  3.911254368027886*^9},ExpressionUUID->"c17399a7-72b6-491c-9b6c-\
3b3d3bd74888"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"testtest", "[", "x_", "]"}], " ", ":=", " ", 
   RowBox[{"x", " ", "+", " ", "2"}]}], ";"}]], "Code",
 CellLabel->
  "In[547]:=",ExpressionUUID->"f08f4ef2-c42f-485b-b5c6-9f2203d853c1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["The End", "Subsection",ExpressionUUID->"93ef96f8-cdd4-4a74-9dec-0a5c9c453d84"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"End", " ", "Private", " ", "Context"}], " ", "*)"}]}]], "Code",
 CellLabel->
  "In[548]:=",ExpressionUUID->"f65015db-7c2f-46e6-8fd0-4c554e235f60"],

Cell[BoxData["\<\"JacquardProlog`Private`\"\>"], "Output",
 CellChangeTimes->{{3.911252420707132*^9, 3.911252421840217*^9}, {
   3.911254381288813*^9, 3.91125438267412*^9}, {3.911254645818158*^9, 
   3.9112546461296673`*^9}, {3.911290460468799*^9, 3.911290460819466*^9}, 
   3.912268028254214*^9, {3.9125463520055923`*^9, 3.912546352392489*^9}, {
   3.912589070498757*^9, 3.912589070832815*^9}, {3.912600350105955*^9, 
   3.912600350384853*^9}, {3.912601705036995*^9, 3.912601705345232*^9}, {
   3.915050870333157*^9, 3.915050870643181*^9}, {3.915535456190961*^9, 
   3.915535456525549*^9}},
 CellLabel->
  "Out[548]=",ExpressionUUID->"2b7f13db-f8d3-4b9c-aa03-f71ba27a4ce1"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"EndPackage", "[", "]"}]], "Code",
 CellLabel->
  "In[549]:=",ExpressionUUID->"da96e4bb-6742-4fdf-947f-cfb4a7154ca5"],

Cell[BoxData[
 RowBox[{"<<", "Utilities`CleanSlate`"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.549536915366044*^9, 3.5495369233915033`*^9}},
 CellLabel->
  "In[550]:=",ExpressionUUID->"61746ed5-bbf8-41e4-b8f0-14c0ca47e0fb"],

Cell[TextData[{
 "You\[CloseCurlyQuote]ll need the following packages on your ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " ",
 StyleBox["$Path",
  FontSlant->"Italic"],
 " if you don\[CloseCurlyQuote]t mention their explicit locations. The \
following shows explicit locations where I put them on a Linux system:"
}], "Text",
 CellChangeTimes->{{3.841245538638632*^9, 3.841245647324567*^9}, {
  3.84139870846646*^9, 
  3.8413987116890798`*^9}},ExpressionUUID->"55d453db-05f8-4e44-ada6-\
95403f2d9ff5"],

Cell[BoxData[{
 RowBox[{"<<", 
  "\"\<~/Dropbox/MMA/Packages/JacquardProlog.m\>\""}], "\[IndentingNewLine]", 
 RowBox[{"<<", "\"\<~/Dropbox/MMA/logic.m\>\""}], "\[IndentingNewLine]", 
 RowBox[{"<<", "\"\<~/Dropbox/MMA/Packages/Jacquard.m\>\""}]}], "Input",
 CellChangeTimes->{{3.629505394618649*^9, 3.6295054078237057`*^9}, {
  3.645653564684004*^9, 3.645653570450636*^9}, {3.841153579311688*^9, 
  3.841153624246653*^9}},
 CellLabel->
  "In[551]:=",ExpressionUUID->"504ea0b2-cf1b-43f8-ae18-65a5cba5770d"]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["POLISH PREFIX GRAMMARS", "Title",
 CellChangeTimes->{{3.841316792633304*^9, 3.841316795651947*^9}, {
  3.841398725078986*^9, 
  3.841398729093936*^9}},ExpressionUUID->"c6fea088-9084-404a-9dbd-\
dfd1fc71b462"],

Cell[TextData[{
 "Our Polish prefix grammars (PPFs) are of the form ",
 StyleBox["[non-terminal] [some-fixed-number-of-arguments]", "Input"],
 ". Such grammars are easy to parse, and it\[CloseCurlyQuote]s easy to \
automatically generate parsers for such grammars. "
}], "Text",
 CellChangeTimes->{{3.841399950937957*^9, 3.84140008609688*^9}, 
   3.841677512696266*^9, {3.841749488316256*^9, 3.841749530272447*^9}, {
   3.911252443835974*^9, 
   3.911252444318129*^9}},ExpressionUUID->"8f130eb3-d9d5-4a18-a9ce-\
98a468fb2728"],

Cell[CellGroupData[{

Cell["DEFINITIONS", "Section",
 CellChangeTimes->{{3.548675666007521*^9, 
  3.5486756701105204`*^9}},ExpressionUUID->"9cd88974-9d17-4a85-86cd-\
7ea469772cfd"],

Cell["Definitions are in bold italics.", "Text",
 CellChangeTimes->{{3.841245776796187*^9, 3.841245874555089*^9}, {
   3.8413990535098753`*^9, 3.841399058136131*^9}, {3.912268104473333*^9, 
   3.912268104525978*^9}, {3.912268302804605*^9, 3.912268321814058*^9}, 
   3.91254345807055*^9, 
   3.915050934609847*^9},ExpressionUUID->"b6cab472-0ccd-46b5-9b0b-\
7a47c2c3739b"],

Cell[TextData[{
 "Let a ",
 StyleBox["grammar",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 " be a function from ",
 StyleBox["non-terminal symbols",
  FontSlant->"Italic"],
 " to ",
 StyleBox["productions",
  FontSlant->"Italic"],
 ", each of which is a list as a ",
 StyleBox["suit",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 " (",
 StyleBox["permutation",
  FontSlant->"Italic"],
 ", ordered, no duplicates",
 ") of ",
 StyleBox["alternatives",
  FontSlant->"Italic"],
 ". Alternatives are ordered for zipping them with travesty-generation \
probabilities. Logically, alternatives are unordered, i.e., a ",
 StyleBox["set",
  FontSlant->"Italic"],
 " rather than a suit."
}], "Text",
 CellChangeTimes->{{3.548582753966124*^9, 3.5485828293476357`*^9}, {
   3.5485829967887287`*^9, 3.548583057605596*^9}, {3.548583120039505*^9, 
   3.54858335874995*^9}, {3.548583390877015*^9, 3.548583441398699*^9}, {
   3.5485835105358686`*^9, 3.5485835344566154`*^9}, {3.548584996979827*^9, 
   3.548585002141003*^9}, {3.548585266809862*^9, 3.5485852783644047`*^9}, {
   3.5485933331353245`*^9, 3.548593376697681*^9}, {3.548594206774685*^9, 
   3.548594281586165*^9}, {3.548665539747817*^9, 3.5486655426189814`*^9}, {
   3.548666280188168*^9, 3.548666283299346*^9}, {3.548666314009021*^9, 
   3.548666328535182*^9}, {3.5486669327563276`*^9, 3.54866699159421*^9}, {
   3.548671649013735*^9, 3.548671678577735*^9}, {3.548671811131735*^9, 
   3.548671816186735*^9}, {3.5486759083395205`*^9, 3.54867596905652*^9}, {
   3.5486763561085205`*^9, 3.54867642814552*^9}, {3.623815595998097*^9, 
   3.6238155983818693`*^9}, {3.623815828428257*^9, 3.623815903273566*^9}, {
   3.8412458168397408`*^9, 3.841245821588372*^9}, {3.841245898634103*^9, 
   3.841245937548195*^9}, {3.84139906957193*^9, 3.841399069820922*^9}, {
   3.841399126206284*^9, 3.841399130025505*^9}, {3.912268131326917*^9, 
   3.912268146842124*^9}, {3.912543524420146*^9, 3.912543526676135*^9}, {
   3.912544504077219*^9, 3.912544506661399*^9}, {3.912544550018201*^9, 
   3.912544555566408*^9}, 
   3.9125445868380127`*^9},ExpressionUUID->"4c8c4044-cfcf-4280-8e3c-\
8de099459c90"],

Cell[TextData[{
 "The productions of a ",
 StyleBox["context-free grammar",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 " pertain anywhere in an ",
 StyleBox["utterance",
  FontSlant->"Italic"],
 " without regard to preceding or following input. Such grammars are the only \
ones of interest, here."
}], "Text",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQXfvKLiep4JXjFfnVpSDaxXZmF4jmTjSeBKIXODPO
AtHT/l/fDqKbBO7sBtHKh3QOgehrqhdPgegZc86dBdH7oua3JANpyWaXVhCd
8ipyGYg2Wnl6OYieErJkWjqQTgsWmwOizU/dYM4A0ncOGvGCaLl35Te6gPSm
c5fBdCUrm2k3kLabkgmmn3k6WIJoMwVBaxB9zXhGG4g+xvy5F0S3FChc6QXS
52ouXQfROuYpL0D0np+sL0F01N2uF/1AOmKT+3sQXZHzJ+7h/1eOXu6JCSB6
z5Z3ao/nvXHUsZbWANEXv/72BNG3z1l6gWgANT2hgg==
  "],ExpressionUUID->"293d5200-c565-4422-803f-6683e92b04f2"],

Cell[TextData[{
 "Each ",
 StyleBox["alternative",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 " is a ",
 StyleBox["list, ",
  FontSlant->"Italic"],
 "as a ",
 StyleBox["sequence",
  FontSlant->"Italic"],
 " (ordered, duplicates allowed),",
 " of ",
 StyleBox["terms",
  FontSlant->"Italic"],
 ". The terms in an alternative must match, in both order and form, the terms \
in ",
 StyleBox["utterances",
  FontSlant->"Italic"],
 "."
}], "Text",
 CellChangeTimes->{{3.548582753966124*^9, 3.5485828293476357`*^9}, {
   3.5485829967887287`*^9, 3.548583057605596*^9}, {3.548583120039505*^9, 
   3.54858335874995*^9}, {3.548583390877015*^9, 3.548583441398699*^9}, {
   3.5485835105358686`*^9, 3.5485835344566154`*^9}, {3.548584996979827*^9, 
   3.548585002141003*^9}, {3.548585266809862*^9, 3.5485852783644047`*^9}, {
   3.5485933331353245`*^9, 3.548593376697681*^9}, {3.548594206774685*^9, 
   3.548594281586165*^9}, {3.548665539747817*^9, 3.5486655426189814`*^9}, {
   3.548666280188168*^9, 3.548666283299346*^9}, {3.548666314009021*^9, 
   3.5486663491746197`*^9}, 3.548666382250757*^9, {3.548666485676103*^9, 
   3.5486665491825275`*^9}, {3.548666589149484*^9, 3.548666617594344*^9}, {
   3.5486666695999413`*^9, 3.548666696143902*^9}, {3.548671691665735*^9, 
   3.548671730271735*^9}, {3.5486760097025204`*^9, 3.54867601630352*^9}, {
   3.623815676075409*^9, 3.623815734042601*^9}, 3.6238159722943*^9, {
   3.841153758596483*^9, 3.8411537652476068`*^9}, {3.841154093504404*^9, 
   3.841154118616422*^9}, {3.841245987755184*^9, 3.841246003925659*^9}, {
   3.841399189367806*^9, 3.841399196565268*^9}, {3.912544310035146*^9, 
   3.912544312586017*^9}, {3.912544462600853*^9, 3.9125444882482443`*^9}, {
   3.912544600686119*^9, 
   3.912544611477416*^9}},ExpressionUUID->"ed2d5464-fd3d-4cee-a2f5-\
999f0724b1ec"],

Cell[TextData[{
 "A ",
 StyleBox["term",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 " is either a ",
 StyleBox["terminal symbol",
  FontSlant->"Italic"],
 " or a ",
 StyleBox["non-terminal symbol. ",
  FontSlant->"Italic"]
}], "Text",
 CellChangeTimes->{{3.548582753966124*^9, 3.5485828293476357`*^9}, {
  3.5485829967887287`*^9, 3.548583057605596*^9}, {3.548583120039505*^9, 
  3.54858335874995*^9}, {3.548583390877015*^9, 3.548583441398699*^9}, {
  3.5485835105358686`*^9, 3.5485835344566154`*^9}, {3.548584996979827*^9, 
  3.548585002141003*^9}, {3.548585266809862*^9, 3.5485852783644047`*^9}, {
  3.5485933331353245`*^9, 3.548593376697681*^9}, {3.548594206774685*^9, 
  3.548594281586165*^9}, {3.548665539747817*^9, 3.5486655426189814`*^9}, {
  3.548666280188168*^9, 3.548666283299346*^9}, {3.548666314009021*^9, 
  3.548666382250757*^9}, {3.548666625421692*^9, 3.548666639924041*^9}, {
  3.548671739247735*^9, 3.548671741638735*^9}, {3.54867601998952*^9, 
  3.5486760265335207`*^9}, {3.841399149815283*^9, 3.8413991742473392`*^9}, {
  3.841399207595504*^9, 
  3.8413992482724547`*^9}},ExpressionUUID->"0369d8cc-054a-49cd-a1bf-\
bce4db72f007"],

Cell[TextData[{
 "A ",
 StyleBox["terminal symbol",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 " is a literal \[LongDash] a ",
 StyleBox["Symbol", "Input"],
 ", ",
 StyleBox["String", "Input"],
 ", or a ",
 StyleBox["Number", "Input"],
 " \[LongDash] that must match exactly a ",
 StyleBox["token",
  FontSlant->"Italic"],
 " appearing in the input."
}], "Text",
 CellChangeTimes->{{3.548582753966124*^9, 3.5485828293476357`*^9}, {
  3.5485829967887287`*^9, 3.548583057605596*^9}, {3.548583120039505*^9, 
  3.54858335874995*^9}, {3.548583390877015*^9, 3.548583441398699*^9}, {
  3.5485835105358686`*^9, 3.5485835344566154`*^9}, {3.548584996979827*^9, 
  3.548585002141003*^9}, {3.548585266809862*^9, 3.5485852783644047`*^9}, {
  3.5485933331353245`*^9, 3.548593376697681*^9}, {3.548594206774685*^9, 
  3.548594281586165*^9}, {3.548665539747817*^9, 3.5486655426189814`*^9}, {
  3.548666280188168*^9, 3.548666283299346*^9}, {3.548666314009021*^9, 
  3.548666382250757*^9}, {3.54867603391652*^9, 3.548676048300521*^9}, {
  3.5486764431045203`*^9, 3.548676447761521*^9}, {3.841254329874946*^9, 
  3.841254335836235*^9}, {3.912544653142775*^9, 
  3.912544716498673*^9}},ExpressionUUID->"bfe7cd85-f0a4-46e7-8e2d-\
54db03fe6e99"],

Cell[TextData[{
 "A ",
 StyleBox["non-terminal symbol",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 " is any term in the grammar that is not a terminal symbol. A",
 " non-terminal symbol ",
 "recurses back into the grammar. It\[CloseCurlyQuote]s always of ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " type ",
 StyleBox["Symbol", "Input"],
 "."
}], "Text",
 CellChangeTimes->{{3.912544061940233*^9, 3.912544107276786*^9}, {
  3.912544199880512*^9, 3.912544201968457*^9}, {3.912544784744583*^9, 
  3.912544787518003*^9}},ExpressionUUID->"296a1dd8-fb06-4580-9711-\
11638900fcbc"],

Cell[TextData[{
 "A ",
 StyleBox["production",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 " is a ",
 "suit",
 " of ",
 StyleBox["alternatives",
  FontSlant->"Italic"],
 "."
}], "Text",
 CellChangeTimes->{{3.623407425245723*^9, 3.6234074316524*^9}, {
   3.6238156239724007`*^9, 3.623815666347084*^9}, 3.623815967367429*^9, {
   3.841153678466175*^9, 3.841153679772957*^9}, 
   3.841245979265031*^9},ExpressionUUID->"80269b5b-1d0e-46c8-88d6-\
8950d4deda8e"],

Cell[TextData[{
 "A ",
 StyleBox["token",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 " is a symbol, string, or number, for example, containing an atomic \
utterance of the language of interest. In WFF-n-Proof, our first motivating \
example, a token is a single character."
}], "Text",
 CellChangeTimes->{{3.623407478106385*^9, 3.623407504649423*^9}, {
   3.841246337936664*^9, 3.841246389545138*^9}, {3.841254345089597*^9, 
   3.841254359008959*^9}, {3.841399262779629*^9, 3.841399286648327*^9}, {
   3.912268205186659*^9, 3.912268216195101*^9}, {3.91254467422468*^9, 
   3.91254467709801*^9}, 3.912601612884383*^9, 
   3.9126016709480877`*^9},ExpressionUUID->"e3ae6d4c-5e44-482a-9157-\
6da7bac6e294"],

Cell[TextData[{
 "An ",
 StyleBox["utterance",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 " is a list (as a sequence) of terminal symbols. "
}], "Text",
 CellChangeTimes->{{3.548582753966124*^9, 3.5485828293476357`*^9}, {
   3.5485829967887287`*^9, 3.548583057605596*^9}, {3.548583120039505*^9, 
   3.54858335874995*^9}, {3.548583390877015*^9, 3.548583441398699*^9}, {
   3.5485835105358686`*^9, 3.5485835344566154`*^9}, {3.548584996979827*^9, 
   3.548585002141003*^9}, {3.548585266809862*^9, 3.5485852783644047`*^9}, {
   3.5485933331353245`*^9, 3.548593376697681*^9}, {3.548594206774685*^9, 
   3.548594281586165*^9}, {3.548665539747817*^9, 3.5486655426189814`*^9}, {
   3.548666280188168*^9, 3.548666283299346*^9}, {3.548666314009021*^9, 
   3.5486663491746197`*^9}, 3.548666382250757*^9, {3.548666485676103*^9, 
   3.5486665491825275`*^9}, {3.548666589149484*^9, 3.548666617594344*^9}, {
   3.5486666695999413`*^9, 3.548666696143902*^9}, {3.548671691665735*^9, 
   3.548671730271735*^9}, {3.5486760097025204`*^9, 3.54867601630352*^9}, {
   3.623815676075409*^9, 3.623815734042601*^9}, 3.6238159722943*^9, {
   3.841153758596483*^9, 3.8411537652476068`*^9}, {3.841154093504404*^9, 
   3.841154118616422*^9}, {3.841245987755184*^9, 3.841246003925659*^9}, {
   3.841399189367806*^9, 3.841399196565268*^9}, {3.841677708658646*^9, 
   3.841677709013706*^9}, {3.841678402360271*^9, 3.841678473011051*^9}, {
   3.841679411806513*^9, 3.841679471066739*^9}, {3.84168662043617*^9, 
   3.841686769835307*^9}, {3.84175269697842*^9, 3.841752701662408*^9}, 
   3.912371131952601*^9, {3.912544417182*^9, 3.912544435087409*^9}, {
   3.912544829566799*^9, 
   3.912544831428379*^9}},ExpressionUUID->"1f84c7ce-ed5d-4ac9-a96e-\
5868e07a603c"],

Cell[TextData[{
 "The ",
 StyleBox["start symbol",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 " is the special, distinguished name and symbol ",
 StyleBox["Start",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 ", not available for other uses. "
}], "Text",
 CellChangeTimes->{{3.548582753966124*^9, 3.5485828293476357`*^9}, {
   3.5485829967887287`*^9, 3.548583057605596*^9}, {3.548583120039505*^9, 
   3.54858335874995*^9}, {3.548583390877015*^9, 3.548583441398699*^9}, {
   3.5485835105358686`*^9, 3.5485835344566154`*^9}, {3.548584996979827*^9, 
   3.548585002141003*^9}, {3.548585266809862*^9, 3.5485852783644047`*^9}, {
   3.5485933331353245`*^9, 3.548593376697681*^9}, {3.548594206774685*^9, 
   3.548594281586165*^9}, {3.548665539747817*^9, 3.5486655426189814`*^9}, {
   3.548666280188168*^9, 3.548666283299346*^9}, {3.548666314009021*^9, 
   3.5486663156972017`*^9}, {3.5486663727851357`*^9, 
   3.5486663822517576`*^9}, {3.548671750518735*^9, 3.5486717954447346`*^9}, 
   3.548671827089735*^9, {3.5486760547485204`*^9, 3.54867605480352*^9}, {
   3.841254380033658*^9, 3.8412543866030073`*^9}, {3.841399322970133*^9, 
   3.841399357718349*^9}},ExpressionUUID->"9cd60e70-1465-4be6-9bdd-\
f54f5cf80bd2"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["WFF-N-PROOF", "Title",
 CellChangeTimes->{{3.841316821036775*^9, 3.841316830473963*^9}, 
   3.912601614016146*^9, 3.912601670983115*^9, {3.915535602621757*^9, 
   3.915535603473665*^9}},ExpressionUUID->"d459bd98-b9b3-43e1-9fb5-\
83abae0cf75c"],

Cell["\<\
The following is an example of a PPF grammar from the famous game \
\[OpenCurlyDoubleQuote]WFF-n-Proof.\[CloseCurlyDoubleQuote] We\
\[CloseCurlyQuote]ll generate travesties, parsers, antiparsers, unparsers, \
and even resurrect a couple of old Prolog simulators by Cabrera and Jabelean \
to process inference rules from the game. This is a big example. It \
illustrates all our syntax-driven machinery. Once that machinery is \
developed, however, we re-use it without modification on algebraic \
expressions and on types for programming languages.\
\>", "Text",
 CellChangeTimes->{{3.5486668963929586`*^9, 3.548666924514503*^9}, {
   3.841399417909555*^9, 3.841399421802702*^9}, {3.912270372279395*^9, 
   3.912270423359044*^9}, {3.912270455693966*^9, 3.912270534455834*^9}, 
   3.912601615212259*^9, 3.912601671013562*^9, {3.915051149145177*^9, 
   3.915051149446376*^9}, {3.915051582003871*^9, 
   3.915051583818646*^9}},ExpressionUUID->"3655ecaa-0df0-481a-8c95-\
4841ac1b5078"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "P", ",", "WFF", ",", "Proposition", ",", "Unary", ",", "Binary", ",", "T",
     ",", "nonTerminalsFromGrammar", ",", "terminalsFromGrammar"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.548582753966124*^9, 3.548582829347636*^9}, {
   3.5485829967887287`*^9, 3.548583057605596*^9}, {3.548583120039505*^9, 
   3.54858335874995*^9}, {3.548583390877015*^9, 3.548583441398699*^9}, {
   3.5485835105358686`*^9, 3.5485835344566154`*^9}, {3.548584996979827*^9, 
   3.548585002141003*^9}, {3.548585266809862*^9, 3.5485852783644056`*^9}, {
   3.5485933331353245`*^9, 3.548593376697681*^9}, {3.548594206774685*^9, 
   3.548594281586165*^9}, {3.548665539747817*^9, 3.5486655426189814`*^9}, {
   3.548666280188168*^9, 3.548666293370922*^9}, {3.548666391700367*^9, 
   3.548666395490018*^9}, {3.54867048383675*^9, 3.54867050681775*^9}, {
   3.548762973774949*^9, 3.5487629846630383`*^9}, {3.623407197120378*^9, 
   3.6234072410903482`*^9}, {3.623407275432143*^9, 3.62340740453813*^9}, 
   3.623815797226323*^9, 3.623816018194888*^9, 3.9126016161050587`*^9, 
   3.9126016710480337`*^9},
 CellLabel->
  "In[554]:=",ExpressionUUID->"232a65c7-f0f6-419b-826f-f6d4389cf925"],

Cell[TextData[{
 "We represent suits (permutations), sets, bags, and lists as lists in ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 ". "
}], "Text",
 CellChangeTimes->{{3.623815987445628*^9, 3.623816002879139*^9}, {
  3.911290246774602*^9, 
  3.911290251457827*^9}},ExpressionUUID->"3e3cbe39-c425-472e-b497-\
b59985910f2f"],

Cell[CellGroupData[{

Cell["P = Suit of Productions = Grammar", "Section",
 CellChangeTimes->{{3.54867360691074*^9, 3.5486736223961916`*^9}, {
  3.5486759000195203`*^9, 3.5486759023475204`*^9}, {3.8411538349347563`*^9, 
  3.841153836486107*^9}, {3.841154037467211*^9, 3.8411540376248207`*^9}, {
  3.841216152657038*^9, 3.841216155236374*^9}, {3.841246497493732*^9, 
  3.841246509492941*^9}, {3.9150516175318117`*^9, 3.915051623579946*^9}, {
  3.915051795198477*^9, 3.915051797172546*^9}, {3.9155353622657013`*^9, 
  3.9155353772502537`*^9}},ExpressionUUID->"4ddfca37-297d-4fe3-8d4a-\
f8cab00d9f99"],

Cell["\<\
NOTE: We never refer to Global Variables in function bodies. That\
\[CloseCurlyQuote]s dangerous because their values may change willy-nilly. \
Instead, all our functions take all data through parameters. Our Global \
Variables represent specific examples like WFF-n-Proof, and those Global \
Variables may appear as actual arguments when calling functions.\
\>", "Text",
 CellChangeTimes->{{3.8412502894372187`*^9, 3.84125036414787*^9}, {
   3.841254177794358*^9, 3.841254266957022*^9}, {3.841399440551675*^9, 
   3.841399641565851*^9}, 3.912601620666177*^9, 
   3.912601671470927*^9},ExpressionUUID->"9a5ae521-99a8-4ebd-8ec9-\
844f298ac87b"],

Cell["\<\
P is a list (as a suit of productions) of lists (as alternatives, i.e., as \
sequences of terms). \
\>", "Text",
 CellChangeTimes->{{3.84115390916422*^9, 3.841153914354281*^9}, {
  3.841154049959308*^9, 3.8411540768321137`*^9}, {3.84124641981497*^9, 
  3.841246464289379*^9}},ExpressionUUID->"eebf4a24-1554-4a32-ac3c-\
c9d942060304"],

Cell["A WFF is either a Proposition, a Unary, or a Binary:", "Text",
 CellChangeTimes->{{3.62381605546668*^9, 3.623816071362472*^9}, {
   3.841399652626668*^9, 3.84139965352881*^9}, 3.9126016218254147`*^9, 
   3.912601671699063*^9},ExpressionUUID->"cc8a8618-26a5-4005-a7c6-\
f96b8741aca1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P", "[", "WFF", "]"}], "=", 
   RowBox[{"(", GridBox[{
      {"Proposition"},
      {"Unary"},
      {"Binary"}
     }], ")"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.548582753966124*^9, 3.548582829347636*^9}, {
   3.5485829967887287`*^9, 3.548583057605596*^9}, {3.548583120039505*^9, 
   3.54858335874995*^9}, {3.548583390877015*^9, 3.548583441398699*^9}, {
   3.5485835105358686`*^9, 3.5485835344566154`*^9}, {3.548584996979827*^9, 
   3.548585002141003*^9}, {3.548585266809862*^9, 3.5485852783644056`*^9}, {
   3.5485933331353245`*^9, 3.548593376697681*^9}, {3.548594206774685*^9, 
   3.548594281586165*^9}, {3.548665539747817*^9, 3.5486655426189814`*^9}, {
   3.548666280188168*^9, 3.548666293370922*^9}, {3.548666391700367*^9, 
   3.548666395490018*^9}, {3.54867048383675*^9, 3.54867050681775*^9}, {
   3.548762973774949*^9, 3.5487629846630383`*^9}, {3.623407197120378*^9, 
   3.6234072410903482`*^9}, {3.623407275432143*^9, 3.62340740453813*^9}, 
   3.623815797226323*^9, 3.623816076196072*^9, 3.912601622919711*^9, 
   3.912601671957706*^9},
 CellLabel->
  "In[555]:=",ExpressionUUID->"de28d666-0494-4d73-baf6-395cb1a22825"],

Cell[TextData[{
 "A Proposition is any one of the four terminal constants ",
 Cell[BoxData[
  FormBox["p", TraditionalForm]],ExpressionUUID->
  "9b543142-6f5c-47d6-88e7-1ab9c5cc81aa"],
 ", ",
 Cell[BoxData[
  FormBox["q", TraditionalForm]],ExpressionUUID->
  "6c850ce7-b245-4e5d-adbd-fa5dfa438b2d"],
 ", ",
 Cell[BoxData[
  FormBox["r", TraditionalForm]],ExpressionUUID->
  "a4f769b0-36f9-4bfe-bc51-3090befffeb1"],
 ", ",
 Cell[BoxData[
  FormBox["s", TraditionalForm]],ExpressionUUID->
  "9c73c851-fd60-4b12-99f1-8a2a8fde27f8"],
 ". "
}], "Text",
 CellChangeTimes->{{3.6238160798097258`*^9, 
  3.623816116880649*^9}},ExpressionUUID->"fba77f8e-38cc-408b-933c-\
bc2459a687e7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P", "[", "Proposition", "]"}], "=", " ", 
   RowBox[{"(", GridBox[{
      {"\"\<p\>\""},
      {"\"\<q\>\""},
      {"\"\<r\>\""},
      {"\"\<s\>\""}
     }], ")"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.548582753966124*^9, 3.548582829347636*^9}, {
   3.5485829967887287`*^9, 3.548583057605596*^9}, {3.548583120039505*^9, 
   3.54858335874995*^9}, {3.548583390877015*^9, 3.548583441398699*^9}, {
   3.5485835105358686`*^9, 3.5485835344566154`*^9}, {3.548584996979827*^9, 
   3.548585002141003*^9}, {3.548585266809862*^9, 3.5485852783644056`*^9}, {
   3.5485933331353245`*^9, 3.548593376697681*^9}, {3.548594206774685*^9, 
   3.548594281586165*^9}, {3.548665539747817*^9, 3.5486655426189814`*^9}, {
   3.548666280188168*^9, 3.548666293370922*^9}, {3.548666391700367*^9, 
   3.548666395490018*^9}, {3.54867048383675*^9, 3.54867050681775*^9}, {
   3.548762973774949*^9, 3.5487629846630383`*^9}, {3.623407197120378*^9, 
   3.6234072410903482`*^9}, {3.623407275432143*^9, 3.62340740453813*^9}, 
   3.623815797226323*^9, 3.623816076196072*^9, {3.623816126467086*^9, 
   3.623816128489489*^9}},
 CellLabel->
  "In[556]:=",ExpressionUUID->"45bb61eb-0ca0-47aa-9371-60b258c5f066"],

Cell[TextData[{
 "A Unary \[LongDash] the language has only one Unary \[LongDash] is a \
terminal ",
 Cell[BoxData[
  FormBox["N", TraditionalForm]],ExpressionUUID->
  "e93f28c5-e849-43b3-966f-527b79abd4e3"],
 " for NOT followed by a WFF."
}], "Text",
 CellChangeTimes->{{3.623816130723379*^9, 3.623816147375296*^9}, {
   3.841246529967691*^9, 3.841246541474418*^9}, {3.841399667572385*^9, 
   3.841399670509243*^9}, {3.911290305854686*^9, 3.91129033666366*^9}, 
   3.912601623993957*^9, 
   3.912601672193819*^9},ExpressionUUID->"e1ea35f2-619c-4f81-bbdd-\
6a0cc8ede241"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P", "[", "Unary", "]"}], "=", 
   RowBox[{"(", GridBox[{
      {"\"\<N\>\"", "WFF"}
     }], ")"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.548582753966124*^9, 3.548582829347636*^9}, {
   3.5485829967887287`*^9, 3.548583057605596*^9}, {3.548583120039505*^9, 
   3.54858335874995*^9}, {3.548583390877015*^9, 3.548583441398699*^9}, {
   3.5485835105358686`*^9, 3.5485835344566154`*^9}, {3.548584996979827*^9, 
   3.548585002141003*^9}, {3.548585266809862*^9, 3.5485852783644056`*^9}, {
   3.5485933331353245`*^9, 3.548593376697681*^9}, {3.548594206774685*^9, 
   3.548594281586165*^9}, {3.548665539747817*^9, 3.5486655426189814`*^9}, {
   3.548666280188168*^9, 3.548666293370922*^9}, {3.548666391700367*^9, 
   3.548666395490018*^9}, {3.54867048383675*^9, 3.54867050681775*^9}, {
   3.548762973774949*^9, 3.5487629846630383`*^9}, {3.623407197120378*^9, 
   3.6234072410903482`*^9}, {3.623407275432143*^9, 3.62340740453813*^9}, 
   3.623815797226323*^9, 3.623816076196072*^9, {3.623816126467086*^9, 
   3.623816151336595*^9}, 3.912601624992076*^9, 3.912601672439262*^9},
 CellLabel->
  "In[557]:=",ExpressionUUID->"ae5a5620-12cf-45ae-9a82-c0b8083b30ab"],

Cell["The language has four Binaries:", "Text",
 CellChangeTimes->{{3.841246549339994*^9, 
  3.841246557364343*^9}},ExpressionUUID->"66a354ed-596e-4f60-bbb2-\
aef364cc68bd"],

Cell["\<\
C is Conditional
A is not And, it\[CloseCurlyQuote]s OR!
K is Konjunction (it\[CloseCurlyQuote]s AND)
E is Equivalence\
\>", "Text",
 CellChangeTimes->{{3.6238881343259563`*^9, 
  3.623888166915509*^9}},ExpressionUUID->"59c3ab88-8a66-4380-950e-\
b9cc1f5e2bc6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P", "[", "Binary", "]"}], "=", 
   RowBox[{"(", GridBox[{
      {"\"\<C\>\"", "WFF", "WFF"},
      {"\"\<A\>\"", "WFF", "WFF"},
      {"\"\<K\>\"", "WFF", "WFF"},
      {"\"\<E\>\"", "WFF", "WFF"}
     }], ")"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.548582753966124*^9, 3.548582829347636*^9}, {
   3.5485829967887287`*^9, 3.548583057605596*^9}, {3.548583120039505*^9, 
   3.54858335874995*^9}, {3.548583390877015*^9, 3.548583441398699*^9}, {
   3.5485835105358686`*^9, 3.5485835344566154`*^9}, {3.548584996979827*^9, 
   3.548585002141003*^9}, {3.548585266809862*^9, 3.5485852783644056`*^9}, {
   3.5485933331353245`*^9, 3.548593376697681*^9}, {3.548594206774685*^9, 
   3.548594281586165*^9}, {3.548665539747817*^9, 3.5486655426189814`*^9}, {
   3.548666280188168*^9, 3.548666293370922*^9}, {3.548666391700367*^9, 
   3.548666395490018*^9}, {3.54867048383675*^9, 3.54867050681775*^9}, {
   3.548762973774949*^9, 3.5487629846630383`*^9}, {3.623407197120378*^9, 
   3.6234072410903482`*^9}, {3.623407275432143*^9, 3.62340740453813*^9}, 
   3.623815797226323*^9, 3.623816076196072*^9, {3.623816126467086*^9, 
   3.6238161703918953`*^9}, {3.912601626182674*^9, 3.912601628126347*^9}, {
   3.9126016726624403`*^9, 3.91260167683679*^9}},
 CellLabel->
  "In[558]:=",ExpressionUUID->"bfa9c90d-bf2a-4f5e-bb7d-03aa1f9ef383"],

Cell["The magical Start symbol is just a WFF:", "Text",
 CellChangeTimes->{{3.84124657177442*^9, 3.841246582293783*^9}, 
   3.912601628712317*^9},ExpressionUUID->"a1062f64-3522-48e4-8fe9-\
9d825c479e75"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P", "[", "Start", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"{", "WFF", "}"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.548582753966124*^9, 3.548582829347636*^9}, {
   3.5485829967887287`*^9, 3.548583057605596*^9}, {3.548583120039505*^9, 
   3.54858335874995*^9}, {3.548583390877015*^9, 3.548583441398699*^9}, {
   3.5485835105358686`*^9, 3.5485835344566154`*^9}, {3.548584996979827*^9, 
   3.548585002141003*^9}, {3.548585266809862*^9, 3.5485852783644056`*^9}, {
   3.5485933331353245`*^9, 3.548593376697681*^9}, {3.548594206774685*^9, 
   3.548594281586165*^9}, {3.548665539747817*^9, 3.5486655426189814`*^9}, {
   3.548666280188168*^9, 3.548666293370922*^9}, {3.548666391700367*^9, 
   3.548666395490018*^9}, {3.54867048383675*^9, 3.54867050681775*^9}, {
   3.548762973774949*^9, 3.5487629846630383`*^9}, {3.623407197120378*^9, 
   3.6234072410903482`*^9}, {3.623407275432143*^9, 3.62340740453813*^9}, 
   3.623815797226323*^9, 3.623816076196072*^9, {3.623816126467086*^9, 
   3.6238161703918953`*^9}, {3.8412164865569687`*^9, 3.841216488580596*^9}, {
   3.841216789331361*^9, 3.841216791648531*^9}, 3.912601629206069*^9},
 CellLabel->
  "In[559]:=",ExpressionUUID->"f30f1a2b-4d21-4f0f-b8de-8af2383728ce"],

Cell["Double-check:", "Text",
 CellChangeTimes->{{3.84124658813334*^9, 
  3.841246593467279*^9}},ExpressionUUID->"a1602603-5b5e-42bd-9732-\
b63b9c27cf6a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"??", "P"}]], "Input",
 CellChangeTimes->{{3.623815766658329*^9, 3.623815771104059*^9}},
 CellLabel->
  "In[560]:=",ExpressionUUID->"efa24837-3574-4c1f-ac32-a0efb3e5351b"],

Cell[BoxData[
 InterpretationBox[
  StyleBox[
   FrameBox[
    DynamicModuleBox[{System`InformationDump`open$$ = True, 
     System`InformationDump`mouseOver$$ = False}, 
     PaneSelectorBox[{True->
      TagBox[GridBox[{
         {
          ItemBox[
           PaneBox[
            StyleBox[
             TagBox[
              TooltipBox[
               StyleBox["\<\" Symbol\"\>", "InformationRowLabel",
                StripOnInput->False],
               "\"Symbol\"",
               TooltipStyle->"TextStyling"],
              Annotation[#, "Symbol", "Tooltip"]& ], "InformationTitleText",
             StripOnInput->False,
             BaseStyle -> None],
            FrameMargins->{{4, 0}, {-1, 1}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           PaneBox[
            StyleBox["\<\"Global`P\"\>", "InformationUsageText",
             StripOnInput->False,
             LineSpacing->{1.5, 1.5, 3.}],
            FrameMargins->{{10, 10}, {8, 10}}],
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False]},
         {
          PaneBox[
           TagBox[GridBox[{
              {
               StyleBox[
                TagBox[
                 TooltipBox[
                  StyleBox["\<\" Definitions\"\>", "InformationRowLabel",
                   StripOnInput->False],
                  "\"Definitions\"",
                  TooltipStyle->"TextStyling"],
                 Annotation[#, "Definitions", "Tooltip"]& ], "DialogStyle",
                StripOnInput->False]},
              {
               TemplateBox[{"\"\[ThinSpace]\"", 
                 GridBox[{{
                    RowBox[{
                    RowBox[{"P", "[", "WFF", "]"}], "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "Proposition", "}"}], ",", 
                    RowBox[{"{", "Unary", "}"}], ",", 
                    RowBox[{"{", "Binary", "}"}]}], "}"}]}]}, {" "}, {
                    RowBox[{
                    RowBox[{"P", "[", "Proposition", "]"}], "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "\"p\"", "}"}], ",", 
                    RowBox[{"{", "\"q\"", "}"}], ",", 
                    RowBox[{"{", "\"r\"", "}"}], ",", 
                    RowBox[{"{", "\"s\"", "}"}]}], "}"}]}]}, {" "}, {
                    RowBox[{
                    RowBox[{"P", "[", "Unary", "]"}], "=", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"\"N\"", ",", "WFF"}], "}"}], "}"}]}]}, {" "}, {
                    RowBox[{
                    RowBox[{"P", "[", "Binary", "]"}], "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"C\"", ",", "WFF", ",", "WFF"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"A\"", ",", "WFF", ",", "WFF"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"K\"", ",", "WFF", ",", "WFF"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"E\"", ",", "WFF", ",", "WFF"}], "}"}]}], 
                    "}"}]}]}, {" "}, {
                    RowBox[{
                    RowBox[{"P", "[", "Start", "]"}], "=", 
                    RowBox[{"{", 
                    RowBox[{"{", "WFF", "}"}], "}"}]}]}, {" "}}, 
                  GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                  DefaultBaseStyle -> "Column", 
                  GridBoxItemSize -> {
                   "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}]},
                "RowDefault"]}
             },
             DefaultBaseStyle->"Column",
             GridBoxAlignment->{"Columns" -> {{Left}}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
            "Column"],
           FrameMargins->{{6, 0}, {3, 6}}], "\<\"\"\>"},
         {
          PaneBox[GridBox[{
             {
              
              DynamicModuleBox[{System`InformationDump`open$$ = {
               False, False, False, False, False, False}}, 
               StyleBox[GridBox[{
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Full Name\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"FullName\"",
                    TooltipStyle->"TextStyling"],
                    
                    Annotation[#, "FullName", 
                    "Tooltip"]& ], "\<\"Global`P\"\>"}
                 },
                 AutoDelete->False,
                 GridBoxAlignment->{"Columns" -> {Right, Left}},
                 GridBoxDividers->None,
                 GridBoxItemSize->{"Columns" -> {Automatic, Automatic}},
                 GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.5599999999999999]}, 
                    Offset[0.27999999999999997`]}, "Rows" -> {
                    Offset[0.2], {
                    Offset[0.8]}, 
                    Offset[0.2]}}], "DialogStyle",
                StripOnInput->False],
               DynamicModuleValues:>{}]}
            },
            DefaultBaseStyle->"Column",
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxDividers->{"Columns" -> {{False}}, "Rows" -> {{False}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.5599999999999999]}, 
                Offset[0.27999999999999997`]}, "Rows" -> {
                Offset[0.2], {
                 Offset[3.6]}, 
                Offset[0.2]}}],
           FrameMargins->{{6, 6}, {6, 3}}], ""},
         {
          ItemBox[
           TagBox[
            ButtonBox[
             PaneSelectorBox[{False->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "UpPointerOpener"],
               ImageSizeCache->{15., {2., 13.}}], True->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "UpPointerOpenerHot"],
               ImageSizeCache->{15., {2., 13.}}]}, Dynamic[
              System`InformationDump`mouseOver$$]],
             Alignment->Left,
             Appearance->{"Default" -> None},
             
             ButtonFunction:>FEPrivate`Set[
              System`InformationDump`open$$, False],
             Evaluator->Automatic,
             FrameMargins->{{9, 0}, {0, 0}},
             ImageMargins->0,
             ImageSize->Full,
             Method->"Preemptive"],
            
            EventHandlerTag[{
             "MouseEntered" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, True], 
              "MouseExited" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, False], 
              Method -> "Preemptive", PassEventsDown -> Automatic, 
              PassEventsUp -> True}]],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], "\[SpanFromLeft]"}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          GrayLevel[0.8], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {Left, Right}, "Rows" -> {{Center}}},
        GridBoxDividers->{
         "Columns" -> {{None}}, "Rows" -> {False, {True}, False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], False->
      TagBox[GridBox[{
         {
          ItemBox[
           PaneBox[
            StyleBox[
             TagBox[
              TooltipBox[
               StyleBox["\<\" Symbol\"\>", "InformationRowLabel",
                StripOnInput->False],
               "\"Symbol\"",
               TooltipStyle->"TextStyling"],
              Annotation[#, "Symbol", "Tooltip"]& ], "InformationTitleText",
             StripOnInput->False],
            FrameMargins->{{4, 0}, {-1, 1}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           PaneBox[
            StyleBox["\<\"Global`P\"\>", "InformationUsageText",
             StripOnInput->False,
             LineSpacing->{1.5, 1.5, 3.}],
            FrameMargins->{{10, 10}, {8, 10}}],
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           TagBox[
            ButtonBox[
             PaneSelectorBox[{False->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpener"]], True->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpenerHot"]]}, Dynamic[
              System`InformationDump`mouseOver$$]],
             Alignment->Left,
             Appearance->{"Default" -> None},
             
             ButtonFunction:>FEPrivate`Set[
              System`InformationDump`open$$, True],
             Evaluator->Automatic,
             FrameMargins->{{9, 0}, {0, 0}},
             ImageMargins->0,
             ImageSize->Full,
             Method->"Preemptive"],
            
            EventHandlerTag[{
             "MouseEntered" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, True], 
              "MouseExited" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, False], 
              Method -> "Preemptive", PassEventsDown -> Automatic, 
              PassEventsUp -> True}]],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], "\[SpanFromLeft]"}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          GrayLevel[0.8], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {Left, Right}, "Rows" -> {{Center}}},
        GridBoxDividers->{
         "Columns" -> {{None}}, "Rows" -> {False, {True}, False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"]}, Dynamic[System`InformationDump`open$$],
      BaselinePosition->Baseline,
      FrameMargins->0,
      ImageSize->Automatic],
     DynamicModuleValues:>{}],
    BaseStyle->"InformationGridFrame",
    StripOnInput->False], "InformationGridPlain",
   StripOnInput->False],
  InformationData[<|
   "ObjectType" -> "Symbol", "Usage" -> "Global`P", "Documentation" -> None, 
    "OwnValues" -> None, "UpValues" -> None, "DownValues" -> 
    Information`InformationValueForm[
     DownValues, $CellContext`P, {$CellContext`P[$CellContext`WFF] -> \
{{$CellContext`Proposition}, {$CellContext`Unary}, {$CellContext`Binary}}, \
$CellContext`P[$CellContext`Proposition] -> {{"p"}, {"q"}, {"r"}, {
         "s"}}, $CellContext`P[$CellContext`Unary] -> {{
         "N", $CellContext`WFF}}, $CellContext`P[$CellContext`Binary] -> {{
         "C", $CellContext`WFF, $CellContext`WFF}, {
         "A", $CellContext`WFF, $CellContext`WFF}, {
         "K", $CellContext`WFF, $CellContext`WFF}, {
         "E", $CellContext`WFF, $CellContext`WFF}}, \
$CellContext`P[$CellContext`Start] -> {{$CellContext`WFF}}}], "SubValues" -> 
    None, "DefaultValues" -> None, "NValues" -> None, "FormatValues" -> None, 
    "Options" -> None, "Attributes" -> {}, "FullName" -> "Global`P"|>, 
   True]]], "Output",
 CellChangeTimes->{3.841404194458786*^9, 3.84140436380645*^9, 
  3.841404587195924*^9, 3.841404744358293*^9, 3.841404847030123*^9, 
  3.841404998619916*^9, 3.841405363005735*^9, 3.841422364106669*^9, 
  3.841487792868697*^9, 3.911255352947331*^9, 3.9112904609091463`*^9, 
  3.912268396246431*^9, 3.912546352489911*^9, 3.9125890709428*^9, 
  3.9126003504867373`*^9, 3.912601705455967*^9, 3.915050870749488*^9, 
  3.915535456634336*^9},
 CellLabel->
  "Out[560]=",ExpressionUUID->"b6f13e5b-5fd9-45de-97aa-d90b6e7eaf40"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["NT = Set of Non-Terminals", "Section",
 CellChangeTimes->{{3.841216577481906*^9, 3.841216608793377*^9}, {
   3.8414005360516253`*^9, 3.841400550567121*^9}, 3.91260164326962*^9, {
   3.915051772478381*^9, 3.915051773972124*^9}, {3.915535387683948*^9, 
   3.915535399813994*^9}},ExpressionUUID->"40b9ef41-4c06-4488-bb4b-\
89f230be020c"],

Cell[TextData[{
 "\[OpenCurlyDoubleQuote]DownValues\[CloseCurlyDoubleQuote] sniffs the domain \
(non-terminals) of a tabular function-definition like ",
 StyleBox["P", "Input"],
 "."
}], "Text",
 CellChangeTimes->{{3.54867569868552*^9, 3.5486757154845204`*^9}, {
  3.5486760926505203`*^9, 3.5486761077455206`*^9}, {3.54867647355952*^9, 
  3.5486764769985204`*^9}, {3.548755853250419*^9, 3.548755861696108*^9}, {
  3.8412146881267*^9, 3.84121469848253*^9}, {3.841246618947403*^9, 
  3.84124668363408*^9}, {3.841400205057066*^9, 
  3.8414002280723143`*^9}},ExpressionUUID->"bfb91be7-80d8-4b6f-830d-\
a098e8a5c20d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"DownValues", "[", "P", "]"}], "//", "TableForm"}]], "Input",
 CellChangeTimes->{{3.841214451361033*^9, 3.8412145427395787`*^9}, {
  3.841247510663264*^9, 3.841247532183339*^9}},
 CellLabel->
  "In[561]:=",ExpressionUUID->"220e7906-1147-45dc-af23-fa970a11d088"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       RowBox[{"HoldPattern", "[", 
        RowBox[{"P", "[", "Binary", "]"}], "]"}], "\[RuleDelayed]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\<\"C\"\>", ",", "WFF", ",", "WFF"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\<\"A\"\>", ",", "WFF", ",", "WFF"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\<\"K\"\>", ",", "WFF", ",", "WFF"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\<\"E\"\>", ",", "WFF", ",", "WFF"}], "}"}]}], "}"}]}]},
     {
      RowBox[{
       RowBox[{"HoldPattern", "[", 
        RowBox[{"P", "[", "Proposition", "]"}], "]"}], "\[RuleDelayed]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "\<\"p\"\>", "}"}], ",", 
         RowBox[{"{", "\<\"q\"\>", "}"}], ",", 
         RowBox[{"{", "\<\"r\"\>", "}"}], ",", 
         RowBox[{"{", "\<\"s\"\>", "}"}]}], "}"}]}]},
     {
      RowBox[{
       RowBox[{"HoldPattern", "[", 
        RowBox[{"P", "[", "Start", "]"}], "]"}], "\[RuleDelayed]", 
       RowBox[{"{", 
        RowBox[{"{", "WFF", "}"}], "}"}]}]},
     {
      RowBox[{
       RowBox[{"HoldPattern", "[", 
        RowBox[{"P", "[", "Unary", "]"}], "]"}], "\[RuleDelayed]", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"\<\"N\"\>", ",", "WFF"}], "}"}], "}"}]}]},
     {
      RowBox[{
       RowBox[{"HoldPattern", "[", 
        RowBox[{"P", "[", "WFF", "]"}], "]"}], "\[RuleDelayed]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "Proposition", "}"}], ",", 
         RowBox[{"{", "Unary", "}"}], ",", 
         RowBox[{"{", "Binary", "}"}]}], "}"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.912601705462461*^9, 3.915050870756682*^9, 
  3.915535456640757*^9},
 CellLabel->
  "Out[561]//TableForm=",ExpressionUUID->"f600b538-9c00-486d-92e0-\
46c237805462"]
}, Open  ]],

Cell[TextData[{
 "How about a pretty display? In ",
 StyleBox["gridRules", "Code"],
 " from the ",
 StyleBox["Jacquard",
  FontSlant->"Italic"],
 " package above, terminals are in dark red, non-terminals in dark blue. \
Lists are green boxes. Lists of lists are doubled green boxes. This visual \
notation does not distinguish lists as suits, sets, sequences, or bags. Rules \
have orange boxes on the left and light-yellow boxes on the right.\.18The \
following displays the rules above."
}], "Text",
 CellChangeTimes->{{3.841246707749188*^9, 3.841246713694433*^9}, {
  3.8412468004849567`*^9, 3.841246854404259*^9}, {3.841247496079574*^9, 
  3.841247501636218*^9}, {3.841247552189951*^9, 3.8412475874328957`*^9}, {
  3.841249323441228*^9, 3.841249351484261*^9}, {3.841254478935403*^9, 
  3.841254632783431*^9}, {3.841400236858873*^9, 3.841400354605666*^9}, {
  3.912268491979961*^9, 3.912268520740996*^9}, {3.915051702004376*^9, 
  3.915051743232802*^9}},ExpressionUUID->"019d4216-3d1b-410e-a628-\
d00052ccc5a2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"d", "=", 
      RowBox[{"DownValues", "[", "P", "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Zip", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Function", "[", 
        RowBox[{"hp", ",", 
         RowBox[{"hp", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}]}], "]"}], "/@", 
       RowBox[{"Unevaluated", "/@", "d"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Function", "[", 
        RowBox[{"hp", ",", 
         RowBox[{"hp", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "]"}], "/@", "d"}], ",", 
      "Rule"}], "]"}]}], "]"}], "//", 
  StyleBox["gridRules",
   Background->RGBColor[1, 1, 0]]}]], "Input",
 CellChangeTimes->{
  3.841246750962532*^9, {3.841247672093781*^9, 3.841247688122778*^9}},
 CellLabel->
  "In[562]:=",ExpressionUUID->"afefb7a9-c834-471f-b897-c105a723e2fa"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[GridBox[{
        {
         StyleBox[
          StyleBox[
           TagBox[GridBox[{
              {"Binary"}
             },
             AutoDelete->False,
             GridBoxAlignment->{"Columns" -> {{Left}}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
            "Grid"],
           StripOnInput->False,
           FontWeight->Bold],
          StripOnInput->False,
          LineColor->GrayLevel[0],
          FrontFaceColor->GrayLevel[0],
          BackFaceColor->GrayLevel[0],
          GraphicsColor->GrayLevel[0],
          FontWeight->Bold,
          FontColor->GrayLevel[0]], 
         StyleBox[
          TagBox[GridBox[{
             {
              TagBox[GridBox[{
                 {
                  StyleBox[
                   TagBox[GridBox[{
                    {"\<\"C\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                   FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                   BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                   GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                   FontWeight->Bold,
                   FontColor->RGBColor[
                    Rational[2, 3], 0, 0]]},
                 {
                  StyleBox[
                   TagBox[GridBox[{
                    {"WFF"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   FontWeight->Bold]},
                 {
                  StyleBox[
                   TagBox[GridBox[{
                    {"WFF"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   FontWeight->Bold]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]},
             {
              TagBox[GridBox[{
                 {
                  StyleBox[
                   TagBox[GridBox[{
                    {"\<\"A\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                   FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                   BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                   GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                   FontWeight->Bold,
                   FontColor->RGBColor[
                    Rational[2, 3], 0, 0]]},
                 {
                  StyleBox[
                   TagBox[GridBox[{
                    {"WFF"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   FontWeight->Bold]},
                 {
                  StyleBox[
                   TagBox[GridBox[{
                    {"WFF"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   FontWeight->Bold]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]},
             {
              TagBox[GridBox[{
                 {
                  StyleBox[
                   TagBox[GridBox[{
                    {"\<\"K\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                   FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                   BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                   GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                   FontWeight->Bold,
                   FontColor->RGBColor[
                    Rational[2, 3], 0, 0]]},
                 {
                  StyleBox[
                   TagBox[GridBox[{
                    {"WFF"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   FontWeight->Bold]},
                 {
                  StyleBox[
                   TagBox[GridBox[{
                    {"WFF"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   FontWeight->Bold]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]},
             {
              TagBox[GridBox[{
                 {
                  StyleBox[
                   TagBox[GridBox[{
                    {"\<\"E\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                   FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                   BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                   GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                   FontWeight->Bold,
                   FontColor->RGBColor[
                    Rational[2, 3], 0, 0]]},
                 {
                  StyleBox[
                   TagBox[GridBox[{
                    {"WFF"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   FontWeight->Bold]},
                 {
                  StyleBox[
                   TagBox[GridBox[{
                    {"WFF"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   FontWeight->Bold]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]}
            },
            AutoDelete->False,
            FrameStyle->RGBColor[0, 
              Rational[2, 3], 0],
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxBackground->{"Columns" -> {{
                 RGBColor[0.88, 1, 0.88]}}},
            GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
           "Grid"],
          StripOnInput->False,
          LineColor->RGBColor[0, 0, 1],
          FrontFaceColor->RGBColor[0, 0, 1],
          BackFaceColor->RGBColor[0, 0, 1],
          GraphicsColor->RGBColor[0, 0, 1],
          FontWeight->Bold,
          FontColor->RGBColor[0, 0, 1]]},
        {
         StyleBox[
          StyleBox[
           TagBox[GridBox[{
              {"Proposition"}
             },
             AutoDelete->False,
             GridBoxAlignment->{"Columns" -> {{Left}}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
            "Grid"],
           StripOnInput->False,
           FontWeight->Bold],
          StripOnInput->False,
          LineColor->GrayLevel[0],
          FrontFaceColor->GrayLevel[0],
          BackFaceColor->GrayLevel[0],
          GraphicsColor->GrayLevel[0],
          FontWeight->Bold,
          FontColor->GrayLevel[0]], 
         StyleBox[
          TagBox[GridBox[{
             {
              TagBox[GridBox[{
                 {
                  StyleBox[
                   TagBox[GridBox[{
                    {"\<\"p\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                   FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                   BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                   GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                   FontWeight->Bold,
                   FontColor->RGBColor[
                    Rational[2, 3], 0, 0]]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]},
             {
              TagBox[GridBox[{
                 {
                  StyleBox[
                   TagBox[GridBox[{
                    {"\<\"q\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                   FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                   BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                   GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                   FontWeight->Bold,
                   FontColor->RGBColor[
                    Rational[2, 3], 0, 0]]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]},
             {
              TagBox[GridBox[{
                 {
                  StyleBox[
                   TagBox[GridBox[{
                    {"\<\"r\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                   FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                   BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                   GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                   FontWeight->Bold,
                   FontColor->RGBColor[
                    Rational[2, 3], 0, 0]]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]},
             {
              TagBox[GridBox[{
                 {
                  StyleBox[
                   TagBox[GridBox[{
                    {"\<\"s\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                   FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                   BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                   GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                   FontWeight->Bold,
                   FontColor->RGBColor[
                    Rational[2, 3], 0, 0]]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]}
            },
            AutoDelete->False,
            FrameStyle->RGBColor[0, 
              Rational[2, 3], 0],
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxBackground->{"Columns" -> {{
                 RGBColor[0.88, 1, 0.88]}}},
            GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
           "Grid"],
          StripOnInput->False,
          LineColor->RGBColor[0, 0, 1],
          FrontFaceColor->RGBColor[0, 0, 1],
          BackFaceColor->RGBColor[0, 0, 1],
          GraphicsColor->RGBColor[0, 0, 1],
          FontWeight->Bold,
          FontColor->RGBColor[0, 0, 1]]},
        {
         StyleBox[
          StyleBox[
           TagBox[GridBox[{
              {"Start"}
             },
             AutoDelete->False,
             GridBoxAlignment->{"Columns" -> {{Left}}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
            "Grid"],
           StripOnInput->False,
           FontWeight->Bold],
          StripOnInput->False,
          LineColor->GrayLevel[0],
          FrontFaceColor->GrayLevel[0],
          BackFaceColor->GrayLevel[0],
          GraphicsColor->GrayLevel[0],
          FontWeight->Bold,
          FontColor->GrayLevel[0]], 
         StyleBox[
          TagBox[GridBox[{
             {
              TagBox[GridBox[{
                 {
                  StyleBox[
                   TagBox[GridBox[{
                    {"WFF"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   FontWeight->Bold]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]}
            },
            AutoDelete->False,
            FrameStyle->RGBColor[0, 
              Rational[2, 3], 0],
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxBackground->{"Columns" -> {{
                 RGBColor[0.88, 1, 0.88]}}},
            GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
           "Grid"],
          StripOnInput->False,
          LineColor->RGBColor[0, 0, 1],
          FrontFaceColor->RGBColor[0, 0, 1],
          BackFaceColor->RGBColor[0, 0, 1],
          GraphicsColor->RGBColor[0, 0, 1],
          FontWeight->Bold,
          FontColor->RGBColor[0, 0, 1]]},
        {
         StyleBox[
          StyleBox[
           TagBox[GridBox[{
              {"Unary"}
             },
             AutoDelete->False,
             GridBoxAlignment->{"Columns" -> {{Left}}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
            "Grid"],
           StripOnInput->False,
           FontWeight->Bold],
          StripOnInput->False,
          LineColor->GrayLevel[0],
          FrontFaceColor->GrayLevel[0],
          BackFaceColor->GrayLevel[0],
          GraphicsColor->GrayLevel[0],
          FontWeight->Bold,
          FontColor->GrayLevel[0]], 
         StyleBox[
          TagBox[GridBox[{
             {
              TagBox[GridBox[{
                 {
                  StyleBox[
                   TagBox[GridBox[{
                    {"\<\"N\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                   FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                   BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                   GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                   FontWeight->Bold,
                   FontColor->RGBColor[
                    Rational[2, 3], 0, 0]]},
                 {
                  StyleBox[
                   TagBox[GridBox[{
                    {"WFF"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   FontWeight->Bold]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]}
            },
            AutoDelete->False,
            FrameStyle->RGBColor[0, 
              Rational[2, 3], 0],
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxBackground->{"Columns" -> {{
                 RGBColor[0.88, 1, 0.88]}}},
            GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
           "Grid"],
          StripOnInput->False,
          LineColor->RGBColor[0, 0, 1],
          FrontFaceColor->RGBColor[0, 0, 1],
          BackFaceColor->RGBColor[0, 0, 1],
          GraphicsColor->RGBColor[0, 0, 1],
          FontWeight->Bold,
          FontColor->RGBColor[0, 0, 1]]},
        {
         StyleBox[
          StyleBox[
           TagBox[GridBox[{
              {"WFF"}
             },
             AutoDelete->False,
             GridBoxAlignment->{"Columns" -> {{Left}}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
            "Grid"],
           StripOnInput->False,
           FontWeight->Bold],
          StripOnInput->False,
          LineColor->GrayLevel[0],
          FrontFaceColor->GrayLevel[0],
          BackFaceColor->GrayLevel[0],
          GraphicsColor->GrayLevel[0],
          FontWeight->Bold,
          FontColor->GrayLevel[0]], 
         StyleBox[
          TagBox[GridBox[{
             {
              TagBox[GridBox[{
                 {
                  StyleBox[
                   TagBox[GridBox[{
                    {"Proposition"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   FontWeight->Bold]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]},
             {
              TagBox[GridBox[{
                 {
                  StyleBox[
                   TagBox[GridBox[{
                    {"Unary"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   FontWeight->Bold]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]},
             {
              TagBox[GridBox[{
                 {
                  StyleBox[
                   TagBox[GridBox[{
                    {"Binary"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   FontWeight->Bold]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]}
            },
            AutoDelete->False,
            FrameStyle->RGBColor[0, 
              Rational[2, 3], 0],
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxBackground->{"Columns" -> {{
                 RGBColor[0.88, 1, 0.88]}}},
            GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
           "Grid"],
          StripOnInput->False,
          LineColor->RGBColor[0, 0, 1],
          FrontFaceColor->RGBColor[0, 0, 1],
          BackFaceColor->RGBColor[0, 0, 1],
          GraphicsColor->RGBColor[0, 0, 1],
          FontWeight->Bold,
          FontColor->RGBColor[0, 0, 1]]}
       },
       AutoDelete->False,
       FrameStyle->RGBColor[0, 0, 1],
       GridBoxAlignment->{"Columns" -> {{Left}}},
       GridBoxBackground->{"Columns" -> {
           RGBColor[1, 0.9, 0.8], {
            RGBColor[1, 1, 0.85]}}},
       GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"]}
   },
   AutoDelete->False,
   FrameStyle->RGBColor[0, 
     Rational[2, 3], 0],
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxBackground->{"Columns" -> {{
        RGBColor[0.88, 1, 0.88]}}},
   GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{3.912601705489913*^9, 3.915050870773219*^9, 
  3.915535456657859*^9},
 CellLabel->
  "Out[562]=",ExpressionUUID->"ba4a4f21-45ee-48c3-9b20-810ec9e2b303"]
}, Open  ]],

Cell["Sniff out the non-terminals.", "Text",
 CellChangeTimes->{{3.912268453953484*^9, 
  3.912268459181989*^9}},ExpressionUUID->"f47bac72-4b93-405e-9854-\
3762c7cdd921"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "nonTerminalsFromGrammar", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nonTerminalsFromGrammar", "[", "ps_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"#", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}], "&"}], "/@", 
   RowBox[{"DownValues", "[", "ps", "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.54867004883952*^9, 3.548670140590694*^9}, {
  3.5486757552695203`*^9, 3.54867577428452*^9}},
 CellLabel->
  "In[563]:=",ExpressionUUID->"c8435255-caf6-40f1-af3d-12988e3b4b31"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"NT", "=", 
    RowBox[{"nonTerminalsFromGrammar", "[", "P", "]"}]}], ")"}], "//", 
  "InputForm"}]], "Input",
 CellChangeTimes->{{3.62340754702971*^9, 3.623407550069459*^9}, {
  3.841216545745515*^9, 3.8412165580166616`*^9}},
 CellLabel->
  "In[565]:=",ExpressionUUID->"0d8c1064-d99b-4647-a49b-d1cc279f69d9"],

Cell["{Binary, Proposition, Start, Unary, WFF}", "Output",
 CellChangeTimes->{3.912601705528799*^9, 3.915050870786828*^9, 
  3.9155354566745*^9},
 CellLabel->
  "Out[565]//InputForm=",ExpressionUUID->"1cc2680f-d3b6-4f9d-a266-\
546053f0dfb9"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["T = Set of Terminals", "Section",
 CellChangeTimes->{{3.54867619030852*^9, 3.5486762006845207`*^9}, {
   3.8412147502406697`*^9, 3.841214754301209*^9}, {3.8414005218417664`*^9, 
   3.84140052830025*^9}, 3.912601657228266*^9, {3.915051762424455*^9, 
   3.915051763989765*^9}, {3.915535410308382*^9, 
   3.915535416608047*^9}},ExpressionUUID->"b69821c9-b032-441a-a6a3-\
dbc282268e73"],

Cell["\<\
The terminals in a grammar is the complement of the non-terminals against the \
set of all symbols, which is the union of all the right-hand sides of the \
productions.\
\>", "Text",
 CellChangeTimes->{{3.540643694649667*^9, 3.540643696688667*^9}, {
   3.5486761169765205`*^9, 3.5486761759255204`*^9}, {3.54867648369452*^9, 
   3.5486764859375205`*^9}, 3.687638291845022*^9, {3.8412147104378443`*^9, 
   3.841214728797196*^9}, {3.841400422092149*^9, 
   3.841400422982233*^9}},ExpressionUUID->"7c8ace97-2057-40ce-8724-\
32a5c669c804"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "allSymbols", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"allSymbols", "[", "ps_", "]"}], ":=", 
  RowBox[{"Union", "@", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"#", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "&"}], "/@", 
     RowBox[{"DownValues", "[", "ps", "]"}]}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.54867021875951*^9, 3.54867031236687*^9}, {
  3.548670347458379*^9, 3.548670386442277*^9}, {3.5486757874835205`*^9, 
  3.548675797842521*^9}},
 CellLabel->
  "In[566]:=",ExpressionUUID->"e490d708-2abb-4def-9ce8-8a6ed2abc2ba"],

Cell[TextData[{
 "In ",
 StyleBox["gridExpression", "Code"],
 " from ",
 StyleBox["Jacquard",
  FontSlant->"Italic"],
 ", terminals are in a light-yellow background, non-terminals in a purple \
background; ",
 StyleBox["gridExpression",
  FontSlant->"Italic"],
 " is a visual ",
 StyleBox["FullForm",
  FontSlant->"Italic"],
 ", so it shows the Head ",
 StyleBox["List",
  FontSlant->"Italic"],
 " explicitly, whereas ",
 StyleBox["gridRules",
  FontSlant->"Italic"],
 ", as above, exhibits lists as colored boxes without the explicit Head ",
 StyleBox["List",
  FontSlant->"Italic"],
 "."
}], "Text",
 CellChangeTimes->{{3.841249439985693*^9, 3.841249483153432*^9}, {
  3.841254692841628*^9, 3.841254736293911*^9}, {3.841254769197891*^9, 
  3.841254770944068*^9}, {3.841400446486301*^9, 3.841400460897981*^9}, {
  3.912268548180442*^9, 3.9122685821604033`*^9}, {3.915051830921894*^9, 
  3.915051835115571*^9}},ExpressionUUID->"c17595f9-8017-4fba-be6a-\
ee085fcc82e6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"allSymbols", "[", "P", "]"}], "//", 
  StyleBox["gridExpression",
   Background->RGBColor[1, 1, 0]]}]], "Input",
 CellChangeTimes->{{3.841247447212355*^9, 3.841247458134458*^9}, {
  3.8412476326682367`*^9, 3.84124764881878*^9}},
 CellLabel->
  "In[568]:=",ExpressionUUID->"811aeb9a-9d90-4324-948e-bac779c8d6de"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"\"\>", 
     TagBox[GridBox[{
        {
         StyleBox["\<\"A\"\>",
          StripOnInput->False,
          FontWeight->Bold]}
       },
       AutoDelete->False,
       GridBoxAlignment->{"Columns" -> {{Left}}},
       GridBoxBackground->{"Columns" -> {{
            RGBColor[1, 1, 0.85]}}},
       GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"]},
    {"\<\"\"\>", 
     TagBox[GridBox[{
        {
         StyleBox["\<\"C\"\>",
          StripOnInput->False,
          FontWeight->Bold]}
       },
       AutoDelete->False,
       GridBoxAlignment->{"Columns" -> {{Left}}},
       GridBoxBackground->{"Columns" -> {{
            RGBColor[1, 1, 0.85]}}},
       GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"]},
    {"\<\"\"\>", 
     TagBox[GridBox[{
        {
         StyleBox["\<\"E\"\>",
          StripOnInput->False,
          FontWeight->Bold]}
       },
       AutoDelete->False,
       GridBoxAlignment->{"Columns" -> {{Left}}},
       GridBoxBackground->{"Columns" -> {{
            RGBColor[1, 1, 0.85]}}},
       GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"]},
    {"\<\"\"\>", 
     TagBox[GridBox[{
        {
         StyleBox["\<\"K\"\>",
          StripOnInput->False,
          FontWeight->Bold]}
       },
       AutoDelete->False,
       GridBoxAlignment->{"Columns" -> {{Left}}},
       GridBoxBackground->{"Columns" -> {{
            RGBColor[1, 1, 0.85]}}},
       GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"]},
    {"\<\"\"\>", 
     TagBox[GridBox[{
        {
         StyleBox["\<\"N\"\>",
          StripOnInput->False,
          FontWeight->Bold]}
       },
       AutoDelete->False,
       GridBoxAlignment->{"Columns" -> {{Left}}},
       GridBoxBackground->{"Columns" -> {{
            RGBColor[1, 1, 0.85]}}},
       GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"]},
    {"\<\"\"\>", 
     TagBox[GridBox[{
        {
         StyleBox["\<\"p\"\>",
          StripOnInput->False,
          FontWeight->Bold]}
       },
       AutoDelete->False,
       GridBoxAlignment->{"Columns" -> {{Left}}},
       GridBoxBackground->{"Columns" -> {{
            RGBColor[1, 1, 0.85]}}},
       GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"]},
    {
     TagBox[GridBox[{
        {
         StyleBox["List",
          StripOnInput->False,
          FontWeight->Bold]}
       },
       AutoDelete->False,
       GridBoxAlignment->{"Columns" -> {{Left}}},
       GridBoxBackground->{"Columns" -> {{
            RGBColor[0.94, 0.88, 0.94]}}},
       GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"], 
     TagBox[GridBox[{
        {
         StyleBox["\<\"q\"\>",
          StripOnInput->False,
          FontWeight->Bold]}
       },
       AutoDelete->False,
       GridBoxAlignment->{"Columns" -> {{Left}}},
       GridBoxBackground->{"Columns" -> {{
            RGBColor[1, 1, 0.85]}}},
       GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"]},
    {"\<\"\"\>", 
     TagBox[GridBox[{
        {
         StyleBox["\<\"r\"\>",
          StripOnInput->False,
          FontWeight->Bold]}
       },
       AutoDelete->False,
       GridBoxAlignment->{"Columns" -> {{Left}}},
       GridBoxBackground->{"Columns" -> {{
            RGBColor[1, 1, 0.85]}}},
       GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"]},
    {"\<\"\"\>", 
     TagBox[GridBox[{
        {
         StyleBox["\<\"s\"\>",
          StripOnInput->False,
          FontWeight->Bold]}
       },
       AutoDelete->False,
       GridBoxAlignment->{"Columns" -> {{Left}}},
       GridBoxBackground->{"Columns" -> {{
            RGBColor[1, 1, 0.85]}}},
       GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"]},
    {"\<\"\"\>", 
     TagBox[GridBox[{
        {
         StyleBox["Binary",
          StripOnInput->False,
          FontWeight->Bold]}
       },
       AutoDelete->False,
       GridBoxAlignment->{"Columns" -> {{Left}}},
       GridBoxBackground->{"Columns" -> {{
            RGBColor[0.94, 0.88, 0.94]}}},
       GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"]},
    {"\<\"\"\>", 
     TagBox[GridBox[{
        {
         StyleBox["Proposition",
          StripOnInput->False,
          FontWeight->Bold]}
       },
       AutoDelete->False,
       GridBoxAlignment->{"Columns" -> {{Left}}},
       GridBoxBackground->{"Columns" -> {{
            RGBColor[0.94, 0.88, 0.94]}}},
       GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"]},
    {"\<\"\"\>", 
     TagBox[GridBox[{
        {
         StyleBox["Unary",
          StripOnInput->False,
          FontWeight->Bold]}
       },
       AutoDelete->False,
       GridBoxAlignment->{"Columns" -> {{Left}}},
       GridBoxBackground->{"Columns" -> {{
            RGBColor[0.94, 0.88, 0.94]}}},
       GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"]},
    {"\<\"\"\>", 
     TagBox[GridBox[{
        {
         StyleBox["WFF",
          StripOnInput->False,
          FontWeight->Bold]}
       },
       AutoDelete->False,
       GridBoxAlignment->{"Columns" -> {{Left}}},
       GridBoxBackground->{"Columns" -> {{
            RGBColor[0.94, 0.88, 0.94]}}},
       GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"]}
   },
   AutoDelete->False,
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxBackground->{"Columns" -> {
       RGBColor[1, 0.9, 0.8], {
        RGBColor[0.88, 1, 0.88]}}},
   GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> False},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{3.9126017055454483`*^9, 3.915050870797503*^9, 
  3.915535456691701*^9},
 CellLabel->
  "Out[568]=",ExpressionUUID->"2602527b-0e96-42d7-babf-9703d2b1c6f8"]
}, Open  ]],

Cell[TextData[{
 StyleBox["InputForm",
  FontSlant->"Italic"],
 " is another way to visualize data. It adds back in the double quotes around \
Strings."
}], "Text",
 CellChangeTimes->{{3.841247472386118*^9, 3.841247477887148*^9}, {
  3.841247605029209*^9, 3.841247655559569*^9}, {3.8412493819783573`*^9, 
  3.841249389078498*^9}, {3.841254779706579*^9, 3.841254798886444*^9}, {
  3.841400489192877*^9, 
  3.8414004960764713`*^9}},ExpressionUUID->"119cf89d-1777-4b86-90bd-\
15d200583ce2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"allSymbols", "[", "P", "]"}], "//", "InputForm"}]], "Input",
 CellChangeTimes->{{3.841249416254254*^9, 3.841249429158533*^9}},
 CellLabel->
  "In[569]:=",ExpressionUUID->"e5ad9465-2130-4327-af87-803ec2800b75"],

Cell["\<\
{\"A\", \"C\", \"E\", \"K\", \"N\", \"p\", \"q\", \"r\", \"s\", Binary, \
Proposition, Unary, WFF}\
\>", "Output",
 CellChangeTimes->{3.912601705563568*^9, 3.915050870801135*^9, 
  3.915535456704297*^9},
 CellLabel->
  "Out[569]//InputForm=",ExpressionUUID->"ceb655d1-f1c4-4a6b-a4b7-\
60d2c95a83de"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "terminalsFromGrammar", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"terminalsFromGrammar", "[", "ps_", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Complement", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"allSymbols", " ", "@", " ", "ps"}], ",", "\[IndentingNewLine]", 
    RowBox[{"nonTerminalsFromGrammar", " ", "@", " ", "ps"}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.54064343798347*^9, 3.540643488938565*^9}, {
  3.540734976347844*^9, 3.540734976994843*^9}, {3.548670184405075*^9, 
  3.548670193999034*^9}, {3.5486758035395203`*^9, 3.54867580559452*^9}},
 CellLabel->
  "In[570]:=",ExpressionUUID->"e1a30d71-ec62-4d9d-81de-e0234deb3007"],

Cell["Sniff out the terminals.", "Text",
 CellChangeTimes->{{3.841154260791566*^9, 3.841154270617577*^9}, {
  3.912268636280744*^9, 
  3.912268641991393*^9}},ExpressionUUID->"97ed0780-f93f-4c36-9161-\
8b2135152516"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"T", "=", 
    RowBox[{"terminalsFromGrammar", " ", "@", " ", "P"}]}], ")"}], "//", 
  "InputForm"}]], "Input",
 CellChangeTimes->{{3.540639515418429*^9, 3.540639602919434*^9}, {
   3.540639638803486*^9, 3.5406396514482093`*^9}, {3.5406396914504976`*^9, 
   3.540639736030048*^9}, 3.540641762614941*^9, 3.540643096606268*^9, {
   3.540643130908268*^9, 3.540643179314268*^9}, {3.540643388781551*^9, 
   3.540643430079678*^9}, {3.5406435337320437`*^9, 3.540643537948465*^9}, 
   3.540734977820843*^9, {3.548672514184044*^9, 3.5486725181604414`*^9}},
 CellLabel->
  "In[572]:=",ExpressionUUID->"b31907a7-fbfe-4894-9d88-de4e1d4509ac"],

Cell["{\"A\", \"C\", \"E\", \"K\", \"N\", \"p\", \"q\", \"r\", \"s\"}", \
"Output",
 CellChangeTimes->{3.841404211726744*^9, 3.841404364007596*^9, 
  3.841404587410448*^9, 3.841404744557275*^9, 3.841404847276818*^9, 
  3.841404998835649*^9, 3.841405363242601*^9, 3.841422364306138*^9, 
  3.841487793152171*^9, 3.911255353031028*^9, 3.911290460968755*^9, 
  3.912268609064803*^9, 3.912546352556093*^9, 3.912589071044033*^9, 
  3.9126003505606527`*^9, 3.912601705583558*^9, 3.915050870809342*^9, 
  3.915535456709155*^9},
 CellLabel->
  "Out[572]//InputForm=",ExpressionUUID->"c8ad83a7-a2ec-4a9a-bd0c-\
9727d7388d8f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["ANTI-PARSING: SYNTAX-DRIVEN TRAVESTIES", "Section",
 CellChangeTimes->{{3.540829537690338*^9, 3.5408295412993402`*^9}, {
  3.54867581910452*^9, 3.54867582164752*^9}, {3.5486818895421095`*^9, 
  3.548681891598109*^9}, {3.548758346109267*^9, 3.548758351775592*^9}, {
  3.549017250041628*^9, 
  3.549017253069344*^9}},ExpressionUUID->"de58f9e4-ce80-4697-a283-\
a7dce78e64b5"],

Cell[TextData[{
 "We\[CloseCurlyQuote]ll do travesties before parsers so we can use \
travesties to ",
 StyleBox["test",
  FontSlant->"Italic"],
 " parsers."
}], "Text",
 CellChangeTimes->{{3.912600129151047*^9, 
  3.912600153210854*^9}},ExpressionUUID->"091e059f-0018-4f24-adf2-\
eb950150555b"],

Cell[CellGroupData[{

Cell["Inject Probabilities into the Grammar", "Subsection",
 CellChangeTimes->{{3.540731388980681*^9, 3.540731416294412*^9}, {
  3.54867805339132*^9, 
  3.548678060463027*^9}},ExpressionUUID->"ac7cd585-7ee7-4b0d-b074-\
520964b4683f"],

Cell[TextData[{
 "Transform each alternative (sequence of terms) into a list of rules, one \
rule for the probability of choosing the alternative in a travesty and \
another rule for the original alternative itself. Generate the probabilities \
with a given function that maps the alternatives to a parallel, isocardinal \
(zippable) list. The orders of the alternatives and of the probabilities are \
important only for ",
 StyleBox["Zip", "Input"],
 ". The alternatives are, notionally, a set."
}], "Text",
 CellChangeTimes->{{3.54867625681752*^9, 3.54867635173252*^9}, {
  3.548755911159999*^9, 3.548755951267019*^9}, {3.6234090247367153`*^9, 
  3.623409025128632*^9}, {3.623816307400713*^9, 3.623816341399294*^9}, {
  3.841214791868857*^9, 3.841214795581569*^9}, {3.841254841516295*^9, 
  3.841254894685729*^9}, {3.8414006178493357`*^9, 3.841400641566272*^9}, {
  3.912268713223201*^9, 3.912268713856182*^9}, {3.912545896211101*^9, 
  3.912545921264096*^9}},ExpressionUUID->"0cf3ea91-98ba-4f77-bb8a-\
baefeb991566"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "injectGenerationProbabilities", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"injectGenerationProbabilities", "[", "\[IndentingNewLine]", 
     RowBox[{
     "grammar_", ",", "\[IndentingNewLine]", "probsFromAlternatives_"}], 
     "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"newTable", ",", 
        RowBox[{"nonTerminals", "=", 
         RowBox[{"nonTerminalsFromGrammar", "@", "grammar"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Scan", "[", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"Scan", " ", "is", " ", "like", " ", "Map"}], ",", " ", 
          RowBox[{
           RowBox[{"but", " ", "just", " ", "for", " ", "side"}], "-", 
           "effects"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{"nonTerminal", ",", "\[IndentingNewLine]", 
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"alternatives", "=", 
                RowBox[{"grammar", "[", "nonTerminal", "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"probabilities", "=", 
                RowBox[{"probsFromAlternatives", "[", 
                 RowBox[{"grammar", "[", "nonTerminal", "]"}], "]"}]}]}], 
              "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"newTable", "[", "nonTerminal", "]"}], "=", 
              RowBox[{"(*", " ", 
               RowBox[{"side", "-", 
                RowBox[{"effect", " ", "this", " ", "definition"}]}], " ", 
               "*)"}], "\[IndentingNewLine]", 
              RowBox[{"Zip", "[", 
               RowBox[{
               "probabilities", ",", " ", "alternatives", ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Function", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"prob", ",", "alt"}], "}"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\"\<probability\>\"", "\[Rule]", "prob"}], ",", 
                    RowBox[{"\"\<alternative\>\"", "\[Rule]", "alt"}]}], 
                   "}"}]}], "]"}]}], "]"}]}]}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", "nonTerminals"}], "]"}], ";", 
       RowBox[{"(*", " ", 
        RowBox[{"scan", " ", "over", " ", "this", " ", "list"}], " ", "*)"}], 
       "\[IndentingNewLine]", "newTable"}]}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"return", " ", "the", " ", "side"}], "-", 
    RowBox[{"effected", " ", "table"}]}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.540731467557538*^9, 3.540731508540636*^9}, {
   3.540731557278509*^9, 3.540731621505931*^9}, {3.540731708956678*^9, 
   3.54073171370315*^9}, {3.540731776187398*^9, 3.5407318026760483`*^9}, {
   3.548584588104154*^9, 3.5485846003035016`*^9}, 3.548665713331745*^9, {
   3.548671859685735*^9, 3.548671976037735*^9}, {3.5486720145157347`*^9, 
   3.5486721179824276`*^9}, {3.548672192226851*^9, 3.548672202194848*^9}, {
   3.5486722774783754`*^9, 3.548672322376865*^9}, {3.548672383084935*^9, 
   3.5486724845220776`*^9}, {3.548672899767598*^9, 3.548672917728394*^9}, {
   3.5486731430849276`*^9, 3.5486731696055794`*^9}, {3.548673200645683*^9, 
   3.5486732016397824`*^9}, {3.548673257762394*^9, 3.5486732599136095`*^9}, 
   3.548673294172035*^9, {3.548676216602521*^9, 3.54867621915452*^9}, {
   3.549634458734583*^9, 3.549634460632774*^9}, {3.841217566468073*^9, 
   3.8412175743786488`*^9}, {3.841400661245524*^9, 3.8414007534356947`*^9}, 
   3.841404083185593*^9},
 CellLabel->
  "In[573]:=",ExpressionUUID->"32f333a9-f192-4fee-ac40-c53289832f66"],

Cell[TextData[{
 "The following function assigns equal probabilities to every element of a \
list. It\[CloseCurlyQuote]s the default. Use something else if you have \
better estimates of appropriate probabilities. We\[CloseCurlyQuote]ll see an \
example of that in ",
 StyleBox["BPTProbabilities", "Input"],
 " below for Benjamin-Pierce types. "
}], "Text",
 CellChangeTimes->{{3.548665705572302*^9, 3.548665708759485*^9}, {
  3.841254912124318*^9, 3.841254917612651*^9}, {3.841400761322077*^9, 
  3.841400832857114*^9}, {3.91226876091453*^9, 
  3.912268766779483*^9}},ExpressionUUID->"8335e098-b38b-472e-a387-\
e02f2bb9ccad"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "equiProbabilities", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"equiProbabilities", "[", "list_List", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"l", "=", 
      RowBox[{"Length", "@", "list"}]}], "}"}], ",", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"N", "[", 
       FractionBox["1", "l"], "]"}], ",", 
      RowBox[{"{", "l", "}"}]}], "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.5407321711368885`*^9, 3.540732228984673*^9}, {
  3.540823258528471*^9, 3.540823263647983*^9}, {3.548584611450851*^9, 
  3.548584620994145*^9}},
 CellLabel->
  "In[575]:=",ExpressionUUID->"f253462d-e344-472c-b1c0-1fbe75de0abd"]
}, Open  ]],

Cell[CellGroupData[{

Cell["iP = set of probabilized productions", "Subsection",
 CellChangeTimes->{{3.548667832071556*^9, 3.548667840977556*^9}, {
  3.548673628098621*^9, 3.548673640427388*^9}, {3.915051901253133*^9, 
  3.915051902768304*^9}},ExpressionUUID->"1c10531e-5aef-4bf6-bbdc-\
06b56a0fe7a5"],

Cell["\<\
Productions (headed by non-terminals) with injected probabilities.\
\>", "Text",
 CellChangeTimes->{{3.548667850373556*^9, 3.548667856861556*^9}, {
  3.841218216038814*^9, 
  3.841218221673988*^9}},ExpressionUUID->"67d5e350-62bf-4bcb-bdb8-\
5f62ed7ef90a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "iP", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{"iP", "=", 
    RowBox[{"injectGenerationProbabilities", "[", 
     RowBox[{"P", ",", "equiProbabilities"}], "]"}]}], ")"}], ";"}]}], "Input",
 CellChangeTimes->{{3.540731627075488*^9, 3.540731694525233*^9}, {
   3.5407320650482807`*^9, 3.540732066192395*^9}, {3.540732213927168*^9, 
   3.54073221955873*^9}, {3.540901767436321*^9, 3.540901769499083*^9}, {
   3.540901832338356*^9, 3.540901844090301*^9}, {3.540901888605576*^9, 
   3.5409018912359977`*^9}, {3.548584660333467*^9, 3.548584665705627*^9}, {
   3.548672342663893*^9, 3.548672348048432*^9}, {3.548672933237944*^9, 
   3.5486729693035507`*^9}, {3.548673411933809*^9, 3.548673427081324*^9}, 
   3.623816690302316*^9},
 CellLabel->
  "In[577]:=",ExpressionUUID->"c828d464-32a0-4b83-9f75-ed11ac10b60b"],

Cell[TextData[{
 "Examine them (",
 StyleBox["DownValues",
  FontSlant->"Italic"],
 " doesn\[CloseCurlyQuote]t Evaluate its arguments by default, so we must)."
}], "Text",
 CellChangeTimes->{{3.8412150129946537`*^9, 3.841215026839218*^9}, {
  3.841215147449106*^9, 3.841215181565181*^9}, {3.841216380535676*^9, 
  3.841216391048981*^9}, {3.841400869736867*^9, 
  3.84140087102988*^9}},ExpressionUUID->"579dfdf7-0350-4bbb-8874-\
e4fe9b2fa30e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TableForm", "/@", 
  RowBox[{"DownValues", "[", 
   RowBox[{"Evaluate", "[", "iP", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.841214919810514*^9, 3.841214989657213*^9}, {
  3.841216324022897*^9, 3.8412163384302607`*^9}},
 CellLabel->
  "In[579]:=",ExpressionUUID->"6865ac32-f370-4948-b971-2c73834aba59"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{
     RowBox[{"HoldPattern", "[", 
      RowBox[{"newTable$4744", "[", "Binary", "]"}], "]"}], "\[RuleDelayed]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\<\"probability\"\>", "\[Rule]", "0.25`"}], ",", 
         RowBox[{"\<\"alternative\"\>", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\<\"C\"\>", ",", "WFF", ",", "WFF"}], "}"}]}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\<\"probability\"\>", "\[Rule]", "0.25`"}], ",", 
         RowBox[{"\<\"alternative\"\>", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\<\"A\"\>", ",", "WFF", ",", "WFF"}], "}"}]}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\<\"probability\"\>", "\[Rule]", "0.25`"}], ",", 
         RowBox[{"\<\"alternative\"\>", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\<\"K\"\>", ",", "WFF", ",", "WFF"}], "}"}]}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\<\"probability\"\>", "\[Rule]", "0.25`"}], ",", 
         RowBox[{"\<\"alternative\"\>", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\<\"E\"\>", ",", "WFF", ",", "WFF"}], "}"}]}]}], "}"}]}], 
      "}"}]}],
    Function[BoxForm`e$, 
     TableForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{
     RowBox[{"HoldPattern", "[", 
      RowBox[{"newTable$4744", "[", "Proposition", "]"}], "]"}], 
     "\[RuleDelayed]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\<\"probability\"\>", "\[Rule]", "0.25`"}], ",", 
         RowBox[{"\<\"alternative\"\>", "\[Rule]", 
          RowBox[{"{", "\<\"p\"\>", "}"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\<\"probability\"\>", "\[Rule]", "0.25`"}], ",", 
         RowBox[{"\<\"alternative\"\>", "\[Rule]", 
          RowBox[{"{", "\<\"q\"\>", "}"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\<\"probability\"\>", "\[Rule]", "0.25`"}], ",", 
         RowBox[{"\<\"alternative\"\>", "\[Rule]", 
          RowBox[{"{", "\<\"r\"\>", "}"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\<\"probability\"\>", "\[Rule]", "0.25`"}], ",", 
         RowBox[{"\<\"alternative\"\>", "\[Rule]", 
          RowBox[{"{", "\<\"s\"\>", "}"}]}]}], "}"}]}], "}"}]}],
    Function[BoxForm`e$, 
     TableForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{
     RowBox[{"HoldPattern", "[", 
      RowBox[{"newTable$4744", "[", "Start", "]"}], "]"}], "\[RuleDelayed]", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\<\"probability\"\>", "\[Rule]", "1.`"}], ",", 
        RowBox[{"\<\"alternative\"\>", "\[Rule]", 
         RowBox[{"{", "WFF", "}"}]}]}], "}"}], "}"}]}],
    Function[BoxForm`e$, 
     TableForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{
     RowBox[{"HoldPattern", "[", 
      RowBox[{"newTable$4744", "[", "Unary", "]"}], "]"}], "\[RuleDelayed]", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\<\"probability\"\>", "\[Rule]", "1.`"}], ",", 
        RowBox[{"\<\"alternative\"\>", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\<\"N\"\>", ",", "WFF"}], "}"}]}]}], "}"}], "}"}]}],
    Function[BoxForm`e$, 
     TableForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{
     RowBox[{"HoldPattern", "[", 
      RowBox[{"newTable$4744", "[", "WFF", "]"}], "]"}], "\[RuleDelayed]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\<\"probability\"\>", "\[Rule]", "0.3333333333333333`"}], 
         ",", 
         RowBox[{"\<\"alternative\"\>", "\[Rule]", 
          RowBox[{"{", "Proposition", "}"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\<\"probability\"\>", "\[Rule]", "0.3333333333333333`"}], 
         ",", 
         RowBox[{"\<\"alternative\"\>", "\[Rule]", 
          RowBox[{"{", "Unary", "}"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\<\"probability\"\>", "\[Rule]", "0.3333333333333333`"}], 
         ",", 
         RowBox[{"\<\"alternative\"\>", "\[Rule]", 
          RowBox[{"{", "Binary", "}"}]}]}], "}"}]}], "}"}]}],
    Function[BoxForm`e$, 
     TableForm[BoxForm`e$]]]}], "}"}]], "Output",
 CellChangeTimes->{3.9126017055980177`*^9, 3.91505087082398*^9, 
  3.915535456728817*^9},
 CellLabel->
  "Out[579]=",ExpressionUUID->"e1ce4b51-7e8d-439a-9eb2-49808e67e586"]
}, Open  ]],

Cell[TextData[{
 "Something more pretty to look at? In here, \
\[OpenCurlyDoubleQuote]probability\[CloseCurlyDoubleQuote] and \
\[OpenCurlyDoubleQuote]alternative\[CloseCurlyDoubleQuote] are strings as \
keys in lookup tables. They\[CloseCurlyQuote]re not terminals in the grammar \
because they\[CloseCurlyQuote]re inside orange boxes, where keys always go in \
",
 StyleBox["gridRules",
  FontSlant->"Italic"],
 "."
}], "Text",
 CellChangeTimes->{{3.841218863696916*^9, 3.841218874566896*^9}, {
  3.841254954864398*^9, 3.8412550283356233`*^9}, {3.841400891742531*^9, 
  3.841400901132495*^9}, {3.915051936158174*^9, 3.91505193762487*^9}, {
  3.915051970892958*^9, 
  3.915051994995208*^9}},ExpressionUUID->"a2400838-dc2c-4e8e-a744-\
701512898d56"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"d", "=", 
      RowBox[{"DownValues", "[", 
       RowBox[{"Evaluate", "[", "iP", "]"}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Zip", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Function", "[", 
        RowBox[{"hp", ",", 
         RowBox[{"hp", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}]}], "]"}], "/@", 
       RowBox[{"Unevaluated", "/@", "d"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Function", "[", 
        RowBox[{"hp", ",", 
         RowBox[{"hp", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "]"}], "/@", "d"}], ",", 
      "Rule"}], "]"}]}], "]"}], "//", 
  StyleBox["gridRules",
   Background->RGBColor[1, 0.85, 0.85]]}]], "Input",
 CellChangeTimes->{{3.8412188771139183`*^9, 3.841218897723927*^9}, {
  3.841218936463955*^9, 3.841219234048889*^9}, {3.841219280021266*^9, 
  3.8412194120158463`*^9}, {3.841219473840257*^9, 3.841219549017197*^9}, {
  3.841219627146553*^9, 3.841219662074101*^9}},
 CellLabel->
  "In[580]:=",ExpressionUUID->"999cd3d7-dfcb-453d-b675-edfac083d4ac"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[GridBox[{
        {
         StyleBox[
          StyleBox[
           TagBox[GridBox[{
              {"Binary"}
             },
             AutoDelete->False,
             GridBoxAlignment->{"Columns" -> {{Left}}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
            "Grid"],
           StripOnInput->False,
           FontWeight->Bold],
          StripOnInput->False,
          LineColor->GrayLevel[0],
          FrontFaceColor->GrayLevel[0],
          BackFaceColor->GrayLevel[0],
          GraphicsColor->GrayLevel[0],
          FontWeight->Bold,
          FontColor->GrayLevel[0]], 
         StyleBox[
          TagBox[GridBox[{
             {
              TagBox[GridBox[{
                 {
                  TagBox[GridBox[{
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"probability\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"0.25`"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]},
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"alternative\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    TagBox[GridBox[{
                    {
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"C\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]]},
                    {
                    StyleBox[
                    TagBox[GridBox[{
                    {"WFF"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold]},
                    {
                    StyleBox[
                    TagBox[GridBox[{
                    {"WFF"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 
                    Rational[2, 3], 0],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 0, 1],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[1, 1, 0.85]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                   "Grid"]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]},
             {
              TagBox[GridBox[{
                 {
                  TagBox[GridBox[{
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"probability\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"0.25`"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]},
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"alternative\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    TagBox[GridBox[{
                    {
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"A\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]]},
                    {
                    StyleBox[
                    TagBox[GridBox[{
                    {"WFF"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold]},
                    {
                    StyleBox[
                    TagBox[GridBox[{
                    {"WFF"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 
                    Rational[2, 3], 0],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 0, 1],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[1, 1, 0.85]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                   "Grid"]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]},
             {
              TagBox[GridBox[{
                 {
                  TagBox[GridBox[{
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"probability\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"0.25`"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]},
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"alternative\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    TagBox[GridBox[{
                    {
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"K\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]]},
                    {
                    StyleBox[
                    TagBox[GridBox[{
                    {"WFF"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold]},
                    {
                    StyleBox[
                    TagBox[GridBox[{
                    {"WFF"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 
                    Rational[2, 3], 0],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 0, 1],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[1, 1, 0.85]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                   "Grid"]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]},
             {
              TagBox[GridBox[{
                 {
                  TagBox[GridBox[{
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"probability\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"0.25`"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]},
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"alternative\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    TagBox[GridBox[{
                    {
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"E\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]]},
                    {
                    StyleBox[
                    TagBox[GridBox[{
                    {"WFF"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold]},
                    {
                    StyleBox[
                    TagBox[GridBox[{
                    {"WFF"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 
                    Rational[2, 3], 0],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 0, 1],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[1, 1, 0.85]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                   "Grid"]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]}
            },
            AutoDelete->False,
            FrameStyle->RGBColor[0, 
              Rational[2, 3], 0],
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxBackground->{"Columns" -> {{
                 RGBColor[0.88, 1, 0.88]}}},
            GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
           "Grid"],
          StripOnInput->False,
          LineColor->RGBColor[0, 0, 1],
          FrontFaceColor->RGBColor[0, 0, 1],
          BackFaceColor->RGBColor[0, 0, 1],
          GraphicsColor->RGBColor[0, 0, 1],
          FontWeight->Bold,
          FontColor->RGBColor[0, 0, 1]]},
        {
         StyleBox[
          StyleBox[
           TagBox[GridBox[{
              {"Proposition"}
             },
             AutoDelete->False,
             GridBoxAlignment->{"Columns" -> {{Left}}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
            "Grid"],
           StripOnInput->False,
           FontWeight->Bold],
          StripOnInput->False,
          LineColor->GrayLevel[0],
          FrontFaceColor->GrayLevel[0],
          BackFaceColor->GrayLevel[0],
          GraphicsColor->GrayLevel[0],
          FontWeight->Bold,
          FontColor->GrayLevel[0]], 
         StyleBox[
          TagBox[GridBox[{
             {
              TagBox[GridBox[{
                 {
                  TagBox[GridBox[{
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"probability\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"0.25`"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]},
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"alternative\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    TagBox[GridBox[{
                    {
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"p\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 
                    Rational[2, 3], 0],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 0, 1],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[1, 1, 0.85]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                   "Grid"]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]},
             {
              TagBox[GridBox[{
                 {
                  TagBox[GridBox[{
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"probability\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"0.25`"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]},
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"alternative\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    TagBox[GridBox[{
                    {
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"q\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 
                    Rational[2, 3], 0],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 0, 1],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[1, 1, 0.85]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                   "Grid"]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]},
             {
              TagBox[GridBox[{
                 {
                  TagBox[GridBox[{
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"probability\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"0.25`"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]},
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"alternative\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    TagBox[GridBox[{
                    {
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"r\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 
                    Rational[2, 3], 0],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 0, 1],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[1, 1, 0.85]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                   "Grid"]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]},
             {
              TagBox[GridBox[{
                 {
                  TagBox[GridBox[{
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"probability\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"0.25`"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]},
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"alternative\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    TagBox[GridBox[{
                    {
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"s\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 
                    Rational[2, 3], 0],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 0, 1],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[1, 1, 0.85]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                   "Grid"]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]}
            },
            AutoDelete->False,
            FrameStyle->RGBColor[0, 
              Rational[2, 3], 0],
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxBackground->{"Columns" -> {{
                 RGBColor[0.88, 1, 0.88]}}},
            GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
           "Grid"],
          StripOnInput->False,
          LineColor->RGBColor[0, 0, 1],
          FrontFaceColor->RGBColor[0, 0, 1],
          BackFaceColor->RGBColor[0, 0, 1],
          GraphicsColor->RGBColor[0, 0, 1],
          FontWeight->Bold,
          FontColor->RGBColor[0, 0, 1]]},
        {
         StyleBox[
          StyleBox[
           TagBox[GridBox[{
              {"Start"}
             },
             AutoDelete->False,
             GridBoxAlignment->{"Columns" -> {{Left}}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
            "Grid"],
           StripOnInput->False,
           FontWeight->Bold],
          StripOnInput->False,
          LineColor->GrayLevel[0],
          FrontFaceColor->GrayLevel[0],
          BackFaceColor->GrayLevel[0],
          GraphicsColor->GrayLevel[0],
          FontWeight->Bold,
          FontColor->GrayLevel[0]], 
         StyleBox[
          TagBox[GridBox[{
             {
              TagBox[GridBox[{
                 {
                  TagBox[GridBox[{
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"probability\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"1.`"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]},
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"alternative\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    TagBox[GridBox[{
                    {
                    StyleBox[
                    TagBox[GridBox[{
                    {"WFF"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 
                    Rational[2, 3], 0],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 0, 1],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[1, 1, 0.85]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                   "Grid"]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]}
            },
            AutoDelete->False,
            FrameStyle->RGBColor[0, 
              Rational[2, 3], 0],
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxBackground->{"Columns" -> {{
                 RGBColor[0.88, 1, 0.88]}}},
            GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
           "Grid"],
          StripOnInput->False,
          LineColor->RGBColor[0, 0, 1],
          FrontFaceColor->RGBColor[0, 0, 1],
          BackFaceColor->RGBColor[0, 0, 1],
          GraphicsColor->RGBColor[0, 0, 1],
          FontWeight->Bold,
          FontColor->RGBColor[0, 0, 1]]},
        {
         StyleBox[
          StyleBox[
           TagBox[GridBox[{
              {"Unary"}
             },
             AutoDelete->False,
             GridBoxAlignment->{"Columns" -> {{Left}}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
            "Grid"],
           StripOnInput->False,
           FontWeight->Bold],
          StripOnInput->False,
          LineColor->GrayLevel[0],
          FrontFaceColor->GrayLevel[0],
          BackFaceColor->GrayLevel[0],
          GraphicsColor->GrayLevel[0],
          FontWeight->Bold,
          FontColor->GrayLevel[0]], 
         StyleBox[
          TagBox[GridBox[{
             {
              TagBox[GridBox[{
                 {
                  TagBox[GridBox[{
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"probability\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"1.`"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]},
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"alternative\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    TagBox[GridBox[{
                    {
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"N\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]]},
                    {
                    StyleBox[
                    TagBox[GridBox[{
                    {"WFF"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 
                    Rational[2, 3], 0],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 0, 1],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[1, 1, 0.85]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                   "Grid"]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]}
            },
            AutoDelete->False,
            FrameStyle->RGBColor[0, 
              Rational[2, 3], 0],
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxBackground->{"Columns" -> {{
                 RGBColor[0.88, 1, 0.88]}}},
            GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
           "Grid"],
          StripOnInput->False,
          LineColor->RGBColor[0, 0, 1],
          FrontFaceColor->RGBColor[0, 0, 1],
          BackFaceColor->RGBColor[0, 0, 1],
          GraphicsColor->RGBColor[0, 0, 1],
          FontWeight->Bold,
          FontColor->RGBColor[0, 0, 1]]},
        {
         StyleBox[
          StyleBox[
           TagBox[GridBox[{
              {"WFF"}
             },
             AutoDelete->False,
             GridBoxAlignment->{"Columns" -> {{Left}}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
            "Grid"],
           StripOnInput->False,
           FontWeight->Bold],
          StripOnInput->False,
          LineColor->GrayLevel[0],
          FrontFaceColor->GrayLevel[0],
          BackFaceColor->GrayLevel[0],
          GraphicsColor->GrayLevel[0],
          FontWeight->Bold,
          FontColor->GrayLevel[0]], 
         StyleBox[
          TagBox[GridBox[{
             {
              TagBox[GridBox[{
                 {
                  TagBox[GridBox[{
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"probability\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"0.3333333333333333`"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]},
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"alternative\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    TagBox[GridBox[{
                    {
                    StyleBox[
                    TagBox[GridBox[{
                    {"Proposition"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 
                    Rational[2, 3], 0],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 0, 1],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[1, 1, 0.85]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                   "Grid"]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]},
             {
              TagBox[GridBox[{
                 {
                  TagBox[GridBox[{
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"probability\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"0.3333333333333333`"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]},
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"alternative\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    TagBox[GridBox[{
                    {
                    StyleBox[
                    TagBox[GridBox[{
                    {"Unary"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 
                    Rational[2, 3], 0],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 0, 1],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[1, 1, 0.85]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                   "Grid"]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]},
             {
              TagBox[GridBox[{
                 {
                  TagBox[GridBox[{
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"probability\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"0.3333333333333333`"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]},
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"alternative\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    TagBox[GridBox[{
                    {
                    StyleBox[
                    TagBox[GridBox[{
                    {"Binary"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 
                    Rational[2, 3], 0],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 0, 1],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[1, 1, 0.85]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                   "Grid"]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]}
            },
            AutoDelete->False,
            FrameStyle->RGBColor[0, 
              Rational[2, 3], 0],
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxBackground->{"Columns" -> {{
                 RGBColor[0.88, 1, 0.88]}}},
            GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
           "Grid"],
          StripOnInput->False,
          LineColor->RGBColor[0, 0, 1],
          FrontFaceColor->RGBColor[0, 0, 1],
          BackFaceColor->RGBColor[0, 0, 1],
          GraphicsColor->RGBColor[0, 0, 1],
          FontWeight->Bold,
          FontColor->RGBColor[0, 0, 1]]}
       },
       AutoDelete->False,
       FrameStyle->RGBColor[0, 0, 1],
       GridBoxAlignment->{"Columns" -> {{Left}}},
       GridBoxBackground->{"Columns" -> {
           RGBColor[1, 0.9, 0.8], {
            RGBColor[1, 1, 0.85]}}},
       GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"]}
   },
   AutoDelete->False,
   FrameStyle->RGBColor[0, 
     Rational[2, 3], 0],
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxBackground->{"Columns" -> {{
        RGBColor[0.88, 1, 0.88]}}},
   GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{3.912601705632846*^9, 3.915050870849215*^9, 
  3.9155354567522907`*^9},
 CellLabel->
  "Out[580]=",ExpressionUUID->"a5d3e86b-cf20-4ac7-a819-73d813bd81f7"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Choose From Alternatives", "Subsection",
 CellChangeTimes->{{3.548667384118556*^9, 
  3.548667389406556*^9}},ExpressionUUID->"0054a0ba-857f-47c4-910f-\
7bec8952e275"],

Cell["\<\
A function from probabilized alternatives to a particular choice, given an \
input die roll.\
\>", "Text",
 CellChangeTimes->{{3.841215273012089*^9, 
  3.8412152991513433`*^9}},ExpressionUUID->"4416d463-87e5-4652-98ad-\
5a9157c19230"],

Cell[CellGroupData[{

Cell["Case: One Alternative", "Subsubsection",
 CellChangeTimes->{{3.9150520252256923`*^9, 
  3.9150520321968327`*^9}},ExpressionUUID->"4d4352e8-9f58-4287-8ffd-\
9aa3140dad03"],

Cell[TextData[{
 "If there is only one alternative (no ",
 StyleBox["rest___", "Input"],
 " in the pattern), choose that alternative. Access the key \
\[OpenCurlyDoubleQuote]alternative\[CloseCurlyDoubleQuote] in the lookup \
table by applying the rules via ",
 StyleBox["/.", "Input"],
 ", ",
 StyleBox["ReplaceAll", "Input"],
 ". "
}], "Text",
 CellChangeTimes->{{3.540731846004379*^9, 3.5407318686456447`*^9}, {
   3.5407319701157885`*^9, 3.5407320037881556`*^9}, {3.54073225365714*^9, 
   3.5407323097957535`*^9}, {3.540732343238097*^9, 3.540732443202093*^9}, {
   3.540732559608732*^9, 3.54073266473202*^9}, {3.540732893483841*^9, 
   3.5407329047638407`*^9}, {3.540733964959843*^9, 3.540733985286843*^9}, {
   3.5407340565318446`*^9, 3.540734066138843*^9}, {3.540734290543843*^9, 
   3.540734336733843*^9}, {3.540734369027843*^9, 3.540734394818843*^9}, {
   3.5407351740588427`*^9, 3.5407351755068426`*^9}, {3.540743560045554*^9, 
   3.540743566685218*^9}, {3.5408223913605576`*^9, 3.540822459032324*^9}, {
   3.540822651246354*^9, 3.540822668157356*^9}, {3.540822955918354*^9, 
   3.5408229858883543`*^9}, {3.540823034727354*^9, 3.540823080483668*^9}, {
   3.540823430256641*^9, 3.540823433223938*^9}, {3.54082347354597*^9, 
   3.5408235701316276`*^9}, {3.540824100732349*^9, 3.540824125582349*^9}, {
   3.540824160958349*^9, 3.5408242890883493`*^9}, {3.540824367965349*^9, 
   3.540824468178349*^9}, {3.540824577100349*^9, 3.540824580431349*^9}, 
   3.5408246391213493`*^9, {3.540824705083349*^9, 3.54082471460235*^9}, {
   3.540824748672349*^9, 3.540824787528349*^9}, {3.540825034369349*^9, 
   3.540825065082349*^9}, {3.540825107920349*^9, 3.540825152086696*^9}, {
   3.5408252115185795`*^9, 3.540825274660206*^9}, {3.5408253096261973`*^9, 
   3.5408254328270893`*^9}, {3.5408254755263586`*^9, 
   3.5408255272375298`*^9}, {3.540825589667772*^9, 3.540825597138519*^9}, {
   3.540825652575062*^9, 3.540825711689973*^9}, {3.540825769795783*^9, 
   3.540825947821584*^9}, {3.5408259969004908`*^9, 3.540826030185819*^9}, {
   3.5408261748574004`*^9, 3.540826199469939*^9}, {3.5408262549393916`*^9, 
   3.540826306508234*^9}, {3.540826514962345*^9, 3.540826520382345*^9}, {
   3.540829215052338*^9, 3.540829232204338*^9}, {3.540901940818661*^9, 
   3.5409019515115237`*^9}, {3.548584683161171*^9, 3.548584691723443*^9}, {
   3.5485934460698795`*^9, 3.54859351142888*^9}, {3.548665778807492*^9, 
   3.5486657966045084`*^9}, {3.84125505084779*^9, 3.841255153930736*^9}, {
   3.841319816422351*^9, 3.8413198186302*^9}, {3.912545981419057*^9, 
   3.912546001155686*^9}, {3.912599201842935*^9, 
   3.912599277168404*^9}},ExpressionUUID->"b3186b13-6ab5-417c-8eab-\
99ebcdbdf7c3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "chooseFromAlternatives", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"chooseFromAlternatives", "[", 
    RowBox[{
     RowBox[{"{", "probabilizedAlternative_", "}"}], ",", "dieRoll_"}], "]"}],
    ":=", 
   RowBox[{"\"\<alternative\>\"", "/.", "probabilizedAlternative"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.540731846004379*^9, 3.5407318686456447`*^9}, {
   3.5407319701157885`*^9, 3.5407320037881556`*^9}, {3.54073225365714*^9, 
   3.5407323097957535`*^9}, {3.540732343238097*^9, 3.540732443202093*^9}, {
   3.540732559608732*^9, 3.54073266473202*^9}, {3.540732893483841*^9, 
   3.5407329047638407`*^9}, {3.540733964959843*^9, 3.540733985286843*^9}, {
   3.5407340565318446`*^9, 3.540734066138843*^9}, {3.540734290543843*^9, 
   3.540734336733843*^9}, {3.540734369027843*^9, 3.540734394818843*^9}, {
   3.5407351740588427`*^9, 3.5407351755068426`*^9}, {3.540743560045554*^9, 
   3.540743566685218*^9}, {3.5408223913605576`*^9, 3.540822459032324*^9}, {
   3.540822651246354*^9, 3.540822668157356*^9}, {3.540822955918354*^9, 
   3.5408229858883543`*^9}, {3.540823034727354*^9, 3.540823080483668*^9}, {
   3.540823430256641*^9, 3.540823433223938*^9}, {3.54082347354597*^9, 
   3.5408235701316276`*^9}, {3.540824100732349*^9, 3.540824125582349*^9}, {
   3.540824160958349*^9, 3.5408242890883493`*^9}, {3.540824367965349*^9, 
   3.540824468178349*^9}, {3.540824577100349*^9, 3.540824580431349*^9}, 
   3.5408246391213493`*^9, {3.540824705083349*^9, 3.54082471460235*^9}, {
   3.540824748672349*^9, 3.540824787528349*^9}, {3.540825034369349*^9, 
   3.540825065082349*^9}, {3.540825107920349*^9, 3.540825152086696*^9}, {
   3.5408252115185795`*^9, 3.540825274660206*^9}, {3.5408253096261973`*^9, 
   3.5408254328270893`*^9}, {3.5408254755263586`*^9, 
   3.5408255272375298`*^9}, {3.540825589667772*^9, 3.540825597138519*^9}, {
   3.540825652575062*^9, 3.540825711689973*^9}, {3.540825769795783*^9, 
   3.540825947821584*^9}, {3.5408259969004908`*^9, 3.540826030185819*^9}, {
   3.5408261748574004`*^9, 3.540826199469939*^9}, {3.5408262549393916`*^9, 
   3.540826306508234*^9}, {3.540826514962345*^9, 3.540826520382345*^9}, {
   3.540829215052338*^9, 3.540829232204338*^9}, {3.540901940818661*^9, 
   3.5409019515115237`*^9}, {3.548584683161171*^9, 3.548584691723443*^9}, {
   3.5485934460698795`*^9, 3.54859351142888*^9}, {3.548665778807492*^9, 
   3.548665782930726*^9}, {3.548673718855544*^9, 3.548673720030427*^9}, {
   3.5486741209475255`*^9, 3.5486741550105257`*^9}, {3.548675234702267*^9, 
   3.548675236022399*^9}, {3.841400944334983*^9, 3.841400945551803*^9}},
 CellLabel->
  "In[581]:=",ExpressionUUID->"f5707359-66ac-4c45-9776-e8ddc176aeb5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Case: Many Alternatives", "Subsubsection",
 CellChangeTimes->{{3.915052076082794*^9, 3.915052086196197*^9}, {
  3.915052168057877*^9, 
  3.915052173093074*^9}},ExpressionUUID->"7d8ab04d-3362-49e1-af5e-\
c9d90f88bbc3"],

Cell["\<\
If there are many alternatives, pick the first whose cumulative probability \
is greater than or equal to the dieRoll. Track the cumulative probability by \
decrementing the dieRoll by each probability while recursing down the \
alternatives. \
\>", "Text",
 CellChangeTimes->{{3.540731846004379*^9, 3.5407318686456447`*^9}, {
   3.5407319701157885`*^9, 3.5407320037881556`*^9}, {3.54073225365714*^9, 
   3.5407323097957535`*^9}, {3.540732343238097*^9, 3.540732443202093*^9}, {
   3.540732559608732*^9, 3.54073266473202*^9}, {3.540732893483841*^9, 
   3.5407329047638407`*^9}, {3.540733964959843*^9, 3.540733985286843*^9}, {
   3.5407340565318446`*^9, 3.540734066138843*^9}, {3.540734290543843*^9, 
   3.540734336733843*^9}, {3.540734369027843*^9, 3.540734394818843*^9}, {
   3.5407351740588427`*^9, 3.5407351755068426`*^9}, {3.540743560045554*^9, 
   3.540743566685218*^9}, {3.5408223913605576`*^9, 3.540822459032324*^9}, {
   3.540822651246354*^9, 3.540822668157356*^9}, {3.540822955918354*^9, 
   3.5408229858883543`*^9}, {3.540823034727354*^9, 3.540823080483668*^9}, {
   3.540823430256641*^9, 3.540823433223938*^9}, {3.54082347354597*^9, 
   3.5408235701316276`*^9}, {3.540824100732349*^9, 3.540824125582349*^9}, {
   3.540824160958349*^9, 3.5408242890883493`*^9}, {3.540824367965349*^9, 
   3.540824468178349*^9}, {3.540824577100349*^9, 3.540824580431349*^9}, 
   3.5408246391213493`*^9, {3.540824705083349*^9, 3.54082471460235*^9}, {
   3.540824748672349*^9, 3.540824787528349*^9}, {3.540825034369349*^9, 
   3.540825065082349*^9}, {3.540825107920349*^9, 3.540825152086696*^9}, {
   3.5408252115185795`*^9, 3.540825274660206*^9}, {3.5408253096261973`*^9, 
   3.5408254328270893`*^9}, {3.5408254755263586`*^9, 
   3.5408255272375298`*^9}, {3.540825589667772*^9, 3.540825597138519*^9}, {
   3.540825652575062*^9, 3.540825711689973*^9}, {3.540825769795783*^9, 
   3.540825947821584*^9}, {3.5408259969004908`*^9, 3.540826030185819*^9}, {
   3.5408261748574004`*^9, 3.540826199469939*^9}, {3.5408262549393916`*^9, 
   3.540826306508234*^9}, {3.540826514962345*^9, 3.540826520382345*^9}, {
   3.540829215052338*^9, 3.540829232204338*^9}, {3.540901940818661*^9, 
   3.5409019515115237`*^9}, {3.548584683161171*^9, 3.548584691723443*^9}, {
   3.5485934460698795`*^9, 3.54859351142888*^9}, {3.548665778807492*^9, 
   3.5486658109133267`*^9}, {3.548676544531521*^9, 3.548676605813577*^9}, {
   3.623816730863425*^9, 3.623816743518765*^9}, {3.841255175192001*^9, 
   3.841255175922277*^9}, {3.841319836966234*^9, 3.841319902969861*^9}, 
   3.912546017555602*^9, {3.912599282775253*^9, 3.91259928518859*^9}, {
   3.915052228892404*^9, 
   3.915052242900145*^9}},ExpressionUUID->"28756831-3542-40d1-aa60-\
483c3a4cd0bd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    StyleBox["chooseFromAlternatives",
     Background->RGBColor[1, 1, 0]], "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"probabilizedAlternative_", ",", "rest___"}], "}"}], ",", 
     "dieRoll_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p", "=", 
       RowBox[{"\"\<probability\>\"", "/.", "probabilizedAlternative"}]}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"dieRoll", "<", "p"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "then", " ", "*)"}], 
       RowBox[{"\"\<alternative\>\"", "/.", "probabilizedAlternative"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "else", " ", "*)"}], 
       RowBox[{
        StyleBox["chooseFromAlternatives",
         Background->RGBColor[1, 1, 0]], "[", 
        RowBox[{
         RowBox[{"{", "rest", "}"}], ",", 
         StyleBox[
          RowBox[{"dieRoll", "-", "p"}],
          Background->RGBColor[0.88, 1, 0.88]]}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    StyleBox["chooseFromAlternatives",
     Background->RGBColor[1, 1, 0]], "[", "badArgs___", "]"}], ":=", 
   RowBox[{"Throw", "[", 
    RowBox[{"{", 
     RowBox[{"\"\<CHOOSE:BADARGS: \>\"", ",", 
      RowBox[{"{", "badArgs", "}"}]}], "}"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.540731846004379*^9, 3.5407318686456447`*^9}, {
   3.5407319701157885`*^9, 3.5407320037881556`*^9}, {3.54073225365714*^9, 
   3.5407323097957535`*^9}, {3.540732343238097*^9, 3.540732443202093*^9}, {
   3.540732559608732*^9, 3.54073266473202*^9}, {3.540732893483841*^9, 
   3.5407329047638407`*^9}, {3.540733964959843*^9, 3.540733985286843*^9}, {
   3.5407340565318446`*^9, 3.540734066138843*^9}, {3.540734290543843*^9, 
   3.540734336733843*^9}, {3.540734369027843*^9, 3.540734394818843*^9}, {
   3.5407351740588427`*^9, 3.5407351755068426`*^9}, {3.540743560045554*^9, 
   3.540743566685218*^9}, {3.5408223913605576`*^9, 3.540822459032324*^9}, {
   3.540822651246354*^9, 3.540822668157356*^9}, {3.540822955918354*^9, 
   3.5408229858883543`*^9}, {3.540823034727354*^9, 3.540823080483668*^9}, {
   3.540823430256641*^9, 3.540823433223938*^9}, {3.54082347354597*^9, 
   3.5408235701316276`*^9}, {3.540824100732349*^9, 3.540824125582349*^9}, {
   3.540824160958349*^9, 3.5408242890883493`*^9}, {3.540824367965349*^9, 
   3.540824468178349*^9}, {3.540824577100349*^9, 3.540824580431349*^9}, 
   3.5408246391213493`*^9, {3.540824705083349*^9, 3.54082471460235*^9}, {
   3.540824748672349*^9, 3.540824787528349*^9}, {3.540825034369349*^9, 
   3.540825065082349*^9}, {3.540825107920349*^9, 3.540825152086696*^9}, {
   3.5408252115185795`*^9, 3.540825274660206*^9}, {3.5408253096261973`*^9, 
   3.5408254328270893`*^9}, {3.5408254755263586`*^9, 
   3.5408255272375298`*^9}, {3.540825589667772*^9, 3.540825597138519*^9}, {
   3.540825652575062*^9, 3.540825711689973*^9}, {3.540825769795783*^9, 
   3.540825947821584*^9}, {3.5408259969004908`*^9, 3.540826030185819*^9}, {
   3.5408261748574004`*^9, 3.540826199469939*^9}, {3.5408262549393916`*^9, 
   3.540826306508234*^9}, {3.540826514962345*^9, 3.540826520382345*^9}, {
   3.540829215052338*^9, 3.540829232204338*^9}, {3.540901940818661*^9, 
   3.5409019515115237`*^9}, {3.548584683161171*^9, 3.548584691723443*^9}, {
   3.5485934460698795`*^9, 3.54859351142888*^9}, {3.548665778807492*^9, 
   3.54866578458182*^9}, {3.548674170323525*^9, 3.5486742081305256`*^9}, {
   3.548674239408525*^9, 3.548674261094526*^9}, {3.5486743360915256`*^9, 
   3.548674381291526*^9}, 3.548674413064525*^9, {3.5486744509265256`*^9, 
   3.5486744521985254`*^9}, {3.548674490164525*^9, 3.548674522301035*^9}, 
   3.548675230824879*^9},
 CellLabel->
  "In[583]:=",ExpressionUUID->"cfc9d35c-953c-4520-bc5c-b43e6dc6c33d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
generateSentences [ probabilizedGrammar, groundTerm, terminalSymbols, \
recursionLimit:100 ]\
\>", "Subsection",
 CellChangeTimes->{{3.540734794874843*^9, 3.5407348192498426`*^9}, {
   3.540735656975609*^9, 3.5407356579747086`*^9}, {3.540835342182508*^9, 
   3.540835370282508*^9}, {3.548668060623556*^9, 3.548668063768556*^9}, {
   3.548674630926896*^9, 3.5486746359984026`*^9}, 
   3.623409227800389*^9},ExpressionUUID->"613354b5-bbd3-4abd-bf80-\
6d92f5128966"],

Cell[TextData[{
 "The ",
 StyleBox["ground term",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 " is the term to force when the recursion limit is exceeded. The default \
recursion limit is 100. 500 is a useful value for this limit, later. "
}], "Text",
 CellChangeTimes->{{3.548674559059709*^9, 3.5486746246942725`*^9}, {
  3.548674663928196*^9, 3.54867466917572*^9}, {3.5486780913291135`*^9, 
  3.548678093070287*^9}, {3.841255242675729*^9, 3.841255257484296*^9}, {
  3.915052265741227*^9, 
  3.915052266372917*^9}},ExpressionUUID->"d7f99f2e-af13-4274-86ee-\
0b648bf64556"],

Cell[CellGroupData[{

Cell["debugPrint: helper", "Subsubsection",
 CellChangeTimes->{{3.5486746451353183`*^9, 3.548674655703373*^9}, {
  3.911290812670608*^9, 3.911290814479515*^9}, {3.9122689312024527`*^9, 
  3.912268932975599*^9}},ExpressionUUID->"77f478ec-bc47-4fd1-a1e1-\
3445e73f9f2c"],

Cell[TextData[{
 "It\[CloseCurlyQuote]s debatable whether to have a symbol like ",
 StyleBox["debugPrint",
  FontSlant->"Italic"],
 " for ",
 StyleBox["Print",
  FontSlant->"Italic"],
 " debugging, or to use ",
 StyleBox["Block[{Print=Identity},...]", "Input"],
 " to switch off printing."
}], "Text",
 CellChangeTimes->{{3.8412202226041594`*^9, 3.841220251071516*^9}, {
  3.841255275512965*^9, 
  3.84125527739074*^9}},ExpressionUUID->"a3d0e713-e4dd-4b67-8e8d-\
973b0e1a98bf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "debugPrint", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"debugPrint", "=", "Identity"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Set", " ", "it", " ", "to", " ", "Print", " ", "when", " ", 
     "debugging"}], ",", " ", 
    RowBox[{"to", " ", "Identity", " ", "when", " ", "not", " ", 
     RowBox[{"debugging", "."}]}]}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.841218254425345*^9, 3.841218280727948*^9}, {
  3.841255916119547*^9, 3.841255919940748*^9}, {3.841256424045286*^9, 
  3.841256436620038*^9}},
 CellLabel->
  "In[585]:=",ExpressionUUID->"7bdb4e0e-503a-42bd-8247-d309af24c67a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["chainExpansion", "Subsubsection",
 CellChangeTimes->{{3.5486746451353183`*^9, 3.548674655703373*^9}, {
  3.9125461588812027`*^9, 
  3.912546160161051*^9}},ExpressionUUID->"88fdf6b6-8885-4a77-b43f-\
6b550f1245a9"],

Cell["\<\
Iterate down the terms, randomly choosing a branch to explore.\
\>", "Text",
 CellChangeTimes->{{3.5486746923540382`*^9, 3.548674701113914*^9}, {
  3.548674904564257*^9, 3.548674924173218*^9}, {3.623816805941064*^9, 
  3.623816817363608*^9}, {3.841404028926012*^9, 
  3.841404032474373*^9}},ExpressionUUID->"ade8db40-6411-4aaa-8533-\
872310a7916b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ClearAll", "[", "chainExpansion", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.540743882890836*^9, 3.5407439815457*^9}, {
   3.5407440339499397`*^9, 3.540744037613306*^9}, {3.540744070270572*^9, 
   3.540744076591204*^9}, {3.5407441081763616`*^9, 3.5407441101455584`*^9}, {
   3.5407441627488184`*^9, 3.5407441661881623`*^9}, {3.5407445010372214`*^9, 
   3.540744626409221*^9}, {3.540744656455221*^9, 3.5407447811192217`*^9}, {
   3.5407448166692214`*^9, 3.540744957847222*^9}, {3.540745036967312*^9, 
   3.540745037382353*^9}, {3.540745237945407*^9, 3.5407452433699493`*^9}, {
   3.5407454681094213`*^9, 3.540745550841694*^9}, {3.540745611764785*^9, 
   3.54074578172822*^9}, {3.54074585762922*^9, 3.54074590916322*^9}, {
   3.54074605385122*^9, 3.54074608543322*^9}, {3.540822038559281*^9, 
   3.54082212495792*^9}, 3.540822378298251*^9, {3.540824799571349*^9, 
   3.540824833473349*^9}, {3.540824864931349*^9, 3.540824943763349*^9}, {
   3.5408265621733446`*^9, 3.540826570603345*^9}, {3.540828917969338*^9, 
   3.5408290426773396`*^9}, {3.540829110002338*^9, 3.54082915893134*^9}, {
   3.540829680303338*^9, 3.540829684037339*^9}, {3.540829723209338*^9, 
   3.540829812362338*^9}, {3.5408299402693386`*^9, 3.540829948524338*^9}, 
   3.540902180886638*^9, {3.540902213097785*^9, 3.540902218338261*^9}, {
   3.548584898452877*^9, 3.548584900150975*^9}, {3.548585429361134*^9, 
   3.5485854303621435`*^9}, {3.548585463554261*^9, 3.5485854655133204`*^9}, {
   3.548585633427575*^9, 3.548585715414331*^9}, {3.548593308223834*^9, 
   3.548593317208732*^9}, {3.54859356618088*^9, 3.54859358461188*^9}, {
   3.548594151288137*^9, 3.548594199319939*^9}, {3.548594322085215*^9, 
   3.548594416077613*^9}, 3.548594446661274*^9, {3.548594489818274*^9, 
   3.548594562389274*^9}, {3.5486040094162254`*^9, 3.548604030985382*^9}, {
   3.5486042065129356`*^9, 3.5486042085881405`*^9}, 3.5486671701860685`*^9, {
   3.548667883546556*^9, 3.548667886882556*^9}, 3.5486746811879215`*^9, {
   3.54867473207601*^9, 3.5486747873035316`*^9}, {3.548674863746176*^9, 
   3.54867486489029*^9}},
 CellLabel->
  "In[587]:=",ExpressionUUID->"5a3b8b5d-1c30-4787-a065-64e756d1f0f5"],

Cell["Case: exhausted the production:", "Text",
 CellChangeTimes->{{3.548674868434644*^9, 3.548674876842485*^9}, {
  3.548675009304729*^9, 
  3.5486750258023796`*^9}},ExpressionUUID->"dc011c32-cbb7-4120-880b-\
e3012322489a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"chainExpansion", "[", 
    RowBox[{"iP_", ",", "groundTerm_", ",", "T_", ",", 
     RowBox[{"production", ":", 
      RowBox[{"{", "}"}]}], ",", "sentence_", ",", "\[IndentingNewLine]", 
     "i_", ",", "iLim_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"debugPrint", "[", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<branch\>\"", "\[Rule]", "\"\<exhausted\>\""}], ",", 
         RowBox[{"\"\<i\>\"", "\[Rule]", "i"}], ",", 
         RowBox[{"\"\<production\>\"", "\[Rule]", "production"}], ",", 
         RowBox[{"\"\<sentence\>\"", "\[Rule]", "sentence"}]}], "|>"}], "]"}],
       ";", "\[IndentingNewLine]", "sentence"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.540743882890836*^9, 3.5407439815457*^9}, {
   3.5407440339499397`*^9, 3.540744037613306*^9}, {3.540744070270572*^9, 
   3.540744076591204*^9}, {3.5407441081763616`*^9, 3.5407441101455584`*^9}, {
   3.5407441627488184`*^9, 3.5407441661881623`*^9}, {3.5407445010372214`*^9, 
   3.540744626409221*^9}, {3.540744656455221*^9, 3.5407447811192217`*^9}, {
   3.5407448166692214`*^9, 3.540744957847222*^9}, {3.540745036967312*^9, 
   3.540745037382353*^9}, {3.540745237945407*^9, 3.5407452433699493`*^9}, {
   3.5407454681094213`*^9, 3.540745550841694*^9}, {3.540745611764785*^9, 
   3.54074578172822*^9}, {3.54074585762922*^9, 3.54074590916322*^9}, {
   3.54074605385122*^9, 3.54074608543322*^9}, {3.540822038559281*^9, 
   3.54082212495792*^9}, 3.540822378298251*^9, {3.540824799571349*^9, 
   3.540824833473349*^9}, {3.540824864931349*^9, 3.540824943763349*^9}, {
   3.5408265621733446`*^9, 3.540826570603345*^9}, {3.540828917969338*^9, 
   3.5408290426773396`*^9}, {3.540829110002338*^9, 3.54082915893134*^9}, {
   3.540829680303338*^9, 3.540829684037339*^9}, {3.540829723209338*^9, 
   3.540829812362338*^9}, {3.5408299402693386`*^9, 3.540829948524338*^9}, 
   3.540902180886638*^9, {3.540902213097785*^9, 3.540902218338261*^9}, {
   3.548584898452877*^9, 3.548584900150975*^9}, {3.548585429361134*^9, 
   3.5485854303621435`*^9}, {3.548585463554261*^9, 3.5485854655133204`*^9}, {
   3.548585633427575*^9, 3.548585715414331*^9}, {3.548593308223834*^9, 
   3.548593317208732*^9}, {3.54859356618088*^9, 3.54859358461188*^9}, {
   3.548594151288137*^9, 3.548594199319939*^9}, {3.548594322085215*^9, 
   3.548594416077613*^9}, 3.548594446661274*^9, {3.548594489818274*^9, 
   3.548594562389274*^9}, {3.5486040094162254`*^9, 3.548604030985382*^9}, {
   3.5486042065129356`*^9, 3.5486042085881405`*^9}, 3.5486671701860685`*^9, {
   3.548667883546556*^9, 3.548667886882556*^9}, 3.5486746811879215`*^9, {
   3.54867473207601*^9, 3.5486747873035316`*^9}, {3.548674863746176*^9, 
   3.54867486489029*^9}, {3.54867512161696*^9, 3.548675122249023*^9}, {
   3.5486769198319755`*^9, 3.5486769210861*^9}, 3.5486770239733887`*^9, {
   3.623409258495041*^9, 3.623409270805382*^9}, {3.841167861234568*^9, 
   3.841167862322069*^9}, {3.841175573773219*^9, 3.841175590926634*^9}, {
   3.841175879274828*^9, 3.841175904088496*^9}, {3.841218285252416*^9, 
   3.84121828595156*^9}, {3.841319973349275*^9, 3.8413199958065243`*^9}, {
   3.841320970501375*^9, 3.841320971507602*^9}, {3.8413210155540648`*^9, 
   3.841321021250476*^9}, 3.841321051653203*^9, {3.841321251976259*^9, 
   3.841321278554192*^9}, 3.841321633161917*^9, {3.841337179626584*^9, 
   3.841337184708152*^9}, 3.841339789744905*^9, {3.841350515160722*^9, 
   3.8413505192905083`*^9}},
 CellLabel->
  "In[588]:=",ExpressionUUID->"09c9a31f-d33c-41ed-b1c9-0ff028a1d006"],

Cell["Case: found a term in the production", "Text",
 CellChangeTimes->{{3.548674883083109*^9, 3.548674901859987*^9}, {
  3.548675028985698*^9, 3.548675043923191*^9}, {3.6238168583424087`*^9, 
  3.623816859330482*^9}, {3.915052306634418*^9, 3.915052326814399*^9}},
 FontWeight->"Bold",ExpressionUUID->"3a3a4cee-fb44-45c2-b794-9e916f47f6b0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     StyleBox["chainExpansion",
      Background->RGBColor[1, 1, 0]], "[", 
     RowBox[{"iP_", ",", "gd_", ",", "T_", ",", "\[IndentingNewLine]", 
      RowBox[{"production", ":", 
       RowBox[{"{", 
        RowBox[{"term_", ",", "rest___"}], "}"}]}], ",", 
      "\[IndentingNewLine]", "sentence_", ",", "i_", ",", "iLim_"}], "]"}], "/;", 
    RowBox[{"(", 
     RowBox[{"i", "<", "iLim"}], ")"}]}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"terminal", " ", "symbol"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"T", ",", "term"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"subtrees", ",", "result"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "handle", " ", "something", " ", "like", " ", 
           "\"\<if Term then Term else Term\>\""}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"subtrees", "=", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"MemberQ", "[", 
                RowBox[{"T", ",", "#"}], "]"}], ",", 
               RowBox[{"{", "#", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                StyleBox["chainExpansion",
                 Background->RGBColor[1, 1, 0]], "[", 
                RowBox[{"iP", ",", "gd", ",", "T", ",", 
                 RowBox[{"{", "#", "}"}], ",", 
                 RowBox[{"{", "}"}], ",", 
                 RowBox[{"i", "+", "1"}], ",", "iLim"}], "]"}]}], "]"}], 
             "&"}], "/@", 
            RowBox[{"{", "rest", "}"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"result", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"sentence", ",", 
             RowBox[{"{", "term", "}"}], ",", 
             RowBox[{"Flatten", "[", 
              RowBox[{"subtrees", ",", "1"}], "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"debugPrint", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<branch\>\"", "\[Rule]", "\"\<term\>\""}], ",", 
             RowBox[{"\"\<i\>\"", "\[Rule]", "i"}], ",", 
             RowBox[{"\"\<prodn\>\"", "\[Rule]", "production"}], ",", 
             RowBox[{"\"\<term\>\"", "\[Rule]", "term"}], ",", 
             RowBox[{"\"\<rest\>\"", "\[Rule]", 
              RowBox[{"{", "rest", "}"}]}], ",", 
             RowBox[{"\"\<sub\>\"", "\[Rule]", "subtrees"}], ",", 
             RowBox[{"\"\<res\>\"", "\[Rule]", "result"}]}], "|>"}], "]"}], 
          ";", "\[IndentingNewLine]", "result"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"non", "-", 
         RowBox[{"terminal", " ", "symbol"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"choice", "=", 
            RowBox[{
             StyleBox["chooseFromAlternatives",
              Background->RGBColor[1, 0.85, 0.85]], "[", 
             RowBox[{
              RowBox[{"iP", "[", "term", "]"}], ",", 
              RowBox[{"RandomReal", "[", "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", "replacement", ",", "result"}], "}"}], ",", 
         " ", 
         RowBox[{
          RowBox[{"replacement", "=", 
           RowBox[{
            StyleBox["chainExpansion",
             Background->RGBColor[1, 1, 0]], "[", 
            RowBox[{"iP", ",", "gd", ",", "T", ",", "choice", ",", 
             RowBox[{"{", "}"}], ",", 
             RowBox[{"i", "+", "1"}], ",", "iLim"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"result", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"sentence", ",", "replacement"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"debugPrint", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<branch\>\"", "\[Rule]", "\"\<nterm\>\""}], ",", 
             RowBox[{"\"\<i\>\"", "\[Rule]", "i"}], ",", 
             RowBox[{"\"\<prodn\>\"", "\[Rule]", "production"}], ",", 
             RowBox[{"\"\<term\>\"", "\[Rule]", "term"}], ",", 
             RowBox[{"\"\<rest\>\"", "\[Rule]", 
              RowBox[{"{", "rest", "}"}]}], ",", 
             RowBox[{"\"\<choice\>\"", "\[Rule]", "choice"}], ",", 
             RowBox[{"\"\<repl\>\"", "\[Rule]", "replacement"}], ",", 
             RowBox[{"\"\<res\>\"", "\[Rule]", "result"}]}], "|>"}], "]"}], 
          ";", "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", 
        "]"}]}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.841176264328454*^9, 3.841176273171339*^9}, {
   3.841176305241989*^9, 3.841176510088317*^9}, {3.8411779102056828`*^9, 
   3.84117791834796*^9}, {3.8411779551116457`*^9, 3.841178143238062*^9}, {
   3.841178209715444*^9, 3.841178344714537*^9}, {3.841178521975874*^9, 
   3.8411785947128277`*^9}, {3.841178639533242*^9, 3.841178643979718*^9}, {
   3.8411786875391*^9, 3.841178697071862*^9}, {3.8412182910574017`*^9, 
   3.841218297150985*^9}, {3.841218338778349*^9, 3.841218345328695*^9}, {
   3.8412183977694407`*^9, 3.841218407071632*^9}, {3.841255324303321*^9, 
   3.8412553621899147`*^9}, 3.841320027032838*^9, {3.841320063099355*^9, 
   3.841320082972632*^9}, {3.841320674179637*^9, 3.8413207051134653`*^9}, {
   3.841320767461033*^9, 3.841320769831496*^9}, {3.841320851351839*^9, 
   3.84132090270226*^9}, 3.841320945325808*^9, {3.841321088744818*^9, 
   3.841321089762931*^9}, 3.841321131951105*^9, {3.841321218943896*^9, 
   3.841321241654186*^9}, {3.84132164453323*^9, 3.841321683281463*^9}, 
   3.841335026582237*^9, {3.841335742524428*^9, 3.841335743214775*^9}, {
   3.841336288974803*^9, 3.841336356388628*^9}, {3.841336393414267*^9, 
   3.841336417082097*^9}, {3.84133646575968*^9, 3.8413364711410646`*^9}, {
   3.841336508335896*^9, 3.841336532018125*^9}, {3.841336565545449*^9, 
   3.841336580884849*^9}, {3.84133673701497*^9, 3.8413370084459357`*^9}, {
   3.841337058164521*^9, 3.841337058237864*^9}, {3.841337193344139*^9, 
   3.841337202206134*^9}, {3.841337396331944*^9, 3.84133740878541*^9}, {
   3.841337502672978*^9, 3.841337531710102*^9}, {3.841337562084399*^9, 
   3.841337593856257*^9}, {3.841337668002029*^9, 3.841337680632954*^9}, {
   3.841337713011259*^9, 3.841337823853856*^9}, {3.841337854854043*^9, 
   3.841337859532714*^9}, {3.841337917905477*^9, 3.84133797963255*^9}, {
   3.841338028396767*^9, 3.841338151579906*^9}, {3.841338193871572*^9, 
   3.8413382329258957`*^9}, {3.841338293580323*^9, 3.841338306256666*^9}, {
   3.841338344486017*^9, 3.841338370339818*^9}, 3.841338449381003*^9, {
   3.841338566648833*^9, 3.841338572656899*^9}, {3.841338642340341*^9, 
   3.8413386449057913`*^9}, {3.841338677332927*^9, 3.841338684401613*^9}, {
   3.841338716517643*^9, 3.841338717699044*^9}, {3.841338960258355*^9, 
   3.841338961449428*^9}, {3.8413389924202547`*^9, 3.841338993504328*^9}, {
   3.841339120285305*^9, 3.8413391214744673`*^9}, 3.841339286387097*^9, {
   3.841339334068489*^9, 3.841339439657683*^9}, {3.841339469783032*^9, 
   3.841339539253917*^9}, {3.84133959188839*^9, 3.841339666076672*^9}, {
   3.841339696796421*^9, 3.841339698197984*^9}, {3.841339849610125*^9, 
   3.841339869573475*^9}, {3.841339977490213*^9, 3.8413399896692038`*^9}, {
   3.8413400390364943`*^9, 3.8413400972887077`*^9}, {3.841340221878573*^9, 
   3.841340224021961*^9}, {3.841340434486306*^9, 3.8413404367265787`*^9}, {
   3.8413405179443617`*^9, 3.841340519888699*^9}, {3.841340674759364*^9, 
   3.841340678496753*^9}, {3.841340996362259*^9, 3.841340999501748*^9}, {
   3.841341063028633*^9, 3.84134107125673*^9}, {3.841341113935085*^9, 
   3.841341115053*^9}, {3.841341447502436*^9, 3.8413414645819397`*^9}, {
   3.841341598681039*^9, 3.841341690299048*^9}, {3.841350534516512*^9, 
   3.841350548841456*^9}, {3.841350895259501*^9, 3.8413511103468733`*^9}, {
   3.841351354720818*^9, 3.8413513862221622`*^9}, {3.8413515505842857`*^9, 
   3.841351551709965*^9}, 3.841351807659697*^9, {3.841351897394552*^9, 
   3.84135192985179*^9}, {3.8414036213849163`*^9, 3.8414036239014397`*^9}, 
   3.841403987382889*^9},
 CellLabel->
  "In[589]:=",ExpressionUUID->"f2aaf48e-9741-463f-97cc-829ea378b918"],

Cell["Case: exceeded the recursion limit", "Text",
 CellChangeTimes->{{3.540743882890836*^9, 3.5407439815457*^9}, {
   3.5407440339499397`*^9, 3.540744037613306*^9}, {3.540744070270572*^9, 
   3.540744076591204*^9}, {3.5407441081763616`*^9, 3.5407441101455584`*^9}, {
   3.5407441627488184`*^9, 3.5407441661881623`*^9}, {3.5407445010372214`*^9, 
   3.540744626409221*^9}, {3.540744656455221*^9, 3.5407447811192217`*^9}, {
   3.5407448166692214`*^9, 3.540744957847222*^9}, {3.540745036967312*^9, 
   3.540745037382353*^9}, {3.540745237945407*^9, 3.5407452433699493`*^9}, {
   3.5407454681094213`*^9, 3.540745550841694*^9}, {3.540745611764785*^9, 
   3.54074578172822*^9}, {3.54074585762922*^9, 3.54074590916322*^9}, {
   3.54074605385122*^9, 3.54074608543322*^9}, {3.540822038559281*^9, 
   3.54082212495792*^9}, 3.540822378298251*^9, {3.540824799571349*^9, 
   3.540824833473349*^9}, {3.540824864931349*^9, 3.540824943763349*^9}, {
   3.5408265621733446`*^9, 3.540826570603345*^9}, {3.540828917969338*^9, 
   3.5408290426773396`*^9}, {3.540829110002338*^9, 3.54082915893134*^9}, {
   3.540829680303338*^9, 3.540829684037339*^9}, {3.540829723209338*^9, 
   3.540829812362338*^9}, {3.5408299402693386`*^9, 3.540829948524338*^9}, 
   3.540902180886638*^9, {3.540902213097785*^9, 3.540902218338261*^9}, {
   3.548584898452877*^9, 3.548584900150975*^9}, {3.548585429361134*^9, 
   3.5485854303621435`*^9}, {3.548585463554261*^9, 3.5485854655133204`*^9}, {
   3.548585633427575*^9, 3.548585715414331*^9}, {3.548593308223834*^9, 
   3.548593317208732*^9}, {3.54859356618088*^9, 3.54859358461188*^9}, {
   3.548594151288137*^9, 3.548594199319939*^9}, {3.548594322085215*^9, 
   3.548594416077613*^9}, 3.548594446661274*^9, {3.548594489818274*^9, 
   3.548594562389274*^9}, {3.5486040094162254`*^9, 3.548604030985382*^9}, {
   3.5486042065129356`*^9, 3.5486042085881405`*^9}, {3.5486671701860685`*^9, 
   3.5486671719692464`*^9}, {3.548667250300079*^9, 3.5486672855696054`*^9}, {
   3.548667894245556*^9, 3.548667940192556*^9}, {3.548668100764556*^9, 
   3.548668168967556*^9}, {3.548668209365556*^9, 3.548668261385556*^9}, {
   3.548668464301596*^9, 3.5486684755638466`*^9}, {3.548674999896789*^9, 
   3.5486750041862183`*^9}, {3.548675048267626*^9, 3.548675049787778*^9}, 
   3.91505233492241*^9},
 FontWeight->"Bold",ExpressionUUID->"7572c186-9387-4870-bbc8-66e830432a00"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    StyleBox["chainExpansion",
     Background->RGBColor[1, 1, 0]], "[", 
    RowBox[{
    "iP_", ",", "gd_", ",", "T_", ",", "production_", ",", "sentence_", ",", 
     "i_", ",", "iLim_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"choice", "=", 
        RowBox[{
         StyleBox["chooseFromAlternatives",
          Background->RGBColor[1, 0.85, 0.85]], "[", 
         RowBox[{
          RowBox[{"iP", "[", "gd", "]"}], ",", 
          RowBox[{"RandomReal", "[", "]"}]}], "]"}]}], ",", "result"}], "}"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"result", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"sentence", ",", "choice"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"debugPrint", "[", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<branch\>\"", "\[Rule]", "\"\<exceeded\>\""}], ",", 
         RowBox[{"\"\<i\>\"", "\[Rule]", "i"}], ",", 
         RowBox[{"\"\<sen\>\"", "\[Rule]", "sentence"}], ",", 
         RowBox[{"\"\<choice\>\"", "\[Rule]", "choice"}], ",", 
         RowBox[{"\"\<prodn\>\"", "\[Rule]", "production"}], ",", 
         RowBox[{"\"\<res\>\"", "\[Rule]", "result"}]}], "|>"}], "]"}], ";", 
      "\[IndentingNewLine]", "result"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.540743882890836*^9, 3.5407439815457*^9}, {
   3.5407440339499397`*^9, 3.540744037613306*^9}, {3.540744070270572*^9, 
   3.540744076591204*^9}, {3.5407441081763616`*^9, 3.5407441101455584`*^9}, {
   3.5407441627488184`*^9, 3.5407441661881623`*^9}, {3.5407445010372214`*^9, 
   3.540744626409221*^9}, {3.540744656455221*^9, 3.5407447811192217`*^9}, {
   3.5407448166692214`*^9, 3.540744957847222*^9}, {3.540745036967312*^9, 
   3.540745037382353*^9}, {3.540745237945407*^9, 3.5407452433699493`*^9}, {
   3.5407454681094213`*^9, 3.540745550841694*^9}, {3.540745611764785*^9, 
   3.54074578172822*^9}, {3.54074585762922*^9, 3.54074590916322*^9}, {
   3.54074605385122*^9, 3.54074608543322*^9}, {3.540822038559281*^9, 
   3.54082212495792*^9}, 3.540822378298251*^9, {3.540824799571349*^9, 
   3.540824833473349*^9}, {3.540824864931349*^9, 3.540824943763349*^9}, {
   3.5408265621733446`*^9, 3.540826570603345*^9}, {3.540828917969338*^9, 
   3.5408290426773396`*^9}, {3.540829110002338*^9, 3.54082915893134*^9}, {
   3.540829680303338*^9, 3.540829684037339*^9}, {3.540829723209338*^9, 
   3.540829812362338*^9}, {3.5408299402693386`*^9, 3.540829948524338*^9}, 
   3.540902180886638*^9, {3.540902213097785*^9, 3.540902218338261*^9}, {
   3.548584898452877*^9, 3.548584900150975*^9}, {3.548585429361134*^9, 
   3.5485854303621435`*^9}, {3.548585463554261*^9, 3.5485854655133204`*^9}, {
   3.548585633427575*^9, 3.548585715414331*^9}, {3.548593308223834*^9, 
   3.548593317208732*^9}, {3.54859356618088*^9, 3.54859358461188*^9}, {
   3.548594151288137*^9, 3.548594199319939*^9}, {3.548594322085215*^9, 
   3.548594416077613*^9}, 3.548594446661274*^9, {3.548594489818274*^9, 
   3.548594562389274*^9}, {3.5486040094162254`*^9, 3.548604030985382*^9}, {
   3.5486042065129356`*^9, 3.5486042085881405`*^9}, {3.5486671701860685`*^9, 
   3.5486671719692464`*^9}, {3.548667250300079*^9, 3.5486672855696054`*^9}, {
   3.548667894245556*^9, 3.548667940192556*^9}, {3.548668100764556*^9, 
   3.548668168967556*^9}, {3.548668209365556*^9, 3.548668261385556*^9}, {
   3.548668464301596*^9, 3.548668465627861*^9}, {3.548668638372403*^9, 
   3.548668644892707*^9}, {3.548674801033905*^9, 3.548674848300631*^9}, {
   3.5486751318819866`*^9, 3.54867513241804*^9}, 3.5486766936773624`*^9, 
   3.548676939129904*^9, {3.645747875725647*^9, 3.645747887292137*^9}, {
   3.84117554556209*^9, 3.841175564910424*^9}, {3.841175666566979*^9, 
   3.841175666687065*^9}, {3.841218451498085*^9, 3.841218452944287*^9}, {
   3.841220315463463*^9, 3.84122033838*^9}, {3.8412553739523487`*^9, 
   3.841255397157498*^9}, {3.8412570937377768`*^9, 3.8412570981230383`*^9}, 
   3.841320088584989*^9, {3.841320121814685*^9, 3.841320141711036*^9}, {
   3.841320641914757*^9, 3.841320668604266*^9}, 3.841321703652736*^9, 
   3.841324739932773*^9, {3.841324974739161*^9, 3.841324976017132*^9}, 
   3.841337213362024*^9, {3.841350572385562*^9, 3.841350576314876*^9}, {
   3.841350703862301*^9, 3.841350829379089*^9}, {3.84135086393838*^9, 
   3.841350876089671*^9}, 3.841351267677215*^9},
 CellLabel->
  "In[590]:=",ExpressionUUID->"864691ab-c843-4e7e-bb8c-16581c848d66"]
}, Open  ]],

Cell[CellGroupData[{

Cell["generateSentence [ iP, groundTerm, T, recursionLimit ]", "Subsubsection",
 CellChangeTimes->{{3.623816994820166*^9, 
  3.623817028827552*^9}},ExpressionUUID->"c04cef19-7726-4b2a-a30b-\
ff89946c6072"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ClearAll", "[", "generateSentence", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.5407347419098444`*^9, 3.540734793948843*^9}, {
   3.540734864760843*^9, 3.540734942549843*^9}, {3.540734978666843*^9, 
   3.540734986443843*^9}, {3.5407351508038425`*^9, 3.5407351582588425`*^9}, {
   3.5407351960018425`*^9, 3.5407352961008425`*^9}, {3.540735335836161*^9, 
   3.540735338931781*^9}, {3.540735388131619*^9, 3.540735401013194*^9}, {
   3.5407354372834473`*^9, 3.540735562310449*^9}, {3.540735596395263*^9, 
   3.540735613541692*^9}, {3.540735666746585*^9, 3.540735668569768*^9}, 
   3.540735731317042*^9, {3.540735840794989*^9, 3.54073601872378*^9}, 
   3.540736285634468*^9, {3.540743574552005*^9, 3.540743589168466*^9}, 
   3.5407437453290806`*^9, {3.540744969343221*^9, 3.540745047791394*^9}, 
   3.540810011631563*^9, {3.540827133734344*^9, 3.540827212568267*^9}, {
   3.540827247023712*^9, 3.540827249487958*^9}, 3.540829853374338*^9, {
   3.540834536711508*^9, 3.540834549818508*^9}, {3.540835376075508*^9, 
   3.5408353791065083`*^9}, {3.548668008595557*^9, 3.548668021375556*^9}, {
   3.548675078320631*^9, 3.5486751087606745`*^9}, {3.5486778242394075`*^9, 
   3.548677833702354*^9}, 3.54897307811657*^9, 3.623816984623373*^9},
 CellLabel->
  "In[591]:=",ExpressionUUID->"71b720d9-659a-45c9-b0f6-40fdd31ca60b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"generateSentence", "[", 
   RowBox[{"iP_", ",", "groundTerm_", ",", "T_", ",", 
    RowBox[{"recursionLimit_", ":", "100"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"$RecursionLimit", "=", "4096"}], "}"}], ",", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"supports", " ", "little"}], "-", 
      RowBox[{
      "r", " ", "recursionLimits", " ", "up", " ", "to", " ", "500"}]}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     StyleBox["chainExpansion",
      Background->RGBColor[1, 0.85, 0.85]], "[", 
     RowBox[{"iP", ",", "groundTerm", ",", "T", ",", 
      RowBox[{"{", "Start", "}"}], ",", 
      RowBox[{"{", "}"}], ",", "0", ",", "recursionLimit"}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.5407347419098444`*^9, 3.540734793948843*^9}, {
   3.540734864760843*^9, 3.540734942549843*^9}, {3.540734978666843*^9, 
   3.540734986443843*^9}, {3.5407351508038425`*^9, 3.5407351582588425`*^9}, {
   3.5407351960018425`*^9, 3.5407352961008425`*^9}, {3.540735335836161*^9, 
   3.540735338931781*^9}, {3.540735388131619*^9, 3.540735401013194*^9}, {
   3.5407354372834473`*^9, 3.540735562310449*^9}, {3.540735596395263*^9, 
   3.540735613541692*^9}, {3.540735666746585*^9, 3.540735668569768*^9}, 
   3.540735731317042*^9, {3.540735840794989*^9, 3.54073601872378*^9}, 
   3.540736285634468*^9, {3.540743574552005*^9, 3.540743589168466*^9}, 
   3.5407437453290806`*^9, {3.540744969343221*^9, 3.540745047791394*^9}, 
   3.540810011631563*^9, {3.540827133734344*^9, 3.540827212568267*^9}, {
   3.540827247023712*^9, 3.540827249487958*^9}, 3.540829853374338*^9, {
   3.540834536711508*^9, 3.540834549818508*^9}, {3.540835376075508*^9, 
   3.5408353791065083`*^9}, {3.548668008595557*^9, 3.548668021375556*^9}, {
   3.548675078320631*^9, 3.5486751087606745`*^9}, {3.5486778242394075`*^9, 
   3.548677833702354*^9}, 3.54897307811657*^9, 3.623816984623373*^9, {
   3.841307771558899*^9, 3.841307826393543*^9}, {3.84132017295686*^9, 
   3.841320189357894*^9}, {3.841320258954052*^9, 3.841320264709002*^9}, {
   3.841321715959915*^9, 3.841321722347062*^9}, {3.841325212718853*^9, 
   3.8413252260432587`*^9}, {3.915052357274101*^9, 3.915052361550078*^9}},
 CellLabel->
  "In[592]:=",ExpressionUUID->"e9be814a-67ce-480d-ab13-498a1120acf8"],

Cell["\<\
The following historically generated bugs.  Keep it around as a regression \
test.\
\>", "Text",
 CellChangeTimes->{{3.540829970437338*^9, 3.540829989341338*^9}, 
   3.623817038291675*^9},ExpressionUUID->"af62170d-b67f-4c74-bd44-\
568804f7dbb9"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"SeedRandom", "[", "26", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testSentence$", "=", 
   RowBox[{"generateSentence", "[", 
    RowBox[{"iP", ",", "Proposition", ",", "T", ",", "500"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"testSentence$", "//", "InputForm"}]}], "Input",
 CellChangeTimes->{{3.540810018700967*^9, 3.540810028805545*^9}, {
   3.5408100820145884`*^9, 3.5408102036235437`*^9}, 3.5408104185699916`*^9, {
   3.5408104607468557`*^9, 3.540810471259059*^9}, {3.540810574763444*^9, 
   3.540810681737176*^9}, {3.540810725241875*^9, 3.540810765261877*^9}, {
   3.5408108121172466`*^9, 3.540810840465915*^9}, {3.540812074696375*^9, 
   3.540812113203577*^9}, {3.540812149878674*^9, 3.5408121885878887`*^9}, {
   3.540812364744964*^9, 3.540812367452119*^9}, {3.540812404323228*^9, 
   3.540812409754538*^9}, {3.540812453054015*^9, 3.5408124558681765`*^9}, {
   3.54081249247927*^9, 3.540812549890555*^9}, {3.54081259195796*^9, 
   3.540812626637944*^9}, {3.540819201114363*^9, 3.540819247608364*^9}, {
   3.540819298310363*^9, 3.540819316187363*^9}, {3.540819354364363*^9, 
   3.5408194648383627`*^9}, 3.540819547871364*^9, {3.540819967279363*^9, 
   3.5408199819853625`*^9}, {3.540820018161644*^9, 3.540820109356763*^9}, {
   3.540820140357863*^9, 3.540820252416067*^9}, {3.5408202848883142`*^9, 
   3.5408202920750346`*^9}, {3.540820330405865*^9, 3.540820409649789*^9}, {
   3.5408206623900604`*^9, 3.540820747155538*^9}, 3.540820793738194*^9, {
   3.5408208706798873`*^9, 3.5408209033533573`*^9}, {3.540820937319358*^9, 
   3.540821055421359*^9}, {3.540821097017358*^9, 3.540821100210359*^9}, {
   3.540821383726358*^9, 3.540821387388358*^9}, {3.540821417501358*^9, 
   3.540821419106358*^9}, 3.540821518348359*^9, 3.5408215744793596`*^9, {
   3.5408216509533596`*^9, 3.540821694228358*^9}, {3.540821747444358*^9, 
   3.5408218498143597`*^9}, {3.540821884315359*^9, 3.540821889339358*^9}, {
   3.540821942928358*^9, 3.540821961763358*^9}, {3.540822016074358*^9, 
   3.540822016861359*^9}, {3.540834575003508*^9, 3.540834576266508*^9}, {
   3.540835384091508*^9, 3.540835386819508*^9}, {3.548584923347076*^9, 
   3.5485849248591447`*^9}, 3.548604051796463*^9, 3.5486042261378956`*^9, {
   3.548667971961556*^9, 3.548667972294556*^9}, {3.548668029384556*^9, 
   3.548668030008556*^9}, {3.548668278392556*^9, 3.548668317421556*^9}, {
   3.548675142131011*^9, 3.548675155980397*^9}, {3.54867551970552*^9, 
   3.548675548846521*^9}, 3.548676730519046*^9, {3.548676789881982*^9, 
   3.548676790801074*^9}, {3.548677634076393*^9, 3.548677661461131*^9}, {
   3.5486778445684395`*^9, 3.5486778639983826`*^9}, {3.548973064752805*^9, 
   3.54897306484181*^9}, {3.623409404786364*^9, 3.623409409657185*^9}, {
   3.623409541969984*^9, 3.623409547794218*^9}, {3.841178918892048*^9, 
   3.841178940419286*^9}, {3.841220152231094*^9, 3.841220155206321*^9}, {
   3.841320204747134*^9, 3.841320208887663*^9}, {3.841320291799343*^9, 
   3.841320293240738*^9}, {3.841320473203952*^9, 3.8413204757841377`*^9}, 
   3.841320606599797*^9, {3.841320740940005*^9, 3.841320758854747*^9}, {
   3.841320795399994*^9, 3.841320809892715*^9}, 3.841321729642514*^9, {
   3.841321822842509*^9, 3.8413218244117804`*^9}},
 CellLabel->
  "In[593]:=",ExpressionUUID->"225b4bf0-98f9-45e1-accf-4e096e2126b2"],

Cell["\<\
{\"K\", \"E\", \"N\", \"E\", \"K\", \"N\", \"K\", \"r\", \"p\", \"E\", \"N\", \
\"p\", \"N\", \"A\", \"r\", \"q\", \"s\", 
 \"N\", \"N\", \"r\", \"N\", \"E\", \"N\", \"s\", \"s\"}\
\>", "Output",
 CellChangeTimes->{3.8414042494237623`*^9, 3.841404364156562*^9, 
  3.841404587561221*^9, 3.8414047447133093`*^9, 3.841404847469014*^9, 
  3.84140499899034*^9, 3.8414053634319553`*^9, 3.841422364457446*^9, 
  3.841487793453356*^9, 3.841490387650486*^9, 3.911255353125956*^9, 
  3.911290461047138*^9, 3.912268979588496*^9, 3.912546352657895*^9, 
  3.9125890711241503`*^9, 3.9126003506376143`*^9, 3.912601705717557*^9, 
  3.915050870875915*^9, 3.915535456784181*^9},
 CellLabel->
  "Out[595]//InputForm=",ExpressionUUID->"141083fe-6ed9-4349-b57b-\
b883d770c2bf"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["expressionStringFromSentenceRules", "Subsubsection",
 CellChangeTimes->{{3.841218535146037*^9, 
  3.841218543525116*^9}},ExpressionUUID->"7dd5770a-4987-4516-a28c-\
9821c99a95c7"],

Cell["\<\
Just in case we want to transform terminals in the grammar to something else, \
for example, for putting in a lexical separator.\
\>", "Text",
 CellChangeTimes->{{3.841218546640611*^9, 3.841218559754731*^9}, {
   3.841218594079358*^9, 3.841218599881281*^9}, {3.841218837680003*^9, 
   3.841218844458746*^9}, {3.84132188933321*^9, 3.841321910684387*^9}, 
   3.841322021365908*^9},ExpressionUUID->"478c8696-ba88-4254-b736-\
f486bc913e85"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"bulletSeparatorRules", ",", "expressionStringFromSentence"}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.540754274666566*^9, 3.540754346450744*^9}, {
   3.540761155742535*^9, 3.540761227279688*^9}, {3.54076135871383*^9, 
   3.540761360432002*^9}, 3.540761430757034*^9, {3.5407618204539995`*^9, 
   3.540761838702824*^9}, {3.540805389495356*^9, 3.540805409055855*^9}, {
   3.540805777232674*^9, 3.540805809427453*^9}, {3.540806726834234*^9, 
   3.540806731018652*^9}, {3.5408069190914574`*^9, 3.5408069902715745`*^9}, {
   3.540807027897337*^9, 3.5408072219044485`*^9}, {3.540807261052533*^9, 
   3.540807321425495*^9}, {3.540830017691338*^9, 3.540830021644339*^9}, 
   3.540834597905508*^9, {3.540835312163508*^9, 3.540835321399508*^9}, {
   3.548585038095518*^9, 3.548585051731193*^9}, {3.548594662504274*^9, 
   3.5485946638162746`*^9}, 3.623817061908345*^9, {3.841322009320441*^9, 
   3.841322010588107*^9}},
 CellLabel->
  "In[596]:=",ExpressionUUID->"110f3dc1-39a7-4f5c-8eb4-195879d466fa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"bulletSeparatorRules", "=", 
   RowBox[{"{", 
    RowBox[{"x_String", "\[RuleDelayed]", 
     RowBox[{"x", "<>", "\"\<\[Bullet]\>\""}]}], "}"}]}], ";", 
  RowBox[{
   RowBox[{"expressionStringFromSentence", "[", 
    RowBox[{"sentence_", ",", 
     RowBox[{"rules_", ":", 
      RowBox[{"{", "}"}]}]}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sentence", "/.", "rules"}], "//", "StringJoin"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.540754274666566*^9, 3.540754346450744*^9}, {
   3.540761155742535*^9, 3.540761227279688*^9}, {3.54076135871383*^9, 
   3.540761360432002*^9}, 3.540761430757034*^9, {3.5407618204539995`*^9, 
   3.540761838702824*^9}, {3.540805389495356*^9, 3.540805409055855*^9}, {
   3.540805777232674*^9, 3.540805809427453*^9}, {3.540806726834234*^9, 
   3.540806731018652*^9}, {3.5408069190914574`*^9, 3.5408069902715745`*^9}, {
   3.540807027897337*^9, 3.5408072219044485`*^9}, {3.540807261052533*^9, 
   3.540807321425495*^9}, {3.540830017691338*^9, 3.540830021644339*^9}, 
   3.540834597905508*^9, {3.540835312163508*^9, 3.540835321399508*^9}, {
   3.548585038095518*^9, 3.548585051731193*^9}, {3.548594662504274*^9, 
   3.5485946638162746`*^9}, 3.623817061908345*^9, {3.84125545340337*^9, 
   3.841255502169081*^9}, {3.841321790843816*^9, 3.841321794072108*^9}, {
   3.8413218319688463`*^9, 3.841321871058427*^9}, {3.841321926283147*^9, 
   3.8413219730478*^9}},
 CellLabel->
  "In[597]:=",ExpressionUUID->"c170bc2d-3143-4e59-b236-e9397d44c2ac"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"expressionStringFromSentence", "[", 
  RowBox[{"testSentence$", ",", "bulletSeparatorRules"}], "]"}]], "Input",
 CellChangeTimes->{{3.623409560664506*^9, 3.623409569531713*^9}, {
  3.841321955242075*^9, 3.841321982621408*^9}},
 CellLabel->
  "In[598]:=",ExpressionUUID->"99e000aa-5237-4544-a1f9-95b5b4335a3d"],

Cell[BoxData["\<\"K\[Bullet]E\[Bullet]N\[Bullet]E\[Bullet]K\[Bullet]N\[Bullet]\
K\[Bullet]r\[Bullet]p\[Bullet]E\[Bullet]N\[Bullet]p\[Bullet]N\[Bullet]A\
\[Bullet]r\[Bullet]q\[Bullet]s\[Bullet]N\[Bullet]N\[Bullet]r\[Bullet]N\
\[Bullet]E\[Bullet]N\[Bullet]s\[Bullet]s\[Bullet]\"\>"], "Output",
 CellChangeTimes->{3.841404259467653*^9, 3.841404364202214*^9, 
  3.841404587601465*^9, 3.84140474475779*^9, 3.8414048474973803`*^9, 
  3.841404999028385*^9, 3.841405363464375*^9, 3.841422364492125*^9, 
  3.841487811045689*^9, 3.911255353141907*^9, 3.911290461059528*^9, 
  3.912269000846023*^9, 3.912546352675961*^9, 3.912589071138277*^9, 
  3.912600350652939*^9, 3.912601705728265*^9, 3.9150508708875237`*^9, 
  3.915535456801776*^9},
 CellLabel->
  "Out[598]=",ExpressionUUID->"969cccc2-1134-45bf-8c8e-9913a7e68802"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"expressionStringFromSentence", "@", "testSentence$"}]], "Input",
 CellChangeTimes->{{3.841321986038679*^9, 3.841321992506643*^9}},
 CellLabel->
  "In[599]:=",ExpressionUUID->"deffa611-f4ba-4a6d-9e38-4bbd8bbe8173"],

Cell[BoxData["\<\"KENEKNKrpENpNArqsNNrNENss\"\>"], "Output",
 CellChangeTimes->{3.841404259489511*^9, 3.841404364223598*^9, 
  3.841404587629284*^9, 3.841404744780902*^9, 3.841404847513158*^9, 
  3.841404999053677*^9, 3.841405363484025*^9, 3.841422364514338*^9, 
  3.84148781108596*^9, 3.9112553531472*^9, 3.911290461062649*^9, 
  3.912269008579969*^9, 3.912546352678848*^9, 3.912589071141996*^9, 
  3.912600350656086*^9, 3.91260170573108*^9, 3.915050870890732*^9, 
  3.915535456804666*^9},
 CellLabel->
  "Out[599]=",ExpressionUUID->"0de6eb7f-fba4-4e63-8eb1-6829cfa53c0d"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Interactive Test Samples", "Subsection",
 CellChangeTimes->{{3.5486781159455748`*^9, 
  3.548678127008681*^9}},ExpressionUUID->"fc77d8e4-ea7a-44e5-bc50-\
60ff23ffcb07"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"contender", "=", "\"\<\>\""}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{
   "biggest", " ", "one", " ", "we", " ", "found", " ", "so", " ", "far"}], 
   " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"ClearAll", "[", "genDisplay", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"genDisplay", "[", 
    RowBox[{"_", ":", "Null"}], "]"}], ":=", 
   RowBox[{"(*", " ", 
    RowBox[{"throw", "-", 
     RowBox[{
     "away", " ", "argument", " ", "needed", " ", "for", " ", "Animate"}]}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"sen", "=", 
       RowBox[{
        StyleBox["generateSentence",
         Background->RGBColor[1, 0.85, 0.85]], "[", 
        RowBox[{"iP", ",", "Proposition", ",", "T", ",", "100"}], "]"}]}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"s", "=", 
          RowBox[{"expressionStringFromSentence", " ", "@", " ", "sen"}]}], 
         ",", 
         RowBox[{"l", "=", 
          RowBox[{"Length", "@", "sen"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"e", "=", 
            RowBox[{"ToExpression", " ", "@", " ", "s"}]}], ",", 
           RowBox[{"ls", "=", 
            RowBox[{"StringLength", "@", "s"}]}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"ls", ">", 
             RowBox[{"StringLength", "@", "contender"}]}], ",", 
            RowBox[{"contender", "=", "s"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"c", "=", 
              RowBox[{"Column", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"sen", ",", 
                  RowBox[{"e", "//", "InputForm"}], ",", "l"}], "}"}], ",", 
                RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}]}], "}"}], ",", 
            "\[IndentingNewLine]", "c"}], "]"}]}]}], "]"}]}], "]"}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.540834154692635*^9, 3.540834166416807*^9}, {
   3.5408368517147236`*^9, 3.540836955109724*^9}, {3.5408390724281235`*^9, 
   3.540839072615161*^9}, {3.5412648280724015`*^9, 3.5412648661590014`*^9}, {
   3.541272703745747*^9, 3.541272737083911*^9}, {3.5412727900545297`*^9, 
   3.5412727919489093`*^9}, {3.541272842289079*^9, 3.541272861866125*^9}, {
   3.548585198835372*^9, 3.548585212092796*^9}, {3.548595162007208*^9, 
   3.5485952312351294`*^9}, {3.548595273676374*^9, 3.548595278765883*^9}, {
   3.54866837250524*^9, 3.548668375227785*^9}, {3.54866867379902*^9, 
   3.548668739714611*^9}, {3.548669489633941*^9, 3.548669541371941*^9}, {
   3.548669586113941*^9, 3.548669594779941*^9}, {3.5486751774155393`*^9, 
   3.54867517782458*^9}, 3.548677438973884*^9, 3.548677887416724*^9, {
   3.548678663115309*^9, 3.548678716342309*^9}, {3.548766906217334*^9, 
   3.548766907552799*^9}, {3.5490174697833443`*^9, 3.549017480470956*^9}, {
   3.549017525069665*^9, 3.5490175490233445`*^9}, {3.5490175964948635`*^9, 
   3.549017604223607*^9}, {3.623409664440418*^9, 3.623409679240517*^9}, {
   3.84125551275616*^9, 3.841255519706861*^9}, {3.841255600215987*^9, 
   3.8412556734778*^9}, {3.841256888290668*^9, 3.841256888404598*^9}, {
   3.841307187425945*^9, 3.841307193357506*^9}, {3.841307237993803*^9, 
   3.841307239608398*^9}, {3.84130768587296*^9, 3.841307703870924*^9}, {
   3.841324897377254*^9, 3.8413248976872196`*^9}, {3.841325167879921*^9, 
   3.841325168808742*^9}, 3.841327409765059*^9, 3.841327463944785*^9, 
   3.8414031085430307`*^9, {3.841495866740481*^9, 3.841495886328815*^9}, {
   3.84149597311003*^9, 3.841496015699839*^9}, {3.911290932677849*^9, 
   3.911290945233392*^9}},
 CellLabel->
  "In[600]:=",ExpressionUUID->"6d148c47-98d2-47f2-a356-5a0383539cb6"],

Cell["\<\
Press the button as many times as you like to see new Well-Formed Formulae.\
\>", "Text",
 CellChangeTimes->{{3.911290879308586*^9, 
  3.911290900886809*^9}},ExpressionUUID->"322f5fc0-f242-43b7-987b-\
18a99b9af03e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"SeedRandom", "[", "26", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"DynamicModule", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"foo", "=", 
     RowBox[{"genDisplay", "[", "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Manipulate", "[", 
    RowBox[{"foo", ",", "\[IndentingNewLine]", 
     RowBox[{"Button", "[", 
      RowBox[{"\"\<GEN\>\"", ",", " ", 
       RowBox[{"foo", "=", 
        RowBox[{"genDisplay", "[", "]"}]}]}], "]"}]}], "]"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.841307008207397*^9, 3.841307013750893*^9}, {
   3.841307097001243*^9, 3.841307127160602*^9}, {3.841307210876955*^9, 
   3.8413072326933613`*^9}, {3.841307359592749*^9, 3.841307365677553*^9}, {
   3.841307650197779*^9, 3.841307679737352*^9}, 3.841307715851918*^9, {
   3.911290865852984*^9, 3.911290868755131*^9}},
 CellLabel->
  "In[603]:=",ExpressionUUID->"2aaf10f4-9967-4156-841b-a04c1752182e"],

Cell[BoxData[
 DynamicModuleBox[{$CellContext`foo$$ = 
  Column[{{"K", "E", "N", "E", "K", "N", "K", "r", "p", "E", "N", "p", "N", 
     "A", "r", "q", "s", "N", "N", "r", "N", "E", "N", "s", "s"}, 
    InputForm[$CellContext`KENEKNKrpENpNArqsNNrNENss], 25}, Frame -> All]}, 
  TagBox[
   StyleBox[
    DynamicModuleBox[{Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
     Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
     1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{
       Hold[
        Button["GEN", $CellContext`foo$$ = $CellContext`genDisplay[]]], 
       Manipulate`Dump`ThisIsNotAControl, ControlType -> None}}, 
     Typeset`size$$ = {792., {39.7010498046875, 48.2989501953125}}, 
     Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = True}, 
     DynamicBox[Manipulate`ManipulateBoxes[
      1, StandardForm, "Variables" :> {}, "ControllerVariables" :> {}, 
       "OtherVariables" :> {
        Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
         Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
         Typeset`specs$$, Typeset`size$$, Typeset`update$$, 
         Typeset`initDone$$, Typeset`skipInitDone$$}, 
       "Body" :> $CellContext`foo$$, "Specifications" :> {
         Button["GEN", $CellContext`foo$$ = $CellContext`genDisplay[]]}, 
       "Options" :> {}, "DefaultOptions" :> {}],
      ImageSizeCache->{858., {109., 118.}},
      SingleEvaluation->True],
     Deinitialization:>None,
     DynamicModuleValues:>{},
     SynchronousInitialization->True,
     UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
     UnsavedVariables:>{Typeset`initDone$$},
     UntrackedVariables:>{Typeset`size$$}], "Manipulate",
    Deployed->True,
    StripOnInput->False],
   Manipulate`InterpretManipulate[1]],
  DynamicModuleValues:>{}]], "Output",
 CellChangeTimes->{
  3.841404364281271*^9, 3.841404450752404*^9, 3.841404587685341*^9, 
   3.841404744840769*^9, {3.841404847564706*^9, 3.841404870833452*^9}, 
   3.841404904849281*^9, 3.84140499910338*^9, 3.841405363524846*^9, 
   3.841422364554555*^9, 3.841487811138811*^9, 3.911255353165557*^9, 
   3.911290461078164*^9, 3.911290869463006*^9, 3.912269020284475*^9, 
   3.912546352696358*^9, 3.91258907115831*^9, 3.912600350673969*^9, 
   3.91260170574745*^9, 3.915050870907042*^9, 3.9155354568225403`*^9},
 CellLabel->
  "Out[604]=",ExpressionUUID->"518bcf93-a6b0-414b-83ff-8cf9bddb149a"]
}, Open  ]],

Cell[TextData[{
 "Animate is a funny beast: the expression being evaluated must depend on the \
iteration variable, ",
 StyleBox["u", "Input"],
 " in this case, or nothing happens. We make an artificial dependency."
}], "Text",
 CellChangeTimes->{{3.841495709712904*^9, 
  3.841495756795022*^9}},ExpressionUUID->"c13058ea-ab09-4302-92aa-\
3595f4e1578d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Animate", "[", 
  RowBox[{
   RowBox[{"genDisplay", "[", "u", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"u", ",", "1", ",", "25", ",", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.841495633165654*^9, 3.841495700651239*^9}},
 CellLabel->
  "In[605]:=",ExpressionUUID->"91326c65-611f-48be-82dd-40c12254f322"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`u$$ = 21, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`u$$], 1, 25, 1, ControlType -> Animator}}, 
    Typeset`size$$ = {141., {39.7010498046875, 48.2989501953125}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = True}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`u$$ = 1}, 
      "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> $CellContext`genDisplay[$CellContext`u$$], 
      "Specifications" :> {{$CellContext`u$$, 1, 25, 1, 
         AppearanceElements -> {
          "ProgressSlider", "PlayPauseButton", "FasterSlowerButtons", 
           "DirectionButton"}}}, 
      "Options" :> {
       ControlType -> Animator, AppearanceElements -> None, DefaultBaseStyle -> 
        "Animate", DefaultLabelStyle -> "AnimateLabel", SynchronousUpdating -> 
        True, ShrinkingDelay -> 10.}, "DefaultOptions" :> {}],
     ImageSizeCache->{4392., {165., 173.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Animate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.84149567571241*^9, 3.841495701638105*^9}, 
   3.91125535321261*^9, 3.911290461103497*^9, 3.912546352724412*^9, 
   3.912589071191811*^9, 3.912600350706513*^9, 3.912601705773147*^9, 
   3.91505087093364*^9, 3.915535456850219*^9},
 CellLabel->
  "Out[605]=",ExpressionUUID->"4087d345-37d2-4811-960e-249627034b53"]
}, Open  ]],

Cell["Here\[CloseCurlyQuote]s the biggest one found so far.", "Text",
 CellChangeTimes->{{3.911290964971261*^9, 
  3.9112909707903028`*^9}},ExpressionUUID->"3e0c89ea-a467-41c0-8cc5-\
6e4960507c31"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dynamic", "[", "contender", "]"}]], "Input",
 CellChangeTimes->{{3.841495763527195*^9, 3.841495771634595*^9}},
 CellLabel->
  "In[606]:=",ExpressionUUID->"afac0e73-05e1-4523-8c0d-8a021c47d703"],

Cell[BoxData[
 DynamicBox[ToBoxes[$CellContext`contender, StandardForm],
  ImageSizeCache->{
   1510.8019042968783`, {98.32340240478516, 19.18787384033203}}]], "Output",
 CellChangeTimes->{3.841495776574793*^9, 3.841495818306115*^9, 
  3.911255353223855*^9, 3.911290461114668*^9, 3.912269053048522*^9, 
  3.9125463527312937`*^9, 3.912589071200103*^9, 3.9126003507285023`*^9, 
  3.912601705780561*^9, 3.915050870942257*^9, 3.9155354568580847`*^9},
 CellLabel->
  "Out[606]=",ExpressionUUID->"6fc7e388-2e69-4231-821c-12f45774251f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["randomUtterance [ ]", "Subsection",
 CellChangeTimes->{{3.549017640270018*^9, 3.5490176438935857`*^9}, {
  3.62340962976768*^9, 
  3.623409630675989*^9}},ExpressionUUID->"77afeab6-4687-4038-b998-\
583aa5837234"],

Cell["This seed historically exposed bugs, so we keep it around.", "Text",
 CellChangeTimes->{{3.915052761759354*^9, 
  3.915052777830327*^9}},ExpressionUUID->"a5947deb-7cb6-418f-993e-\
738d5e58db13"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"SeedRandom", "[", "26", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"randomUtterance", "[", 
   RowBox[{"len_", ":", "100"}], "]"}], ":=", 
  RowBox[{"expressionStringFromSentence", " ", "@", " ", 
   RowBox[{"generateSentence", "[", 
    RowBox[{"iP", ",", "Proposition", ",", "T", ",", "len"}], "]"}]}]}], "\n", 
 RowBox[{
  RowBox[{"randomUtterance", "[", "]"}], "//", "InputForm"}]}], "Input",
 CellChangeTimes->{{3.54901765022787*^9, 3.549017712265641*^9}, 
   3.549021017932152*^9, {3.623817209436774*^9, 3.623817210692793*^9}, {
   3.841164802771138*^9, 3.8411648151854057`*^9}, {3.841327361329407*^9, 
   3.841327361554964*^9}, 3.84140390095488*^9, 3.84140492539638*^9},
 CellLabel->
  "In[607]:=",ExpressionUUID->"be587091-8930-4e2f-9703-619dc11aab2a"],

Cell["\"KENEKNKrpENpNArqsNNrNENss\"", "Output",
 CellChangeTimes->{
  3.841404847583106*^9, {3.841404887743327*^9, 3.8414049263239307`*^9}, 
   3.841404999142717*^9, 3.841405363556157*^9, 3.841422364593934*^9, 
   3.911255353236685*^9, 3.911290461123145*^9, 3.912269070716621*^9, 
   3.9125463527397113`*^9, 3.912589071214841*^9, 3.9126003507320633`*^9, 
   3.9126017057890997`*^9, 3.915050870949631*^9, 3.91553545686758*^9},
 CellLabel->
  "Out[609]//InputForm=",ExpressionUUID->"e534a2b9-ab49-4e31-ad08-\
ad1fa4910002"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["PARSING", "Section",
 CellChangeTimes->{{3.548678144108391*^9, 
  3.5486781468636665`*^9}},ExpressionUUID->"f03389af-0505-4f92-9176-\
33ed17317e57"],

Cell["\<\
Given an utterance, build a tree of the non-terminals that generate it. \
\>", "Text",
 CellChangeTimes->{{3.548678362862264*^9, 3.5486784370106783`*^9}, 
   3.5486785081177883`*^9, {3.549018771454486*^9, 3.549018773748617*^9}, {
   3.841311020524808*^9, 
   3.841311021430883*^9}},ExpressionUUID->"11ba8125-0fc1-4496-b636-\
a8e748b158c6"],

Cell[TextData[{
 "We\[CloseCurlyQuote]ll first create a hard-coded parser for the WFF \
language, then we will create a machine-generated parser and compare the two \
parsers. The machine-generated parser results from a ",
 StyleBox["parser-generator",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 " that can write a parser from any PFF grammar. "
}], "Text",
 CellChangeTimes->{{3.9125994568434553`*^9, 3.912599553520268*^9}, 
   3.912601662732771*^9},ExpressionUUID->"b60e45aa-9282-4ab3-8093-\
bbda4de5241f"],

Cell[CellGroupData[{

Cell["Hard-Coded, Recursive-Descent Parser (Ground Truth)", "Subsection",
 CellChangeTimes->{{3.841310579870779*^9, 
  3.841310598728842*^9}},ExpressionUUID->"4451dfb0-1865-4d4f-a6dd-\
2ab22e1d9ae9"],

Cell["This parser is hard-coded to our grammar. ", "Text",
 CellChangeTimes->{{3.5486785229422708`*^9, 3.5486785332393*^9}, {
   3.548678917233309*^9, 3.5486789803193088`*^9}, {3.548761887129839*^9, 
   3.548761920709265*^9}, {3.548762638625438*^9, 3.548762696540229*^9}, {
   3.548762732134788*^9, 3.548762740829658*^9}, {3.549361386625375*^9, 
   3.549361388933507*^9}, {3.623817285688679*^9, 3.623817294952701*^9}, {
   3.645655941537511*^9, 3.645655942904088*^9}, 3.687638492606398*^9, {
   3.841310225272255*^9, 3.841310307062202*^9}, {3.841310339120592*^9, 
   3.84131039387107*^9}, {3.841310424144387*^9, 3.841310510323071*^9}, {
   3.841310541771331*^9, 3.8413105761836853`*^9}, 3.841310777907331*^9, {
   3.841310857246621*^9, 3.84131092020378*^9}, {3.841311047438208*^9, 
   3.84131106978728*^9}, {3.912599568523533*^9, 
   3.912599584824212*^9}},ExpressionUUID->"0634c781-9dc6-4d37-9bb5-\
ba42c4d6c192"],

Cell["\<\
First, tokenize the utterance. In our example, tokenizing is trivial because \
each token is a single character.\
\>", "Text",
 CellChangeTimes->{{3.548678572273203*^9, 3.5486785925582314`*^9}, {
  3.841310607512587*^9, 3.841310616043182*^9}, {3.915052852528369*^9, 
  3.915052853135037*^9}},ExpressionUUID->"b483cdf3-a3c5-4e82-8e35-\
ca0a042a5f2b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "tokens", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tokens", "[", "utterance_", "]"}], ":=", 
   RowBox[{"Characters", "[", "utterance", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.548678560401016*^9, 3.548678600779309*^9}, {
  3.548762126038364*^9, 3.548762126165415*^9}, {3.5487628116187353`*^9, 
  3.548762814093983*^9}, {3.841155067760544*^9, 3.84115507574677*^9}},
 CellLabel->
  "In[610]:=",ExpressionUUID->"9aafb3ae-2995-42bc-975d-01c3d3fdb828"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"parse", ",", "remToks", ",", "partTree"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.548678989337309*^9, 3.548679165160309*^9}, {
   3.5486791990703087`*^9, 3.548679242156309*^9}, {3.5486793018333087`*^9, 
   3.5486794857303085`*^9}, {3.548679553574309*^9, 3.548679555199309*^9}, {
   3.548679592796309*^9, 3.548679598557309*^9}, {3.5486796363623085`*^9, 
   3.548679678600309*^9}, {3.5486797161103086`*^9, 3.548679742013309*^9}, {
   3.548680000036984*^9, 3.548680087586738*^9}, {3.5486801332753067`*^9, 
   3.548680162381217*^9}, {3.5486801936313415`*^9, 3.54868020911989*^9}, {
   3.548680245865565*^9, 3.548680265092487*^9}, {3.548680295799557*^9, 
   3.548680446628639*^9}, {3.548680497903765*^9, 3.548680640887062*^9}, {
   3.548680673721868*^9, 3.548680895567683*^9}, {3.5486810035821095`*^9, 
   3.54868102836711*^9}, {3.5486811056271095`*^9, 3.548681129804109*^9}, {
   3.548681215526109*^9, 3.548681228125109*^9}, {3.548681459385109*^9, 
   3.548681491552109*^9}, {3.5487590213758907`*^9, 3.548759337873266*^9}, {
   3.5487595254283304`*^9, 3.548759539982419*^9}, {3.548759596781057*^9, 
   3.548759669756459*^9}, {3.548759737957816*^9, 3.5487597558552356`*^9}, {
   3.548759880212311*^9, 3.548759949733311*^9}, {3.548760008885311*^9, 
   3.5487600517133126`*^9}, 3.548760087235311*^9, {3.548760127669311*^9, 
   3.548760187826311*^9}, {3.548760258833312*^9, 3.5487602622553124`*^9}, {
   3.548761377701639*^9, 3.5487613793918085`*^9}, {3.548761964646834*^9, 
   3.548761988606413*^9}, {3.54876672355289*^9, 3.548766725992134*^9}, {
   3.548766759618496*^9, 3.5487668136659*^9}, {3.548771901671317*^9, 
   3.548771917798317*^9}, {3.548791581900611*^9, 3.548791584045734*^9}, {
   3.549013527276035*^9, 3.5490135297967477`*^9}, 3.623845711270899*^9},
 CellLabel->
  "In[612]:=",ExpressionUUID->"c2f4e638-1913-40c5-80dd-b4d14255cbed"],

Cell[TextData[{
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " has a built-in named \[OpenCurlyDoubleQuote]Alternatives\
\[CloseCurlyDoubleQuote] for pattern-matching. It has nothing to do with \
alternatives in our grammar."
}], "Text",
 CellChangeTimes->{{3.841255758999742*^9, 3.841255786674279*^9}, {
  3.915052879342754*^9, 
  3.915052880711207*^9}},ExpressionUUID->"0d5dd3af-a9c5-46c6-9b77-\
efaeb6ac361f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"??", "Alternatives"}]], "Input",
 CellChangeTimes->{{3.841219842878079*^9, 3.841219846459019*^9}},
 CellLabel->
  "In[613]:=",ExpressionUUID->"3a37bb25-ab1d-4c8b-b3dc-b961b95396a5"],

Cell[BoxData[
 InterpretationBox[
  StyleBox[
   FrameBox[
    DynamicModuleBox[{System`InformationDump`open$$ = True, 
     System`InformationDump`mouseOver$$ = False}, 
     PaneSelectorBox[{True->
      TagBox[GridBox[{
         {
          ItemBox[
           PaneBox[
            StyleBox[
             TagBox[
              TooltipBox[
               StyleBox["\<\" Symbol\"\>", "InformationRowLabel",
                StripOnInput->False],
               "\"Symbol\"",
               TooltipStyle->"TextStyling"],
              Annotation[#, "Symbol", "Tooltip"]& ], "InformationTitleText",
             StripOnInput->False,
             BaseStyle -> None],
            FrameMargins->{{4, 0}, {-1, 1}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], 
          ItemBox[
           PaneBox[
            TooltipBox[
             ButtonBox[
              PaneSelectorBox[{False->
               
               DynamicBox[FEPrivate`FrontEndResource[
                "FEBitmaps", "InformationHelpIcon"],
                ImageSizeCache->{20., {6., 14.}}], True->
               
               DynamicBox[FEPrivate`FrontEndResource[
                "FEBitmaps", "InformationHelpIconHot"],
                ImageSizeCache->{20., {6., 14.}}]}, Dynamic[
                CurrentValue["MouseOver"]]],
              Appearance->None,
              BaseStyle->"Link",
              ButtonData->"paclet:ref/Alternatives",
              ButtonNote->"paclet:ref/Alternatives"],
             "\"paclet:ref/Alternatives\""],
            FrameMargins->{{0, 4}, {0, 2}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           PaneBox[
            
            StyleBox["\<\"\\!\\(\\*RowBox[{SubscriptBox[StyleBox[\\\"p\\\", \
\\\"TI\\\"], StyleBox[\\\"1\\\", \\\"TR\\\"]], \\\"|\\\", \
SubscriptBox[StyleBox[\\\"p\\\", \\\"TI\\\"], StyleBox[\\\"2\\\", \
\\\"TR\\\"]], \\\"|\\\", StyleBox[\\\"\[Ellipsis]\\\", \\\"TR\\\"]}]\\) is a \
pattern object that represents any of the patterns \
\\!\\(\\*SubscriptBox[StyleBox[\\\"p\\\", \\\"TI\\\"], StyleBox[\\\"i\\\", \\\
\"TI\\\"]]\\). \"\>", "InformationUsageText",
             StripOnInput->False,
             LineSpacing->{1.5, 1.5, 3.}],
            FrameMargins->{{10, 10}, {8, 10}}],
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False]},
         {
          PaneBox[GridBox[{
             {
              
              DynamicModuleBox[{System`InformationDump`open$$ = {
               False, False, False, False, False, False}}, 
               StyleBox[GridBox[{
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Documentation\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"Documentation\"",
                    TooltipStyle->"TextStyling"],
                    Annotation[#, "Documentation", "Tooltip"]& ], 
                   TemplateBox[{
                    
                    TemplateBox[{
                    "\"Local \[RightGuillemet]\"", "paclet:ref/Alternatives", 
                    "paclet:ref/Alternatives", "Link", {
                    RGBColor[0.9686274509803922, 0.4666666666666667, 0.]}, 
                    BaseStyle -> {
                    RGBColor[0.0784313725490196, 0.1568627450980392, 0.6]}}, 
                    "HyperlinkTemplate"], "\"  \"", 
                    StyleBox[
                    "\"|\"", "InformationRowLabel", StripOnInput -> False], 
                    "\"  \"", 
                    TemplateBox[{"\"Web \[RightGuillemet]\"", {
                    URL[
                    "http://reference.wolfram.com/language/ref/Alternatives.\
html"], None}, "http://reference.wolfram.com/language/ref/Alternatives.html", 
                    "Hyperlink", {
                    RGBColor[0.9686274509803922, 0.4666666666666667, 0.]}, 
                    BaseStyle -> {
                    RGBColor[0.0784313725490196, 0.1568627450980392, 0.6]}}, 
                    "HyperlinkTemplate"]},
                    "RowDefault"]},
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Attributes\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"Attributes\"",
                    TooltipStyle->"TextStyling"],
                    Annotation[#, "Attributes", "Tooltip"]& ], 
                   RowBox[{"{", "Protected", "}"}]},
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Full Name\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"FullName\"",
                    TooltipStyle->"TextStyling"],
                    
                    Annotation[#, "FullName", 
                    "Tooltip"]& ], "\<\"System`Alternatives\"\>"}
                 },
                 AutoDelete->False,
                 GridBoxAlignment->{"Columns" -> {Right, Left}},
                 GridBoxDividers->None,
                 GridBoxItemSize->{"Columns" -> {Automatic, Automatic}},
                 GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.5599999999999999]}, 
                    Offset[0.27999999999999997`]}, "Rows" -> {
                    Offset[0.2], {
                    Offset[0.8]}, 
                    Offset[0.2]}}], "DialogStyle",
                StripOnInput->False],
               DynamicModuleValues:>{}]}
            },
            DefaultBaseStyle->"Column",
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxDividers->{"Columns" -> {{False}}, "Rows" -> {{False}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.5599999999999999]}, 
                Offset[0.27999999999999997`]}, "Rows" -> {
                Offset[0.2], {
                 Offset[3.6]}, 
                Offset[0.2]}}],
           FrameMargins->{{6, 6}, {6, 3}}], ""},
         {
          ItemBox[
           TagBox[
            ButtonBox[
             PaneSelectorBox[{False->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "UpPointerOpener"],
               ImageSizeCache->{15., {2., 13.}}], True->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "UpPointerOpenerHot"],
               ImageSizeCache->{15., {2., 13.}}]}, Dynamic[
              System`InformationDump`mouseOver$$]],
             Alignment->Left,
             Appearance->{"Default" -> None},
             
             ButtonFunction:>FEPrivate`Set[
              System`InformationDump`open$$, False],
             Evaluator->Automatic,
             FrameMargins->{{9, 0}, {0, 0}},
             ImageMargins->0,
             ImageSize->Full,
             Method->"Preemptive"],
            
            EventHandlerTag[{
             "MouseEntered" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, True], 
              "MouseExited" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, False], 
              Method -> "Preemptive", PassEventsDown -> Automatic, 
              PassEventsUp -> True}]],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], "\[SpanFromLeft]"}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          GrayLevel[0.8], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {Left, Right}, "Rows" -> {{Center}}},
        GridBoxDividers->{
         "Columns" -> {{None}}, "Rows" -> {False, {True}, False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], False->
      TagBox[GridBox[{
         {
          ItemBox[
           PaneBox[
            StyleBox[
             TagBox[
              TooltipBox[
               StyleBox["\<\" Symbol\"\>", "InformationRowLabel",
                StripOnInput->False],
               "\"Symbol\"",
               TooltipStyle->"TextStyling"],
              Annotation[#, "Symbol", "Tooltip"]& ], "InformationTitleText",
             StripOnInput->False],
            FrameMargins->{{4, 0}, {-1, 1}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], 
          ItemBox[
           PaneBox[
            TooltipBox[
             ButtonBox[
              PaneSelectorBox[{False->
               
               DynamicBox[FEPrivate`FrontEndResource[
                "FEBitmaps", "InformationHelpIcon"]], True->
               
               DynamicBox[FEPrivate`FrontEndResource[
                "FEBitmaps", "InformationHelpIconHot"]]}, Dynamic[
                CurrentValue["MouseOver"]]],
              Appearance->None,
              BaseStyle->"Link",
              ButtonData->"paclet:ref/Alternatives",
              ButtonNote->"paclet:ref/Alternatives"],
             "\"paclet:ref/Alternatives\""],
            FrameMargins->{{0, 4}, {0, 2}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           PaneBox[
            
            StyleBox["\<\"\\!\\(\\*RowBox[{SubscriptBox[StyleBox[\\\"p\\\", \
\\\"TI\\\"], StyleBox[\\\"1\\\", \\\"TR\\\"]], \\\"|\\\", \
SubscriptBox[StyleBox[\\\"p\\\", \\\"TI\\\"], StyleBox[\\\"2\\\", \
\\\"TR\\\"]], \\\"|\\\", StyleBox[\\\"\[Ellipsis]\\\", \\\"TR\\\"]}]\\) is a \
pattern object that represents any of the patterns \
\\!\\(\\*SubscriptBox[StyleBox[\\\"p\\\", \\\"TI\\\"], StyleBox[\\\"i\\\", \\\
\"TI\\\"]]\\). \"\>", "InformationUsageText",
             StripOnInput->False,
             LineSpacing->{1.5, 1.5, 3.}],
            FrameMargins->{{10, 10}, {8, 10}}],
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           TagBox[
            ButtonBox[
             PaneSelectorBox[{False->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpener"]], True->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpenerHot"]]}, Dynamic[
              System`InformationDump`mouseOver$$]],
             Alignment->Left,
             Appearance->{"Default" -> None},
             
             ButtonFunction:>FEPrivate`Set[
              System`InformationDump`open$$, True],
             Evaluator->Automatic,
             FrameMargins->{{9, 0}, {0, 0}},
             ImageMargins->0,
             ImageSize->Full,
             Method->"Preemptive"],
            
            EventHandlerTag[{
             "MouseEntered" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, True], 
              "MouseExited" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, False], 
              Method -> "Preemptive", PassEventsDown -> Automatic, 
              PassEventsUp -> True}]],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], "\[SpanFromLeft]"}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          GrayLevel[0.8], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {Left, Right}, "Rows" -> {{Center}}},
        GridBoxDividers->{
         "Columns" -> {{None}}, "Rows" -> {False, {True}, False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"]}, Dynamic[System`InformationDump`open$$],
      BaselinePosition->Baseline,
      FrameMargins->0,
      ImageSize->Automatic],
     DynamicModuleValues:>{}],
    BaseStyle->"InformationGridFrame",
    StripOnInput->False], "InformationGridPlain",
   StripOnInput->False],
  InformationData[<|
   "ObjectType" -> "Symbol", "Usage" -> 
    "\!\(\*RowBox[{SubscriptBox[StyleBox[\"p\", \"TI\"], StyleBox[\"1\", \"TR\
\"]], \"|\", SubscriptBox[StyleBox[\"p\", \"TI\"], StyleBox[\"2\", \"TR\"]], \
\"|\", StyleBox[\"\[Ellipsis]\", \"TR\"]}]\) is a pattern object that \
represents any of the patterns \!\(\*SubscriptBox[StyleBox[\"p\", \"TI\"], \
StyleBox[\"i\", \"TI\"]]\). ", 
    "Documentation" -> <|
     "Local" -> "paclet:ref/Alternatives", "Web" -> 
      "http://reference.wolfram.com/language/ref/Alternatives.html"|>, 
    "OwnValues" -> None, "UpValues" -> None, "DownValues" -> None, 
    "SubValues" -> None, "DefaultValues" -> None, "NValues" -> None, 
    "FormatValues" -> None, "Options" -> None, "Attributes" -> {Protected}, 
    "FullName" -> "System`Alternatives"|>, True]]], "Output",
 CellChangeTimes->{3.841219847211659*^9, 3.8412199542294903`*^9, 
  3.841220348141769*^9, 3.841228886062312*^9, 3.841230084763767*^9, 
  3.841230194710988*^9, 3.841230263854752*^9, 3.8412489714514503`*^9, 
  3.84124902729089*^9, 3.841249074286662*^9, 3.841255753647707*^9, 
  3.841256488764668*^9, 3.8413110799838533`*^9, 3.8413182694977007`*^9, 
  3.8413220863539658`*^9, 3.841322402527196*^9, 3.841324757536903*^9, 
  3.841324987201683*^9, 3.8413329238043747`*^9, 3.841350163811957*^9, 
  3.8413522372437773`*^9, 3.841403442005086*^9, 3.841405010096795*^9, 
  3.841405364486382*^9, 3.841422364667429*^9, 3.911255353275032*^9, 
  3.911290461160522*^9, 3.9122691077000723`*^9, 3.912546352780977*^9, 
  3.912589071261801*^9, 3.912600350776828*^9, 3.912601705829681*^9, 
  3.915050870995599*^9, 3.9155354569134903`*^9},
 CellLabel->
  "Out[613]=",ExpressionUUID->"ea3c50ab-9c3c-46f1-bd1f-5fb4703687d8"]
}, Open  ]],

Cell["\<\
Our parser transforms a list of tokens and a tree into a new list of tokens \
and a tree. The parser consumes one or more tokens and recursively builds up \
the tree. If there are no tokens, the parser returns the tree. \
\>", "Text",
 CellChangeTimes->{{3.841230489887611*^9, 3.841230577781254*^9}, {
  3.841230619858321*^9, 3.841230651524627*^9}, {3.841311096182732*^9, 
  3.841311109225103*^9}},ExpressionUUID->"abf84e5e-99fd-4ffc-812f-\
1338e8eaa07d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"remToks", "[", "list_List", "]"}], ":=", 
   RowBox[{"First", "@", "list"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"partTree", "[", "list_List", "]"}], ":=", 
    RowBox[{"First", "@", 
     RowBox[{"Rest", "@", "list"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"parse", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", 
      RowBox[{"tree_", ":", "Null"}]}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "tree"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"parse", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"tok", ":", 
         RowBox[{"Alternatives", "@@", 
          RowBox[{"{", 
           RowBox[{
           "\"\<p\>\"", ",", "\"\<q\>\"", ",", "\"\<r\>\"", ",", 
            "\"\<s\>\""}], "}"}]}]}], ",", "toks___"}], "}"}], ",", 
      RowBox[{"tree_", ":", "Null"}]}], "]"}], ":=", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "toks", "}"}], ",", 
      RowBox[{"Proposition", "[", "tok", "]"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"parse", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"tok", ":", 
         RowBox[{"Alternatives", "@@", 
          RowBox[{"{", "\"\<N\>\"", "}"}]}]}], ",", "toks___"}], "}"}], ",", 
      RowBox[{"tree_", ":", "Null"}]}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"R", "=", 
        RowBox[{"parse", "[", 
         RowBox[{"{", "toks", "}"}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"remToks", "@", "R"}], ",", 
        RowBox[{"Unary", "[", 
         RowBox[{"tok", ",", 
          RowBox[{"partTree", "@", "R"}]}], "]"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"parse", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"tok", ":", 
         RowBox[{"Alternatives", "@@", 
          RowBox[{"{", 
           RowBox[{
           "\"\<C\>\"", ",", "\"\<A\>\"", ",", "\"\<K\>\"", ",", 
            "\"\<E\>\""}], "}"}]}]}], ",", "toks___"}], "}"}], ",", 
      RowBox[{"tree_", ":", "Null"}]}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"L", "=", 
        RowBox[{"parse", "[", 
         RowBox[{"{", "toks", "}"}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"R", "=", 
          RowBox[{"parse", "[", 
           RowBox[{"remToks", "@", "L"}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"remToks", "@", "R"}], ",", 
          RowBox[{"Binary", "[", 
           RowBox[{"tok", ",", 
            RowBox[{"partTree", "@", "L"}], ",", 
            RowBox[{"partTree", "@", "R"}]}], "]"}]}], "}"}]}], "]"}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"parse", "[", "xs___", "]"}], ":=", 
   RowBox[{"Throw", "[", 
    RowBox[{"{", 
     RowBox[{"\"\<PARSE: CATASTROPHE: \>\"", ",", " ", "xs"}], "}"}], "]"}]}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.548678989337309*^9, 3.548679165160309*^9}, {
   3.5486791990703087`*^9, 3.548679242156309*^9}, {3.5486793018333087`*^9, 
   3.5486794857303085`*^9}, {3.548679553574309*^9, 3.548679555199309*^9}, {
   3.548679592796309*^9, 3.548679598557309*^9}, {3.5486796363623085`*^9, 
   3.548679678600309*^9}, {3.5486797161103086`*^9, 3.548679742013309*^9}, {
   3.548680000036984*^9, 3.548680087586738*^9}, {3.5486801332753067`*^9, 
   3.548680162381217*^9}, {3.5486801936313415`*^9, 3.54868020911989*^9}, {
   3.548680245865565*^9, 3.548680265092487*^9}, {3.548680295799557*^9, 
   3.548680446628639*^9}, {3.548680497903765*^9, 3.548680640887062*^9}, {
   3.548680673721868*^9, 3.548680895567683*^9}, {3.5486810035821095`*^9, 
   3.54868102836711*^9}, {3.5486811056271095`*^9, 3.548681129804109*^9}, {
   3.548681215526109*^9, 3.548681228125109*^9}, {3.548681459385109*^9, 
   3.548681491552109*^9}, {3.5487590213758907`*^9, 3.548759337873266*^9}, {
   3.5487595254283304`*^9, 3.548759539982419*^9}, {3.548759596781057*^9, 
   3.548759669756459*^9}, {3.548759737957816*^9, 3.5487597558552356`*^9}, {
   3.548759880212311*^9, 3.548759949733311*^9}, {3.548760008885311*^9, 
   3.5487600517133126`*^9}, 3.548760087235311*^9, {3.548760127669311*^9, 
   3.548760187826311*^9}, {3.548760258833312*^9, 3.5487602622553124`*^9}, {
   3.548761377701639*^9, 3.5487613793918085`*^9}, {3.548761964646834*^9, 
   3.548761988606413*^9}, {3.54876672355289*^9, 3.548766725992134*^9}, {
   3.548766759618496*^9, 3.5487668136659*^9}, {3.548771901671317*^9, 
   3.548771917798317*^9}, {3.548791581900611*^9, 3.548791584045734*^9}, {
   3.549013527276035*^9, 3.5490135297967477`*^9}, 3.623845711270899*^9, {
   3.841256779307438*^9, 3.841256781289755*^9}},
 CellLabel->
  "In[614]:=",ExpressionUUID->"b36fbf91-c4c3-4949-a523-5b89941744fb"],

Cell["\<\
Check out the parses of generated sentences by pressing the button below:\
\>", "Text",
 CellChangeTimes->{{3.549361413940937*^9, 
  3.549361427340703*^9}},ExpressionUUID->"afb15955-a826-4a17-8f8f-\
e6bc5572f501"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SeedRandom", "[", "26", "]"}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{"historically", " ", "generated", " ", "bugs"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"gengen", "=", 
     RowBox[{
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"sen", "=", 
          RowBox[{"generateSentence", "[", 
           RowBox[{"iP", ",", "Proposition", ",", "T", ",", "500"}], "]"}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"tpt", "=", 
            RowBox[{"Timing", "@", 
             RowBox[{"partTree", "@", 
              RowBox[{"parse", "@", "sen"}]}]}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"s", "=", 
              RowBox[{
              "expressionStringFromSentence", " ", "@", " ", "sen"}]}], "}"}],
             ",", "\[IndentingNewLine]", 
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"e", "=", 
                RowBox[{"ToExpression", " ", "@", " ", "s"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"With", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"c", "=", "\[IndentingNewLine]", 
                  RowBox[{"Column", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"sen", ",", "s", ",", "e", ",", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"Length", "@", "sen"}], "]"}], "<>", 
                    "\"\< Leaves\>\""}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"ToString", "@", 
                    RowBox[{"tpt", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "*", "Seconds"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"TreeForm", "[", 
                    RowBox[{
                    RowBox[{"tpt", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"VertexLabeling", "\[Rule]", "Automatic"}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"tpt", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}]}], "}"}], 
                ",", "c"}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}], 
      "&"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"DynamicModule", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"foo", "=", 
       RowBox[{"gengen", "[", "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Manipulate", "[", 
      RowBox[{"foo", ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<Gen\>\"", ",", 
         RowBox[{"foo", "=", 
          RowBox[{"gengen", "[", "]"}]}]}], "]"}]}], "]"}]}], "]"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.5412648755202017`*^9, 3.541264934110601*^9}, {
   3.548595021918274*^9, 3.5485950245992737`*^9}, {3.548595073081316*^9, 
   3.5485951249395013`*^9}, {3.548595241094116*^9, 3.548595246492656*^9}, {
   3.548604121147398*^9, 3.54860412337162*^9}, {3.5486684229343243`*^9, 
   3.5486684250207396`*^9}, {3.54867518253305*^9, 3.5486751829410915`*^9}, 
   3.548681759711109*^9, {3.5486821339431076`*^9, 3.548682153660109*^9}, {
   3.548682299021109*^9, 3.548682310877109*^9}, {3.548682367017109*^9, 
   3.548682369804109*^9}, {3.548758715114373*^9, 3.548758786074432*^9}, {
   3.548766843214855*^9, 3.548766847568291*^9}, {3.548781396700361*^9, 
   3.548781441715361*^9}, {3.54879164675432*^9, 3.548791647870384*^9}, {
   3.5487916813062983`*^9, 3.548791713274125*^9}, {3.629584650087736*^9, 
   3.629584695990087*^9}, {3.687638527208827*^9, 3.687638529183337*^9}, {
   3.841213675419433*^9, 3.841213675696472*^9}, {3.841220433197888*^9, 
   3.841220464874787*^9}, {3.841220504989827*^9, 3.841220505291378*^9}, {
   3.841256681831167*^9, 3.841256686704027*^9}, {3.841256728913031*^9, 
   3.841256730749259*^9}, {3.841311173567727*^9, 3.841311179296705*^9}, {
   3.841311238700635*^9, 3.841311240349584*^9}, {3.841405020239756*^9, 
   3.841405026002809*^9}, {3.911291071880518*^9, 3.911291188361698*^9}},
 CellLabel->
  "In[621]:=",ExpressionUUID->"2ee1bf78-47aa-471b-9a1f-e91a436964b6"],

Cell[BoxData[
 DynamicModuleBox[{$CellContext`foo$$ = 
  Column[{{"K", "E", "N", "E", "K", "N", "K", "r", "p", "E", "N", "p", "N", 
     "A", "r", "q", "s", "N", "N", "r", "N", "E", "N", "s", "s"}, 
    "KENEKNKrpENpNArqsNNrNENss", $CellContext`KENEKNKrpENpNArqsNNrNENss, 
    "25 Leaves", "0.00008" $CellContext`Seconds, 
    TreeForm[
     $CellContext`Binary["K", 
      $CellContext`Binary["E", 
       $CellContext`Unary["N", 
        $CellContext`Binary["E", 
         $CellContext`Binary["K", 
          $CellContext`Unary["N", 
           $CellContext`Binary["K", 
            $CellContext`Proposition["r"], 
            $CellContext`Proposition["p"]]], 
          $CellContext`Binary["E", 
           $CellContext`Unary["N", 
            $CellContext`Proposition["p"]], 
           $CellContext`Unary["N", 
            $CellContext`Binary["A", 
             $CellContext`Proposition["r"], 
             $CellContext`Proposition["q"]]]]], 
         $CellContext`Proposition["s"]]], 
       $CellContext`Unary["N", 
        $CellContext`Unary["N", 
         $CellContext`Proposition["r"]]]], 
      $CellContext`Unary["N", 
       $CellContext`Binary["E", 
        $CellContext`Unary["N", 
         $CellContext`Proposition["s"]], 
        $CellContext`Proposition["s"]]]], VertexLabeling -> Automatic], 
    $CellContext`Binary["K", 
     $CellContext`Binary["E", 
      $CellContext`Unary["N", 
       $CellContext`Binary["E", 
        $CellContext`Binary["K", 
         $CellContext`Unary["N", 
          $CellContext`Binary["K", 
           $CellContext`Proposition["r"], 
           $CellContext`Proposition["p"]]], 
         $CellContext`Binary["E", 
          $CellContext`Unary["N", 
           $CellContext`Proposition["p"]], 
          $CellContext`Unary["N", 
           $CellContext`Binary["A", 
            $CellContext`Proposition["r"], 
            $CellContext`Proposition["q"]]]]], 
        $CellContext`Proposition["s"]]], 
      $CellContext`Unary["N", 
       $CellContext`Unary["N", 
        $CellContext`Proposition["r"]]]], 
     $CellContext`Unary["N", 
      $CellContext`Binary["E", 
       $CellContext`Unary["N", 
        $CellContext`Proposition["s"]], 
       $CellContext`Proposition["s"]]]]}, Frame -> All]}, 
  TagBox[
   StyleBox[
    DynamicModuleBox[{Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
     Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
     1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{
       Hold[
        Button[
        "Gen", $CellContext`foo$$ = (
          With[{$CellContext`sen = \
$CellContext`generateSentence[$CellContext`iP, $CellContext`Proposition, \
$CellContext`T, 500]}, 
           With[{$CellContext`tpt = Timing[
               $CellContext`partTree[
                $CellContext`parse[$CellContext`sen]]]}, 
            
            With[{$CellContext`s = \
$CellContext`expressionStringFromSentence[$CellContext`sen]}, 
             With[{$CellContext`e = ToExpression[$CellContext`s]}, 
              
              With[{$CellContext`c = 
                Column[{$CellContext`sen, $CellContext`s, $CellContext`e, 
                   ToString[
                    Length[$CellContext`sen]] <> " Leaves", ToString[
                    Part[$CellContext`tpt, 1]] $CellContext`Seconds, 
                   TreeForm[
                    Part[$CellContext`tpt, 2], VertexLabeling -> Automatic], 
                   Part[$CellContext`tpt, 2]}, Frame -> 
                  All]}, $CellContext`c]]]]]& )[]]], 
       Manipulate`Dump`ThisIsNotAControl, ControlType -> None}}, 
     Typeset`size$$ = {1439., {214.7010498046875, 223.2989501953125}}, 
     Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = True}, 
     DynamicBox[Manipulate`ManipulateBoxes[
      1, StandardForm, "Variables" :> {}, "ControllerVariables" :> {}, 
       "OtherVariables" :> {
        Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
         Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
         Typeset`specs$$, Typeset`size$$, Typeset`update$$, 
         Typeset`initDone$$, Typeset`skipInitDone$$}, 
       "Body" :> $CellContext`foo$$, "Specifications" :> {
         Button[
         "Gen", $CellContext`foo$$ = (
           With[{$CellContext`sen = \
$CellContext`generateSentence[$CellContext`iP, $CellContext`Proposition, \
$CellContext`T, 500]}, 
            With[{$CellContext`tpt = Timing[
                $CellContext`partTree[
                 $CellContext`parse[$CellContext`sen]]]}, 
             
             With[{$CellContext`s = \
$CellContext`expressionStringFromSentence[$CellContext`sen]}, 
              With[{$CellContext`e = ToExpression[$CellContext`s]}, 
               
               With[{$CellContext`c = 
                 Column[{$CellContext`sen, $CellContext`s, $CellContext`e, 
                    ToString[
                    Length[$CellContext`sen]] <> " Leaves", ToString[
                    Part[$CellContext`tpt, 1]] $CellContext`Seconds, 
                    TreeForm[
                    Part[$CellContext`tpt, 2], VertexLabeling -> Automatic], 
                    Part[$CellContext`tpt, 2]}, Frame -> 
                   All]}, $CellContext`c]]]]]& )[]]}, "Options" :> {}, 
       "DefaultOptions" :> {}],
      ImageSizeCache->{1505., {284., 293.}},
      SingleEvaluation->True],
     Deinitialization:>None,
     DynamicModuleValues:>{},
     SynchronousInitialization->True,
     UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
     UnsavedVariables:>{Typeset`initDone$$},
     UntrackedVariables:>{Typeset`size$$}], "Manipulate",
    Deployed->True,
    StripOnInput->False],
   Manipulate`InterpretManipulate[1]],
  DynamicModuleValues:>{}]], "Output",
 CellChangeTimes->{3.911291189492334*^9, 3.912269122970717*^9, 
  3.912269224041074*^9, 3.912546352816845*^9, 3.912589071286354*^9, 
  3.912600350797895*^9, 3.912601705846183*^9, 3.9150508710122833`*^9, 
  3.9155354569325314`*^9},
 CellLabel->
  "Out[622]=",ExpressionUUID->"7a82aaa7-6686-4623-9f87-b18782ae9c5a"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["DATA-DRIVEN PARSING", "Section",
 CellChangeTimes->{{3.5486819478251095`*^9, 3.548681952882109*^9}, {
  3.548758326382139*^9, 
  3.5487583300153465`*^9}},ExpressionUUID->"d92ffcbc-9f80-4bef-bc3e-\
c04e4499c54a"],

Cell[TextData[{
 "Can we write ",
 StyleBox["parserFromGrammar",
  FontSlant->"Italic"],
 ", a function that writes a parser from a grammar? We want such a thing \
because (1) it saves us work and (2) it\[CloseCurlyQuote]s reusable on any \
PPF grammar."
}], "Text",
 CellChangeTimes->{{3.548755438039005*^9, 3.548755477067683*^9}, {
  3.5487555092723417`*^9, 3.548755543793695*^9}, {3.548762506442221*^9, 
  3.548762553286906*^9}, {3.549361448425909*^9, 3.5493614546212635`*^9}, {
  3.912599705221927*^9, 3.912599705645424*^9}, {3.912600166592372*^9, 
  3.912600190889402*^9}},ExpressionUUID->"524e96a9-af81-44bd-ad9b-\
48f2386f9495"],

Cell["\<\
Here is a parser generator that will work on any PPF grammar, without \
left-recursion, of fixed-arity prefix forms.\
\>", "Text",
 CellChangeTimes->{{3.548762856688242*^9, 3.5487629211676893`*^9}, 
   3.549361468605064*^9, 3.645656069714648*^9, {3.841220551678124*^9, 
   3.841220554222797*^9}, {3.841311363879964*^9, 3.841311408073179*^9}, {
   3.84140509485247*^9, 3.841405105874873*^9}, {3.912599723032269*^9, 
   3.9125997444508247`*^9}, {3.9126001971268992`*^9, 3.912600235636901*^9}, {
   3.9150530195033617`*^9, 
   3.915053021882824*^9}},ExpressionUUID->"f60a7c78-847c-46bd-9552-\
2906164d5936"],

Cell["Inspect a grammar", "Text",
 CellChangeTimes->{{3.548762588766453*^9, 
  3.548762593414918*^9}},ExpressionUUID->"3e16c00a-bd9d-497c-a778-\
a97c11c9d4b7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"DownValues", "[", "P", "]"}], "//", "TableForm"}]], "Input",
 CellChangeTimes->{{3.548762559951572*^9, 3.5487625668232584`*^9}, {
  3.5487630130858803`*^9, 3.548763015045077*^9}, {3.62384938602829*^9, 
  3.623849420254168*^9}},
 CellLabel->
  "In[623]:=",ExpressionUUID->"80672418-2dc1-4b80-b419-c850f8d30180"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       RowBox[{"HoldPattern", "[", 
        RowBox[{"P", "[", "Binary", "]"}], "]"}], "\[RuleDelayed]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\<\"C\"\>", ",", "WFF", ",", "WFF"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\<\"A\"\>", ",", "WFF", ",", "WFF"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\<\"K\"\>", ",", "WFF", ",", "WFF"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\<\"E\"\>", ",", "WFF", ",", "WFF"}], "}"}]}], "}"}]}]},
     {
      RowBox[{
       RowBox[{"HoldPattern", "[", 
        RowBox[{"P", "[", "Proposition", "]"}], "]"}], "\[RuleDelayed]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "\<\"p\"\>", "}"}], ",", 
         RowBox[{"{", "\<\"q\"\>", "}"}], ",", 
         RowBox[{"{", "\<\"r\"\>", "}"}], ",", 
         RowBox[{"{", "\<\"s\"\>", "}"}]}], "}"}]}]},
     {
      RowBox[{
       RowBox[{"HoldPattern", "[", 
        RowBox[{"P", "[", "Start", "]"}], "]"}], "\[RuleDelayed]", 
       RowBox[{"{", 
        RowBox[{"{", "WFF", "}"}], "}"}]}]},
     {
      RowBox[{
       RowBox[{"HoldPattern", "[", 
        RowBox[{"P", "[", "Unary", "]"}], "]"}], "\[RuleDelayed]", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"\<\"N\"\>", ",", "WFF"}], "}"}], "}"}]}]},
     {
      RowBox[{
       RowBox[{"HoldPattern", "[", 
        RowBox[{"P", "[", "WFF", "]"}], "]"}], "\[RuleDelayed]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "Proposition", "}"}], ",", 
         RowBox[{"{", "Unary", "}"}], ",", 
         RowBox[{"{", "Binary", "}"}]}], "}"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.9126017059136677`*^9, 3.9150508710709887`*^9, 
  3.915535456994869*^9},
 CellLabel->
  "Out[623]//TableForm=",ExpressionUUID->"bd892b8a-dfca-426f-8504-\
e4d959ff6272"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
prefix, 
suffix, 
terminalsFromRule, 
nonTerminalHeadFromRule, 
arityFromPrefixRule\
\>", "Subsection",
 CellChangeTimes->{{3.548762617479324*^9, 3.548762630336609*^9}, {
  3.548765860793623*^9, 3.548765868259369*^9}, {3.5490189989361715`*^9, 
  3.5490190341765385`*^9}},ExpressionUUID->"36e32a9d-5bcc-4960-b4fd-\
405da8b8b783"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ClearAll", "[", "\[IndentingNewLine]", 
   RowBox[{
   "prefix", ",", "suffix", ",", "\[IndentingNewLine]", "terminalsFromRule", 
    ",", "\[IndentingNewLine]", "nonTerminalHeadFromRule", ",", 
    "\[IndentingNewLine]", "arityFromPrefixRule"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.5487629341629887`*^9, 3.548762939064479*^9}, {
  3.548763004604033*^9, 3.5487630093645086`*^9}, {3.5487635846270285`*^9, 
  3.548763628755441*^9}, {3.548763659085474*^9, 3.548763717217286*^9}, {
  3.5487637576023264`*^9, 3.5487637693555*^9}, {3.5487638266782317`*^9, 
  3.548763948330398*^9}, {3.548764013751937*^9, 3.548764030776639*^9}, {
  3.5487640706826296`*^9, 3.548764170128574*^9}, {3.54876421249281*^9, 
  3.548764212763836*^9}, {3.548764743316886*^9, 3.54876488986354*^9}, {
  3.548765687999345*^9, 3.5487658401675606`*^9}, {3.5487823848683596`*^9, 
  3.54878239617236*^9}, {3.623409924055402*^9, 3.62340992582513*^9}},
 CellLabel->
  "In[624]:=",ExpressionUUID->"aebe5819-f0cb-456b-89e3-74f23ecda387"],

Cell[BoxData[
 RowBox[{
  RowBox[{"prefix", "=", "First"}], ";", 
  RowBox[{"suffix", "=", "Rest"}], ";"}]], "Input",
 CellChangeTimes->{{3.5487629341629887`*^9, 3.548762939064479*^9}, {
   3.548763004604033*^9, 3.5487630093645086`*^9}, {3.5487635846270285`*^9, 
   3.548763628755441*^9}, {3.548763659085474*^9, 3.548763717217286*^9}, {
   3.5487637576023264`*^9, 3.5487637693555*^9}, {3.5487638266782317`*^9, 
   3.548763948330398*^9}, {3.548764013751937*^9, 3.548764030776639*^9}, {
   3.5487640706826296`*^9, 3.548764170128574*^9}, {3.54876421249281*^9, 
   3.548764212763836*^9}, {3.548764743316886*^9, 3.54876488986354*^9}, {
   3.548765687999345*^9, 3.5487658401675606`*^9}, {3.5487823848683596`*^9, 
   3.54878239617236*^9}, 3.623409924055402*^9, {3.62388740399349*^9, 
   3.623887406767249*^9}},
 CellLabel->
  "In[625]:=",ExpressionUUID->"3301b22c-c588-42ac-b72f-f878b5fc808c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"terminalsFromRule", "[", 
    RowBox[{"rule_", ",", "nonTerminals_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"prefix", "/@", 
      RowBox[{"rule", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"!", 
       RowBox[{"MemberQ", "[", 
        RowBox[{"nonTerminals", ",", "#"}], "]"}]}], "&"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.5487629341629887`*^9, 3.548762939064479*^9}, {
   3.548763004604033*^9, 3.5487630093645086`*^9}, {3.5487635846270285`*^9, 
   3.548763628755441*^9}, {3.548763659085474*^9, 3.548763717217286*^9}, {
   3.5487637576023264`*^9, 3.5487637693555*^9}, {3.5487638266782317`*^9, 
   3.548763948330398*^9}, {3.548764013751937*^9, 3.548764030776639*^9}, {
   3.5487640706826296`*^9, 3.548764170128574*^9}, {3.54876421249281*^9, 
   3.548764212763836*^9}, {3.548764743316886*^9, 3.54876488986354*^9}, {
   3.548765687999345*^9, 3.5487658401675606`*^9}, {3.5487823848683596`*^9, 
   3.54878239617236*^9}, 3.623409924055402*^9, {3.62388740399349*^9, 
   3.623887413492853*^9}},
 CellLabel->
  "In[626]:=",ExpressionUUID->"1d4628ef-36f8-4b95-9e63-545e84460510"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"nonTerminalHeadFromRule", "[", 
    RowBox[{"rule_", ",", "nonTerminals_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"h", "=", 
       RowBox[{"rule", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"nonTerminals", ",", "h"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Throw", "[", 
         RowBox[{"{", 
          RowBox[{
          "\"\<NON-TERMINAL HEAD FROM RULE: CATASTROPHE\>\"", ",", " ", 
           "nonTerminals", ",", " ", "h"}], "}"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "h"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5487629341629887`*^9, 3.548762939064479*^9}, {
   3.548763004604033*^9, 3.5487630093645086`*^9}, {3.5487635846270285`*^9, 
   3.548763628755441*^9}, {3.548763659085474*^9, 3.548763717217286*^9}, {
   3.5487637576023264`*^9, 3.5487637693555*^9}, {3.5487638266782317`*^9, 
   3.548763948330398*^9}, {3.548764013751937*^9, 3.548764030776639*^9}, {
   3.5487640706826296`*^9, 3.548764170128574*^9}, {3.54876421249281*^9, 
   3.548764212763836*^9}, {3.548764743316886*^9, 3.54876488986354*^9}, {
   3.548765687999345*^9, 3.5487658401675606`*^9}, {3.5487823848683596`*^9, 
   3.54878239617236*^9}, 3.623409924055402*^9, {3.62388740399349*^9, 
   3.623887423107332*^9}, 3.8413114816780643`*^9},
 CellLabel->
  "In[627]:=",ExpressionUUID->"24deb93c-24d8-4cab-9b18-60d4bf2be014"],

Cell[BoxData[
 RowBox[{
  RowBox[{"arityFromPrefixRule", "[", "rule_", "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"lens", "=", 
      RowBox[{"Union", "[", 
       RowBox[{"Length", "/@", 
        RowBox[{"suffix", "/@", 
         RowBox[{"rule", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", "lens"}], ">", "1"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Throw", "[", 
        RowBox[{"{", 
         RowBox[{"\"\<ARITY FROM PREFIX RULE: CATASTROPHE\>\"", ",", "lens"}],
          "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"First", "@", "lens"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5487629341629887`*^9, 3.548762939064479*^9}, {
   3.548763004604033*^9, 3.5487630093645086`*^9}, {3.5487635846270285`*^9, 
   3.548763628755441*^9}, {3.548763659085474*^9, 3.548763717217286*^9}, {
   3.5487637576023264`*^9, 3.5487637693555*^9}, {3.5487638266782317`*^9, 
   3.548763948330398*^9}, {3.548764013751937*^9, 3.548764030776639*^9}, {
   3.5487640706826296`*^9, 3.548764170128574*^9}, {3.54876421249281*^9, 
   3.548764212763836*^9}, {3.548764743316886*^9, 3.54876488986354*^9}, {
   3.548765687999345*^9, 3.5487658401675606`*^9}, {3.5487823848683596`*^9, 
   3.54878239617236*^9}, 3.623409924055402*^9, {3.62388740399349*^9, 
   3.623887423107332*^9}},
 CellLabel->
  "In[628]:=",ExpressionUUID->"792ce188-984a-4908-a965-4b0f6e4c07f5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["genParserBody, parserDefFromGrammarRule", "Subsection",
 CellChangeTimes->{{3.549018840645653*^9, 3.549018849365039*^9}, 
   3.549019072170439*^9},ExpressionUUID->"3e07325c-6177-4ccc-8d67-\
8e39374cdc37"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"genParserBody", ",", "parserDefFromGrammarRule"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.548764255192079*^9, 3.54876428810037*^9}, {
   3.548764554706027*^9, 3.54876465464002*^9}, {3.548766015798121*^9, 
   3.548766041541696*^9}, {3.548766113128854*^9, 3.5487662587504163`*^9}, {
   3.548766354306969*^9, 3.548766372248763*^9}, {3.548766419098448*^9, 
   3.548766548177354*^9}, {3.54876660743628*^9, 3.5487666483503723`*^9}, {
   3.548767035927368*^9, 3.548767043084221*^9}, {3.5487670750806675`*^9, 
   3.548767108033076*^9}, {3.54876714075253*^9, 3.5487671500136776`*^9}, {
   3.548767195010677*^9, 3.548767259594757*^9}, {3.548767368398992*^9, 
   3.54876752142638*^9}, {3.5487676461037607`*^9, 3.548767870232761*^9}, {
   3.5487679442047606`*^9, 3.54876802408976*^9}, {3.54876814935576*^9, 
   3.54876816371876*^9}, {3.54876820329676*^9, 3.5487682305897603`*^9}, {
   3.54877144842099*^9, 3.5487714494108906`*^9}, {3.548771504507381*^9, 
   3.5487715052513084`*^9}, {3.548771668858944*^9, 3.548771715083321*^9}, {
   3.548771746280317*^9, 3.548771752079317*^9}, {3.548771798253317*^9, 
   3.548771864978317*^9}, {3.548772022707317*^9, 3.548772066840317*^9}, {
   3.548772413135317*^9, 3.548772415406317*^9}, 3.548772519258317*^9, {
   3.548772841491317*^9, 3.548772843065317*^9}, {3.548772922161174*^9, 
   3.54877294821778*^9}, {3.5487730058785443`*^9, 3.548773128383794*^9}, {
   3.548773209302885*^9, 3.548773222907245*^9}, {3.548773271710125*^9, 
   3.5487732724542*^9}, {3.548773330487002*^9, 3.548773350110965*^9}, {
   3.548773448843837*^9, 3.548773452019154*^9}, {3.548773682257176*^9, 
   3.548773715281478*^9}, {3.548773748186768*^9, 3.548773751123061*^9}, {
   3.548773845156464*^9, 3.548773845354484*^9}, {3.548773885066455*^9, 
   3.548773885705519*^9}, {3.548773925793707*^9, 3.5487739426977086`*^9}, {
   3.5487742337787066`*^9, 3.548774235997707*^9}, {3.548774299799707*^9, 
   3.548774301023707*^9}, {3.548774331758707*^9, 3.5487743349817066`*^9}, {
   3.5487744302897067`*^9, 3.548774446695707*^9}, {3.548774713499707*^9, 
   3.548774761745708*^9}, {3.5487748199887066`*^9, 3.548774989863577*^9}, {
   3.54877504669126*^9, 3.5487751442630157`*^9}, {3.548775210149604*^9, 
   3.5487752109876876`*^9}, {3.548775247444333*^9, 3.548775247765365*^9}, {
   3.548775610003585*^9, 3.548775617071292*^9}, {3.5487756533529196`*^9, 
   3.5487756821638*^9}, {3.54877573296488*^9, 3.548775764479031*^9}, {
   3.548775852515834*^9, 3.54877588338092*^9}, {3.5487759152871103`*^9, 
   3.5487759200065823`*^9}, {3.5487759761361403`*^9, 3.54877598757314*^9}, {
   3.548776028766141*^9, 3.548776028815141*^9}, {3.548780064862323*^9, 
   3.5487801132121572`*^9}, 3.548780152526089*^9, {3.548780192192055*^9, 
   3.548780194721308*^9}, {3.548780276643499*^9, 3.548780415818415*^9}, {
   3.548780447254559*^9, 3.5487804722370586`*^9}, {3.548780754811311*^9, 
   3.54878078350518*^9}, 3.548781016384466*^9, {3.548782260965361*^9, 
   3.548782264695359*^9}, {3.5487824043103595`*^9, 3.548782406999359*^9}, {
   3.5487825425123615`*^9, 3.54878265237936*^9}, 3.548791775519686*^9, 
   3.548972642585658*^9, {3.5489727072943606`*^9, 3.5489727573192205`*^9}, {
   3.54897295748267*^9, 3.548972962695968*^9}, {3.548973173628033*^9, 
   3.5489731864597664`*^9}, {3.549013568039856*^9, 3.549013571847638*^9}, {
   3.549013683133875*^9, 3.549013699566815*^9}, {3.549018905772961*^9, 
   3.549018923366945*^9}, {3.54901907300368*^9, 3.5490190759598103`*^9}, {
   3.549361555518035*^9, 3.549361557391142*^9}},
 CellLabel->
  "In[629]:=",ExpressionUUID->"353a9312-83d2-46bb-b6c7-62e214743a0e"],

Cell["For arity-0 productions:", "Text",
 CellChangeTimes->{{3.841221266655713*^9, 
  3.841221275974936*^9}},ExpressionUUID->"4f6aafd7-3aeb-4397-99f0-\
80755bc12b18"],

Cell[BoxData[
 RowBox[{
  RowBox[{"genParserBody", "[", 
   RowBox[{
   "0", ",", "tok_", ",", "toks_", ",", "head_", ",", "parts_", ",", 
    "parse_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"{", 
   RowBox[{"toks", ",", 
    RowBox[{"head", "[", 
     RowBox[{"tok", ",", 
      RowBox[{"Sequence", "@@", "parts"}]}], "]"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.548764255192079*^9, 3.54876428810037*^9}, {
   3.548764554706027*^9, 3.54876465464002*^9}, {3.548766015798121*^9, 
   3.548766041541696*^9}, {3.548766113128854*^9, 3.5487662587504163`*^9}, {
   3.548766354306969*^9, 3.548766372248763*^9}, {3.548766419098448*^9, 
   3.548766548177354*^9}, {3.54876660743628*^9, 3.5487666483503723`*^9}, {
   3.548767035927368*^9, 3.548767043084221*^9}, {3.5487670750806675`*^9, 
   3.548767108033076*^9}, {3.54876714075253*^9, 3.5487671500136776`*^9}, {
   3.548767195010677*^9, 3.548767259594757*^9}, {3.548767368398992*^9, 
   3.54876752142638*^9}, {3.5487676461037607`*^9, 3.548767870232761*^9}, {
   3.5487679442047606`*^9, 3.54876802408976*^9}, {3.54876814935576*^9, 
   3.54876816371876*^9}, {3.54876820329676*^9, 3.5487682305897603`*^9}, {
   3.54877144842099*^9, 3.5487714494108906`*^9}, {3.548771504507381*^9, 
   3.5487715052513084`*^9}, {3.548771668858944*^9, 3.548771715083321*^9}, {
   3.548771746280317*^9, 3.548771752079317*^9}, {3.548771798253317*^9, 
   3.548771864978317*^9}, {3.548772022707317*^9, 3.548772066840317*^9}, {
   3.548772413135317*^9, 3.548772415406317*^9}, 3.548772519258317*^9, {
   3.548772841491317*^9, 3.548772843065317*^9}, {3.548772922161174*^9, 
   3.54877294821778*^9}, {3.5487730058785443`*^9, 3.548773128383794*^9}, {
   3.548773209302885*^9, 3.548773222907245*^9}, {3.548773271710125*^9, 
   3.5487732724542*^9}, {3.548773330487002*^9, 3.548773350110965*^9}, {
   3.548773448843837*^9, 3.548773452019154*^9}, {3.548773682257176*^9, 
   3.548773715281478*^9}, {3.548773748186768*^9, 3.548773751123061*^9}, {
   3.548773845156464*^9, 3.548773845354484*^9}, {3.548773885066455*^9, 
   3.548773885705519*^9}, {3.548773925793707*^9, 3.5487739426977086`*^9}, {
   3.5487742337787066`*^9, 3.548774235997707*^9}, {3.548774299799707*^9, 
   3.548774301023707*^9}, {3.548774331758707*^9, 3.5487743349817066`*^9}, {
   3.5487744302897067`*^9, 3.548774446695707*^9}, {3.548774713499707*^9, 
   3.548774761745708*^9}, {3.5487748199887066`*^9, 3.548774989863577*^9}, {
   3.54877504669126*^9, 3.5487751442630157`*^9}, {3.548775210149604*^9, 
   3.5487752109876876`*^9}, {3.548775247444333*^9, 3.548775247765365*^9}, {
   3.548775610003585*^9, 3.548775617071292*^9}, {3.5487756533529196`*^9, 
   3.5487756821638*^9}, {3.54877573296488*^9, 3.548775764479031*^9}, {
   3.548775852515834*^9, 3.54877588338092*^9}, {3.5487759152871103`*^9, 
   3.5487759200065823`*^9}, {3.5487759761361403`*^9, 3.54877598757314*^9}, {
   3.548776028766141*^9, 3.548776028815141*^9}, {3.548780064862323*^9, 
   3.5487801132121572`*^9}, 3.548780152526089*^9, {3.548780192192055*^9, 
   3.548780194721308*^9}, {3.548780276643499*^9, 3.548780415818415*^9}, {
   3.548780447254559*^9, 3.5487804722370586`*^9}, {3.548780754811311*^9, 
   3.54878078350518*^9}, 3.548781016384466*^9, {3.548782260965361*^9, 
   3.548782264695359*^9}, {3.5487824043103595`*^9, 3.548782406999359*^9}, {
   3.5487825425123615`*^9, 3.54878265237936*^9}, 3.548791775519686*^9, 
   3.548972642585658*^9, {3.5489727072943606`*^9, 3.5489727573192205`*^9}, {
   3.54897295748267*^9, 3.548972962695968*^9}, {3.548973173628033*^9, 
   3.5489731864597664`*^9}, {3.549013568039856*^9, 3.549013571847638*^9}, {
   3.549013683133875*^9, 3.549013699566815*^9}, {3.549018905772961*^9, 
   3.549018923366945*^9}, {3.54901907300368*^9, 3.5490190759598103`*^9}, {
   3.549361555518035*^9, 3.549361561773394*^9}},
 CellLabel->
  "In[630]:=",ExpressionUUID->"345fb820-3dde-4a95-b0cc-7b9702ce6e5d"],

Cell["Recurse for productions with right-hand sides", "Text",
 CellChangeTimes->{{3.8412212877888827`*^9, 3.8412213059395742`*^9}, {
  3.912599912959661*^9, 
  3.912599914843739*^9}},ExpressionUUID->"7feadf99-fc45-4efb-b558-\
76eb9d6eb4c5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"genParserBody", "[", 
   RowBox[{
    RowBox[{"arity_", "?", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"#", ">", "0"}], "&"}], ")"}]}], ",", "tok_", ",", "toks_", 
    ",", "head_", ",", "parts_", ",", "parse_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"rec", "=", 
      RowBox[{"parse", "[", "toks", "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"genParserBody", "[", 
     RowBox[{
      RowBox[{"arity", "-", "1"}], ",", "tok", ",", 
      RowBox[{"remToks", "@", "rec"}], ",", "\[IndentingNewLine]", "head", 
      ",", 
      RowBox[{"Join", "[", 
       RowBox[{"parts", ",", 
        RowBox[{"{", 
         RowBox[{"partTree", "@", "rec"}], "}"}]}], "]"}], ",", "parse"}], 
     "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.548764255192079*^9, 3.54876428810037*^9}, {
   3.548764554706027*^9, 3.54876465464002*^9}, {3.548766015798121*^9, 
   3.548766041541696*^9}, {3.548766113128854*^9, 3.5487662587504163`*^9}, {
   3.548766354306969*^9, 3.548766372248763*^9}, {3.548766419098448*^9, 
   3.548766548177354*^9}, {3.54876660743628*^9, 3.5487666483503723`*^9}, {
   3.548767035927368*^9, 3.548767043084221*^9}, {3.5487670750806675`*^9, 
   3.548767108033076*^9}, {3.54876714075253*^9, 3.5487671500136776`*^9}, {
   3.548767195010677*^9, 3.548767259594757*^9}, {3.548767368398992*^9, 
   3.54876752142638*^9}, {3.5487676461037607`*^9, 3.548767870232761*^9}, {
   3.5487679442047606`*^9, 3.54876802408976*^9}, {3.54876814935576*^9, 
   3.54876816371876*^9}, {3.54876820329676*^9, 3.5487682305897603`*^9}, {
   3.54877144842099*^9, 3.5487714494108906`*^9}, {3.548771504507381*^9, 
   3.5487715052513084`*^9}, {3.548771668858944*^9, 3.548771715083321*^9}, {
   3.548771746280317*^9, 3.548771752079317*^9}, {3.548771798253317*^9, 
   3.548771864978317*^9}, {3.548772022707317*^9, 3.548772066840317*^9}, {
   3.548772413135317*^9, 3.548772415406317*^9}, 3.548772519258317*^9, {
   3.548772841491317*^9, 3.548772843065317*^9}, {3.548772922161174*^9, 
   3.54877294821778*^9}, {3.5487730058785443`*^9, 3.548773128383794*^9}, {
   3.548773209302885*^9, 3.548773222907245*^9}, {3.548773271710125*^9, 
   3.5487732724542*^9}, {3.548773330487002*^9, 3.548773350110965*^9}, {
   3.548773448843837*^9, 3.548773452019154*^9}, {3.548773682257176*^9, 
   3.548773715281478*^9}, {3.548773748186768*^9, 3.548773751123061*^9}, {
   3.548773845156464*^9, 3.548773845354484*^9}, {3.548773885066455*^9, 
   3.548773885705519*^9}, {3.548773925793707*^9, 3.5487739426977086`*^9}, {
   3.5487742337787066`*^9, 3.548774235997707*^9}, {3.548774299799707*^9, 
   3.548774301023707*^9}, {3.548774331758707*^9, 3.5487743349817066`*^9}, {
   3.5487744302897067`*^9, 3.548774446695707*^9}, {3.548774713499707*^9, 
   3.548774761745708*^9}, {3.5487748199887066`*^9, 3.548774989863577*^9}, {
   3.54877504669126*^9, 3.5487751442630157`*^9}, {3.548775210149604*^9, 
   3.5487752109876876`*^9}, {3.548775247444333*^9, 3.548775247765365*^9}, {
   3.548775610003585*^9, 3.548775617071292*^9}, {3.5487756533529196`*^9, 
   3.5487756821638*^9}, {3.54877573296488*^9, 3.548775764479031*^9}, {
   3.548775852515834*^9, 3.54877588338092*^9}, {3.5487759152871103`*^9, 
   3.5487759200065823`*^9}, {3.5487759761361403`*^9, 3.54877598757314*^9}, {
   3.548776028766141*^9, 3.548776028815141*^9}, {3.548780064862323*^9, 
   3.5487801132121572`*^9}, 3.548780152526089*^9, {3.548780192192055*^9, 
   3.548780194721308*^9}, {3.548780276643499*^9, 3.548780415818415*^9}, {
   3.548780447254559*^9, 3.5487804722370586`*^9}, {3.548780754811311*^9, 
   3.54878078350518*^9}, 3.548781016384466*^9, {3.548782260965361*^9, 
   3.548782264695359*^9}, {3.5487824043103595`*^9, 3.548782406999359*^9}, {
   3.5487825425123615`*^9, 3.54878265237936*^9}, 3.548791775519686*^9, 
   3.548972642585658*^9, {3.5489727072943606`*^9, 3.5489727573192205`*^9}, {
   3.54897295748267*^9, 3.548972962695968*^9}, {3.548973173628033*^9, 
   3.5489731864597664`*^9}, {3.549013568039856*^9, 3.549013571847638*^9}, {
   3.549013683133875*^9, 3.549013699566815*^9}, {3.549018905772961*^9, 
   3.549018923366945*^9}, {3.54901907300368*^9, 3.5490190759598103`*^9}, {
   3.549361555518035*^9, 3.549361564501549*^9}, {3.84122062885121*^9, 
   3.8412206556264*^9}, 3.841221253896816*^9, {3.841311579570304*^9, 
   3.841311590250588*^9}},
 CellLabel->
  "In[631]:=",ExpressionUUID->"876773fd-7a70-4239-b947-a10b5bfd96ee"],

Cell[TextData[{
 "Accumulate overloads of ",
 StyleBox["parserTargetSym",
  FontSlant->"Italic"],
 ": for each set of terminals in a rule, write a ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " pattern to recognize those ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " Alternatives (\[OpenCurlyDoubleQuote]firstPattern\[CloseCurlyDoubleQuote] \
below). "
}], "Text",
 CellChangeTimes->{{3.841311712705439*^9, 3.841311790829403*^9}, {
  3.8413119076885633`*^9, 3.841311915040742*^9}, {3.841316524431582*^9, 
  3.841316622006033*^9}},ExpressionUUID->"ecdf866c-dffd-4766-b2c2-\
930a04c91e33"],

Cell[BoxData[
 RowBox[{
  RowBox[{"parserDefFromGrammarRule", "[", 
   RowBox[{"parserTargetSym_", ",", "rule_", ",", "nonTerminals_"}], "]"}], ":=",
   "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"tok", ",", "toks", ",", "tree", ",", "parts", ",", "xs"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ts", "=", 
          RowBox[{"terminalsFromRule", "[", 
           RowBox[{"rule", ",", "nonTerminals"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"h", "=", 
          RowBox[{"nonTerminalHeadFromRule", "[", 
           RowBox[{"rule", ",", "nonTerminals"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"a", "=", 
          RowBox[{"arityFromPrefixRule", "[", "rule", "]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", "ts"}], "=!=", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", "then", " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"firstPattern", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"tok", ":", 
                 RowBox[{"Alternatives", "@@", "ts"}]}], ",", "toks___"}], 
               "}"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"secondPattern", "=", 
              RowBox[{"tree_", ":", "Null"}]}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{"perform", " ", "the", " ", "def", " ", "in"}], "-", 
             RowBox[{"place", " ", "by", " ", "side"}], "-", 
             RowBox[{
             "effect", " ", "on", " ", "the", " ", "given", " ", "symbol"}]}],
             " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"parserTargetSym", "[", 
             RowBox[{"firstPattern", ",", "secondPattern"}], "]"}], ":=", 
            "\[IndentingNewLine]", 
            RowBox[{
             StyleBox["genParserBody",
              Background->RGBColor[1, 0.85, 0.85]], "[", 
             RowBox[{"a", ",", "tok", ",", 
              RowBox[{"{", "toks", "}"}], ",", "h", ",", 
              RowBox[{"{", "}"}], ",", "parserTargetSym"}], "]"}]}]}], "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", "else", " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"parserTargetSym", "[", 
           RowBox[{
            RowBox[{"{", "}"}], ",", 
            RowBox[{"tree_", ":", "Null"}]}], "]"}], ":=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "}"}], ",", "tree"}], "}"}]}]}], "]"}]}], "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"parserTargetSym", "[", "xs___", "]"}], ":=", 
      RowBox[{"Throw", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"ToString", "@", "parserTargetSym"}], "<>", 
          "\"\<: CATASTROPHE: \>\""}], ",", "xs"}], "}"}], "]"}]}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.548764255192079*^9, 3.54876428810037*^9}, {
   3.548764554706027*^9, 3.54876465464002*^9}, {3.548766015798121*^9, 
   3.548766041541696*^9}, {3.548766113128854*^9, 3.5487662587504163`*^9}, {
   3.548766354306969*^9, 3.548766372248763*^9}, {3.548766419098448*^9, 
   3.548766548177354*^9}, {3.54876660743628*^9, 3.5487666483503723`*^9}, {
   3.548767035927368*^9, 3.548767043084221*^9}, {3.5487670750806675`*^9, 
   3.548767108033076*^9}, {3.54876714075253*^9, 3.5487671500136776`*^9}, {
   3.548767195010677*^9, 3.548767259594757*^9}, {3.548767368398992*^9, 
   3.54876752142638*^9}, {3.5487676461037607`*^9, 3.548767870232761*^9}, {
   3.5487679442047606`*^9, 3.54876802408976*^9}, {3.54876814935576*^9, 
   3.54876816371876*^9}, {3.54876820329676*^9, 3.5487682305897603`*^9}, {
   3.54877144842099*^9, 3.5487714494108906`*^9}, {3.548771504507381*^9, 
   3.5487715052513084`*^9}, {3.548771668858944*^9, 3.548771715083321*^9}, {
   3.548771746280317*^9, 3.548771752079317*^9}, {3.548771798253317*^9, 
   3.548771864978317*^9}, {3.548772022707317*^9, 3.548772066840317*^9}, {
   3.548772413135317*^9, 3.548772415406317*^9}, 3.548772519258317*^9, {
   3.548772841491317*^9, 3.548772843065317*^9}, {3.548772922161174*^9, 
   3.54877294821778*^9}, {3.5487730058785443`*^9, 3.548773128383794*^9}, {
   3.548773209302885*^9, 3.548773222907245*^9}, {3.548773271710125*^9, 
   3.5487732724542*^9}, {3.548773330487002*^9, 3.548773350110965*^9}, {
   3.548773448843837*^9, 3.548773452019154*^9}, {3.548773682257176*^9, 
   3.548773715281478*^9}, {3.548773748186768*^9, 3.548773751123061*^9}, {
   3.548773845156464*^9, 3.548773845354484*^9}, {3.548773885066455*^9, 
   3.548773885705519*^9}, {3.548773925793707*^9, 3.5487739426977086`*^9}, {
   3.5487742337787066`*^9, 3.548774235997707*^9}, {3.548774299799707*^9, 
   3.548774301023707*^9}, {3.548774331758707*^9, 3.5487743349817066`*^9}, {
   3.5487744302897067`*^9, 3.548774446695707*^9}, {3.548774713499707*^9, 
   3.548774761745708*^9}, {3.5487748199887066`*^9, 3.548774989863577*^9}, {
   3.54877504669126*^9, 3.5487751442630157`*^9}, {3.548775210149604*^9, 
   3.5487752109876876`*^9}, {3.548775247444333*^9, 3.548775247765365*^9}, {
   3.548775610003585*^9, 3.548775617071292*^9}, {3.5487756533529196`*^9, 
   3.5487756821638*^9}, {3.54877573296488*^9, 3.548775764479031*^9}, {
   3.548775852515834*^9, 3.54877588338092*^9}, {3.5487759152871103`*^9, 
   3.5487759200065823`*^9}, {3.5487759761361403`*^9, 3.54877598757314*^9}, {
   3.548776028766141*^9, 3.548776028815141*^9}, {3.548780064862323*^9, 
   3.5487801132121572`*^9}, 3.548780152526089*^9, {3.548780192192055*^9, 
   3.548780194721308*^9}, {3.548780276643499*^9, 3.548780415818415*^9}, {
   3.548780447254559*^9, 3.5487804722370586`*^9}, {3.548780754811311*^9, 
   3.54878078350518*^9}, 3.548781016384466*^9, {3.548782260965361*^9, 
   3.548782264695359*^9}, {3.5487824043103595`*^9, 3.548782406999359*^9}, {
   3.5487825425123615`*^9, 3.54878265237936*^9}, 3.548791775519686*^9, 
   3.548972642585658*^9, {3.5489727072943606`*^9, 3.5489727573192205`*^9}, {
   3.54897295748267*^9, 3.548972962695968*^9}, {3.548973173628033*^9, 
   3.5489731864597664`*^9}, {3.549013568039856*^9, 3.549013571847638*^9}, {
   3.549013683133875*^9, 3.549013699566815*^9}, {3.549018905772961*^9, 
   3.549018923366945*^9}, {3.54901907300368*^9, 3.5490190759598103`*^9}, {
   3.549361555518035*^9, 3.549361564501549*^9}, {3.623887755297329*^9, 
   3.623887766814921*^9}, {3.6238878389077806`*^9, 3.623887861331784*^9}, {
   3.623887899833766*^9, 3.623887908977084*^9}, {3.623887948887939*^9, 
   3.62388796326434*^9}, 3.841228206238839*^9, {3.841316480822844*^9, 
   3.841316507534498*^9}, {3.841392965129376*^9, 3.841392966533388*^9}},
 CellLabel->
  "In[632]:=",ExpressionUUID->"75bc6916-e6f8-4415-8671-3faa870d4c00"],

Cell[TextData[{
 "Build up a parser table from that grammar by side-effecting ",
 StyleBox["parserTable", "Input"],
 "."
}], "Text",
 CellChangeTimes->{{3.841319407252574*^9, 3.841319451262827*^9}, {
  3.84161142006077*^9, 3.841611420982614*^9}, {3.912600294527643*^9, 
  3.912600303435182*^9}},ExpressionUUID->"e672e468-d9ac-4bcd-99e7-\
e4ac08d91933"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "parserPatterns", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"parserPatterns", "[", 
    RowBox[{"grammar_", ",", "parserTable_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Scan", "[", 
    RowBox[{"(*", " ", 
     RowBox[{"side", "-", 
      RowBox[{"effect", " ", "the", " ", "parserTable"}]}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"parserDefFromGrammarRule", "[", 
       RowBox[{"parserTable", ",", "#", ",", 
        RowBox[{"nonTerminalsFromGrammar", "@", "grammar"}]}], "]"}], "&"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"DownValues", "@", "grammar"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.841319189959306*^9, 3.84131929113958*^9}, {
  3.912599996704821*^9, 3.912600004504016*^9}},
 CellLabel->
  "In[633]:=",ExpressionUUID->"313aecf1-7186-4400-ab0f-e5a278ac39f4"],

Cell[TextData[{
 "Ad-hoc symbol, ",
 StyleBox["$parse", "Input"],
 ", for a new machine-generated parser. Build the parser by scanning ",
 StyleBox["parserDefFromGrammarRule",
  FontSlant->"Italic"],
 " over all the rules in the grammar:"
}], "Text",
 CellChangeTimes->{{3.54876804243976*^9, 3.5487680505507603`*^9}, {
  3.623887498344653*^9, 3.623887504014685*^9}, {3.8413119310801773`*^9, 
  3.841311960569578*^9}, {3.9125999691560373`*^9, 3.912599969347486*^9}, {
  3.912600331303931*^9, 
  3.912600334090326*^9}},ExpressionUUID->"fcdd07f7-6174-422f-b8c3-\
b92e5476c9a9"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "$parse", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"parserPatterns", "[", 
   RowBox[{"P", ",", "$parse"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DownValues", "@", "$parse"}], "//", "TableForm"}]}], "Input",
 CellChangeTimes->{{3.841611429272925*^9, 3.84161146686625*^9}},
 CellLabel->
  "In[635]:=",ExpressionUUID->"8ecc70b8-cd1c-4858-8431-212bdc5d4843"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       RowBox[{"HoldPattern", "[", 
        RowBox[{"$parse", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"tok$7076", ":", 
             
             RowBox[{"\<\"C\"\>", "|", "\<\"A\"\>", "|", "\<\"K\"\>", 
              "|", "\<\"E\"\>"}]}], ",", "toks$7076___"}], "}"}], ",", 
          RowBox[{"tree$7076_", ":", "Null"}]}], "]"}], "]"}], 
       "\[RuleDelayed]", 
       RowBox[{"genParserBody", "[", 
        RowBox[{"2", ",", "tok$7076", ",", 
         RowBox[{"{", "toks$7076", "}"}], ",", "Binary", ",", 
         RowBox[{"{", "}"}], ",", "$parse"}], "]"}]}]},
     {
      RowBox[{
       RowBox[{"HoldPattern", "[", 
        RowBox[{"$parse", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"tok$7078", ":", 
             
             RowBox[{"\<\"p\"\>", "|", "\<\"q\"\>", "|", "\<\"r\"\>", 
              "|", "\<\"s\"\>"}]}], ",", "toks$7078___"}], "}"}], ",", 
          RowBox[{"tree$7078_", ":", "Null"}]}], "]"}], "]"}], 
       "\[RuleDelayed]", 
       RowBox[{"genParserBody", "[", 
        RowBox[{"0", ",", "tok$7078", ",", 
         RowBox[{"{", "toks$7078", "}"}], ",", "Proposition", ",", 
         RowBox[{"{", "}"}], ",", "$parse"}], "]"}]}]},
     {
      RowBox[{
       RowBox[{"HoldPattern", "[", 
        RowBox[{"$parse", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", 
          RowBox[{"tree_", ":", "Null"}]}], "]"}], "]"}], "\[RuleDelayed]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", "tree"}], "}"}]}]},
     {
      RowBox[{
       RowBox[{"HoldPattern", "[", 
        RowBox[{"$parse", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"tok$7081", ":", 
             RowBox[{"Alternatives", "[", "\<\"N\"\>", "]"}]}], ",", 
            "toks$7081___"}], "}"}], ",", 
          RowBox[{"tree$7081_", ":", "Null"}]}], "]"}], "]"}], 
       "\[RuleDelayed]", 
       RowBox[{"genParserBody", "[", 
        RowBox[{"1", ",", "tok$7081", ",", 
         RowBox[{"{", "toks$7081", "}"}], ",", "Unary", ",", 
         RowBox[{"{", "}"}], ",", "$parse"}], "]"}]}]},
     {
      RowBox[{
       RowBox[{"HoldPattern", "[", 
        RowBox[{"$parse", "[", "xs$___", "]"}], "]"}], "\[RuleDelayed]", 
       RowBox[{"Throw", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"ToString", "[", "$parse", "]"}], 
           "<>", "\<\": CATASTROPHE: \"\>"}], ",", "xs$"}], "}"}], "]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.841611467924705*^9, 3.911255353372025*^9, 
  3.911290461234624*^9, 3.912269308989783*^9, 3.912546352885269*^9, 
  3.91258907140355*^9, 3.9126003509115887`*^9, 3.912601705960829*^9, 
  3.9150508711013803`*^9, 3.915535457023838*^9},
 CellLabel->
  "Out[637]//TableForm=",ExpressionUUID->"0af98db6-2fce-4abd-a5cf-\
8b04e27e448f"]
}, Open  ]],

Cell[TextData[{
 "Compare the hand-written parser ",
 StyleBox["parse", "Input"],
 " to the machine-generated parser ",
 StyleBox["$parse", "Input"],
 " on random inputs (",
 StyleBox["now you see why we did travesty generation before parsing \
\[LongDash] so we can test parsers!",
  FontWeight->"Bold"],
 ")."
}], "Text",
 CellChangeTimes->{{3.5493615811815033`*^9, 3.549361592268137*^9}, {
  3.623887592901649*^9, 3.623887603266719*^9}, {3.911291524965185*^9, 
  3.91129155450963*^9}, {3.912600086451841*^9, 
  3.9126000932620363`*^9}},ExpressionUUID->"4fe10e09-dac1-427d-849a-\
c1bdec78c3e0"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"SeedRandom", "[", "26", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"gengen", "=", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"sen", "=", 
          RowBox[{"generateSentence", "[", 
           RowBox[{"iP", ",", "Proposition", ",", "T", ",", "500"}], "]"}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"tpt", "=", 
            RowBox[{"Timing", "@", 
             RowBox[{"partTree", "@", 
              RowBox[{"parse", "@", "sen"}]}]}]}], "}"}], ",", 
          RowBox[{"(*", " ", 
           RowBox[{"hand", "-", 
            RowBox[{"written", " ", "parser"}]}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"$tpt", "=", 
              RowBox[{"Timing", "@", 
               RowBox[{"partTree", "@", 
                RowBox[{"$parse", "@", "sen"}]}]}]}], "}"}], ",", 
            RowBox[{"(*", " ", 
             RowBox[{"machine", "-", 
              RowBox[{"written", " ", "parser"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"s", "=", 
                RowBox[{
                "expressionStringFromSentence", " ", "@", " ", "sen"}]}], 
               "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"With", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"e", "=", 
                  RowBox[{"ToExpression", " ", "@", " ", "s"}]}], "}"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"With", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"c", "=", "\[IndentingNewLine]", 
                    RowBox[{"Grid", "[", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"sen", ",", "SpanFromLeft"}], "}"}], ","}], 
                    "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"s", ",", "SpanFromLeft"}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"e", ",", "SpanFromLeft"}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"Length", "@", "sen"}], "]"}], "<>", 
                    "\"\< Leaves\>\""}], ",", "SpanFromLeft"}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Manual\>\"", ",", "\"\<Auto\>\""}], "}"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ToString", "@", 
                    RowBox[{"tpt", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "Second"}], ",", 
                    RowBox[{
                    RowBox[{"ToString", "@", 
                    RowBox[{"$tpt", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "Second"}]}], "}"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"TreeForm", "[", 
                    RowBox[{
                    RowBox[{"tpt", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"VertexLabeling", "\[Rule]", "Automatic"}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"TreeForm", "[", 
                    RowBox[{
                    RowBox[{"$tpt", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"VertexLabeling", "\[Rule]", "Automatic"}]}], 
                    "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"tpt", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "===", 
                    "\[IndentingNewLine]", 
                    RowBox[{"$tpt", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}], ",", 
                    RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}]}], "}"}], 
                  ",", "c"}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
       "]"}], "&"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"DynamicModule", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"foo", "=", 
       RowBox[{"gengen", "[", "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Manipulate", "[", 
      RowBox[{"foo", ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<Gen\>\"", ",", 
         RowBox[{"foo", "=", 
          RowBox[{"gengen", "[", "]"}]}]}], "]"}]}], "]"}]}], "]"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.548772150700317*^9, 3.548772152562317*^9}, {
   3.548781072033685*^9, 3.54878108008788*^9}, {3.548781209122975*^9, 
   3.548781220923795*^9}, {3.548781260157871*^9, 3.54878132925896*^9}, {
   3.54878149336536*^9, 3.5487815548063607`*^9}, {3.5487816089013615`*^9, 
   3.54878166397036*^9}, {3.5487817770603614`*^9, 3.5487818235933595`*^9}, {
   3.5487818872853613`*^9, 3.54878205153836*^9}, {3.548782142386359*^9, 
   3.5487821767443595`*^9}, {3.54879183940534*^9, 3.548791870270105*^9}, {
   3.5489730117267737`*^9, 3.5489730361041665`*^9}, 3.5489732353995657`*^9, {
   3.629584777970353*^9, 3.629584788609981*^9}, {3.687638604910495*^9, 
   3.687638609709581*^9}, {3.841220764556778*^9, 3.841220789656146*^9}, 
   3.8412208622339687`*^9, {3.841220948464278*^9, 3.841220949453404*^9}, {
   3.911291319299083*^9, 3.911291494481524*^9}, {3.911291583174954*^9, 
   3.911291590318371*^9}, {3.9126000632969923`*^9, 3.91260007580886*^9}},
 CellLabel->
  "In[638]:=",ExpressionUUID->"02f2c6cd-afff-430e-ae81-28e70dbba943"],

Cell[BoxData[
 DynamicModuleBox[{$CellContext`foo$$ = 
  Grid[{{"KENEKNKrpENpNArqsNNrNENss", 
     SpanFromLeft}, {$CellContext`KENEKNKrpENpNArqsNNrNENss, SpanFromLeft}, {
    "25 Leaves", SpanFromLeft}, {"Manual", "Auto"}, {
    "0.000079" $CellContext`Second, "0.00013" $CellContext`Second}, {
     TreeForm[
      $CellContext`Binary["K", 
       $CellContext`Binary["E", 
        $CellContext`Unary["N", 
         $CellContext`Binary["E", 
          $CellContext`Binary["K", 
           $CellContext`Unary["N", 
            $CellContext`Binary["K", 
             $CellContext`Proposition["r"], 
             $CellContext`Proposition["p"]]], 
           $CellContext`Binary["E", 
            $CellContext`Unary["N", 
             $CellContext`Proposition["p"]], 
            $CellContext`Unary["N", 
             $CellContext`Binary["A", 
              $CellContext`Proposition["r"], 
              $CellContext`Proposition["q"]]]]], 
          $CellContext`Proposition["s"]]], 
        $CellContext`Unary["N", 
         $CellContext`Unary["N", 
          $CellContext`Proposition["r"]]]], 
       $CellContext`Unary["N", 
        $CellContext`Binary["E", 
         $CellContext`Unary["N", 
          $CellContext`Proposition["s"]], 
         $CellContext`Proposition["s"]]]], VertexLabeling -> Automatic], 
     TreeForm[
      $CellContext`Binary["K", 
       $CellContext`Binary["E", 
        $CellContext`Unary["N", 
         $CellContext`Binary["E", 
          $CellContext`Binary["K", 
           $CellContext`Unary["N", 
            $CellContext`Binary["K", 
             $CellContext`Proposition["r"], 
             $CellContext`Proposition["p"]]], 
           $CellContext`Binary["E", 
            $CellContext`Unary["N", 
             $CellContext`Proposition["p"]], 
            $CellContext`Unary["N", 
             $CellContext`Binary["A", 
              $CellContext`Proposition["r"], 
              $CellContext`Proposition["q"]]]]], 
          $CellContext`Proposition["s"]]], 
        $CellContext`Unary["N", 
         $CellContext`Unary["N", 
          $CellContext`Proposition["r"]]]], 
       $CellContext`Unary["N", 
        $CellContext`Binary["E", 
         $CellContext`Unary["N", 
          $CellContext`Proposition["s"]], 
         $CellContext`Proposition["s"]]]], VertexLabeling -> Automatic]}, {
    True}}, Frame -> All]}, 
  TagBox[
   StyleBox[
    DynamicModuleBox[{Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
     Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
     1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{
       Hold[
        Button[
        "Gen", $CellContext`foo$$ = (
          With[{$CellContext`sen = \
$CellContext`generateSentence[$CellContext`iP, $CellContext`Proposition, \
$CellContext`T, 500]}, 
           With[{$CellContext`tpt = Timing[
               $CellContext`partTree[
                $CellContext`parse[$CellContext`sen]]]}, 
            With[{$CellContext`$tpt = Timing[
                $CellContext`partTree[
                 $CellContext`$parse[$CellContext`sen]]]}, 
             
             With[{$CellContext`s = \
$CellContext`expressionStringFromSentence[$CellContext`sen]}, 
              With[{$CellContext`e = ToExpression[$CellContext`s]}, 
               
               With[{$CellContext`c = 
                 Grid[{{$CellContext`s, SpanFromLeft}, {$CellContext`e, 
                    SpanFromLeft}, {ToString[
                    Length[$CellContext`sen]] <> " Leaves", SpanFromLeft}, {
                    "Manual", "Auto"}, {ToString[
                    Part[$CellContext`tpt, 1]] $CellContext`Second, ToString[
                    Part[$CellContext`$tpt, 1]] $CellContext`Second}, {
                    TreeForm[
                    Part[$CellContext`tpt, 2], VertexLabeling -> Automatic], 
                    TreeForm[
                    Part[$CellContext`$tpt, 2], VertexLabeling -> 
                    Automatic]}, {
                    Part[$CellContext`tpt, 2] === 
                    Part[$CellContext`$tpt, 2]}}, Frame -> 
                   All]}, $CellContext`c]]]]]]& )[]]], 
       Manipulate`Dump`ThisIsNotAControl, ControlType -> None}}, 
     Typeset`size$$ = {562., {179.7010498046875, 188.2989501953125}}, 
     Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = True}, 
     DynamicBox[Manipulate`ManipulateBoxes[
      1, StandardForm, "Variables" :> {}, "ControllerVariables" :> {}, 
       "OtherVariables" :> {
        Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
         Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
         Typeset`specs$$, Typeset`size$$, Typeset`update$$, 
         Typeset`initDone$$, Typeset`skipInitDone$$}, 
       "Body" :> $CellContext`foo$$, "Specifications" :> {
         Button[
         "Gen", $CellContext`foo$$ = (
           With[{$CellContext`sen = \
$CellContext`generateSentence[$CellContext`iP, $CellContext`Proposition, \
$CellContext`T, 500]}, 
            With[{$CellContext`tpt = Timing[
                $CellContext`partTree[
                 $CellContext`parse[$CellContext`sen]]]}, 
             With[{$CellContext`$tpt = Timing[
                 $CellContext`partTree[
                  $CellContext`$parse[$CellContext`sen]]]}, 
              
              With[{$CellContext`s = \
$CellContext`expressionStringFromSentence[$CellContext`sen]}, 
               With[{$CellContext`e = ToExpression[$CellContext`s]}, 
                
                With[{$CellContext`c = 
                  Grid[{{$CellContext`s, SpanFromLeft}, {$CellContext`e, 
                    SpanFromLeft}, {ToString[
                    Length[$CellContext`sen]] <> " Leaves", SpanFromLeft}, {
                    "Manual", "Auto"}, {ToString[
                    Part[$CellContext`tpt, 1]] $CellContext`Second, ToString[
                    Part[$CellContext`$tpt, 1]] $CellContext`Second}, {
                    TreeForm[
                    Part[$CellContext`tpt, 2], VertexLabeling -> Automatic], 
                    TreeForm[
                    Part[$CellContext`$tpt, 2], VertexLabeling -> 
                    Automatic]}, {
                    Part[$CellContext`tpt, 2] === 
                    Part[$CellContext`$tpt, 2]}}, Frame -> 
                    All]}, $CellContext`c]]]]]]& )[]]}, "Options" :> {}, 
       "DefaultOptions" :> {}],
      ImageSizeCache->{628., {249., 258.}},
      SingleEvaluation->True],
     Deinitialization:>None,
     DynamicModuleValues:>{},
     SynchronousInitialization->True,
     UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
     UnsavedVariables:>{Typeset`initDone$$},
     UntrackedVariables:>{Typeset`size$$}], "Manipulate",
    Deployed->True,
    StripOnInput->False],
   Manipulate`InterpretManipulate[1]],
  DynamicModuleValues:>{}]], "Output",
 CellChangeTimes->{{3.9112914469078293`*^9, 3.911291479241521*^9}, {
   3.911291586059885*^9, 3.911291626987797*^9}, 3.912269328455583*^9, 
   3.912546352905068*^9, 3.912589071421743*^9, 3.912600350922112*^9, 
   3.912601705976431*^9, 3.915050871113115*^9, 3.915535457044528*^9},
 CellLabel->
  "Out[639]=",ExpressionUUID->"cca2d1ce-e5da-4ba5-b14d-2e6b3972640d"]
}, Open  ]],

Cell["\<\
The machine-generated parser is about 50% slower than the hand-written \
parser, but that\[CloseCurlyQuote]s offset by the engineering factors that we \
didn\[CloseCurlyQuote]t have to write the machine-generated parser by hand \
and that we can reuse the machine-generated parser on other PPF grammars. \
\>", "Text",
 CellChangeTimes->{{3.912600374546825*^9, 
  3.912600442447169*^9}},ExpressionUUID->"27d57ffc-0758-4e6c-a901-\
e670b02e8391"]
}, Open  ]],

Cell[CellGroupData[{

Cell["parseWFF", "Subsection",
 CellChangeTimes->{{3.549017068102096*^9, 3.549017070066588*^9}, 
   3.912601665385301*^9},ExpressionUUID->"c0644aa6-626c-4272-b503-\
5cccb3d44a3d"],

Cell["\<\
Save the machine-generated parser for WFF in a convenient, top-level \
function. \
\>", "Text",
 CellChangeTimes->{{3.912600464258396*^9, 3.91260049510682*^9}, 
   3.912601665624072*^9},ExpressionUUID->"e7b6a9ca-a216-4ae6-a574-\
c4730cb627ce"],

Cell["Reminders on some constituent functions:", "Text",
 CellChangeTimes->{{3.841312187075562*^9, 
  3.841312197001861*^9}},ExpressionUUID->"cb46621a-6feb-4216-8813-\
fc24008147a6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"??", "tokens"}]], "Input",
 CellChangeTimes->{{3.841312175480585*^9, 3.841312177293342*^9}},
 CellLabel->
  "In[640]:=",ExpressionUUID->"7fbc33e0-c397-4986-aa4a-5f37d323e71b"],

Cell[BoxData[
 InterpretationBox[
  StyleBox[
   FrameBox[
    DynamicModuleBox[{System`InformationDump`open$$ = True, 
     System`InformationDump`mouseOver$$ = False}, 
     PaneSelectorBox[{True->
      TagBox[GridBox[{
         {
          ItemBox[
           PaneBox[
            StyleBox[
             TagBox[
              TooltipBox[
               StyleBox["\<\" Symbol\"\>", "InformationRowLabel",
                StripOnInput->False],
               "\"Symbol\"",
               TooltipStyle->"TextStyling"],
              Annotation[#, "Symbol", "Tooltip"]& ], "InformationTitleText",
             StripOnInput->False,
             BaseStyle -> None],
            FrameMargins->{{4, 0}, {-1, 1}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           PaneBox[
            StyleBox["\<\"Global`tokens\"\>", "InformationUsageText",
             StripOnInput->False,
             LineSpacing->{1.5, 1.5, 3.}],
            FrameMargins->{{10, 10}, {8, 10}}],
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False]},
         {
          PaneBox[
           TagBox[GridBox[{
              {
               StyleBox[
                TagBox[
                 TooltipBox[
                  StyleBox["\<\" Definitions\"\>", "InformationRowLabel",
                   StripOnInput->False],
                  "\"Definitions\"",
                  TooltipStyle->"TextStyling"],
                 Annotation[#, "Definitions", "Tooltip"]& ], "DialogStyle",
                StripOnInput->False]},
              {
               TemplateBox[{"\"\[ThinSpace]\"", 
                 GridBox[{{
                    RowBox[{
                    RowBox[{"tokens", "[", "utterance_", "]"}], ":=", 
                    RowBox[{"Characters", "[", "utterance", "]"}]}]}, {" "}}, 
                  GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                  DefaultBaseStyle -> "Column", 
                  GridBoxItemSize -> {
                   "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}]},
                "RowDefault"]}
             },
             DefaultBaseStyle->"Column",
             GridBoxAlignment->{"Columns" -> {{Left}}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
            "Column"],
           FrameMargins->{{6, 0}, {3, 6}}], "\<\"\"\>"},
         {
          PaneBox[GridBox[{
             {
              
              DynamicModuleBox[{System`InformationDump`open$$ = {
               False, False, False, False, False, False}}, 
               StyleBox[GridBox[{
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Full Name\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"FullName\"",
                    TooltipStyle->"TextStyling"],
                    
                    Annotation[#, "FullName", 
                    "Tooltip"]& ], "\<\"Global`tokens\"\>"}
                 },
                 AutoDelete->False,
                 GridBoxAlignment->{"Columns" -> {Right, Left}},
                 GridBoxDividers->None,
                 GridBoxItemSize->{"Columns" -> {Automatic, Automatic}},
                 GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.5599999999999999]}, 
                    Offset[0.27999999999999997`]}, "Rows" -> {
                    Offset[0.2], {
                    Offset[0.8]}, 
                    Offset[0.2]}}], "DialogStyle",
                StripOnInput->False],
               DynamicModuleValues:>{}]}
            },
            DefaultBaseStyle->"Column",
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxDividers->{"Columns" -> {{False}}, "Rows" -> {{False}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.5599999999999999]}, 
                Offset[0.27999999999999997`]}, "Rows" -> {
                Offset[0.2], {
                 Offset[3.6]}, 
                Offset[0.2]}}],
           FrameMargins->{{6, 6}, {6, 3}}], ""},
         {
          ItemBox[
           TagBox[
            ButtonBox[
             PaneSelectorBox[{False->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "UpPointerOpener"],
               ImageSizeCache->{15., {2., 13.}}], True->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "UpPointerOpenerHot"],
               ImageSizeCache->{15., {2., 13.}}]}, Dynamic[
              System`InformationDump`mouseOver$$]],
             Alignment->Left,
             Appearance->{"Default" -> None},
             
             ButtonFunction:>FEPrivate`Set[
              System`InformationDump`open$$, False],
             Evaluator->Automatic,
             FrameMargins->{{9, 0}, {0, 0}},
             ImageMargins->0,
             ImageSize->Full,
             Method->"Preemptive"],
            
            EventHandlerTag[{
             "MouseEntered" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, True], 
              "MouseExited" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, False], 
              Method -> "Preemptive", PassEventsDown -> Automatic, 
              PassEventsUp -> True}]],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], "\[SpanFromLeft]"}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          GrayLevel[0.8], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {Left, Right}, "Rows" -> {{Center}}},
        GridBoxDividers->{
         "Columns" -> {{None}}, "Rows" -> {False, {True}, False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], False->
      TagBox[GridBox[{
         {
          ItemBox[
           PaneBox[
            StyleBox[
             TagBox[
              TooltipBox[
               StyleBox["\<\" Symbol\"\>", "InformationRowLabel",
                StripOnInput->False],
               "\"Symbol\"",
               TooltipStyle->"TextStyling"],
              Annotation[#, "Symbol", "Tooltip"]& ], "InformationTitleText",
             StripOnInput->False],
            FrameMargins->{{4, 0}, {-1, 1}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           PaneBox[
            StyleBox["\<\"Global`tokens\"\>", "InformationUsageText",
             StripOnInput->False,
             LineSpacing->{1.5, 1.5, 3.}],
            FrameMargins->{{10, 10}, {8, 10}}],
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           TagBox[
            ButtonBox[
             PaneSelectorBox[{False->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpener"]], True->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpenerHot"]]}, Dynamic[
              System`InformationDump`mouseOver$$]],
             Alignment->Left,
             Appearance->{"Default" -> None},
             
             ButtonFunction:>FEPrivate`Set[
              System`InformationDump`open$$, True],
             Evaluator->Automatic,
             FrameMargins->{{9, 0}, {0, 0}},
             ImageMargins->0,
             ImageSize->Full,
             Method->"Preemptive"],
            
            EventHandlerTag[{
             "MouseEntered" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, True], 
              "MouseExited" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, False], 
              Method -> "Preemptive", PassEventsDown -> Automatic, 
              PassEventsUp -> True}]],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], "\[SpanFromLeft]"}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          GrayLevel[0.8], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {Left, Right}, "Rows" -> {{Center}}},
        GridBoxDividers->{
         "Columns" -> {{None}}, "Rows" -> {False, {True}, False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"]}, Dynamic[System`InformationDump`open$$],
      BaselinePosition->Baseline,
      FrameMargins->0,
      ImageSize->Automatic],
     DynamicModuleValues:>{}],
    BaseStyle->"InformationGridFrame",
    StripOnInput->False], "InformationGridPlain",
   StripOnInput->False],
  InformationData[<|
   "ObjectType" -> "Symbol", "Usage" -> "Global`tokens", "Documentation" -> 
    None, "OwnValues" -> None, "UpValues" -> None, "DownValues" -> 
    Information`InformationValueForm[
     DownValues, $CellContext`tokens, {$CellContext`tokens[
         Pattern[$CellContext`utterance, 
          Blank[]]] :> Characters[$CellContext`utterance]}], "SubValues" -> 
    None, "DefaultValues" -> None, "NValues" -> None, "FormatValues" -> None, 
    "Options" -> None, "Attributes" -> {}, "FullName" -> "Global`tokens"|>, 
   True]]], "Output",
 CellChangeTimes->{3.841312178256756*^9, 3.841318270440792*^9, 
  3.841322099633089*^9, 3.841322141212151*^9, 3.841322403366958*^9, 
  3.8413247578801003`*^9, 3.841324987540832*^9, 3.841332924166746*^9, 
  3.841350164223839*^9, 3.841352237817089*^9, 3.841392981955318*^9, 
  3.8414034426331778`*^9, 3.841405404497184*^9, 3.841422366217278*^9, 
  3.911255353443546*^9, 3.911290461299894*^9, 3.912269354046045*^9, 
  3.912546352988576*^9, 3.912589071508998*^9, 3.912600351002721*^9, 
  3.9126017060548983`*^9, 3.915050871192852*^9, 3.9155354571208887`*^9},
 CellLabel->
  "Out[640]=",ExpressionUUID->"6261f5dd-a0ef-479b-ba2d-a623c8a7c77d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"??", "partTree"}]], "Input",
 CellChangeTimes->{{3.841312202699864*^9, 3.841312205239889*^9}},
 CellLabel->
  "In[641]:=",ExpressionUUID->"b77ed330-0d90-4998-ba5e-66ec7dfd2056"],

Cell[BoxData[
 InterpretationBox[
  StyleBox[
   FrameBox[
    DynamicModuleBox[{System`InformationDump`open$$ = True, 
     System`InformationDump`mouseOver$$ = False}, 
     PaneSelectorBox[{True->
      TagBox[GridBox[{
         {
          ItemBox[
           PaneBox[
            StyleBox[
             TagBox[
              TooltipBox[
               StyleBox["\<\" Symbol\"\>", "InformationRowLabel",
                StripOnInput->False],
               "\"Symbol\"",
               TooltipStyle->"TextStyling"],
              Annotation[#, "Symbol", "Tooltip"]& ], "InformationTitleText",
             StripOnInput->False,
             BaseStyle -> None],
            FrameMargins->{{4, 0}, {-1, 1}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           PaneBox[
            StyleBox["\<\"Global`partTree\"\>", "InformationUsageText",
             StripOnInput->False,
             LineSpacing->{1.5, 1.5, 3.}],
            FrameMargins->{{10, 10}, {8, 10}}],
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False]},
         {
          PaneBox[
           TagBox[GridBox[{
              {
               StyleBox[
                TagBox[
                 TooltipBox[
                  StyleBox["\<\" Definitions\"\>", "InformationRowLabel",
                   StripOnInput->False],
                  "\"Definitions\"",
                  TooltipStyle->"TextStyling"],
                 Annotation[#, "Definitions", "Tooltip"]& ], "DialogStyle",
                StripOnInput->False]},
              {
               TemplateBox[{"\"\[ThinSpace]\"", 
                 GridBox[{{
                    RowBox[{
                    RowBox[{"partTree", "[", "list_List", "]"}], ":=", 
                    RowBox[{"First", "[", 
                    RowBox[{"Rest", "[", "list", "]"}], "]"}]}]}, {" "}}, 
                  GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                  DefaultBaseStyle -> "Column", 
                  GridBoxItemSize -> {
                   "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}]},
                "RowDefault"]}
             },
             DefaultBaseStyle->"Column",
             GridBoxAlignment->{"Columns" -> {{Left}}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
            "Column"],
           FrameMargins->{{6, 0}, {3, 6}}], "\<\"\"\>"},
         {
          PaneBox[GridBox[{
             {
              
              DynamicModuleBox[{System`InformationDump`open$$ = {
               False, False, False, False, False, False}}, 
               StyleBox[GridBox[{
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Full Name\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"FullName\"",
                    TooltipStyle->"TextStyling"],
                    
                    Annotation[#, "FullName", 
                    "Tooltip"]& ], "\<\"Global`partTree\"\>"}
                 },
                 AutoDelete->False,
                 GridBoxAlignment->{"Columns" -> {Right, Left}},
                 GridBoxDividers->None,
                 GridBoxItemSize->{"Columns" -> {Automatic, Automatic}},
                 GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.5599999999999999]}, 
                    Offset[0.27999999999999997`]}, "Rows" -> {
                    Offset[0.2], {
                    Offset[0.8]}, 
                    Offset[0.2]}}], "DialogStyle",
                StripOnInput->False],
               DynamicModuleValues:>{}]}
            },
            DefaultBaseStyle->"Column",
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxDividers->{"Columns" -> {{False}}, "Rows" -> {{False}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.5599999999999999]}, 
                Offset[0.27999999999999997`]}, "Rows" -> {
                Offset[0.2], {
                 Offset[3.6]}, 
                Offset[0.2]}}],
           FrameMargins->{{6, 6}, {6, 3}}], ""},
         {
          ItemBox[
           TagBox[
            ButtonBox[
             PaneSelectorBox[{False->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "UpPointerOpener"],
               ImageSizeCache->{15., {2., 13.}}], True->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "UpPointerOpenerHot"],
               ImageSizeCache->{15., {2., 13.}}]}, Dynamic[
              System`InformationDump`mouseOver$$]],
             Alignment->Left,
             Appearance->{"Default" -> None},
             
             ButtonFunction:>FEPrivate`Set[
              System`InformationDump`open$$, False],
             Evaluator->Automatic,
             FrameMargins->{{9, 0}, {0, 0}},
             ImageMargins->0,
             ImageSize->Full,
             Method->"Preemptive"],
            
            EventHandlerTag[{
             "MouseEntered" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, True], 
              "MouseExited" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, False], 
              Method -> "Preemptive", PassEventsDown -> Automatic, 
              PassEventsUp -> True}]],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], "\[SpanFromLeft]"}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          GrayLevel[0.8], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {Left, Right}, "Rows" -> {{Center}}},
        GridBoxDividers->{
         "Columns" -> {{None}}, "Rows" -> {False, {True}, False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], False->
      TagBox[GridBox[{
         {
          ItemBox[
           PaneBox[
            StyleBox[
             TagBox[
              TooltipBox[
               StyleBox["\<\" Symbol\"\>", "InformationRowLabel",
                StripOnInput->False],
               "\"Symbol\"",
               TooltipStyle->"TextStyling"],
              Annotation[#, "Symbol", "Tooltip"]& ], "InformationTitleText",
             StripOnInput->False],
            FrameMargins->{{4, 0}, {-1, 1}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           PaneBox[
            StyleBox["\<\"Global`partTree\"\>", "InformationUsageText",
             StripOnInput->False,
             LineSpacing->{1.5, 1.5, 3.}],
            FrameMargins->{{10, 10}, {8, 10}}],
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           TagBox[
            ButtonBox[
             PaneSelectorBox[{False->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpener"]], True->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpenerHot"]]}, Dynamic[
              System`InformationDump`mouseOver$$]],
             Alignment->Left,
             Appearance->{"Default" -> None},
             ButtonFunction:>FEPrivate`Set[
              System`InformationDump`open$$, True],
             Evaluator->Automatic,
             FrameMargins->{{9, 0}, {0, 0}},
             ImageMargins->0,
             ImageSize->Full,
             Method->"Preemptive"],
            
            EventHandlerTag[{
             "MouseEntered" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, True], 
              "MouseExited" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, False], 
              Method -> "Preemptive", PassEventsDown -> Automatic, 
              PassEventsUp -> True}]],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], "\[SpanFromLeft]"}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          GrayLevel[0.8], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {Left, Right}, "Rows" -> {{Center}}},
        GridBoxDividers->{
         "Columns" -> {{None}}, "Rows" -> {False, {True}, False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"]}, Dynamic[System`InformationDump`open$$],
      BaselinePosition->Baseline,
      FrameMargins->0,
      ImageSize->Automatic],
     DynamicModuleValues:>{}],
    BaseStyle->"InformationGridFrame",
    StripOnInput->False], "InformationGridPlain",
   StripOnInput->False],
  InformationData[<|
   "ObjectType" -> "Symbol", "Usage" -> "Global`partTree", "Documentation" -> 
    None, "OwnValues" -> None, "UpValues" -> None, "DownValues" -> 
    Information`InformationValueForm[
     DownValues, $CellContext`partTree, {$CellContext`partTree[
         Pattern[$CellContext`list, 
          Blank[List]]] :> First[
         Rest[$CellContext`list]]}], "SubValues" -> None, "DefaultValues" -> 
    None, "NValues" -> None, "FormatValues" -> None, "Options" -> None, 
    "Attributes" -> {}, "FullName" -> "Global`partTree"|>, True]]], "Output",
 CellChangeTimes->{3.841312206214198*^9, 3.841318270539484*^9, 
  3.841322099708502*^9, 3.841322141339594*^9, 3.841322403475893*^9, 
  3.841324757955585*^9, 3.841324987616417*^9, 3.841332924245344*^9, 
  3.841350164302273*^9, 3.841352237946121*^9, 3.84139298203887*^9, 
  3.8414034427145557`*^9, 3.841405406305072*^9, 3.841422366305592*^9, 
  3.911255353482377*^9, 3.911290461336048*^9, 3.912269356235392*^9, 
  3.912546353030359*^9, 3.912589071549521*^9, 3.9126003510415497`*^9, 
  3.912601706094693*^9, 3.915050871233715*^9, 3.915535457161724*^9},
 CellLabel->
  "Out[641]=",ExpressionUUID->"b3d3ed28-fe28-4385-a5da-2bfdcf77f84a"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["$p: a Handy Composition", "Subsection",
 CellChangeTimes->{{3.915054294700109*^9, 
  3.915054327488451*^9}},ExpressionUUID->"44907b1f-18e8-4696-bb1d-\
ee9c2aa930a1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$p", "=", 
   RowBox[{"Composition", "[", 
    RowBox[{"partTree", ",", "$parse", ",", "tokens"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.5490170732437263`*^9, 3.549017103274516*^9}, {
   3.549021078682917*^9, 3.549021079505939*^9}, 3.5490211770037265`*^9, 
   3.5496343355002613`*^9},
 CellLabel->
  "In[642]:=",ExpressionUUID->"f4f5d667-82c5-4698-8c9f-83f954abebba"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["UNPARSING", "Section",
 CellChangeTimes->{{3.549017277793172*^9, 
  3.549017291660965*^9}},ExpressionUUID->"749dac53-cffb-4b10-917c-\
6e18d39a1e85"],

Cell[TextData[{
 StyleBox["Unparsing",
  FontSlant->"Italic"],
 " is building utterances from trees. We need this for round-trip testing of \
parsers."
}], "Text",
 CellChangeTimes->{{3.841312233639382*^9, 3.8413122544224668`*^9}, {
  3.912600513201159*^9, 3.912600524102323*^9}, {3.915053461419674*^9, 
  3.91505346331527*^9}},ExpressionUUID->"a06cace3-3a67-4477-bfe6-\
7cb43bf0b7c1"],

Cell[CellGroupData[{

Cell["By Hand", "Subsection",
 CellChangeTimes->{{3.5490173856622887`*^9, 
  3.5490173870447645`*^9}},ExpressionUUID->"d0a2591f-dd7e-49e6-8d5f-\
c82496ea1c86"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "unparse", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"unparse", "[", 
    RowBox[{"Proposition", "[", 
     RowBox[{"t", ":", 
      RowBox[{"Alternatives", "@@", 
       RowBox[{"{", 
        RowBox[{
        "\"\<p\>\"", ",", "\"\<q\>\"", ",", "\"\<r\>\"", ",", "\"\<s\>\""}], 
        "}"}]}]}], "]"}], "]"}], ":=", "t"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"unparse", "[", 
    RowBox[{"Unary", "[", 
     RowBox[{
      RowBox[{"t", ":", 
       RowBox[{"Alternatives", "@@", "\"\<N\>\""}]}], ",", "l_"}], "]"}], 
    "]"}], ":=", 
   RowBox[{"t", "<>", 
    RowBox[{"unparse", "[", "l", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"unparse", "[", 
    RowBox[{"Binary", "[", 
     RowBox[{
      RowBox[{"t", ":", 
       RowBox[{"Alternatives", "@@", 
        RowBox[{"{", 
         RowBox[{
         "\"\<C\>\"", ",", "\"\<A\>\"", ",", "\"\<K\>\"", ",", "\"\<E\>\""}], 
         "}"}]}]}], ",", "l_", ",", "r_"}], "]"}], "]"}], ":=", 
   RowBox[{"t", "<>", 
    RowBox[{"unparse", "[", "l", "]"}], "<>", 
    RowBox[{"unparse", "[", "r", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"unparse", "[", "t_", "]"}], ":=", 
  RowBox[{"Throw", "[", 
   RowBox[{"{", 
    RowBox[{"\"\<UNPARSE: CATASTROPHE\>\"", ",", "t"}], "}"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.549017307095847*^9, 3.5490173803856506`*^9}, {
   3.54901776284591*^9, 3.549017797369056*^9}, {3.549017844272156*^9, 
   3.549018030015659*^9}, 3.549019579941991*^9, {3.549019634157548*^9, 
   3.549019707751263*^9}},
 CellLabel->
  "In[643]:=",ExpressionUUID->"b3cf67c2-2b5f-45f3-939d-74900d6f5d4b"],

Cell["Example:", "Text",
 CellChangeTimes->{{3.8413122658356137`*^9, 
  3.8413122680219393`*^9}},ExpressionUUID->"4ed72e9f-3989-4924-902b-\
29c607dff595"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"unparse", "[", 
  RowBox[{"Binary", "[", 
   RowBox[{"\"\<K\>\"", ",", 
    RowBox[{"Proposition", "[", "\"\<p\>\"", "]"}], ",", 
    RowBox[{"Unary", "[", 
     RowBox[{"\"\<N\>\"", ",", 
      RowBox[{"Proposition", "[", "\"\<q\>\"", "]"}]}], "]"}]}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.549019588632656*^9, 3.549019649667059*^9}},
 CellLabel->
  "In[648]:=",ExpressionUUID->"84f75a87-9162-40ea-83ca-615a1710dc9f"],

Cell[BoxData["\<\"KpNq\"\>"], "Output",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGAwBOJnTwpfsDK8dox0qM9nZnztuOnIkqKHXK8do3wmPwDR
JSEZFR2arx3j/tlO7wTSR17vXACivbqP6m4H0r/+mJ+bU/na0en7JIOceW8c
J6loehUAaaXY8/EgOiv+wHIQfc/XYW4hkE648mkViD496fBBEM3ylPsYiD7s
Mel+N5BuC7vANQFId53asQBES5xLWgeiRd31DoDobXt6bs4E0lxeLQ9AdMHs
1Gcg2qrx9MEdIDq7+NQuIN38U+k5iE7LurR+N4iOvDllL5BW6yjYAqIVN+y/
tQ9I568u+Q6iWx51XD8EpJfIdTudBtIhggdcz4DMW3hI6wGQzq6PcHsK8pfA
b5tnQNpf/3TzO5D/uA2WK6i8dbQyWn3aEEjX9GQd51d766hZocg2HUizsX9+
uBpIn9v/MHkjkD5T48K7CUhb3Hv+Llb7raPKPNUeL523jgAwQtLg
  "],
 CellLabel->
  "Out[648]=",ExpressionUUID->"08f3ee2f-3e60-460c-ac23-658743181896"]
}, Open  ]],

Cell["Counterexample:", "Text",
 CellChangeTimes->{{3.841312277397309*^9, 
  3.841312284805577*^9}},ExpressionUUID->"92325328-dad8-490a-b119-\
97e4ef261114"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"unparse", "[", "\"\<p\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.549019738877887*^9, 3.549019744360925*^9}},
 CellLabel->
  "In[649]:=",ExpressionUUID->"b726dc7a-daca-4d6e-850f-509a9b45d966"],

Cell[BoxData[
 TemplateBox[{
  "Throw", "nocatch", 
   "\"Uncaught \\!\\(\\*RowBox[{\\\"Throw\\\", \\\"[\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"\\\\\\\"UNPARSE: CATASTROPHE\\\\\\\"\\\", \\\",\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"}], \\\"}\\\"}], \\\"]\\\"}]\\) returned to top \
level.\"", 2, 649, 1, 30828701621051619894, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGDQB+IfFsuLHnK9dmzYPf8BiBZemVvRofnaMUPHeXonkJbY
wLcQRE8rP6m7HUivemB9bk7la8e6RlvDnHlvHPc56HgVAOlgw4vxIFos5tBy
EM0a4Di3EEgf/Pd5FYhe8+7IQRD9oZX3GIiec3Ty/W4gbfHtItcEIN3/cPcC
EP1JInUdiNb0MzgAolOY+2/OBNmT1f4ARO+Zn/4MRN/0v3t4B5AO0jp1aheQ
3rJS+TmIbtlzef1uIH1a59aUvUDaQKhoC4guun3g1j6QvSql30G0VEXn9UNA
utanx+k0yF2vDrqeAYkHH9Z6AKR9AqLcngLpWLU/Ns+A9MbpZ5rfAemqPwbL
FVTeOlqwrDltCKQ/l548zq/21vH2QUW26UD6w8vPD1cD6Q2zHiVvBNIKlq68
m4B03eEX72K13zq+qVHr8dJ56wgAOs7Qyg==
  "],
 CellLabel->
  "During evaluation of \
In[649]:=",ExpressionUUID->"ac9ecc05-f909-4180-8b69-1c2717afc72f"],

Cell[BoxData[
 RowBox[{"Hold", "[", 
  RowBox[{"Throw", "[", 
   RowBox[{"{", 
    RowBox[{"\<\"UNPARSE: CATASTROPHE\"\>", ",", "\<\"p\"\>"}], "}"}], "]"}], 
  "]"}]], "Output",
 CellChangeTimes->CompressedData["
1:eJwVz1tIE3AUBvBZc4a1qYuiktRNWWaTWoEONOOfLGglmckIm13cZFZryzVp
PdSDy3JoNWlmxVwGyWAru9DNvKQzdc45cQiVtos1dW5uFAlFhHXOw+EHH3wf
HFaFsqQyhkKhHILjVLGcudUh8rpNdpIPligK1agxa+O0ALyTzbjiBSedX5ZR
/vsDi+mqEDGtFYwXgX1xFo0ETNnJDqLuy8VMKcjmiXLQtPxrPWhpOrNbDrp0
P4piL4CvPMdQsWQsEAfW1yU35YKZfxK95SD1yEL0OJg6pN98CjREx7egemsZ
H7XPtvfWgmqt87cWTNTUnbODKVaJ0QfalifOVKth92bS/uR/IXJ68HATlRIm
4syaYCzIpNUqV8aESV6FWTUTHyYD3x740ft0haZ+a5g80xa26EB5UsJDdINv
JPsN+GS6wGW8FCYdXbt5ctMiEUm5wvPg1aMTJ9AVDTYzam8mrdVgQLhkQS8e
HOxHt7fTh9AkgcHXALKl7ng9yM3pbkNNuyo70O8LO/pQWt6tz/dA3qPrfvST
WzaHUjs9A29Bi9nheIe9VRnzqHnd5NMusOr2lKEH9EpUL1HZmv6pXrBAUfML
dQzrPtpA143GvaPg+rM2gRPzDwNZfvCnqGzfLDhf+jd/DlQyxrRR/DOGZ07L
iBBx6uNRHripeWQ4gRMhxR4WrQW0rV6asYKMzq+S5yBNJKC/APcEgtHybRGi
vstpFHIj5D95oEg2
  "],
 CellLabel->
  "Out[649]=",ExpressionUUID->"b6276ec1-7da1-489c-8c0a-a8c7cc5bff81"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Machine-Generated", "Subsection",
 CellChangeTimes->{{3.549018810708907*^9, 3.5490188119327617`*^9}, {
  3.912600539739655*^9, 
  3.912600541668008*^9}},ExpressionUUID->"fe5210d8-b7c0-42f4-b9a2-\
6f75c2e3e1cc"],

Cell[CellGroupData[{

Cell["genUnparserBody, unparserDefFromGrammarRule", "Subsubsection",
 CellChangeTimes->{{3.549018840645653*^9, 3.549018849365039*^9}, 
   3.549019072170439*^9, {3.5490191494399996`*^9, 
   3.5490191547813053`*^9}},ExpressionUUID->"fc329d95-083e-477b-8846-\
75f97f4a9d44"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ClearAll", "[", "unparserDefFromGrammarRule", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.548764255192079*^9, 3.54876428810037*^9}, {
   3.548764554706027*^9, 3.54876465464002*^9}, {3.548766015798121*^9, 
   3.548766041541696*^9}, {3.548766113128854*^9, 3.5487662587504163`*^9}, {
   3.548766354306969*^9, 3.548766372248763*^9}, {3.548766419098448*^9, 
   3.548766548177354*^9}, {3.54876660743628*^9, 3.5487666483503723`*^9}, {
   3.548767035927368*^9, 3.548767043084221*^9}, {3.5487670750806675`*^9, 
   3.548767108033076*^9}, {3.54876714075253*^9, 3.5487671500136776`*^9}, {
   3.548767195010677*^9, 3.548767259594757*^9}, {3.548767368398992*^9, 
   3.54876752142638*^9}, {3.5487676461037607`*^9, 3.548767870232761*^9}, {
   3.5487679442047606`*^9, 3.54876802408976*^9}, {3.54876814935576*^9, 
   3.54876816371876*^9}, {3.54876820329676*^9, 3.5487682305897603`*^9}, {
   3.54877144842099*^9, 3.5487714494108906`*^9}, {3.548771504507381*^9, 
   3.5487715052513084`*^9}, {3.548771668858944*^9, 3.548771715083321*^9}, {
   3.548771746280317*^9, 3.548771752079317*^9}, {3.548771798253317*^9, 
   3.548771864978317*^9}, {3.548772022707317*^9, 3.548772066840317*^9}, {
   3.548772413135317*^9, 3.548772415406317*^9}, 3.548772519258317*^9, {
   3.548772841491317*^9, 3.548772843065317*^9}, {3.548772922161174*^9, 
   3.54877294821778*^9}, {3.5487730058785443`*^9, 3.548773128383794*^9}, {
   3.548773209302885*^9, 3.548773222907245*^9}, {3.548773271710125*^9, 
   3.5487732724542*^9}, {3.548773330487002*^9, 3.548773350110965*^9}, {
   3.548773448843837*^9, 3.548773452019154*^9}, {3.548773682257176*^9, 
   3.548773715281478*^9}, {3.548773748186768*^9, 3.548773751123061*^9}, {
   3.548773845156464*^9, 3.548773845354484*^9}, {3.548773885066455*^9, 
   3.548773885705519*^9}, {3.548773925793707*^9, 3.5487739426977086`*^9}, {
   3.5487742337787066`*^9, 3.548774235997707*^9}, {3.548774299799707*^9, 
   3.548774301023707*^9}, {3.548774331758707*^9, 3.5487743349817066`*^9}, {
   3.5487744302897067`*^9, 3.548774446695707*^9}, {3.548774713499707*^9, 
   3.548774761745708*^9}, {3.5487748199887066`*^9, 3.548774989863577*^9}, {
   3.54877504669126*^9, 3.5487751442630157`*^9}, {3.548775210149604*^9, 
   3.5487752109876876`*^9}, {3.548775247444333*^9, 3.548775247765365*^9}, {
   3.548775610003585*^9, 3.548775617071292*^9}, {3.5487756533529196`*^9, 
   3.5487756821638*^9}, {3.54877573296488*^9, 3.548775764479031*^9}, {
   3.548775852515834*^9, 3.54877588338092*^9}, {3.5487759152871103`*^9, 
   3.5487759200065823`*^9}, {3.5487759761361403`*^9, 3.54877598757314*^9}, {
   3.548776028766141*^9, 3.548776028815141*^9}, {3.548780064862323*^9, 
   3.5487801132121572`*^9}, 3.548780152526089*^9, {3.548780192192055*^9, 
   3.548780194721308*^9}, {3.548780276643499*^9, 3.548780415818415*^9}, {
   3.548780447254559*^9, 3.5487804722370586`*^9}, {3.548780754811311*^9, 
   3.54878078350518*^9}, 3.548781016384466*^9, {3.548782260965361*^9, 
   3.548782264695359*^9}, {3.5487824043103595`*^9, 3.548782406999359*^9}, {
   3.5487825425123615`*^9, 3.54878265237936*^9}, 3.548791775519686*^9, 
   3.548972642585658*^9, {3.5489727072943606`*^9, 3.5489727573192205`*^9}, {
   3.54897295748267*^9, 3.548972962695968*^9}, {3.548973173628033*^9, 
   3.5489731864597664`*^9}, {3.549013568039856*^9, 3.549013571847638*^9}, {
   3.549013683133875*^9, 3.549013699566815*^9}, {3.549018905772961*^9, 
   3.549018923366945*^9}, {3.54901907300368*^9, 3.5490190759598103`*^9}, {
   3.5490191706333585`*^9, 3.5490191709313755`*^9}, {3.5490192103267393`*^9, 
   3.549019265173585*^9}, {3.5490193384550714`*^9, 3.5490193920154643`*^9}, {
   3.549019442071753*^9, 3.549019573104875*^9}, 3.549019774083658*^9, {
   3.549019831932046*^9, 3.54901983483138*^9}, {3.5490199217794657`*^9, 
   3.549020033759124*^9}, {3.5490200710866*^9, 3.549020129879045*^9}, {
   3.549020243539124*^9, 3.5490202591218204`*^9}, {3.549020297736196*^9, 
   3.5490204680374184`*^9}, {3.549020510445509*^9, 3.5490205182024584`*^9}, 
   3.5490206119992704`*^9, {3.549020653996735*^9, 3.549020712897369*^9}, {
   3.549020743539737*^9, 3.549020775270361*^9}, {3.5490208741938524`*^9, 
   3.5490208768204*^9}, {3.623410255228863*^9, 3.623410258800745*^9}},
 CellLabel->
  "In[650]:=",ExpressionUUID->"a6dbe215-2f24-4f5c-b75d-127b4f6fc604"],

Cell[BoxData[
 RowBox[{
  RowBox[{"unparserDefFromGrammarRule", "[", 
   RowBox[{"unparserTargetSym_", ",", "rule_", ",", "nonTerminals_"}], "]"}], 
  ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"term", ",", "terms", ",", "xs"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ts", "=", 
         RowBox[{"terminalsFromRule", "[", 
          RowBox[{"rule", ",", "nonTerminals"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"h", "=", 
         RowBox[{"nonTerminalHeadFromRule", "[", 
          RowBox[{"rule", ",", "nonTerminals"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"a", "=", 
         RowBox[{"arityFromPrefixRule", "[", "rule", "]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", "ts"}], "=!=", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"perform", " ", "the", " ", "def", " ", "in"}], "-", 
           RowBox[{"place", " ", "by", " ", "side"}], "-", 
           RowBox[{
           "effect", " ", "on", " ", "the", " ", "given", " ", "symbol"}]}], 
          " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"a", "===", "0"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"unparserTargetSym", "[", 
             RowBox[{"h", "[", 
              RowBox[{"term", ":", 
               RowBox[{"Alternatives", "@@", "ts"}]}], "]"}], "]"}], ":=", 
            "term"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"unparserTargetSym", "[", 
             RowBox[{"h", "[", 
              RowBox[{
               RowBox[{"term", ":", 
                RowBox[{"Alternatives", "@@", "ts"}]}], ",", "terms___"}], 
              "]"}], "]"}], ":=", "\[IndentingNewLine]", 
            RowBox[{"term", "<>", 
             RowBox[{"StringJoin", "@@", 
              RowBox[{"Map", "[", 
               RowBox[{"unparserTargetSym", ",", 
                RowBox[{"{", "terms", "}"}]}], "]"}]}]}]}]}], 
          "\[IndentingNewLine]", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"unparserTargetSym", "[", "xs___", "]"}], ":=", 
        RowBox[{"Throw", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"ToString", "@", "unparserTargetSym"}], "<>", 
            "\"\<: CATASTROPHE: \>\""}], ",", "xs"}], "}"}], "]"}]}]}]}], 
     "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.548764255192079*^9, 3.54876428810037*^9}, {
   3.548764554706027*^9, 3.54876465464002*^9}, {3.548766015798121*^9, 
   3.548766041541696*^9}, {3.548766113128854*^9, 3.5487662587504163`*^9}, {
   3.548766354306969*^9, 3.548766372248763*^9}, {3.548766419098448*^9, 
   3.548766548177354*^9}, {3.54876660743628*^9, 3.5487666483503723`*^9}, {
   3.548767035927368*^9, 3.548767043084221*^9}, {3.5487670750806675`*^9, 
   3.548767108033076*^9}, {3.54876714075253*^9, 3.5487671500136776`*^9}, {
   3.548767195010677*^9, 3.548767259594757*^9}, {3.548767368398992*^9, 
   3.54876752142638*^9}, {3.5487676461037607`*^9, 3.548767870232761*^9}, {
   3.5487679442047606`*^9, 3.54876802408976*^9}, {3.54876814935576*^9, 
   3.54876816371876*^9}, {3.54876820329676*^9, 3.5487682305897603`*^9}, {
   3.54877144842099*^9, 3.5487714494108906`*^9}, {3.548771504507381*^9, 
   3.5487715052513084`*^9}, {3.548771668858944*^9, 3.548771715083321*^9}, {
   3.548771746280317*^9, 3.548771752079317*^9}, {3.548771798253317*^9, 
   3.548771864978317*^9}, {3.548772022707317*^9, 3.548772066840317*^9}, {
   3.548772413135317*^9, 3.548772415406317*^9}, 3.548772519258317*^9, {
   3.548772841491317*^9, 3.548772843065317*^9}, {3.548772922161174*^9, 
   3.54877294821778*^9}, {3.5487730058785443`*^9, 3.548773128383794*^9}, {
   3.548773209302885*^9, 3.548773222907245*^9}, {3.548773271710125*^9, 
   3.5487732724542*^9}, {3.548773330487002*^9, 3.548773350110965*^9}, {
   3.548773448843837*^9, 3.548773452019154*^9}, {3.548773682257176*^9, 
   3.548773715281478*^9}, {3.548773748186768*^9, 3.548773751123061*^9}, {
   3.548773845156464*^9, 3.548773845354484*^9}, {3.548773885066455*^9, 
   3.548773885705519*^9}, {3.548773925793707*^9, 3.5487739426977086`*^9}, {
   3.5487742337787066`*^9, 3.548774235997707*^9}, {3.548774299799707*^9, 
   3.548774301023707*^9}, {3.548774331758707*^9, 3.5487743349817066`*^9}, {
   3.5487744302897067`*^9, 3.548774446695707*^9}, {3.548774713499707*^9, 
   3.548774761745708*^9}, {3.5487748199887066`*^9, 3.548774989863577*^9}, {
   3.54877504669126*^9, 3.5487751442630157`*^9}, {3.548775210149604*^9, 
   3.5487752109876876`*^9}, {3.548775247444333*^9, 3.548775247765365*^9}, {
   3.548775610003585*^9, 3.548775617071292*^9}, {3.5487756533529196`*^9, 
   3.5487756821638*^9}, {3.54877573296488*^9, 3.548775764479031*^9}, {
   3.548775852515834*^9, 3.54877588338092*^9}, {3.5487759152871103`*^9, 
   3.5487759200065823`*^9}, {3.5487759761361403`*^9, 3.54877598757314*^9}, {
   3.548776028766141*^9, 3.548776028815141*^9}, {3.548780064862323*^9, 
   3.5487801132121572`*^9}, 3.548780152526089*^9, {3.548780192192055*^9, 
   3.548780194721308*^9}, {3.548780276643499*^9, 3.548780415818415*^9}, {
   3.548780447254559*^9, 3.5487804722370586`*^9}, {3.548780754811311*^9, 
   3.54878078350518*^9}, 3.548781016384466*^9, {3.548782260965361*^9, 
   3.548782264695359*^9}, {3.5487824043103595`*^9, 3.548782406999359*^9}, {
   3.5487825425123615`*^9, 3.54878265237936*^9}, 3.548791775519686*^9, 
   3.548972642585658*^9, {3.5489727072943606`*^9, 3.5489727573192205`*^9}, {
   3.54897295748267*^9, 3.548972962695968*^9}, {3.548973173628033*^9, 
   3.5489731864597664`*^9}, {3.549013568039856*^9, 3.549013571847638*^9}, {
   3.549013683133875*^9, 3.549013699566815*^9}, {3.549018905772961*^9, 
   3.549018923366945*^9}, {3.54901907300368*^9, 3.5490190759598103`*^9}, {
   3.5490191706333585`*^9, 3.5490191709313755`*^9}, {3.5490192103267393`*^9, 
   3.549019265173585*^9}, {3.5490193384550714`*^9, 3.5490193920154643`*^9}, {
   3.549019442071753*^9, 3.549019573104875*^9}, 3.549019774083658*^9, {
   3.549019831932046*^9, 3.54901983483138*^9}, {3.5490199217794657`*^9, 
   3.549020033759124*^9}, {3.5490200710866*^9, 3.549020129879045*^9}, {
   3.549020243539124*^9, 3.5490202591218204`*^9}, {3.549020297736196*^9, 
   3.5490204680374184`*^9}, {3.549020510445509*^9, 3.5490205182024584`*^9}, 
   3.5490206119992704`*^9, {3.549020653996735*^9, 3.549020712897369*^9}, {
   3.549020743539737*^9, 3.549020775270361*^9}, {3.5490208741938524`*^9, 
   3.5490208768204*^9}, 3.623410255228863*^9, {3.841316462737712*^9, 
   3.841316467260416*^9}},
 CellLabel->
  "In[651]:=",ExpressionUUID->"56846bc5-e99d-40b8-be87-d6a9d45da8ad"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "$u", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Scan", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"unparserDefFromGrammarRule", "[", 
      RowBox[{"$u", ",", "#", ",", 
       RowBox[{"nonTerminalsFromGrammar", "@", "P"}]}], "]"}], "&"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"DownValues", "@", "P"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"DownValues", "@", "$u"}], "//", "TableForm"}]}], "Input",
 CellChangeTimes->{{3.549020800460043*^9, 3.549020816017031*^9}, {
  3.5496343580105143`*^9, 3.549634358049516*^9}, {3.62341026929162*^9, 
  3.623410278159898*^9}},
 CellLabel->
  "In[652]:=",ExpressionUUID->"f41a5497-0920-48bd-bfae-0d30db4f640b"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       RowBox[{"HoldPattern", "[", 
        RowBox[{"$u", "[", 
         RowBox[{"Binary", "[", 
          RowBox[{
           RowBox[{"term$", ":", 
            
            RowBox[{"\<\"C\"\>", "|", "\<\"A\"\>", "|", "\<\"K\"\>", 
             "|", "\<\"E\"\>"}]}], ",", "terms$___"}], "]"}], "]"}], "]"}], 
       "\[RuleDelayed]", 
       RowBox[{"term$", "<>", 
        RowBox[{"StringJoin", "@@", 
         RowBox[{"$u", "/@", 
          RowBox[{"{", "terms$", "}"}]}]}]}]}]},
     {
      RowBox[{
       RowBox[{"HoldPattern", "[", 
        RowBox[{"$u", "[", 
         RowBox[{"Proposition", "[", 
          RowBox[{"term", ":", 
           
           RowBox[{"\<\"p\"\>", "|", "\<\"q\"\>", "|", "\<\"r\"\>", 
            "|", "\<\"s\"\>"}]}], "]"}], "]"}], "]"}], "\[RuleDelayed]", 
       "term"}]},
     {
      RowBox[{
       RowBox[{"HoldPattern", "[", 
        RowBox[{"$u", "[", 
         RowBox[{"Unary", "[", 
          RowBox[{
           RowBox[{"term$", ":", 
            RowBox[{"Alternatives", "[", "\<\"N\"\>", "]"}]}], ",", 
           "terms$___"}], "]"}], "]"}], "]"}], "\[RuleDelayed]", 
       RowBox[{"term$", "<>", 
        RowBox[{"StringJoin", "@@", 
         RowBox[{"$u", "/@", 
          RowBox[{"{", "terms$", "}"}]}]}]}]}]},
     {
      RowBox[{
       RowBox[{"HoldPattern", "[", 
        RowBox[{"$u", "[", "xs$___", "]"}], "]"}], "\[RuleDelayed]", 
       RowBox[{"Throw", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"ToString", "[", "$u", "]"}], 
           "<>", "\<\": CATASTROPHE: \"\>"}], ",", "xs$"}], "}"}], "]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->CompressedData["
1:eJwdy1tMknEcxnHQyI3N3FI3l7kOKq7CC3ISF1z4Z73aWKxyNVcJlRpLkxlY
jk5u5RpktIhodiBHm/VasEyyWipUZu8qjVxp5wCXAr4c5iYtLsr6/bx49tlz
8V1V01S5n8vhcBSwH08LKyValqhc/p2oMdqwFxWHjx1Bsw/kfqNA4WxGqw+c
p33zqDRzSzRfx5K+sop3CrC8wqGvBSXrBWG0yr1taR2YcqpKjNqOG9wo15o5
2Agy1XMKXjNL3iS8U2lgljbv4gZwfCbLpwRvH4zFVeBNniVvH7hraqwITZh3
S1BVN+05DTIXvMk28KPMoHkFCrlqmx/MfjjRoD3MkkFpaHPuP5bwOxnLIk6E
LDNtvYZ2XdGHeaC5/kxTKjdC7vQ4dJP8CLlE9QbQ5WKd3rgmQtQ5mzrOgvYd
o8WPwVv3idd2NELSSqdLGjujpN1aLD8Ezire70HNzhc0Wtciu6EFn1C/7qIP
CPMcLTuxhFnw0WX/OTCpHOebsVvhsaMFA+p76DApeYbWuMxfroJM0hhANwrq
gwvfXhjqB/98nugZAN+mfre6QZGvuQ91ioe+esAxbctv9Hqi/dMQmDJ3XjYC
btcMU6OgbfXLtQEwaKgunwa99F9pEGy1e9viYOiDiF5ZECOlJueICOw6KXid
IYgRTXr+4g7QZElMOlD5z9peMOqi0l1gP5mJK9fFSA6vyCQXxsh/TyZGCQ==

  "],
 CellLabel->
  "Out[654]//TableForm=",ExpressionUUID->"73204b68-33e5-4b9e-ae25-\
10153885e788"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Ad-hoc Test", "Subsubsection",
 CellChangeTimes->{{3.549021369438156*^9, 
  3.549021373413948*^9}},ExpressionUUID->"0be39cb2-e1f9-4c0d-846e-\
10da0f0a5359"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"$u", "[", 
  RowBox[{"Binary", "[", 
   RowBox[{"\"\<K\>\"", ",", 
    RowBox[{"Proposition", "[", "\"\<p\>\"", "]"}], ",", 
    RowBox[{"Unary", "[", 
     RowBox[{"\"\<N\>\"", ",", 
      RowBox[{"Proposition", "[", "\"\<q\>\"", "]"}]}], "]"}]}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.5490208373059845`*^9, 3.549020855099592*^9}, 
   3.5496343580655193`*^9},
 CellLabel->
  "In[655]:=",ExpressionUUID->"133e7598-fdc3-4063-ac51-8a1d57417dd5"],

Cell[BoxData["\<\"KpNq\"\>"], "Output",
 CellChangeTimes->{{3.549020855551619*^9, 3.549020880385603*^9}, 
   3.549020931381377*^9, 3.5490211017879553`*^9, 3.5490485369054585`*^9, 
   3.549361136536071*^9, 3.5493621669950094`*^9, 3.5495033305111003`*^9, 
   3.5495891142846518`*^9, 3.549633477380453*^9, 3.549634369224633*^9, 
   3.549634706584366*^9, 3.549634994767498*^9, 3.549636076263839*^9, 
   3.54965244864582*^9, 3.5499649116460776`*^9, 3.549965193644207*^9, 
   3.549970214505384*^9, 3.5500678489660583`*^9, 3.5501462887035465`*^9, 
   3.5501484714663935`*^9, 3.550152940589188*^9, 3.550153022551877*^9, 
   3.5501531548824453`*^9, 3.5502218132793055`*^9, 3.550224326501053*^9, 
   3.550364524264911*^9, 3.550412003242645*^9, 3.550710614729358*^9, 
   3.623410284823462*^9, 3.623888025204821*^9, 3.623888088882818*^9, 
   3.623890755833765*^9, 3.624409980372766*^9, 3.629583253508931*^9, 
   3.629584133688957*^9, 3.645653955747303*^9, 3.645656250334901*^9, 
   3.645749614445719*^9, 3.687638642089384*^9, 3.841155490098187*^9, 
   3.84116385744535*^9, 3.841164030588047*^9, 3.841164606137848*^9, 
   3.841166570091886*^9, 3.8411666796825943`*^9, 3.8411668622130404`*^9, 
   3.8411668964683647`*^9, 3.841220348698682*^9, 3.841228886658197*^9, 
   3.841230085969951*^9, 3.841230195234545*^9, 3.841230337630294*^9, 
   3.841248972553104*^9, 3.841249028299397*^9, 3.841249075312558*^9, 
   3.841316665203618*^9, 3.841318270718775*^9, 3.841322150909524*^9, 
   3.8413224036443777`*^9, 3.841324758090901*^9, 3.841324987722213*^9, 
   3.84133292436406*^9, 3.8413501644657307`*^9, 3.84135223819304*^9, 
   3.841392982184907*^9, 3.841403442919952*^9, 3.841405415952786*^9, 
   3.841422366480542*^9, 3.911255353570354*^9, 3.91129046140027*^9, 
   3.912269388268456*^9, 3.912546353103724*^9, 3.9125890716551533`*^9, 
   3.912600351109702*^9, 3.912601706185912*^9, 3.915050871296527*^9, 
   3.9155354572271957`*^9},
 CellLabel->
  "Out[655]=",ExpressionUUID->"2b5fd68a-0692-41ae-b320-c90d851e5a33"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Stress Test", "Subsubsection",
 CellChangeTimes->{{3.549021358406863*^9, 
  3.549021360469368*^9}},ExpressionUUID->"c319db26-cc98-4b7e-96af-\
fef0d8e9cf44"],

Cell["\<\
Generate random utterances (travesties), parse them, unparse the parse, check \
for equality.\
\>", "Text",
 CellChangeTimes->{{3.912600561429816*^9, 
  3.912600586621591*^9}},ExpressionUUID->"9bba6329-fdc4-4b4c-b5b4-\
b10f469d6373"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"$RecursionLimit", "=", "1024"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"And", "@@", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"r", "=", 
           RowBox[{"randomUtterance", "[", "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"$u", "@", 
           RowBox[{"$p", "@", "r"}]}], "===", "r"}]}], "]"}], ",", 
       RowBox[{"{", "100", "}"}]}], "]"}]}]}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{
   "do", " ", "as", " ", "many", " ", "as", " ", "you", " ", "want", " ", 
    "by", " ", "changing", " ", "100"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.5490211074689894`*^9, 3.549021151530965*^9}, {
  3.549021184340051*^9, 3.549021313766074*^9}, {3.549021352646418*^9, 
  3.549021353267633*^9}, {3.549634336917404*^9, 3.54963435808452*^9}, {
  3.687638679507502*^9, 3.687638688858075*^9}, {3.841228895315975*^9, 
  3.8412288961560926`*^9}, {3.912600602803499*^9, 3.91260063040419*^9}},
 CellLabel->
  "In[656]:=",ExpressionUUID->"dbc22a21-4113-4d60-9194-9dce0045bb75"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.549021250615451*^9, 3.5490212557098804`*^9}, 
   3.54902130814902*^9, {3.549021348221004*^9, 3.549021354167275*^9}, 
   3.549048538231534*^9, 3.5493611366040745`*^9, 3.549361657293856*^9, 
   3.549362167054013*^9, 3.549503330666109*^9, 3.549589118325883*^9, 
   3.549633477417457*^9, 3.549634369256637*^9, 3.5496347066933784`*^9, 
   3.549634994905498*^9, 3.549636076349839*^9, 3.54965244894885*^9, 
   3.5499649117480836`*^9, 3.5499651951372924`*^9, 3.549970214557387*^9, 
   3.5500678492000694`*^9, 3.5501462901466293`*^9, 3.550148472845473*^9, 
   3.55015294061619*^9, 3.550153022575878*^9, 3.5501531560735135`*^9, 
   3.550221813328308*^9, 3.55022432714009*^9, 3.550364524302913*^9, 
   3.550412003416655*^9, 3.550710614881367*^9, 3.623410288558964*^9, 
   3.623888092829675*^9, 3.6238907558826737`*^9, 3.624409980433048*^9, 
   3.629583253642539*^9, 3.6295841346689243`*^9, 3.629584818797124*^9, 
   3.645653956020638*^9, 3.645656250414205*^9, 3.645656346680375*^9, 
   3.645749614513116*^9, {3.687638642308616*^9, 3.687638689647176*^9}, 
   3.841155493507612*^9, 3.8411638574927692`*^9, 3.841164030836212*^9, 
   3.8411646061634207`*^9, 3.841166570116069*^9, 3.841166679707327*^9, 
   3.841166862238598*^9, 3.841166896489472*^9, 3.841220349776043*^9, 
   3.84122888669378*^9, 3.841228922473628*^9, 3.841230086030044*^9, 
   3.8412301952689867`*^9, 3.841230337691184*^9, 3.841248972573851*^9, 
   3.841249028331889*^9, 3.841249075340513*^9, 3.8413166652402477`*^9, 
   3.841318270746628*^9, 3.841322150942773*^9, 3.841322403669793*^9, 
   3.84132475811392*^9, 3.84132498774237*^9, 3.841332924385708*^9, 
   3.841350164497818*^9, 3.841352238246885*^9, 3.8413929822101297`*^9, 
   3.841403442958962*^9, 3.841405415992972*^9, 3.841422366508245*^9, 
   3.911255353575897*^9, 3.911290461409165*^9, 3.912269391063123*^9, 
   3.912546353127575*^9, 3.9125890716606073`*^9, 3.912600351116522*^9, {
   3.912600597761159*^9, 3.912600614289012*^9}, 3.912601706275625*^9, 
   3.915050871386175*^9, 3.915535457318802*^9},
 CellLabel->
  "Out[656]=",ExpressionUUID->"2c88e90e-6378-49c4-8fbd-59220883cb5c"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["WFF-N-PROOF INFERENCE RULES", "Section",
 CellChangeTimes->{{3.5487583113042765`*^9, 3.548758316867595*^9}, {
   3.8413166775373797`*^9, 3.84131668294407*^9}, 
   3.9126016658472977`*^9},ExpressionUUID->"88b9463b-57a6-463d-9fd0-\
76e9e74cca07"],

Cell["Start on page 34 of the WFF-n-Proof book.", "Text",
 CellChangeTimes->{{3.841316710958343*^9, 3.841316722969015*^9}, {
   3.911291721743412*^9, 3.911291741822637*^9}, 3.912601666055806*^9, {
   3.915053486612805*^9, 
   3.915053494797423*^9}},ExpressionUUID->"fb24135d-0193-42a0-bce9-\
2efff7b51e6c"],

Cell["Produce a set-as-list of inferences from a term.", "Text",
 CellChangeTimes->{{3.54875859110128*^9, 3.548758617169771*^9}, {
  3.549616843324662*^9, 3.549616849780031*^9}, {3.550145517584441*^9, 
  3.550145518568497*^9}},ExpressionUUID->"36777c0e-bbfc-413e-8501-\
15b38a126fb5"],

Cell[CellGroupData[{

Cell["Outgoing Rules", "Subsection",
 CellChangeTimes->{{3.548762376165596*^9, 
  3.548762381606684*^9}},ExpressionUUID->"7e915fa0-a85a-4c82-8aa5-\
6094c045b0b2"],

Cell[BoxData[
 RowBox[{"ClearAll", "[", 
  RowBox[{
  "Ko", ",", "KoL", ",", "KoR", ",", "Co", ",", "Ao", ",", "No", ",", "Ki", 
   ",", "Ci", ",", "Ai", ",", "AiL", ",", "AiR", ",", "Ni", ",", "R", ",", 
   "Rp", ",", "NNi", ",", "NNo", ",", "CoNo", ",", "AoNo", ",", "CoCi", ",", 
   "CoAi", ",", "CoNKi", ",", "AoCi", ",", "AoAi", ",", "AoNKi", ",", "KoKi", 
   ",", "KoNCi", ",", "KoNAi", ",", "NKoCi", ",", "NKoAi", ",", "NCoKi", ",", 
   "NAoKi"}], "]"}]], "Input",
 CellChangeTimes->{{3.548985948870734*^9, 3.548985982823676*^9}, {
  3.5490142959238644`*^9, 3.549014300456064*^9}, {3.549014524769328*^9, 
  3.549014532539276*^9}, {3.549014583388037*^9, 3.549014589555501*^9}, {
  3.5490146669307685`*^9, 3.549014675709365*^9}, {3.549015627212323*^9, 
  3.5490156922172985`*^9}, {3.5490161816309958`*^9, 3.5490161839018974`*^9}, {
  3.549016500733091*^9, 3.549016503046391*^9}, {3.549362105050466*^9, 
  3.549362108111641*^9}},
 CellLabel->
  "In[657]:=",ExpressionUUID->"71cd8910-30a8-43d3-b7eb-cdc0c122e9db"],

Cell[CellGroupData[{

Cell["mnemonic: \[OpenCurlyDoubleQuote]K\[CloseCurlyDoubleQuote] is \
\[OpenCurlyDoubleQuote]Konjunction\[CloseCurlyDoubleQuote]", "Subsubsection",
 CellChangeTimes->{{3.5493617436537952`*^9, 3.54936174914111*^9}, {
  3.5493618190941105`*^9, 
  3.54936182170926*^9}},ExpressionUUID->"0d1bd6d8-70ca-4e07-a6c3-\
c102b6a30c1e"],

Cell[TextData[{
 "Notice, ",
 StyleBox["And", "Input"],
 " is NOT orderless (commutative), so we must introduces all combinations of \
rules to accommodate various proofs(!).  We could replace it with an \
Orderless \[OpenCurlyDoubleQuote]WFFAnd\[CloseCurlyDoubleQuote], but this \
would not allow us to prove, for example, \[OpenCurlyDoubleQuote]Ksr\
\[CloseCurlyDoubleQuote] because ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 "'s canonicalization will always rewrite it as \[OpenCurlyDoubleQuote]Krs\
\[CloseCurlyDoubleQuote]. A small point, but absent a proof or hypothesis \
that Kxy is equivalent to Kyx, we can\[CloseCurlyQuote]t tolerate this."
}], "Text",
 CellChangeTimes->{{3.549635307694498*^9, 3.549635433424498*^9}, {
   3.623888206148546*^9, 3.623888215793415*^9}, 3.9126016662942653`*^9, {
   3.91505371828938*^9, 
   3.915053722336041*^9}},ExpressionUUID->"5731802f-0c99-4e18-949c-\
4c046629aa2c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Attributes", "[", "And", "]"}]], "Input",
 CellChangeTimes->{{3.5496348920874996`*^9, 3.549634895310498*^9}},
 CellLabel->
  "In[658]:=",ExpressionUUID->"a5e5fad0-2ba2-4e44-8b79-98a5877f37bd"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"Flat", ",", "HoldAll", ",", "OneIdentity", ",", "Protected"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.549634896030498*^9, 3.549634994953498*^9, 3.549636076386839*^9, 
   3.5496524489978557`*^9, 3.5499649118030868`*^9, 3.54996520297374*^9, 
   3.549965495072448*^9, 3.54997021461039*^9, 3.550067849311076*^9, 
   3.550146290435645*^9, 3.550148473056484*^9, 3.550152940651192*^9, 
   3.5501530226068797`*^9, 3.550153156147518*^9, 3.5502218134333143`*^9, 
   3.5502243273261003`*^9, 3.5503645243519177`*^9, 3.550412003508661*^9, 
   3.550710614940369*^9, 3.623410318644609*^9, 3.623890755985779*^9, 
   3.624409980535455*^9, 3.629583254000887*^9, 3.62958413487196*^9, 
   3.6456539562847137`*^9, 3.645656250519895*^9, 3.645656398892329*^9, 
   3.645749614603245*^9, 3.687638698763102*^9, 3.6876387475598397`*^9, 
   3.841155525261408*^9, 3.841163857531127*^9, 3.841164030862351*^9, 
   3.841164606177416*^9, 3.841166570138731*^9, 3.841166679738709*^9, 
   3.841166862270658*^9, 3.841166896516395*^9, 3.841220349838489*^9, 
   3.841228933802155*^9, 3.841230086112107*^9, 3.841230195324411*^9, 
   3.841248972631418*^9, 3.841249028386446*^9, 3.841249075401397*^9, 
   3.841318270768316*^9, 3.841322150987908*^9, 3.84132240371423*^9, 
   3.841324758146471*^9, 3.84132498777031*^9, 3.841332924422624*^9, 
   3.841350164534073*^9, 3.841352238330661*^9, 3.8413929822507*^9, 
   3.841403443012854*^9, {3.841405456624445*^9, 3.8414054783353977`*^9}, 
   3.8414223665819693`*^9, 3.911255353598078*^9, 3.911290461419081*^9, 
   3.912269433931768*^9, 3.912546353137721*^9, 3.9125890716743517`*^9, 
   3.912600351126506*^9, 3.912601706285404*^9, 3.915050871433125*^9, 
   3.915535457368164*^9},
 CellLabel->
  "Out[658]=",ExpressionUUID->"01c665c6-b640-4b37-96e7-972c4289a438"]
}, Open  ]],

Cell["Build a table of names from parsed forms for display.", "Text",
 CellChangeTimes->{{3.5501455507763395`*^9, 3.550145564528126*^9}, {
  3.550147508154295*^9, 3.5501475213920536`*^9}, {3.915054200452455*^9, 
  3.9150542175374804`*^9}},ExpressionUUID->"2d7fe856-8d83-4115-8830-\
e8f616c7128c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"DefineInferenceRule", ",", "InferenceRuleNames"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.550145621866405*^9, 3.5501457711149426`*^9}, 
   3.623410331664885*^9},
 CellLabel->
  "In[659]:=",ExpressionUUID->"b248bd51-5811-4f2b-b98b-d04d7b9bbd68"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"DefineInferenceRule", ",", "HoldAll"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DefineInferenceRule", "[", 
    RowBox[{"sym_", ",", "val_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"Unevaluated", "[", "sym", "]"}], "=", "val"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"InferenceRuleNames", "[", "val", "]"}], "=", 
      RowBox[{"ToString", "@", 
       RowBox[{"Unevaluated", "@", "sym"}]}]}]}], ")"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.550145621866405*^9, 3.5501457711149426`*^9}, 
   3.623410331664885*^9},
 CellLabel->
  "In[660]:=",ExpressionUUID->"c10ce219-eba7-4e67-87c0-edb27b230ee3"],

Cell[TextData[{
 "Rule \[OpenCurlyDoubleQuote]Ko\[CloseCurlyDoubleQuote] says that the two \
arguments, ",
 StyleBox["x", "Input"],
 ", and ",
 StyleBox["y", "Input"],
 ", of a Conjunction ",
 StyleBox["Kxy", "Input"],
 ", are separately true. For example, ",
 StyleBox["Kpq", "Input"],
 " implies ",
 StyleBox["p", "Input"],
 " and implies ",
 StyleBox["q", "Input"],
 "."
}], "Text",
 CellChangeTimes->{{3.912601140721681*^9, 3.912601192497644*^9}, {
  3.912601222658584*^9, 
  3.912601240485224*^9}},ExpressionUUID->"60fffdc9-2575-461f-b6aa-\
51412f973118"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DefineInferenceRule", "[", 
   RowBox[{"Ko", ",", 
    RowBox[{
     RowBox[{"Binary", "[", 
      RowBox[{"\"\<K\>\"", ",", "L_", ",", "R_"}], "]"}], "\[RuleDelayed]", 
     RowBox[{"And", "[", 
      RowBox[{"L", ",", "R"}], "]"}]}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.550145781578541*^9, 3.5501458023067265`*^9}, 
   3.5501458619231358`*^9, {3.623888436136155*^9, 3.6238884518043613`*^9}},
 CellLabel->
  "In[662]:=",ExpressionUUID->"515ecae2-26af-42e0-8fda-0a76bb2ad836"],

Cell["\<\
Because \[OpenCurlyDoubleQuote]And\[CloseCurlyDoubleQuote] is not part of our \
\[OpenCurlyDoubleQuote]object language,\[CloseCurlyDoubleQuote] WFF, we \
actually need two rules. This also eliminates the indeterminacy inherent in \
the actual definitions in WFF-n-Proof.\
\>", "Text",
 CellChangeTimes->{{3.5496168721633115`*^9, 3.549616897251746*^9}, {
  3.550147552176813*^9, 3.550147579968403*^9}, {3.841310647053016*^9, 
  3.841310648219842*^9}, {3.912601666536634*^9, 
  3.9126016667646003`*^9}},ExpressionUUID->"187ebfe9-ce32-49ba-996a-\
79da4cce3b64"],

Cell["pages 37-40", "Text",
 CellChangeTimes->{{3.548985948870734*^9, 3.548985982823676*^9}, {
   3.5490142959238644`*^9, 3.5490143004560637`*^9}, {3.549014524769328*^9, 
   3.549014532539276*^9}, {3.549014583388037*^9, 3.549014589555501*^9}, {
   3.5490146669307685`*^9, 3.549014675709365*^9}, {3.549015627212323*^9, 
   3.5490156922172985`*^9}, 3.5490161816309958`*^9, {3.549016294123705*^9, 
   3.549016312197397*^9}, {3.5490163632205024`*^9, 3.5490163747768183`*^9}, {
   3.549016404948361*^9, 3.549016417353713*^9}, {3.549016454984213*^9, 
   3.5490164923168726`*^9}, {3.5490166669551477`*^9, 3.54901667213478*^9}, 
   3.549361761989845*^9, {3.549616858523531*^9, 3.549616867348036*^9}},
 FontWeight->"Bold",ExpressionUUID->"7f2929e8-3021-4713-8cb0-24b2cd37e28c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DefineInferenceRule", "[", 
   RowBox[{"KoL", ",", 
    RowBox[{
     RowBox[{"Binary", "[", 
      RowBox[{"\"\<K\>\"", ",", "left_", ",", "right_"}], "]"}], 
     "\[RuleDelayed]", "left"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"DefineInferenceRule", "[", 
   RowBox[{"KoR", ",", 
    RowBox[{
     RowBox[{"Binary", "[", 
      RowBox[{"\"\<K\>\"", ",", "left_", ",", "right_"}], "]"}], 
     "\[RuleDelayed]", "right"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.548985948870734*^9, 3.548985982823676*^9}, {
   3.5490142959238644`*^9, 3.549014300456064*^9}, {3.549014524769328*^9, 
   3.549014532539276*^9}, {3.549014583388037*^9, 3.549014589555501*^9}, {
   3.5490146669307685`*^9, 3.549014675709365*^9}, {3.549015627212323*^9, 
   3.5490156922172985`*^9}, 3.5490161816309958`*^9, {3.549016294123705*^9, 
   3.549016312197397*^9}, {3.5490163632205024`*^9, 3.5490163747768183`*^9}, {
   3.549016404948361*^9, 3.549016417353713*^9}, {3.549016454984213*^9, 
   3.5490164923168726`*^9}, {3.5490166669551477`*^9, 3.54901667213478*^9}, 
   3.549361761989845*^9, 3.549616858523531*^9, {3.550145871171665*^9, 
   3.550145883555373*^9}, {3.550146209939041*^9, 3.550146212795205*^9}},
 CellLabel->
  "In[663]:=",ExpressionUUID->"010415cd-5c00-49d7-8bd2-e196382a7cbb"],

Cell["Examples", "Text",
 CellChangeTimes->{{3.912610005430953*^9, 3.912610016362534*^9}},
 FontWeight->"Bold",ExpressionUUID->"8e370ef3-5e2e-4d49-8f2f-f62272c83eb7"],

Cell["Parse \[OpenCurlyDoubleQuote]Kpq,\[CloseCurlyDoubleQuote] then apply \
\[OpenCurlyDoubleQuote]Ko.\[CloseCurlyDoubleQuote]", "Text",
 CellChangeTimes->{{3.915054342088793*^9, 
  3.9150543548231897`*^9}},ExpressionUUID->"d2dbb9cd-ed23-4334-a723-\
8cebb6a54b94"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"$p", "@", "\"\<Kpq\>\""}], "/.", "Ko"}]], "Input",
 CellChangeTimes->{{3.912610021625572*^9, 3.912610040525799*^9}},
 CellLabel->
  "In[665]:=",ExpressionUUID->"a8f7fb5b-598e-4958-b1f0-2f35babdd9d3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Proposition", "[", "\<\"p\"\>", "]"}], "&&", 
  RowBox[{"Proposition", "[", "\<\"q\"\>", "]"}]}]], "Output",
 CellChangeTimes->{{3.912610032629787*^9, 3.912610041124385*^9}, 
   3.915050871450629*^9, 3.915535457389369*^9},
 CellLabel->
  "Out[665]=",ExpressionUUID->"1e202047-4d95-49f4-916c-c77dc64d180e"]
}, Open  ]],

Cell["Pick just the left branch.", "Text",
 CellChangeTimes->{{3.915054364981634*^9, 
  3.915054370429484*^9}},ExpressionUUID->"7d80e810-4bb4-4f35-b1b6-\
82a05a31d728"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"$p", "@", "\"\<Kpq\>\""}], "/.", "KoL"}]], "Input",
 CellChangeTimes->{{3.912610047518909*^9, 3.9126100556566677`*^9}, {
  3.912610110136135*^9, 3.912610111343029*^9}, {3.912610147813208*^9, 
  3.912610148131303*^9}},
 CellLabel->
  "In[666]:=",ExpressionUUID->"5c901eb0-b4f4-4906-b665-da5cfe37dc6b"],

Cell[BoxData[
 RowBox[{"Proposition", "[", "\<\"p\"\>", "]"}]], "Output",
 CellChangeTimes->{3.912610149291635*^9, 3.9150508714541388`*^9, 
  3.9155354573988733`*^9},
 CellLabel->
  "Out[666]=",ExpressionUUID->"bb225d46-516d-4835-97d4-135801a53ff0"]
}, Open  ]],

Cell["parse, infer, unparse:", "Text",
 CellChangeTimes->{{3.912610128454862*^9, 
  3.9126101353595448`*^9}},ExpressionUUID->"925fe4bf-34e4-4e4e-8bce-\
305c47d7596e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"$p", "@", "\"\<Kpq\>\""}], "/.", "KoL"}], "//", "$u"}]], "Input",
 CellChangeTimes->{{3.912610047518909*^9, 3.9126100556566677`*^9}, {
  3.912610110136135*^9, 3.912610111343029*^9}, {3.915054385409007*^9, 
  3.9150544039571533`*^9}},
 CellLabel->
  "In[667]:=",ExpressionUUID->"b0194591-2f3d-429d-8311-36e598660512"],

Cell[BoxData["\<\"p\"\>"], "Output",
 CellChangeTimes->{
  3.91261005597113*^9, 3.912610111743942*^9, 3.915050871461353*^9, {
   3.9150543864269857`*^9, 3.9150544043437843`*^9}, 3.915535457402171*^9},
 CellLabel->
  "Out[667]=",ExpressionUUID->"d9f825a9-04d1-4804-9377-6bd78bfe8e77"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["mnemonic: \[OpenCurlyDoubleQuote]C\[CloseCurlyDoubleQuote] is \
\[OpenCurlyDoubleQuote]Conditional\[CloseCurlyDoubleQuote]", "Subsubsection",
 CellChangeTimes->{{3.549361794404699*^9, 
  3.54936182922969*^9}},ExpressionUUID->"99d78953-8c65-4fe4-b31b-\
4153ca3dcf93"],

Cell[TextData[{
 StyleBox["Modus Ponens",
  FontWeight->"Bold"],
 ": (\[OpenCurlyDoubleQuote]p implies q\[CloseCurlyDoubleQuote] and \
\[OpenCurlyDoubleQuote]p\[CloseCurlyDoubleQuote] means \
\[OpenCurlyDoubleQuote]q\[CloseCurlyDoubleQuote] is true). Modus Ponens is \
like a diode: inference flows only one way, from ",
 Cell[BoxData[
  FormBox[
   RowBox[{"p", "\[Implies]", "q"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "b3cca26e-b140-4940-ba45-5834f38cd00d"],
 " and ",
 Cell[BoxData[
  FormBox["p", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "7b2d263b-afab-4ca5-bf29-65d2debb74b9"],
 " to ",
 Cell[BoxData[
  FormBox["q", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "d26c3678-de1a-4d5d-a48d-0e749dd8831a"],
 "."
}], "Text",
 CellChangeTimes->{{3.548985948870734*^9, 3.548985982823676*^9}, {
   3.5490142959238644`*^9, 3.5490143004560637`*^9}, {3.549014524769328*^9, 
   3.549014532539276*^9}, {3.549014583388037*^9, 3.549014589555501*^9}, {
   3.5490146669307685`*^9, 3.549014675709365*^9}, {3.549015627212323*^9, 
   3.5490156922172985`*^9}, 3.5490161816309958`*^9, {3.549016294123705*^9, 
   3.549016312197397*^9}, {3.5490163632205024`*^9, 3.5490163747768183`*^9}, {
   3.549016404948361*^9, 3.549016417353713*^9}, {3.549016454984213*^9, 
   3.5490164923168726`*^9}, {3.5490166669551477`*^9, 3.54901667213478*^9}, {
   3.549361761989845*^9, 3.549361765541047*^9}, 3.54950393823186*^9, {
   3.5495039768130665`*^9, 3.5495039795512238`*^9}, {3.549504049167205*^9, 
   3.549504076395763*^9}, {3.549504106842504*^9, 3.549504107560545*^9}, {
   3.549504263199447*^9, 3.549504282586556*^9}, {3.549504313340315*^9, 
   3.54950433527757*^9}, {3.5496169208520966`*^9, 3.549616927451474*^9}, {
   3.912602029848091*^9, 3.912602038250897*^9}, {3.912602242200565*^9, 
   3.912602244722857*^9}, {3.915054460154357*^9, 3.915054502653194*^9}, {
   3.91505460820186*^9, 
   3.915054679958024*^9}},ExpressionUUID->"41ce08d8-a9f1-46fb-9281-\
22ceac002058"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DefineInferenceRule", "[", 
   RowBox[{"Co", ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"And", "[", 
        RowBox[{
         RowBox[{"Binary", "[", 
          RowBox[{"\"\<C\>\"", ",", "left_", ",", "right_"}], "]"}], ",", 
         "left_"}], "]"}], "\[RuleDelayed]", "right"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"And", "[", 
        RowBox[{"left_", ",", 
         RowBox[{"Binary", "[", 
          RowBox[{"\"\<C\>\"", ",", "left_", ",", "right_"}], "]"}]}], "]"}], 
       "\[RuleDelayed]", "right"}]}], "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.548985948870734*^9, 3.548985982823676*^9}, {
   3.5490142959238644`*^9, 3.549014300456064*^9}, {3.549014524769328*^9, 
   3.549014532539276*^9}, {3.549014583388037*^9, 3.549014589555501*^9}, {
   3.5490146669307685`*^9, 3.549014675709365*^9}, {3.549015627212323*^9, 
   3.5490156922172985`*^9}, 3.5490161816309958`*^9, {3.549016294123705*^9, 
   3.549016312197397*^9}, {3.5490163632205024`*^9, 3.5490163747768183`*^9}, {
   3.549016404948361*^9, 3.549016417353713*^9}, {3.549016454984213*^9, 
   3.5490164923168726`*^9}, {3.5490166669551477`*^9, 3.54901667213478*^9}, {
   3.549361761989845*^9, 3.549361765541047*^9}, 3.54950393823186*^9, {
   3.5495039768130665`*^9, 3.5495039795512238`*^9}, {3.549504049167205*^9, 
   3.549504076395763*^9}, {3.549504106842504*^9, 3.549504107560545*^9}, {
   3.549504263199447*^9, 3.549504282586556*^9}, {3.549504313340315*^9, 
   3.54950433527757*^9}, 3.5496169208520966`*^9, {3.5496346364863586`*^9, 
   3.549634645857294*^9}, 3.549634702788986*^9, {3.549634922467498*^9, 
   3.549634931602498*^9}, {3.549635299396498*^9, 3.549635299404498*^9}, {
   3.549635450970498*^9, 3.5496354938750963`*^9}, {3.5501458901557508`*^9, 
   3.550145897699182*^9}, 3.550147595123268*^9},
 CellLabel->
  "In[668]:=",ExpressionUUID->"91fa7d87-bfc9-4867-92e5-ea1776ff5f4b"],

Cell[TextData[{
 "The following, CoL and CoR, are not proper rules of inference according to \
the usual interpretation of ",
 StyleBox["Condition",
  FontSlant->"Italic"],
 ", but they are useful for examples 2 and 3 on page 90 of WFF-n-Proof. "
}], "Text",
 CellChangeTimes->{{3.5495043379977255`*^9, 3.5495044379894447`*^9}, {
   3.549591294399348*^9, 3.549591343862176*^9}, 3.549617969332066*^9, {
   3.55014771401707*^9, 3.550147719056359*^9}, 
   3.912601666987385*^9},ExpressionUUID->"2b344a99-86a3-4694-b3fb-\
a16516100c4d"],

Cell[TextData[{
 "Let ",
 StyleBox["CLR", "Input"],
 " stand for any term like ",
 StyleBox["Cpq", "Input"],
 ", where ",
 StyleBox["L=p", "Input"],
 " and ",
 StyleBox["R=q", "Input"],
 "."
}], "Text",
 CellChangeTimes->{{3.9126023253512783`*^9, 
  3.91260238036052*^9}},ExpressionUUID->"8a0c78a6-7046-4b28-a3da-\
ed3013d4e941"],

Cell["\<\
If we are given ONLY CLR and R, can we deduce L? Not from Co. Co lets us \
deduce R from CLR and L but not L from CLR and R. However, we can say, from \
CLR and R, that L is a possibility \[LongDash] a possible solution to the \
following problem: \[OpenCurlyDoubleQuote]Given CLR and R, is there some L \
such that CLR and L implies R, and if so, what is this L?\
\[CloseCurlyDoubleQuote] In other words, L is consistent with CLR and R; L \
does not produce a contradiction. \
\>", "Text",
 CellChangeTimes->{{3.549618005684145*^9, 3.549618179092064*^9}, {
   3.5496183717160807`*^9, 3.549618402051816*^9}, 3.911290353018022*^9, {
   3.912602274920642*^9, 3.912602315701154*^9}, {3.912602399422743*^9, 
   3.91260240212833*^9}},ExpressionUUID->"85848ab0-5cdb-42a2-8f44-\
e5ff7c2c7544"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Directed Rules CoL and CoR are Not Inference Rules", "Subsubsection",
 CellChangeTimes->{{3.9126021333736954`*^9, 3.91260215169346*^9}, {
  3.912602539802528*^9, 
  3.912602542937011*^9}},ExpressionUUID->"afbacb94-c20c-46c9-b9f8-\
b9c48c63fda0"],

Cell[TextData[{
 "Write a ",
 StyleBox["directed rule",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 ", CoL, that solves the problem of finding an L that implies R given CLR. \
Later, we write a generic solver and discard these directed rules."
}], "Text",
 CellChangeTimes->{{3.549618187867565*^9, 3.549618210187842*^9}, {
  3.549618258100582*^9, 3.549618260699731*^9}, {3.91260221626284*^9, 
  3.91260223660558*^9}, {3.912602426798418*^9, 
  3.912602472917664*^9}},ExpressionUUID->"a9f4f0c3-9ea7-4cf5-b398-\
6b68709758eb"],

Cell["\<\
Do not apply directed rules in an inference. Instead, use them to search for \
solutions. \
\>", "Text",
 CellChangeTimes->{{3.912602163533432*^9, 3.912602204168951*^9}, {
  3.912602481783245*^9, 
  3.91260249250683*^9}},ExpressionUUID->"bc7afd5e-ca2b-4a0f-ad28-\
c09383266246"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DefineInferenceRule", "[", 
   RowBox[{"CoL", ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"And", "[", 
        RowBox[{
         RowBox[{"Binary", "[", 
          RowBox[{"\"\<C\>\"", ",", "left_", ",", "right_"}], "]"}], ",", 
         "right_"}], "]"}], "\[RuleDelayed]", "left"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"And", "[", 
        RowBox[{"right_", ",", 
         RowBox[{"Binary", "[", 
          RowBox[{"\"\<C\>\"", ",", "left_", ",", "right_"}], "]"}]}], "]"}], 
       "\[RuleDelayed]", "left"}]}], "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.548985948870734*^9, 3.548985982823676*^9}, {
   3.5490142959238644`*^9, 3.549014300456064*^9}, {3.549014524769328*^9, 
   3.549014532539276*^9}, {3.549014583388037*^9, 3.549014589555501*^9}, {
   3.5490146669307685`*^9, 3.549014675709365*^9}, {3.549015627212323*^9, 
   3.5490156922172985`*^9}, 3.5490161816309958`*^9, {3.549016294123705*^9, 
   3.549016312197397*^9}, {3.5490163632205024`*^9, 3.5490163747768183`*^9}, {
   3.549016404948361*^9, 3.549016417353713*^9}, {3.549016454984213*^9, 
   3.5490164923168726`*^9}, {3.5490166669551477`*^9, 3.54901667213478*^9}, {
   3.549361761989845*^9, 3.549361765541047*^9}, 3.54950393823186*^9, {
   3.5495039768130665`*^9, 3.5495039795512238`*^9}, {3.549504049167205*^9, 
   3.549504076395763*^9}, {3.549504106842504*^9, 3.549504107560545*^9}, {
   3.549504263199447*^9, 3.549504282586556*^9}, {3.549504313340315*^9, 
   3.54950433527757*^9}, {3.549504395734028*^9, 3.549504398975213*^9}, {
   3.549504557578285*^9, 3.549504603394905*^9}, 3.549591349454496*^9, 
   3.549591427377953*^9, {3.549617993567452*^9, 3.549617997142657*^9}, 
   3.549618183980343*^9, {3.5496346692176294`*^9, 3.5496346890006075`*^9}, {
   3.549634936365498*^9, 3.549634936730499*^9}, 3.549635299413498*^9, {
   3.5496355043461437`*^9, 3.549635549621671*^9}, {3.550145905947654*^9, 
   3.55014591269904*^9}},
 CellLabel->
  "In[669]:=",ExpressionUUID->"0e8fda2b-0a9a-4a8c-9d52-e65b29827461"],

Cell["\<\
A related problem is \[OpenCurlyDoubleQuote]Given L and R, can we find a rule \
involving C such that CLR obtains?\[CloseCurlyDoubleQuote] This is not an \
inference, but a possibility. We can\[CloseCurlyQuote]t deduce CLR from L and \
R, but we can say that CLR is consistent with L and R.\
\>", "Text",
 CellChangeTimes->{{3.549618274907544*^9, 3.5496183600684147`*^9}, {
  3.623888467417715*^9, 3.62388846820731*^9}, {3.912602501677782*^9, 
  3.912602525548922*^9}},ExpressionUUID->"2a443756-d677-4cbf-821b-\
602ce795a738"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DefineInferenceRule", "[", 
   RowBox[{"CoR", ",", 
    RowBox[{
     RowBox[{"And", "[", 
      RowBox[{"left_", ",", "right_"}], "]"}], "\[RuleDelayed]", 
     RowBox[{"Binary", "[", 
      RowBox[{"\"\<C\>\"", ",", "left", ",", "right"}], "]"}]}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.548985948870734*^9, 3.548985982823676*^9}, {
   3.5490142959238644`*^9, 3.549014300456064*^9}, {3.549014524769328*^9, 
   3.549014532539276*^9}, {3.549014583388037*^9, 3.549014589555501*^9}, {
   3.5490146669307685`*^9, 3.549014675709365*^9}, {3.549015627212323*^9, 
   3.5490156922172985`*^9}, 3.5490161816309958`*^9, {3.549016294123705*^9, 
   3.549016312197397*^9}, {3.5490163632205024`*^9, 3.5490163747768183`*^9}, {
   3.549016404948361*^9, 3.549016417353713*^9}, {3.549016454984213*^9, 
   3.5490164923168726`*^9}, {3.5490166669551477`*^9, 3.54901667213478*^9}, {
   3.549361761989845*^9, 3.549361765541047*^9}, 3.54950393823186*^9, {
   3.5495039768130665`*^9, 3.5495039795512238`*^9}, {3.549504049167205*^9, 
   3.549504076395763*^9}, {3.549504106842504*^9, 3.549504107560545*^9}, {
   3.549504263199447*^9, 3.549504282586556*^9}, {3.549504313340315*^9, 
   3.54950433527757*^9}, {3.549504395734028*^9, 3.549504398975213*^9}, {
   3.549504557578285*^9, 3.549504603394905*^9}, 3.549591349454496*^9, 
   3.549591427377953*^9, {3.549617993567452*^9, 3.549617997142657*^9}, 
   3.549618183980343*^9, {3.549634939630498*^9, 3.549634940045498*^9}, 
   3.549635299421499*^9, {3.550145917251301*^9, 3.550145922634608*^9}},
 CellLabel->
  "In[670]:=",ExpressionUUID->"b090521a-379f-4c86-a9bc-7cb9c41e6dd4"],

Cell["Examples", "Text",
 CellChangeTimes->{{3.912610005430953*^9, 3.912610016362534*^9}},
 FontWeight->"Bold",ExpressionUUID->"1ea179d0-b611-459f-91e2-cd16547d79c1"],

Cell["Inference in the forward direction.", "Text",
 CellChangeTimes->{{3.912610369924175*^9, 
  3.912610382601841*^9}},ExpressionUUID->"be71a2eb-b9ed-473c-ac22-\
e1c74d9e0e2c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"$p", "@", "\"\<Cpq\>\""}], ")"}], "&&", 
   RowBox[{"(", 
    RowBox[{"$p", "@", "\"\<p\>\""}], ")"}]}], "/.", "Co"}]], "Input",
 CellChangeTimes->{{3.912610021625572*^9, 3.912610040525799*^9}, {
  3.912610210141697*^9, 3.912610222041793*^9}, {3.9126102662247143`*^9, 
  3.912610318186637*^9}},
 CellLabel->
  "In[671]:=",ExpressionUUID->"21d4c6bb-bdd5-4de7-8c4f-58e72744a66f"],

Cell[BoxData[
 RowBox[{"Proposition", "[", "\<\"q\"\>", "]"}]], "Output",
 CellChangeTimes->{{3.912610305306986*^9, 3.912610320112848*^9}, 
   3.915050871474256*^9, 3.915535457416317*^9},
 CellLabel->
  "Out[671]=",ExpressionUUID->"c1c03cdb-29ad-4a34-ac8a-10794e3c78b0"]
}, Open  ]],

Cell["No inference backwards (Co is like a diode).", "Text",
 CellChangeTimes->{{3.9126103858213863`*^9, 
  3.912610405446553*^9}},ExpressionUUID->"3de20d9a-e5d4-445c-a147-\
3a51d3b92159"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"$p", "@", "\"\<Cpq\>\""}], ")"}], "&&", 
    RowBox[{"(", 
     RowBox[{"$p", "@", "\"\<q\>\""}], ")"}]}], "/.", "Co"}], ")"}]], "Input",
 CellChangeTimes->{{3.912610021625572*^9, 3.912610040525799*^9}, {
  3.912610210141697*^9, 3.912610222041793*^9}, {3.9126102662247143`*^9, 
  3.912610318186637*^9}, {3.912610350674283*^9, 3.912610351247574*^9}, {
  3.9126104324655533`*^9, 3.912610469906493*^9}},
 CellLabel->
  "In[672]:=",ExpressionUUID->"f445b0de-bb05-4e71-9fc2-9645633b219c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Binary", "[", 
   RowBox[{"\<\"C\"\>", ",", 
    RowBox[{"Proposition", "[", "\<\"p\"\>", "]"}], ",", 
    RowBox[{"Proposition", "[", "\<\"q\"\>", "]"}]}], "]"}], "&&", 
  RowBox[{"Proposition", "[", "\<\"q\"\>", "]"}]}]], "Output",
 CellChangeTimes->{3.912610470919518*^9, 3.915050871479858*^9, 
  3.915535457423882*^9},
 CellLabel->
  "Out[672]=",ExpressionUUID->"7cd8f6cc-c9eb-4923-9239-3270a47e16e2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"$p", "@", "\"\<Cpq\>\""}], ")"}], "&&", 
     RowBox[{"(", 
      RowBox[{"$p", "@", "\"\<q\>\""}], ")"}]}], "/.", "Co"}], ")"}], "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"$p", "@", "\"\<Cpq\>\""}], ")"}], "&&", 
    RowBox[{"(", 
     RowBox[{"$p", "@", "\"\<q\>\""}], ")"}]}], ")"}]}]], "Input",
 CellChangeTimes->{{3.912610021625572*^9, 3.912610040525799*^9}, {
  3.912610210141697*^9, 3.912610222041793*^9}, {3.9126102662247143`*^9, 
  3.912610318186637*^9}, {3.912610350674283*^9, 3.912610351247574*^9}, {
  3.9126104324655533`*^9, 3.9126104577072353`*^9}},
 CellLabel->
  "In[673]:=",ExpressionUUID->"c855ab79-c194-4fae-9f58-e16fcbc6e842"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.912610351961454*^9, 3.912610458493382*^9, 
  3.915050871486989*^9, 3.915535457427082*^9},
 CellLabel->
  "Out[673]=",ExpressionUUID->"ad0bdfb3-98a6-4ee3-a792-7ed085800eda"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["mnemonic: \[OpenCurlyDoubleQuote]A\[CloseCurlyDoubleQuote] is not AND, \
it\[CloseCurlyQuote]s OR!", "Subsubsection",
 CellChangeTimes->{{3.549361805821351*^9, 
  3.549361834540994*^9}},ExpressionUUID->"e47e62a7-f7a7-4735-b20f-\
5189f4693781"],

Cell[TextData[{
 "The combinatorics on this one are annoying \[LongDash] arguing that we \
would really like an Orderless version of ",
 StyleBox["And", "Input"],
 ", but we can\[CloseCurlyQuote]t tolerate an orderless ",
 StyleBox["And", "Input"],
 " without an infix operator, and we don\[CloseCurlyQuote]t want that."
}], "Text",
 CellChangeTimes->{{3.5496355723549438`*^9, 3.549635611398847*^9}, {
   3.550147795568734*^9, 3.550147810232573*^9}, 3.9112903540401573`*^9, {
   3.912602625274593*^9, 3.912602642042626*^9}, 3.912602676401879*^9, {
   3.9150547402396517`*^9, 
   3.915054745065896*^9}},ExpressionUUID->"27826ebb-00c9-4f2d-a582-\
f89c7a810db1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Attributes", "[", "And", "]"}]], "Input",
 CellChangeTimes->{{3.550147813548763*^9, 3.550147820193143*^9}},
 CellLabel->
  "In[674]:=",ExpressionUUID->"6ca4929a-d3dc-4189-9777-9a21ebb53046"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"Flat", ",", "HoldAll", ",", "OneIdentity", ",", "Protected"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.5501478230463057`*^9, 3.55014847315849*^9, 3.5501529407391973`*^9, 
   3.550153022682884*^9, 3.550153156219522*^9, 3.5502218135833225`*^9, 
   3.5502243274451075`*^9, 3.550364524521926*^9, 3.550412003798677*^9, 
   3.5507106150923786`*^9, 3.6234104223758087`*^9, 3.623890756369431*^9, 
   3.624409980708726*^9, 3.629583254150033*^9, 3.6295841355552063`*^9, 
   3.6456539569000463`*^9, 3.645656250765919*^9, 3.6457496147191353`*^9, 
   3.687638698923594*^9, 3.687638747676605*^9, 3.841155561973743*^9, 
   3.841163857580432*^9, 3.8411640309073*^9, 3.841164606220542*^9, 
   3.841166570180417*^9, 3.841166679781049*^9, 3.841166862316151*^9, 
   3.841166896553204*^9, 3.841220349915772*^9, 3.84122907944699*^9, 
   3.8412300862075453`*^9, 3.841230195383831*^9, 3.841248972688183*^9, 
   3.841249028441597*^9, 3.841249075455529*^9, 3.8413182708412857`*^9, 
   3.8413221510810204`*^9, 3.841322403778597*^9, 3.84132475819592*^9, 
   3.841324987811996*^9, 3.841332924467461*^9, 3.841350164593294*^9, 
   3.84135223840508*^9, 3.841392982302997*^9, 3.841403443079218*^9, {
   3.841405456685522*^9, 3.841405478412066*^9}, 3.841422366642843*^9, 
   3.911255353625149*^9, 3.911290461456805*^9, 3.91226952664471*^9, 
   3.912546353175544*^9, 3.912589071699414*^9, 3.912600351173695*^9, 
   3.912601706308563*^9, 3.915050871490264*^9, 3.9155354574357986`*^9},
 CellLabel->
  "Out[674]=",ExpressionUUID->"9d219e55-bd12-464e-ba07-c826cba1e66a"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"DefineInferenceRule", "[", 
   RowBox[{"Ao", ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"And", "[", 
        RowBox[{
         RowBox[{"Binary", "[", 
          RowBox[{"\"\<A\>\"", ",", "l_", ",", "r_"}], "]"}], ",", 
         RowBox[{"l_", "\[RuleDelayed]", "f_"}], ",", 
         RowBox[{"r_", "\[RuleDelayed]", "f_"}]}], "]"}], "\[RuleDelayed]", 
       "f"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"And", "[", 
        RowBox[{
         RowBox[{"Binary", "[", 
          RowBox[{"\"\<A\>\"", ",", "l_", ",", "r_"}], "]"}], ",", 
         RowBox[{"r_", "\[RuleDelayed]", "f_"}], ",", 
         RowBox[{"l_", "\[RuleDelayed]", "f_"}]}], "]"}], "\[RuleDelayed]", 
       "f"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"And", "[", 
        RowBox[{
         RowBox[{"l_", "\[RuleDelayed]", "f_"}], ",", 
         RowBox[{"Binary", "[", 
          RowBox[{"\"\<A\>\"", ",", "l_", ",", "r_"}], "]"}], ",", 
         RowBox[{"r_", "\[RuleDelayed]", "f_"}]}], "]"}], "\[RuleDelayed]", 
       "f"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"And", "[", 
        RowBox[{
         RowBox[{"r_", "\[RuleDelayed]", "f_"}], ",", 
         RowBox[{"Binary", "[", 
          RowBox[{"\"\<A\>\"", ",", "l_", ",", "r_"}], "]"}], ",", 
         RowBox[{"l_", "\[RuleDelayed]", "f_"}]}], "]"}], "\[RuleDelayed]", 
       "f"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"And", "[", 
        RowBox[{
         RowBox[{"l_", "\[RuleDelayed]", "f_"}], ",", 
         RowBox[{"r_", "\[RuleDelayed]", "f_"}], ",", 
         RowBox[{"Binary", "[", 
          RowBox[{"\"\<A\>\"", ",", "l_", ",", "r_"}], "]"}]}], "]"}], 
       "\[RuleDelayed]", "f"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"And", "[", 
        RowBox[{
         RowBox[{"r_", "\[RuleDelayed]", "f_"}], ",", 
         RowBox[{"l_", "\[RuleDelayed]", "f_"}], ",", 
         RowBox[{"Binary", "[", 
          RowBox[{"\"\<A\>\"", ",", "l_", ",", "r_"}], "]"}]}], "]"}], 
       "\[RuleDelayed]", "f"}]}], "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.548985948870734*^9, 3.548985982823676*^9}, {
   3.5490142959238644`*^9, 3.549014300456064*^9}, {3.549014524769328*^9, 
   3.549014532539276*^9}, {3.549014583388037*^9, 3.549014589555501*^9}, {
   3.5490146669307685`*^9, 3.549014675709365*^9}, {3.549015627212323*^9, 
   3.5490156922172985`*^9}, 3.5490161816309958`*^9, {3.549016294123705*^9, 
   3.549016312197397*^9}, {3.5490163632205024`*^9, 3.5490163747768183`*^9}, {
   3.549016404948361*^9, 3.549016417353713*^9}, {3.549016454984213*^9, 
   3.5490164923168726`*^9}, {3.5490166669551477`*^9, 3.54901667213478*^9}, {
   3.549361761989845*^9, 3.5493617752136*^9}, {3.549591437953558*^9, 
   3.549591452201373*^9}, 3.549634947624498*^9, 3.5496352994284983`*^9, {
   3.549635614944202*^9, 3.549635820560761*^9}, {3.550145926287818*^9, 
   3.550145932415168*^9}},
 CellLabel->
  "In[675]:=",ExpressionUUID->"a6e7eb8f-55c2-42b0-809b-f3e3e5b396b1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["mnemonic: \[OpenCurlyDoubleQuote]N\[CloseCurlyDoubleQuote] is \
\[OpenCurlyDoubleQuote]Negation\[CloseCurlyDoubleQuote]", "Subsubsection",
 CellChangeTimes->{{3.5493619125414557`*^9, 
  3.549361918292784*^9}},ExpressionUUID->"98b95049-aeee-47c6-a5ae-\
188b5c952598"],

Cell[TextData[{
 "Twisted ",
 StyleBox["Modus Tollens",
  FontWeight->"Bold"],
 " (\[OpenCurlyDoubleQuote]not q\[CloseCurlyDoubleQuote] and \
\[OpenCurlyDoubleQuote]p implies q\[CloseCurlyDoubleQuote] means \
\[OpenCurlyDoubleQuote]p\[CloseCurlyDoubleQuote] is false); negation on the \
left"
}], "Text",
 CellChangeTimes->{{3.548985948870734*^9, 3.548985982823676*^9}, {
   3.5490142959238644`*^9, 3.5490143004560637`*^9}, {3.549014524769328*^9, 
   3.549014532539276*^9}, {3.549014583388037*^9, 3.549014589555501*^9}, {
   3.5490146669307685`*^9, 3.549014675709365*^9}, {3.549015627212323*^9, 
   3.5490156922172985`*^9}, 3.5490161816309958`*^9, {3.549016294123705*^9, 
   3.549016312197397*^9}, {3.5490163632205024`*^9, 3.5490163747768183`*^9}, {
   3.549016404948361*^9, 3.549016417353713*^9}, {3.549016454984213*^9, 
   3.5490164923168726`*^9}, {3.5490166669551477`*^9, 3.54901667213478*^9}, {
   3.549361761989845*^9, 3.5493617752136*^9}, 3.549361890333185*^9, {
   3.5495913918309207`*^9, 3.549591399342349*^9}, {3.915054759212552*^9, 
   3.915054854216134*^9}},ExpressionUUID->"8cb69cb5-6599-4ad0-a37a-\
df56ceafa82f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DefineInferenceRule", "[", 
   RowBox[{"No", ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"And", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Unary", "[", 
           RowBox[{"\"\<N\>\"", ",", "left_"}], "]"}], "\[RuleDelayed]", 
          "right_"}], ",", 
         RowBox[{"Unary", "[", 
          RowBox[{"\"\<N\>\"", ",", "right_"}], "]"}]}], "]"}], 
       "\[RuleDelayed]", "left"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"And", "[", 
        RowBox[{
         RowBox[{"Unary", "[", 
          RowBox[{"\"\<N\>\"", ",", "right_"}], "]"}], ",", 
         RowBox[{
          RowBox[{"Unary", "[", 
           RowBox[{"\"\<N\>\"", ",", "left_"}], "]"}], "\[RuleDelayed]", 
          "right_"}]}], "]"}], "\[RuleDelayed]", "left"}]}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.548985948870734*^9, 3.548985982823676*^9}, {
   3.5490142959238644`*^9, 3.549014300456064*^9}, {3.549014524769328*^9, 
   3.549014532539276*^9}, {3.549014583388037*^9, 3.549014589555501*^9}, {
   3.5490146669307685`*^9, 3.549014675709365*^9}, {3.549015627212323*^9, 
   3.5490156922172985`*^9}, 3.5490161816309958`*^9, {3.549016294123705*^9, 
   3.549016312197397*^9}, {3.5490163632205024`*^9, 3.5490163747768183`*^9}, {
   3.549016404948361*^9, 3.549016417353713*^9}, {3.549016454984213*^9, 
   3.5490164923168726`*^9}, {3.5490166669551477`*^9, 3.54901667213478*^9}, {
   3.549361761989845*^9, 3.5493617752136*^9}, 3.549361890333185*^9, 
   3.5495913918309216`*^9, 3.549634958644498*^9, 3.549635299436498*^9, {
   3.549635867120417*^9, 3.549635889475839*^9}, {3.55014593577236*^9, 
   3.5501459407476444`*^9}, {3.912603398369804*^9, 3.912603402566555*^9}},
 CellLabel->
  "In[676]:=",ExpressionUUID->"ad86dd7b-6e89-468d-a61c-1d6343af9b26"]
}, Open  ]],

Cell[CellGroupData[{

Cell["mnemonic: \[OpenCurlyDoubleQuote]E\[CloseCurlyDoubleQuote] is \
\[OpenCurlyDoubleQuote]Equivalence\[CloseCurlyDoubleQuote]", "Subsubsection",
 CellChangeTimes->{{3.549361893605373*^9, 
  3.5493619065011096`*^9}},ExpressionUUID->"6e345ede-566e-4313-b84f-\
167fa571ef3f"],

Cell["\[OpenCurlyDoubleQuote]p\[CloseCurlyDoubleQuote] implies \
\[OpenCurlyDoubleQuote]q\[CloseCurlyDoubleQuote] and \[OpenCurlyDoubleQuote]q\
\[CloseCurlyDoubleQuote] implies \[OpenCurlyDoubleQuote]p\
\[CloseCurlyDoubleQuote].", "Text",
 CellChangeTimes->{{3.9150548709327374`*^9, 
  3.915054882580587*^9}},ExpressionUUID->"b6fa98e3-6ef4-4a31-9f0e-\
081c7c8851c5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DefineInferenceRule", "[", 
   RowBox[{"Eo", ",", 
    RowBox[{
     RowBox[{"Binary", "[", 
      RowBox[{"\"\<E\>\"", ",", "left_", ",", "right_"}], "]"}], 
     "\[RuleDelayed]", 
     RowBox[{"And", "[", 
      RowBox[{
       RowBox[{"Binary", "[", 
        RowBox[{"\"\<C\>\"", ",", "left", ",", "right"}], "]"}], ",", 
       RowBox[{"Binary", "[", 
        RowBox[{"\"\<C\>\"", ",", "right", ",", "left"}], "]"}]}], "]"}]}]}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.548985948870734*^9, 3.548985982823676*^9}, {
   3.5490142959238644`*^9, 3.549014300456064*^9}, {3.549014524769328*^9, 
   3.549014532539276*^9}, {3.549014583388037*^9, 3.549014589555501*^9}, {
   3.5490146669307685`*^9, 3.549014675709365*^9}, {3.549015627212323*^9, 
   3.5490156922172985`*^9}, 3.5490161816309958`*^9, {3.549016294123705*^9, 
   3.549016312197397*^9}, {3.5490163632205024`*^9, 3.5490163747768183`*^9}, {
   3.549016404948361*^9, 3.549016417353713*^9}, {3.549016454984213*^9, 
   3.5490164923168726`*^9}, {3.5490166669551477`*^9, 3.54901667213478*^9}, {
   3.549361761989845*^9, 3.5493617752136*^9}, 3.549361890333185*^9, 
   3.549634964241498*^9, 3.549635299447499*^9, {3.550145944314849*^9, 
   3.550145950691213*^9}},
 CellLabel->
  "In[677]:=",ExpressionUUID->"9f4ffd3b-c8d7-4bba-9e24-f0d5cfb34713"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Incoming Rules", "Subsection",
 CellChangeTimes->{{3.548762384902343*^9, 
  3.548762388279018*^9}},ExpressionUUID->"a0a6a5bb-0294-4ee7-ae7b-\
e6bc0b003437"],

Cell["Produce grammatical terms from parts", "Text",
 CellChangeTimes->{{3.548762391199602*^9, 3.5487623974878597`*^9}, {
  3.915054989577778*^9, 
  3.915054991594315*^9}},ExpressionUUID->"72197689-548c-4300-a16e-\
4e7c2367738a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DefineInferenceRule", "[", 
   RowBox[{"Ki", ",", 
    RowBox[{
     RowBox[{"And", "[", 
      RowBox[{"left_", ",", "right_"}], "]"}], "\[RuleDelayed]", 
     RowBox[{"Binary", "[", 
      RowBox[{"\"\<K\>\"", ",", "left", ",", "right"}], "]"}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DefineInferenceRule", "[", 
   RowBox[{"Ci", ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"left_", "\[RuleDelayed]", "right_"}], ")"}], "\[RuleDelayed]", 
     RowBox[{"Binary", "[", 
      RowBox[{"\"\<C\>\"", ",", "left", ",", "right"}], "]"}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DefineInferenceRule", "[", 
   RowBox[{"Ai", ",", 
    RowBox[{"left_", "\[RuleDelayed]", 
     RowBox[{"And", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Binary", "[", 
        RowBox[{"\"\<A\>\"", ",", "left", ",", "right_"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Binary", "[", 
        RowBox[{"\"\<A\>\"", ",", "right_", ",", "left"}], "]"}]}], "]"}]}]}],
    "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DefineInferenceRule", "[", 
   RowBox[{"AiL", ",", 
    RowBox[{"left_", "\[RuleDelayed]", 
     RowBox[{"Binary", "[", 
      RowBox[{"\"\<A\>\"", ",", "left", ",", "right_"}], "]"}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DefineInferenceRule", "[", 
   RowBox[{"AiR", ",", 
    RowBox[{"Binary", "[", 
     RowBox[{"\"\<A\>\"", ",", "right_", ",", "left"}], "]"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.548985097414034*^9, 3.548985116129104*^9}, {
  3.548985433186239*^9, 3.548985446697012*^9}, {3.54901333710607*^9, 
  3.549013343962588*^9}, {3.5490138190187*^9, 3.5490139483084955`*^9}, {
  3.549014305867708*^9, 3.54901442739775*^9}, {3.549014707510981*^9, 
  3.5490147133488398`*^9}, {3.549362060985946*^9, 3.5493620930577803`*^9}, {
  3.549591478974904*^9, 3.549591511627772*^9}, {3.549634965951498*^9, 
  3.549634967186499*^9}, {3.549635299457498*^9, 3.549635299463498*^9}, {
  3.550145954270418*^9, 3.5501459878543386`*^9}},
 CellLabel->
  "In[678]:=",ExpressionUUID->"9a7548f5-ca6f-4c21-af20-a4cb66363467"],

Cell[TextData[{
 StyleBox["Modus Tollens",
  FontWeight->"Bold"],
 " (\[OpenCurlyDoubleQuote]p\[CloseCurlyDoubleQuote] implies \
\[OpenCurlyDoubleQuote]q\[CloseCurlyDoubleQuote] and \
\[OpenCurlyDoubleQuote]not q\[CloseCurlyDoubleQuote] means \
\[OpenCurlyDoubleQuote]p\[CloseCurlyDoubleQuote] is false)."
}], "Text",
 CellChangeTimes->{{3.548985097414034*^9, 3.548985116129104*^9}, {
  3.548985433186239*^9, 3.548985446697012*^9}, {3.54901333710607*^9, 
  3.549013343962588*^9}, {3.5490138190187*^9, 3.5490139483084955`*^9}, {
  3.549014305867708*^9, 3.54901442739775*^9}, {3.5490147075109806`*^9, 
  3.5490147133488398`*^9}, {3.549362060985946*^9, 3.5493620930577803`*^9}, {
  3.549591478974904*^9, 3.5495914870383654`*^9}, {3.915054900722198*^9, 
  3.915054924982436*^9}},ExpressionUUID->"d0f64d53-5953-4b38-9892-\
92e27d361739"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DefineInferenceRule", "[", 
   RowBox[{"Ni", ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"And", "[", 
        RowBox[{
         RowBox[{"left_", "\[RuleDelayed]", "right_"}], ",", 
         RowBox[{"Unary", "[", 
          RowBox[{"\"\<N\>\"", ",", "right_"}], "]"}]}], "]"}], 
       "\[RuleDelayed]", 
       RowBox[{"Unary", "[", 
        RowBox[{"\"\<N\>\"", ",", "left"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"And", "[", 
        RowBox[{
         RowBox[{"Unary", "[", 
          RowBox[{"\"\<N\>\"", ",", "right_"}], "]"}], ",", 
         RowBox[{"left_", "\[RuleDelayed]", "right_"}]}], "]"}], 
       "\[RuleDelayed]", 
       RowBox[{"Unary", "[", 
        RowBox[{"\"\<N\>\"", ",", "left"}], "]"}]}]}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.548985097414034*^9, 3.548985116129104*^9}, {
   3.548985433186239*^9, 3.548985446697012*^9}, {3.54901333710607*^9, 
   3.549013343962588*^9}, {3.5490138190187*^9, 3.5490139483084955`*^9}, {
   3.549014305867708*^9, 3.54901442739775*^9}, {3.549014707510981*^9, 
   3.5490147133488398`*^9}, {3.549362060985946*^9, 3.5493620930577803`*^9}, {
   3.549591478974904*^9, 3.54959147995096*^9}, {3.549591522689405*^9, 
   3.549591537210235*^9}, 3.5496170329565086`*^9, 3.549634968732498*^9, 
   3.549635299470498*^9, {3.549635982004839*^9, 3.5496360081758394`*^9}, {
   3.550145990524491*^9, 3.550145995659784*^9}},
 CellLabel->
  "In[683]:=",ExpressionUUID->"d63f254d-4a98-435d-8c81-40b129528c21"],

Cell[TextData[StyleBox["Equivalence",
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{{3.549965547656456*^9, 
  3.549965552944758*^9}},ExpressionUUID->"7c9df154-3d84-47ad-a8f6-\
be8227ba686c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DefineInferenceRule", "[", 
   RowBox[{"Ei", ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"And", "[", 
        RowBox[{
         RowBox[{"Binary", "[", 
          RowBox[{"\"\<C\>\"", ",", "l_", ",", "r_"}], "]"}], ",", 
         RowBox[{"Binary", "[", 
          RowBox[{"\"\<C\>\"", ",", "r_", ",", "l_"}], "]"}]}], "]"}], 
       "\[RuleDelayed]", 
       RowBox[{"Binary", "[", 
        RowBox[{"\"\<E\>\"", ",", "l", ",", "r"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"And", "[", 
        RowBox[{
         RowBox[{"Binary", "[", 
          RowBox[{"\"\<C\>\"", ",", "r_", ",", "l_"}], "]"}], ",", 
         RowBox[{"Binary", "[", 
          RowBox[{"\"\<C\>\"", ",", "l_", ",", "r_"}], "]"}]}], "]"}], 
       "\[RuleDelayed]", 
       RowBox[{"Binary", "[", 
        RowBox[{"\"\<E\>\"", ",", "l", ",", "r"}], "]"}]}]}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.548985097414034*^9, 3.548985116129104*^9}, {
   3.548985433186239*^9, 3.548985446697012*^9}, {3.54901333710607*^9, 
   3.549013343962588*^9}, {3.5490138190187*^9, 3.5490139483084955`*^9}, {
   3.549014305867708*^9, 3.54901442739775*^9}, {3.549014707510981*^9, 
   3.5490147133488398`*^9}, {3.549362060985946*^9, 3.5493620930577803`*^9}, {
   3.549591478974904*^9, 3.54959147995096*^9}, {3.549591522689405*^9, 
   3.549591537210235*^9}, 3.5496170329565086`*^9, 3.549634970479498*^9, 
   3.549635299479498*^9, {3.5496360121478395`*^9, 3.5496360666048393`*^9}, {
   3.5501460069404306`*^9, 3.5501460116517*^9}},
 CellLabel->
  "In[684]:=",ExpressionUUID->"7c5d80cc-87b9-45bc-9d78-00894339bca7"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Examples", "Subsection",
 CellChangeTimes->{{3.549016799862105*^9, 
  3.549016801356962*^9}},ExpressionUUID->"8a0d4b60-736b-4e3a-80e4-\
fbfc4e7a36e5"],

Cell[CellGroupData[{

Cell["Example 1:", "Subsubsection",
 CellChangeTimes->{{3.5493654120056133`*^9, 
  3.5493654240293*^9}},ExpressionUUID->"844d10e6-bf17-420d-aadc-bd5f0c97a119"],

Cell["just a parse", "Text",
 CellChangeTimes->{{3.915055008890946*^9, 
  3.915055010591436*^9}},ExpressionUUID->"8ce2e632-dc59-43bf-833f-\
4d128af55030"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"$p", "@", "\"\<Kpq\>\""}]], "Input",
 CellChangeTimes->{{3.549362182136875*^9, 3.5493621901293325`*^9}, 
   3.549634337718483*^9},
 CellLabel->
  "In[685]:=",ExpressionUUID->"6e234509-3698-48a9-ab6f-e743189d4477"],

Cell[BoxData[
 RowBox[{"Binary", "[", 
  RowBox[{"\<\"K\"\>", ",", 
   RowBox[{"Proposition", "[", "\<\"p\"\>", "]"}], ",", 
   RowBox[{"Proposition", "[", "\<\"q\"\>", "]"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.549362191291399*^9, 3.5495033308211184`*^9, 3.549589118581898*^9, 
   3.549589268900496*^9, 3.549633477562472*^9, 3.5496343693876495`*^9, 
   3.549634706885396*^9, 3.549634995120498*^9, 3.549636076547839*^9, 
   3.549652449150871*^9, 3.549964911996098*^9, 3.549965561303236*^9, 
   3.5499702147824006`*^9, 3.5500678495420895`*^9, 3.550146018546095*^9, 
   3.550146290630657*^9, 3.550148473261496*^9, 3.550152940830202*^9, 
   3.550153022759888*^9, 3.550153156288526*^9, 3.55022181372033*^9, 
   3.550224327560114*^9, 3.550364524647933*^9, 3.550412003970688*^9, 
   3.550710615239387*^9, 3.6234104895791397`*^9, 3.623888716267002*^9, 
   3.623890756986937*^9, 3.6244099808508997`*^9, 3.629583254289932*^9, 
   3.629584136005384*^9, 3.645653957360714*^9, 3.645656251047022*^9, 
   3.64574961483615*^9, 3.6876386990609093`*^9, 3.687638747803896*^9, 
   3.841155587629272*^9, 3.841163857629066*^9, 3.841164030947851*^9, 
   3.841164606263793*^9, 3.841166570218141*^9, 3.841166679826138*^9, 
   3.8411668623817253`*^9, 3.841166896587358*^9, 3.84122035000231*^9, 
   3.841230086313748*^9, 3.841230195442214*^9, 3.84124897276284*^9, 
   3.8412490285091*^9, 3.841249075540462*^9, 3.841318270902049*^9, 
   3.841322151162559*^9, 3.841322403849423*^9, 3.84132475824309*^9, 
   3.841324987852354*^9, 3.841332924517823*^9, 3.84135016467139*^9, 
   3.841352238496235*^9, 3.841392982357905*^9, 3.841403443143392*^9, {
   3.841405456738978*^9, 3.84140547846808*^9}, 3.841422366696455*^9, 
   3.91125535365035*^9, 3.911290461521939*^9, 3.912269555564788*^9, 
   3.91254635319949*^9, 3.912589071729417*^9, 3.912600351194565*^9, 
   3.912601706336327*^9, 3.9150508715097027`*^9, 3.915535457455881*^9},
 CellLabel->
  "Out[685]=",ExpressionUUID->"2b4e2ec6-c2fc-441e-8baa-fc8aaadef973"]
}, Open  ]],

Cell["a logical statement outside the grammar", "Text",
 CellChangeTimes->{{3.9150550158905897`*^9, 
  3.915055022737523*^9}},ExpressionUUID->"63f4d661-8180-4536-ad9e-\
46efdc9695d6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"$p", "@", "\"\<Kpq\>\""}], "/.", "Ko"}]], "Input",
 CellChangeTimes->{{3.5493621978067713`*^9, 3.549362199377861*^9}, 
   3.549634338328544*^9, {3.549636096666839*^9, 3.549636102244839*^9}, {
   3.549965562859325*^9, 3.549965566210517*^9}},
 CellLabel->
  "In[686]:=",ExpressionUUID->"a664055f-bcf7-42f0-82a3-8fad1cc8ecfc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Proposition", "[", "\<\"p\"\>", "]"}], "&&", 
  RowBox[{"Proposition", "[", "\<\"q\"\>", "]"}]}]], "Output",
 CellChangeTimes->{
  3.549362200790942*^9, 3.5495033308591204`*^9, 3.5495891186198997`*^9, 
   3.549589270396581*^9, 3.549633477587474*^9, 3.549634369417652*^9, 
   3.549634706916399*^9, 3.549634995153498*^9, {3.5496360765788393`*^9, 
   3.549636102820839*^9}, 3.549652449183874*^9, 3.5499649120341*^9, 
   3.5499655679186144`*^9, 3.549970214836403*^9, 3.5500678495840917`*^9, 
   3.550146020103183*^9, 3.5501462906696587`*^9, 3.550148473299498*^9, 
   3.550152940858204*^9, 3.550153022782891*^9, 3.550153156311528*^9, 
   3.550221813764333*^9, 3.550224327601116*^9, 3.550364524684935*^9, 
   3.55041200401369*^9, 3.550710615312392*^9, 3.623410494283413*^9, 
   3.623888731352543*^9, 3.623890757100913*^9, 3.624409980876714*^9, 
   3.629583254342832*^9, 3.629584136154847*^9, 3.64565395743307*^9, 
   3.645656251118193*^9, 3.6457496148984833`*^9, 3.687638699125397*^9, 
   3.687638747840302*^9, 3.841155590360683*^9, 3.841163857644552*^9, 
   3.841164030963745*^9, 3.8411646062841587`*^9, 3.841166570232098*^9, 
   3.841166679842895*^9, 3.84116686239946*^9, 3.841166896603756*^9, 
   3.841220350027839*^9, 3.84123008634616*^9, 3.84123019546355*^9, 
   3.841248972789234*^9, 3.841249028530992*^9, 3.841249075571302*^9, 
   3.841318270927895*^9, 3.8413221511947193`*^9, 3.8413224038869762`*^9, 
   3.8413247582637587`*^9, 3.841324987871087*^9, 3.841332924539343*^9, 
   3.841350164701436*^9, 3.841352238526543*^9, 3.841392982382394*^9, 
   3.841403443169788*^9, {3.841405456760963*^9, 3.841405478498809*^9}, 
   3.841422366727284*^9, 3.911255353655168*^9, 3.911290461525516*^9, 
   3.912269560000628*^9, 3.912546353205832*^9, 3.912589071732718*^9, 
   3.912600351197583*^9, 3.9126017063401957`*^9, 3.915050871514158*^9, 
   3.915535457458788*^9},
 CellLabel->
  "Out[686]=",ExpressionUUID->"f450c841-1b37-45a6-bc6b-9e22e1bc4c53"]
}, Open  ]],

Cell["Put it back in the grammar by an Incoming Rule.", "Text",
 CellChangeTimes->{{3.915055028943919*^9, 
  3.915055074335072*^9}},ExpressionUUID->"1523f2e3-5f7f-4ec3-af13-\
d356aea74ca7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"$p", "@", "\"\<Kpq\>\""}], "/.", "Ko"}], "/.", "Ki"}]], "Input",
 CellChangeTimes->{{3.549016818440344*^9, 3.549016863807967*^9}, {
   3.549017116050311*^9, 3.549017144737201*^9}, 3.5493621743094273`*^9, {
   3.5493653377593665`*^9, 3.5493653450987864`*^9}, 3.5496343388866*^9},
 CellLabel->
  "In[687]:=",ExpressionUUID->"f7d9d0a4-b0c7-4ef3-88d9-3787ec5ffe0a"],

Cell[BoxData[
 RowBox[{"Binary", "[", 
  RowBox[{"\<\"K\"\>", ",", 
   RowBox[{"Proposition", "[", "\<\"p\"\>", "]"}], ",", 
   RowBox[{"Proposition", "[", "\<\"q\"\>", "]"}]}], "]"}]], "Output",
 CellChangeTimes->{{3.5490168382156205`*^9, 3.549016864909223*^9}, {
   3.5490171221393876`*^9, 3.549017145596021*^9}, 3.549019092768586*^9, 
   3.549020931457381*^9, 3.549048538425545*^9, 3.549361136741082*^9, 
   3.549362174984466*^9, {3.549365341073556*^9, 3.549365350536098*^9}, 
   3.549503330897123*^9, 3.549589118692904*^9, 3.549589271622651*^9, 
   3.5496334776124783`*^9, 3.549634369446656*^9, 3.549634706947402*^9, 
   3.549634995196498*^9, 3.549636076610839*^9, 3.549652449213877*^9, 
   3.549964912071102*^9, 3.5499655714008136`*^9, 3.5499702148734045`*^9, 
   3.550067849626094*^9, 3.550146023006349*^9, 3.550146290708661*^9, 
   3.5501484733365*^9, 3.5501529408862057`*^9, 3.550153022847894*^9, 
   3.550153156334529*^9, 3.550221813805335*^9, 3.5502243276381187`*^9, 
   3.550364524720938*^9, 3.5504120040576925`*^9, 3.550710615370395*^9, 
   3.623410496748154*^9, 3.623888733520508*^9, 3.62389075721779*^9, 
   3.624409980936148*^9, 3.629583254392858*^9, 3.629584136305497*^9, 
   3.645653957549239*^9, 3.645656251201657*^9, 3.6457496149617023`*^9, 
   3.687638699190565*^9, 3.687638747898385*^9, 3.8411555939950843`*^9, 
   3.841163857667172*^9, 3.841164030985868*^9, 3.841164606312416*^9, 
   3.841166570254577*^9, 3.8411666798671417`*^9, 3.841166862423665*^9, 
   3.841166896624911*^9, 3.841220350060877*^9, 3.841230086399654*^9, 
   3.841230195504219*^9, 3.841248972829268*^9, 3.841249028549426*^9, 
   3.841249075609387*^9, 3.841318270954687*^9, 3.84132215120706*^9, 
   3.841322403924458*^9, 3.841324758285952*^9, 3.841324987890455*^9, 
   3.84133292456148*^9, 3.841350164713594*^9, 3.841352238557635*^9, 
   3.841392982407083*^9, 3.841403443207875*^9, {3.841405456791523*^9, 
   3.841405478537281*^9}, 3.841422366760192*^9, 3.911255353666353*^9, 
   3.911290461536504*^9, 3.912269564562995*^9, 3.912546353213906*^9, 
   3.912589071744227*^9, 3.912600351200612*^9, 3.912601706347395*^9, 
   3.915050871521277*^9, 3.915535457466721*^9},
 CellLabel->
  "Out[687]=",ExpressionUUID->"2bbe58f8-3da0-40d6-86c4-8034911b9e29"]
}, Open  ]],

Cell["Unparse, completing the round-trip.", "Text",
 CellChangeTimes->{{3.915055052593402*^9, 
  3.9150550690974607`*^9}},ExpressionUUID->"f872a13b-72ac-47ed-9799-\
62a22576494e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"$p", "@", "\"\<Kpq\>\""}], "/.", "Ko"}], "/.", "Ki"}], "//", 
  "$u"}]], "Input",
 CellChangeTimes->{{3.54936535512936*^9, 3.5493653595646133`*^9}, {
  3.54963433949366*^9, 3.549634358094521*^9}},
 CellLabel->
  "In[688]:=",ExpressionUUID->"d05f96ad-74df-4b45-a44f-b6fc157cbc94"],

Cell[BoxData["\<\"Kpq\"\>"], "Output",
 CellChangeTimes->{
  3.549365360534669*^9, 3.549503330934125*^9, 3.549589118755907*^9, 
   3.549589278164026*^9, 3.549633477636479*^9, 3.549634369478659*^9, 
   3.549634706977406*^9, 3.549634995227498*^9, 3.549636076641839*^9, 
   3.54965244924588*^9, 3.549964912109104*^9, 3.549965572487876*^9, 
   3.549970214910407*^9, 3.550067849664096*^9, 3.5501460252614784`*^9, 
   3.5501462907526636`*^9, 3.550148473374502*^9, 3.550152940912207*^9, 
   3.550153022870895*^9, 3.55015315635753*^9, 3.550221813845338*^9, 
   3.5502243276791205`*^9, 3.55036452475794*^9, 3.550412004101695*^9, 
   3.550710615435398*^9, 3.623410499290893*^9, 3.623888737618827*^9, 
   3.6238907573439*^9, 3.624409981000315*^9, 3.629583254443023*^9, 
   3.629584136406302*^9, 3.645653957766528*^9, 3.645656251283421*^9, 
   3.6457496150281773`*^9, 3.687638699258965*^9, 3.687638747965332*^9, 
   3.8411555962234483`*^9, 3.8411638576919947`*^9, 3.841164031007499*^9, 
   3.8411646063407917`*^9, 3.8411665702758293`*^9, 3.84116667989048*^9, 
   3.841166862453254*^9, 3.841166896645823*^9, 3.841220350091732*^9, 
   3.841230086449749*^9, 3.841230195553806*^9, 3.841248972871249*^9, 
   3.841249028582746*^9, 3.841249075648555*^9, 3.841318270980388*^9, 
   3.8413221512387743`*^9, 3.841322403954308*^9, 3.841324758310116*^9, 
   3.841324987912584*^9, 3.8413329245858107`*^9, 3.841350164748754*^9, 
   3.841352238587575*^9, 3.841392982432331*^9, 3.8414034432453003`*^9, {
   3.841405456823483*^9, 3.841405478574847*^9}, 3.841422366797029*^9, 
   3.911255353671582*^9, 3.911290461539938*^9, 3.912269568237685*^9, 
   3.912546353216767*^9, 3.912589071747973*^9, 3.912600351203454*^9, 
   3.912601706352776*^9, 3.915050871524543*^9, 3.915535457469803*^9},
 CellLabel->
  "Out[688]=",ExpressionUUID->"34c4cc2c-b950-4af9-8eb6-a78475a796da"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Example 2 (ex 1 on page 37 of WFF-n-Proof):", "Subsubsection",
 CellChangeTimes->{{3.54936541735692*^9, 3.549365420845118*^9}, {
   3.5493654969894743`*^9, 3.549365511205287*^9}, {3.549365545749263*^9, 
   3.5493655482614074`*^9}, 
   3.91260166721898*^9},ExpressionUUID->"70404561-2ceb-4f26-8ae2-\
ce2702b396b7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"$p", "@", "\"\<KsKpNr\>\""}]], "Input",
 CellChangeTimes->{{3.549365382671935*^9, 3.54936543677503*^9}, 
   3.549634340060717*^9},
 CellLabel->
  "In[689]:=",ExpressionUUID->"97aa2ae1-425f-4af4-8f77-e189e79673ff"],

Cell[BoxData[
 RowBox[{"Binary", "[", 
  RowBox[{"\<\"K\"\>", ",", 
   RowBox[{"Proposition", "[", "\<\"s\"\>", "]"}], ",", 
   RowBox[{"Binary", "[", 
    RowBox[{"\<\"K\"\>", ",", 
     RowBox[{"Proposition", "[", "\<\"p\"\>", "]"}], ",", 
     RowBox[{"Unary", "[", 
      RowBox[{"\<\"N\"\>", ",", 
       RowBox[{"Proposition", "[", "\<\"r\"\>", "]"}]}], "]"}]}], "]"}]}], 
  "]"}]], "Output",
 CellChangeTimes->{{3.549365427351491*^9, 3.549365437106048*^9}, 
   3.549503330975127*^9, 3.549589118827912*^9, 3.549589280459157*^9, 
   3.549633477662482*^9, 3.5496343695086613`*^9, 3.5496347070064096`*^9, 
   3.549634995318498*^9, 3.549636076672839*^9, 3.549652449279882*^9, 
   3.5499649121491065`*^9, 3.549965573998962*^9, 3.549970214947409*^9, 
   3.550067849713099*^9, 3.5501460270115786`*^9, 3.550146290792666*^9, 
   3.550148473411504*^9, 3.550152940940209*^9, 3.550153022896897*^9, 
   3.5501531563805313`*^9, 3.55022181388734*^9, 3.550224327722123*^9, 
   3.5503645247969418`*^9, 3.5504120041436977`*^9, 3.550710615486401*^9, 
   3.62341050400346*^9, 3.623888750336018*^9, 3.623890757367642*^9, 
   3.624409981066883*^9, 3.629583254497505*^9, 3.629584136473015*^9, 
   3.645653958033897*^9, 3.6456562513686047`*^9, 3.645749615222627*^9, 
   3.687638699324606*^9, 3.68763874802736*^9, 3.841155598823481*^9, 
   3.841163857716306*^9, 3.841164031027919*^9, 3.841164606372447*^9, 
   3.841166570296966*^9, 3.841166679915042*^9, 3.841166862478359*^9, 
   3.8411668966655273`*^9, 3.841220350123893*^9, 3.841230086513049*^9, 
   3.841230195599698*^9, 3.841248972913217*^9, 3.841249028603897*^9, 
   3.8412490756884537`*^9, 3.841318271006912*^9, 3.841322151271834*^9, 
   3.841322403982617*^9, 3.841324758333619*^9, 3.841324987937221*^9, 
   3.841332924610113*^9, 3.841350164780143*^9, 3.841352238599337*^9, 
   3.841392982459219*^9, 3.84140344328391*^9, {3.841405456859811*^9, 
   3.841405478613771*^9}, 3.841422366810105*^9, 3.911255353741654*^9, 
   3.911290461549438*^9, 3.912269571501092*^9, 3.91254635322601*^9, 
   3.912589071758775*^9, 3.912600351209855*^9, 3.912601706360564*^9, 
   3.9150508715290117`*^9, 3.915535457477639*^9},
 CellLabel->
  "Out[689]=",ExpressionUUID->"f106a864-fa41-4356-8dff-b1540e642897"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"$p", "@", "\"\<KsKpNr\>\""}], "/.", "KoR"}], "//", 
  "$u"}]], "Input",
 CellChangeTimes->{{3.5493654787584314`*^9, 3.549365482358637*^9}, {
  3.549634341169828*^9, 3.549634358113523*^9}},
 CellLabel->
  "In[690]:=",ExpressionUUID->"4cdfd3b8-b582-452b-8d35-5b5916e045b5"],

Cell[BoxData["\<\"KpNr\"\>"], "Output",
 CellChangeTimes->{
  3.549365482821664*^9, 3.5495033310511312`*^9, 3.5495891189569206`*^9, 
   3.549589283467328*^9, 3.549633477711486*^9, 3.5496343695686674`*^9, 
   3.549634707065414*^9, 3.549634995378498*^9, 3.549636076732839*^9, 
   3.549652449311887*^9, 3.5499649121861086`*^9, 3.549965575427044*^9, 
   3.549970214983412*^9, 3.550067849756101*^9, 3.550146028150644*^9, 
   3.5501462908306684`*^9, 3.550148473450506*^9, 3.550152940967211*^9, 
   3.5501530229198976`*^9, 3.5501531564035325`*^9, 3.550221813929343*^9, 
   3.550224327759125*^9, 3.550364524832944*^9, 3.5504120041917*^9, 
   3.5507106155574055`*^9, 3.6234105065344*^9, 3.623888761132062*^9, 
   3.623890757417046*^9, 3.624409981136608*^9, 3.629583254548287*^9, 
   3.6295841365231743`*^9, 3.645653958234194*^9, 3.645656251450732*^9, 
   3.645749615295224*^9, 3.687638699392231*^9, 3.687638748096792*^9, 
   3.841155604018468*^9, 3.841163857740467*^9, 3.8411640310506372`*^9, 
   3.8411646064046793`*^9, 3.84116657030656*^9, 3.841166679938992*^9, 
   3.841166862503258*^9, 3.841166896684943*^9, 3.8412203501572638`*^9, 
   3.841230086576581*^9, 3.841230195634843*^9, 3.841248972947309*^9, 
   3.841249028635963*^9, 3.841249075723982*^9, 3.841318271031802*^9, 
   3.841322151303657*^9, 3.841322404010133*^9, 3.841324758356729*^9, 
   3.841324987959044*^9, 3.841332924637315*^9, 3.841350164810236*^9, 
   3.8413522386335077`*^9, 3.841392982485291*^9, 3.8414034433224983`*^9, {
   3.841405456894805*^9, 3.841405478652103*^9}, 3.841422366842048*^9, 
   3.91125535375531*^9, 3.9112904615539827`*^9, 3.912269573915196*^9, 
   3.91254635322912*^9, 3.912589071762641*^9, 3.912600351212881*^9, 
   3.912601706364081*^9, 3.915050871532773*^9, 3.915535457480548*^9},
 CellLabel->
  "Out[690]=",ExpressionUUID->"ad7cc283-4a3c-4a8f-a84d-c00052d0e923"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Example 3 (ex 6 on page 37 of WFF-n-Proof):", "Subsubsection",
 CellChangeTimes->{{3.5493655628452406`*^9, 3.549365586493593*^9}, 
   3.549365666253155*^9, 3.9126015191513033`*^9, 
   3.9126016674507647`*^9},ExpressionUUID->"a957b771-e83b-4ca3-acf1-\
9b91de5fbeef"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"$p", "@", "\"\<KpKKsKqNrs\>\""}], "/.", "KoL"}], "//", 
  "$u"}]], "Input",
 CellChangeTimes->{{3.549365611082*^9, 3.549365613279125*^9}, 
   3.549621380103151*^9, {3.549634342430954*^9, 3.549634358130525*^9}},
 CellLabel->
  "In[691]:=",ExpressionUUID->"a9ac5ddc-2b5f-4ef8-b8ed-dd60ff9fd381"],

Cell[BoxData["\<\"p\"\>"], "Output",
 CellChangeTimes->{
  3.549365613980165*^9, 3.549503331159138*^9, 3.549589119090926*^9, 
   3.5495892863404946`*^9, 3.5496213812832184`*^9, 3.549633477798495*^9, 
   3.5496343696286736`*^9, 3.54963470712542*^9, 3.549634995437498*^9, 
   3.549636076796839*^9, 3.54965244934489*^9, 3.549964912225111*^9, 
   3.5499655790702524`*^9, 3.549970215022414*^9, 3.550067849803104*^9, 
   3.5501460300217505`*^9, 3.550146290875671*^9, 3.550148473487509*^9, 
   3.550152940995212*^9, 3.5501530229418993`*^9, 3.550153156425534*^9, 
   3.550221813971345*^9, 3.550224327797128*^9, 3.550364524868945*^9, 
   3.550412004234702*^9, 3.550710615642411*^9, 3.623410509379341*^9, 
   3.62388877587402*^9, 3.623890757466575*^9, 3.624409981203915*^9, 
   3.629583254609079*^9, 3.629584136585263*^9, 3.645653958382786*^9, 
   3.64565625153407*^9, 3.6457496153604918`*^9, 3.687638699454926*^9, 
   3.687638748164218*^9, 3.841155606304407*^9, 3.84116385776359*^9, 
   3.841164031071546*^9, 3.841164606436405*^9, 3.841166570328854*^9, 
   3.8411666799628077`*^9, 3.841166862526744*^9, 3.841166896702791*^9, 
   3.841220350190687*^9, 3.841230086623207*^9, 3.841230195668715*^9, 
   3.84124897298155*^9, 3.841249028666735*^9, 3.84124907575785*^9, 
   3.841318271057328*^9, 3.841322151335329*^9, 3.8413224040364*^9, 
   3.841324758398941*^9, 3.84132498798421*^9, 3.841332924662737*^9, 
   3.8413501648386*^9, 3.8413522386656837`*^9, 3.841392982512132*^9, 
   3.841403443359357*^9, {3.841405456929945*^9, 3.841405478689356*^9}, 
   3.841422366867307*^9, 3.911255353758298*^9, 3.911290461562689*^9, 
   3.912269579432479*^9, 3.912546353239119*^9, 3.912589071774478*^9, 
   3.912600351219054*^9, 3.912601706373761*^9, 3.915050871539864*^9, 
   3.91553545748837*^9},
 CellLabel->
  "Out[691]=",ExpressionUUID->"49b70e6e-2510-467e-9ff7-6c74d525b6db"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"$p", "@", "\"\<KpKKsKqNrs\>\""}], "/.", "KoR"}], "//", 
  "$u"}]], "Input",
 CellChangeTimes->{{3.549365618006396*^9, 3.5493656271989217`*^9}, {
  3.549634343037015*^9, 3.549634358143525*^9}},
 CellLabel->
  "In[692]:=",ExpressionUUID->"059bf818-e9aa-417f-9515-a93c92d0e47c"],

Cell[BoxData["\<\"KKsKqNrs\"\>"], "Output",
 CellChangeTimes->{{3.5493656211235743`*^9, 3.549365627733952*^9}, 
   3.54950333120014*^9, 3.549589119157931*^9, 3.549589287199542*^9, 
   3.549621382420284*^9, 3.549633477823498*^9, 3.549634369660677*^9, 
   3.549634707156423*^9, 3.549634995467498*^9, 3.549636076830839*^9, 
   3.549652449377893*^9, 3.549964912264113*^9, 3.549965579886299*^9, 
   3.549970215156421*^9, 3.5500678498431063`*^9, 3.550146032189874*^9, 
   3.550146290914673*^9, 3.550148473524511*^9, 3.5501529410222135`*^9, 
   3.550153022967901*^9, 3.550153156448535*^9, 3.550221814012347*^9, 
   3.5502243278391294`*^9, 3.550364524903948*^9, 3.550412004279705*^9, 
   3.550710615696413*^9, 3.623410512375885*^9, 3.623888785607173*^9, 
   3.623890757582591*^9, 3.62440998140421*^9, 3.629583254725956*^9, 
   3.629584136640384*^9, 3.645653958465279*^9, 3.645656251601424*^9, 
   3.645749615428201*^9, 3.687638699524828*^9, 3.687638748228215*^9, 
   3.841155652974666*^9, 3.841163857789031*^9, 3.841164031092339*^9, 
   3.841164606467721*^9, 3.84116657034569*^9, 3.841166679985862*^9, 
   3.841166862546855*^9, 3.8411668967207823`*^9, 3.8412203502235947`*^9, 
   3.841230086733855*^9, 3.841230195700734*^9, 3.841248973025566*^9, 
   3.841249028698524*^9, 3.84124907579055*^9, 3.841318271090122*^9, 
   3.841322151367174*^9, 3.84132240406341*^9, 3.841324758420292*^9, 
   3.841324988007178*^9, 3.841332924688489*^9, 3.841350164866308*^9, 
   3.84135223869872*^9, 3.84139298253799*^9, 3.841403443398613*^9, {
   3.841405456965291*^9, 3.841405478726448*^9}, 3.841422366895895*^9, 
   3.91125535377168*^9, 3.91129046156607*^9, 3.912269581750866*^9, 
   3.912546353242156*^9, 3.912589071777904*^9, 3.912600351222123*^9, 
   3.912601706376738*^9, 3.915050871543376*^9, 3.915535457491144*^9},
 CellLabel->
  "Out[692]=",ExpressionUUID->"72145628-c57f-4cdd-8d33-8a39b8666537"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Example 4 (ex 7 on page 37 of WFF-n-Proof):", "Subsubsection",
 CellChangeTimes->{{3.5493656477420974`*^9, 3.549365663221982*^9}, {
   3.549365739461343*^9, 3.549365740909426*^9}, {3.549589288070592*^9, 
   3.5495892914147825`*^9}, 3.9126015191576347`*^9, 
   3.912601667680843*^9},ExpressionUUID->"65a61b2b-82fd-4ae7-8620-\
81bb9921bcf1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"And", "[", 
    RowBox[{
     RowBox[{"$p", "@", "\"\<KsKqNr\>\""}], ",", 
     RowBox[{"$p", "@", "\"\<s\>\""}]}], "]"}], "/.", "Ki"}], "//", 
  "$u"}]], "Input",
 CellChangeTimes->{{3.549365772503233*^9, 3.549365776272448*^9}, {
   3.54963434669038*^9, 3.549634358162527*^9}, 3.549634975309498*^9, 
   3.549635299512498*^9},
 CellLabel->
  "In[693]:=",ExpressionUUID->"862240a8-9e9e-4f86-973a-14d3cff718ed"],

Cell[BoxData["\<\"KKsKqNrs\"\>"], "Output",
 CellChangeTimes->{
  3.54936577665547*^9, 3.549503331322147*^9, 3.5495891193579416`*^9, 
   3.5495892970981083`*^9, 3.5496334778965044`*^9, 3.549634369751686*^9, 
   3.5496347072494345`*^9, 3.549634995559498*^9, 3.5496360769258394`*^9, 
   3.549652449409897*^9, 3.5499649123641186`*^9, 3.549965581286379*^9, 
   3.549970215196424*^9, 3.5500678498961096`*^9, 3.5501460356060705`*^9, 
   3.5501462909606757`*^9, 3.550148473561513*^9, 3.550152941051215*^9, 
   3.550153022990902*^9, 3.550153156471537*^9, 3.550221814053349*^9, 
   3.550224327877132*^9, 3.55036452494195*^9, 3.550412004324707*^9, 
   3.550710615753416*^9, 3.623410515191415*^9, 3.623888793462568*^9, 
   3.623890757701052*^9, 3.624409981471467*^9, 3.629583254822277*^9, 
   3.629584136702917*^9, 3.645653958548334*^9, 3.645656251684909*^9, 
   3.645749615495066*^9, 3.6876386995914288`*^9, 3.687638748298645*^9, 
   3.841155655959114*^9, 3.841163857799934*^9, 3.841164031112524*^9, 
   3.841164606497205*^9, 3.8411665703675613`*^9, 3.8411666800099277`*^9, 
   3.841166862571234*^9, 3.841166896738163*^9, 3.841220350255662*^9, 
   3.841230086781419*^9, 3.8412301957326317`*^9, 3.841248973067951*^9, 
   3.841249028730008*^9, 3.841249075824397*^9, 3.841318271127026*^9, 
   3.841322151401494*^9, 3.841322404090526*^9, 3.841324758442792*^9, 
   3.841324988030466*^9, 3.841332924699397*^9, 3.84135016489415*^9, 
   3.841352238710565*^9, 3.841392982564189*^9, 3.84140344343598*^9, {
   3.8414054569985523`*^9, 3.841405478768133*^9}, 3.841422366932778*^9, 
   3.911255353774867*^9, 3.911290461577421*^9, 3.912269585301703*^9, 
   3.912546353250237*^9, 3.9125890717880774`*^9, 3.912600351231048*^9, 
   3.912601706379717*^9, 3.915050871551834*^9, 3.915535457498797*^9},
 CellLabel->
  "Out[693]=",ExpressionUUID->"a2deea49-6375-4c89-963c-615c9d900bce"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Example 5 (P9 on page 43 of WFF-n-Proof):", "Subsubsection",
 CellChangeTimes->{{3.5493658471345015`*^9, 3.54936587211793*^9}, 
   3.912601519163002*^9, 
   3.912601667924829*^9},ExpressionUUID->"6067e4fc-0ee7-4ad1-a0df-\
77d48d85eb83"],

Cell["The sequence of rule applications constitute a proof:", "Text",
 CellChangeTimes->{{3.5499655884647894`*^9, 
  3.549965598033337*^9}},ExpressionUUID->"6877a156-a447-44a9-bfbd-\
455ed725666d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"$p", "@", "\"\<KKKrKNsKAprAspqNs\>\""}], "/.", "KoL"}], "/.", 
      "KoL"}], "/.", "KoR"}], "/.", "KoR"}], "/.", "KoR"}], "//", 
  "$u"}]], "Input",
 CellChangeTimes->{{3.549365928379148*^9, 3.549366003735458*^9}, {
  3.549634346729384*^9, 3.549634358174528*^9}},
 CellLabel->
  "In[694]:=",ExpressionUUID->"f9795451-ed47-4cd5-8a40-7d1ad358aaa9"],

Cell[BoxData["\<\"Asp\"\>"], "Output",
 CellChangeTimes->{{3.549365994004902*^9, 3.549366004195484*^9}, 
   3.549503331409152*^9, 3.549589119564954*^9, 3.549589305373581*^9, 
   3.54963347794551*^9, 3.549634369815693*^9, 3.549634707310438*^9, 
   3.549634995626498*^9, 3.549636076987839*^9, 3.549652449509907*^9, 
   3.549964912403121*^9, {3.549965582647457*^9, 3.5499656017515497`*^9}, 
   3.549970215237426*^9, 3.5500678499481125`*^9, 3.5501460377401924`*^9, 
   3.5501462909986777`*^9, 3.550148473599515*^9, 3.550152941081217*^9, 
   3.550153023013903*^9, 3.550153156493538*^9, 3.550221814097352*^9, 
   3.550224327915134*^9, 3.550364524980953*^9, 3.550412004386711*^9, 
   3.5507106158714232`*^9, 3.623410518613136*^9, 3.623888801430485*^9, 
   3.623890757916778*^9, 3.624409981533309*^9, 3.629583255255206*^9, 
   3.629584137067973*^9, 3.645653958659627*^9, 3.645656251767577*^9, 
   3.645749615562418*^9, 3.687638699657247*^9, 3.687638748366119*^9, 
   3.84115566164625*^9, 3.841163857824209*^9, 3.841164031133308*^9, 
   3.841164606526236*^9, 3.841166570389501*^9, 3.841166680035043*^9, 
   3.841166862594159*^9, 3.841166896755967*^9, 3.841220350288468*^9, 
   3.841230086816008*^9, 3.841230195766382*^9, 3.841248973109674*^9, 
   3.84124902876195*^9, 3.841249075857298*^9, 3.84131827116508*^9, 
   3.841322151437181*^9, 3.841322404118804*^9, 3.8413247584660897`*^9, 
   3.84132498805261*^9, 3.841332924728007*^9, 3.841350164920751*^9, 
   3.841352238744869*^9, 3.841392982591951*^9, 3.841403443473423*^9, {
   3.841405457032206*^9, 3.841405478806604*^9}, 3.84142236696091*^9, 
   3.911255353786688*^9, 3.911290461581004*^9, 3.912269589823901*^9, 
   3.912546353254637*^9, 3.912589071791821*^9, 3.912600351234127*^9, 
   3.912601706382615*^9, 3.915050871555427*^9, 3.915535457502186*^9},
 CellLabel->
  "Out[694]=",ExpressionUUID->"27b83bd5-e681-4363-91f2-079cbebac79c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Example 6 (1 on page 90 of WFF-n-Proof)", "Subsubsection",
 CellChangeTimes->{{3.549503364614051*^9, 3.549503382301063*^9}, 
   3.912601519168187*^9, 
   3.91260166813521*^9},ExpressionUUID->"94368d1b-bf7f-4147-9fda-\
0eac9d8629e8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"And", "[", 
    RowBox[{
     RowBox[{"$p", "@", "\"\<CErpCpr\>\""}], ",", 
     RowBox[{"$p", "@", "\"\<Erp\>\""}]}], "]"}], "/.", "Co"}], "//", 
  "$u"}]], "Input",
 CellChangeTimes->{{3.5495033958008347`*^9, 3.549503423846439*^9}, {
   3.549503527311358*^9, 3.549503551383734*^9}, {3.5496343467393856`*^9, 
   3.549634358183529*^9}, 3.549634977550498*^9, 3.5496352995204983`*^9},
 CellLabel->
  "In[695]:=",ExpressionUUID->"db671569-d1da-43e1-a5d3-9de8f6f6a63e"],

Cell[BoxData["\<\"Cpr\"\>"], "Output",
 CellChangeTimes->{
  3.549503424496476*^9, {3.549503543507283*^9, 3.54950355184176*^9}, 
   3.549589119635958*^9, 3.549589311322922*^9, 3.549633477971512*^9, 
   3.549634369846696*^9, 3.549634707339442*^9, 3.549634995656498*^9, 
   3.54963607701784*^9, 3.5496524495449104`*^9, 3.549964912442124*^9, 
   3.549965603430646*^9, 3.549970215293429*^9, 3.550067849994115*^9, 
   3.550146039132272*^9, 3.55014629104368*^9, 3.550148473637518*^9, 
   3.55015294114622*^9, 3.550153023039904*^9, 3.550153156517539*^9, 
   3.550221814139355*^9, 3.550224327956137*^9, 3.550364525018955*^9, 
   3.550412004433714*^9, 3.550710615922426*^9, 3.623410521847022*^9, 
   3.6238888063942204`*^9, 3.623890758084306*^9, 3.624409981604497*^9, 
   3.629583255325478*^9, 3.629584137223645*^9, 3.645653959021929*^9, 
   3.64565625185086*^9, 3.645749615628062*^9, 3.687638699721658*^9, 
   3.687638748432106*^9, 3.841155665252423*^9, 3.841163857843494*^9, 
   3.841164031153492*^9, 3.841164606556601*^9, 3.841166570413776*^9, 
   3.841166680058312*^9, 3.841166862616774*^9, 3.8411668967744093`*^9, 
   3.8412203503202667`*^9, 3.841230086864696*^9, 3.841230195798074*^9, 
   3.841248973144108*^9, 3.841249028794503*^9, 3.841249075889011*^9, 
   3.8413182711959352`*^9, 3.841322151473769*^9, 3.84132240414736*^9, 
   3.841324758489792*^9, 3.841324988076206*^9, 3.841332924750357*^9, 
   3.841350164950035*^9, 3.84135223877752*^9, 3.841392982619775*^9, 
   3.841403443511558*^9, {3.84140545706409*^9, 3.841405478841504*^9}, 
   3.841422366989841*^9, 3.911255353789358*^9, 3.911290461590591*^9, 
   3.91226959255061*^9, 3.912546353262735*^9, 3.912589071794907*^9, 
   3.912600351240322*^9, 3.9126017063900747`*^9, 3.9150508715622463`*^9, 
   3.915535457509799*^9},
 CellLabel->
  "Out[695]=",ExpressionUUID->"901cc9d0-f622-4443-a01e-0d28c33c4aa7"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Example 7 (2 on page 90 of WFF-n-Proof)", "Subsubsection",
 CellChangeTimes->{{3.549504690880909*^9, 3.549504709396968*^9}, 
   3.9126015191735883`*^9, 
   3.912601668374224*^9},ExpressionUUID->"486dba37-7a28-4016-b68d-\
b0db0028450f"],

Cell[TextData[{
 "Here, we actually need a solver, because we may NOT deduce L from CLR and \
R. However, we may propose L as ",
 StyleBox["a solution",
  FontSlant->"Italic"],
 " to the problem of finding an X such that CXR and R. "
}], "Text",
 CellChangeTimes->{{3.549589350086139*^9, 3.549589468005883*^9}, {
  3.549636181349839*^9, 3.5496361821968393`*^9}, {3.549636230338839*^9, 
  3.549636231018839*^9}},ExpressionUUID->"f9b355f9-dba8-41d0-b3fb-\
ac3a87802180"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TreeForm", "@", 
  RowBox[{"$p", "@", "\"\<CNsAKrpNs\>\""}]}]], "Input",
 CellChangeTimes->{{3.549589593872083*^9, 3.5495896375115786`*^9}, 
   3.549634346758387*^9},
 CellLabel->
  "In[696]:=",ExpressionUUID->"72014098-97eb-4ea0-aecc-af3fa6ad1ae9"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[
   TagBox[
    GraphicsComplexBox[{{1.4407023119537148`, 2.711910234265816}, {0., 
     2.0339326756993623`}, {0.677977558566454, 2.0339326756993623`}, {
     0.338988779283227, 1.355955117132908}, {1.0169663378496812`, 
     1.355955117132908}, {1.0169663378496812`, 0.6779775585664538}, {
     2.8814046239074296`, 2.0339326756993623`}, {1.6949438964161352`, 
     1.355955117132908}, {2.372921454982589, 1.355955117132908}, {
     1.6949438964161352`, 0.6779775585664538}, {2.372921454982589, 
     0.6779775585664538}, {2.372921454982589, 0.}, {3.050899013549043, 
     0.6779775585664538}, {3.050899013549043, 0.}, {4.067865351398725, 
     1.355955117132908}, {3.7288765721154973`, 0.6779775585664538}, {
     4.4068541306819515`, 0.6779775585664538}, {4.4068541306819515`, 0.}}, {
      {RGBColor[0.55, 0.45, 0.45], 
       LineBox[{{1, 2}, {1, 3}, {1, 7}, {3, 4}, {3, 5}, {5, 6}, {7, 8}, {7, 
        9}, {7, 15}, {9, 10}, {9, 11}, {9, 13}, {11, 12}, {13, 14}, {15, 
        16}, {15, 17}, {17, 18}}]}, {
       TagBox[
        TooltipBox[InsetBox[
          FrameBox[
           StyleBox["Binary", "StandardForm", "Output",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->Scaled[0.022222222222222223`],
            FontColor->GrayLevel[0]],
           Background->RGBColor[1., 1., 0.871],
           FrameStyle->GrayLevel[0.5],
           StripOnInput->False], 1],
         TagBox[
          RowBox[{"Binary", "[", 
            RowBox[{"\"C\"", ",", 
              RowBox[{"Unary", "[", 
                RowBox[{"\"N\"", ",", 
                  RowBox[{"Proposition", "[", "\"s\"", "]"}]}], "]"}], ",", 
              RowBox[{"Binary", "[", 
                RowBox[{"\"A\"", ",", 
                  RowBox[{"Binary", "[", 
                    RowBox[{"\"K\"", ",", 
                    RowBox[{"Proposition", "[", "\"r\"", "]"}], ",", 
                    RowBox[{"Proposition", "[", "\"p\"", "]"}]}], "]"}], ",", 
                  RowBox[{"Unary", "[", 
                    RowBox[{"\"N\"", ",", 
                    RowBox[{"Proposition", "[", "\"s\"", "]"}]}], "]"}]}], 
                "]"}]}], "]"}], HoldForm]],
        Annotation[#, 
         HoldForm[
          $CellContext`Binary["C", 
           $CellContext`Unary["N", 
            $CellContext`Proposition["s"]], 
           $CellContext`Binary["A", 
            $CellContext`Binary["K", 
             $CellContext`Proposition["r"], 
             $CellContext`Proposition["p"]], 
            $CellContext`Unary["N", 
             $CellContext`Proposition["s"]]]]], "Tooltip"]& ], 
       TagBox[
        TooltipBox[InsetBox[
          FrameBox[
           StyleBox[
            TagBox["\<\"C\"\>",
             HoldForm], "StandardForm", "Output",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->Scaled[0.022222222222222223`],
            FontColor->GrayLevel[0]],
           Background->RGBColor[1., 1., 0.871],
           FrameStyle->GrayLevel[0.5],
           StripOnInput->False], 2],
         TagBox["\"C\"", HoldForm]],
        Annotation[#, 
         HoldForm["C"], "Tooltip"]& ], 
       TagBox[
        TooltipBox[InsetBox[
          FrameBox[
           StyleBox["Unary", "StandardForm", "Output",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->Scaled[0.022222222222222223`],
            FontColor->GrayLevel[0]],
           Background->RGBColor[1., 1., 0.871],
           FrameStyle->GrayLevel[0.5],
           StripOnInput->False], 3],
         TagBox[
          RowBox[{"Unary", "[", 
            RowBox[{"\"N\"", ",", 
              RowBox[{"Proposition", "[", "\"s\"", "]"}]}], "]"}], HoldForm]],
        Annotation[#, 
         HoldForm[
          $CellContext`Unary["N", 
           $CellContext`Proposition["s"]]], "Tooltip"]& ], 
       TagBox[
        TooltipBox[InsetBox[
          FrameBox[
           StyleBox[
            TagBox["\<\"N\"\>",
             HoldForm], "StandardForm", "Output",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->Scaled[0.022222222222222223`],
            FontColor->GrayLevel[0]],
           Background->RGBColor[1., 1., 0.871],
           FrameStyle->GrayLevel[0.5],
           StripOnInput->False], 4],
         TagBox["\"N\"", HoldForm]],
        Annotation[#, 
         HoldForm["N"], "Tooltip"]& ], 
       TagBox[
        TooltipBox[InsetBox[
          FrameBox[
           StyleBox["Proposition", "StandardForm", "Output",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->Scaled[0.022222222222222223`],
            FontColor->GrayLevel[0]],
           Background->RGBColor[1., 1., 0.871],
           FrameStyle->GrayLevel[0.5],
           StripOnInput->False], 5],
         TagBox[
          RowBox[{"Proposition", "[", "\"s\"", "]"}], HoldForm]],
        Annotation[#, 
         HoldForm[
          $CellContext`Proposition["s"]], "Tooltip"]& ], 
       TagBox[
        TooltipBox[InsetBox[
          FrameBox[
           StyleBox[
            TagBox["\<\"s\"\>",
             HoldForm], "StandardForm", "Output",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->Scaled[0.022222222222222223`],
            FontColor->GrayLevel[0]],
           Background->RGBColor[1., 1., 0.871],
           FrameStyle->GrayLevel[0.5],
           StripOnInput->False], 6],
         TagBox["\"s\"", HoldForm]],
        Annotation[#, 
         HoldForm["s"], "Tooltip"]& ], 
       TagBox[
        TooltipBox[InsetBox[
          FrameBox[
           StyleBox["Binary", "StandardForm", "Output",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->Scaled[0.022222222222222223`],
            FontColor->GrayLevel[0]],
           Background->RGBColor[1., 1., 0.871],
           FrameStyle->GrayLevel[0.5],
           StripOnInput->False], 7],
         TagBox[
          RowBox[{"Binary", "[", 
            RowBox[{"\"A\"", ",", 
              RowBox[{"Binary", "[", 
                RowBox[{"\"K\"", ",", 
                  RowBox[{"Proposition", "[", "\"r\"", "]"}], ",", 
                  RowBox[{"Proposition", "[", "\"p\"", "]"}]}], "]"}], ",", 
              RowBox[{"Unary", "[", 
                RowBox[{"\"N\"", ",", 
                  RowBox[{"Proposition", "[", "\"s\"", "]"}]}], "]"}]}], 
            "]"}], HoldForm]],
        Annotation[#, 
         HoldForm[
          $CellContext`Binary["A", 
           $CellContext`Binary["K", 
            $CellContext`Proposition["r"], 
            $CellContext`Proposition["p"]], 
           $CellContext`Unary["N", 
            $CellContext`Proposition["s"]]]], "Tooltip"]& ], 
       TagBox[
        TooltipBox[InsetBox[
          FrameBox[
           StyleBox[
            TagBox["\<\"A\"\>",
             HoldForm], "StandardForm", "Output",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->Scaled[0.022222222222222223`],
            FontColor->GrayLevel[0]],
           Background->RGBColor[1., 1., 0.871],
           FrameStyle->GrayLevel[0.5],
           StripOnInput->False], 8],
         TagBox["\"A\"", HoldForm]],
        Annotation[#, 
         HoldForm["A"], "Tooltip"]& ], 
       TagBox[
        TooltipBox[InsetBox[
          FrameBox[
           StyleBox["Binary", "StandardForm", "Output",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->Scaled[0.022222222222222223`],
            FontColor->GrayLevel[0]],
           Background->RGBColor[1., 1., 0.871],
           FrameStyle->GrayLevel[0.5],
           StripOnInput->False], 9],
         TagBox[
          RowBox[{"Binary", "[", 
            RowBox[{"\"K\"", ",", 
              RowBox[{"Proposition", "[", "\"r\"", "]"}], ",", 
              RowBox[{"Proposition", "[", "\"p\"", "]"}]}], "]"}], HoldForm]],
        Annotation[#, 
         HoldForm[
          $CellContext`Binary["K", 
           $CellContext`Proposition["r"], 
           $CellContext`Proposition["p"]]], "Tooltip"]& ], 
       TagBox[
        TooltipBox[InsetBox[
          FrameBox[
           StyleBox[
            TagBox["\<\"K\"\>",
             HoldForm], "StandardForm", "Output",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->Scaled[0.022222222222222223`],
            FontColor->GrayLevel[0]],
           Background->RGBColor[1., 1., 0.871],
           FrameStyle->GrayLevel[0.5],
           StripOnInput->False], 10],
         TagBox["\"K\"", HoldForm]],
        Annotation[#, 
         HoldForm["K"], "Tooltip"]& ], 
       TagBox[
        TooltipBox[InsetBox[
          FrameBox[
           StyleBox["Proposition", "StandardForm", "Output",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->Scaled[0.022222222222222223`],
            FontColor->GrayLevel[0]],
           Background->RGBColor[1., 1., 0.871],
           FrameStyle->GrayLevel[0.5],
           StripOnInput->False], 11],
         TagBox[
          RowBox[{"Proposition", "[", "\"r\"", "]"}], HoldForm]],
        Annotation[#, 
         HoldForm[
          $CellContext`Proposition["r"]], "Tooltip"]& ], 
       TagBox[
        TooltipBox[InsetBox[
          FrameBox[
           StyleBox[
            TagBox["\<\"r\"\>",
             HoldForm], "StandardForm", "Output",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->Scaled[0.022222222222222223`],
            FontColor->GrayLevel[0]],
           Background->RGBColor[1., 1., 0.871],
           FrameStyle->GrayLevel[0.5],
           StripOnInput->False], 12],
         TagBox["\"r\"", HoldForm]],
        Annotation[#, 
         HoldForm["r"], "Tooltip"]& ], 
       TagBox[
        TooltipBox[InsetBox[
          FrameBox[
           StyleBox["Proposition", "StandardForm", "Output",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->Scaled[0.022222222222222223`],
            FontColor->GrayLevel[0]],
           Background->RGBColor[1., 1., 0.871],
           FrameStyle->GrayLevel[0.5],
           StripOnInput->False], 13],
         TagBox[
          RowBox[{"Proposition", "[", "\"p\"", "]"}], HoldForm]],
        Annotation[#, 
         HoldForm[
          $CellContext`Proposition["p"]], "Tooltip"]& ], 
       TagBox[
        TooltipBox[InsetBox[
          FrameBox[
           StyleBox[
            TagBox["\<\"p\"\>",
             HoldForm], "StandardForm", "Output",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->Scaled[0.022222222222222223`],
            FontColor->GrayLevel[0]],
           Background->RGBColor[1., 1., 0.871],
           FrameStyle->GrayLevel[0.5],
           StripOnInput->False], 14],
         TagBox["\"p\"", HoldForm]],
        Annotation[#, 
         HoldForm["p"], "Tooltip"]& ], 
       TagBox[
        TooltipBox[InsetBox[
          FrameBox[
           StyleBox["Unary", "StandardForm", "Output",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->Scaled[0.022222222222222223`],
            FontColor->GrayLevel[0]],
           Background->RGBColor[1., 1., 0.871],
           FrameStyle->GrayLevel[0.5],
           StripOnInput->False], 15],
         TagBox[
          RowBox[{"Unary", "[", 
            RowBox[{"\"N\"", ",", 
              RowBox[{"Proposition", "[", "\"s\"", "]"}]}], "]"}], HoldForm]],
        Annotation[#, 
         HoldForm[
          $CellContext`Unary["N", 
           $CellContext`Proposition["s"]]], "Tooltip"]& ], 
       TagBox[
        TooltipBox[InsetBox[
          FrameBox[
           StyleBox[
            TagBox["\<\"N\"\>",
             HoldForm], "StandardForm", "Output",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->Scaled[0.022222222222222223`],
            FontColor->GrayLevel[0]],
           Background->RGBColor[1., 1., 0.871],
           FrameStyle->GrayLevel[0.5],
           StripOnInput->False], 16],
         TagBox["\"N\"", HoldForm]],
        Annotation[#, 
         HoldForm["N"], "Tooltip"]& ], 
       TagBox[
        TooltipBox[InsetBox[
          FrameBox[
           StyleBox["Proposition", "StandardForm", "Output",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->Scaled[0.022222222222222223`],
            FontColor->GrayLevel[0]],
           Background->RGBColor[1., 1., 0.871],
           FrameStyle->GrayLevel[0.5],
           StripOnInput->False], 17],
         TagBox[
          RowBox[{"Proposition", "[", "\"s\"", "]"}], HoldForm]],
        Annotation[#, 
         HoldForm[
          $CellContext`Proposition["s"]], "Tooltip"]& ], 
       TagBox[
        TooltipBox[InsetBox[
          FrameBox[
           StyleBox[
            TagBox["\<\"s\"\>",
             HoldForm], "StandardForm", "Output",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->Scaled[0.022222222222222223`],
            FontColor->GrayLevel[0]],
           Background->RGBColor[1., 1., 0.871],
           FrameStyle->GrayLevel[0.5],
           StripOnInput->False], 18],
         TagBox["\"s\"", HoldForm]],
        Annotation[#, 
         HoldForm["s"], "Tooltip"]& ]}}],
    Annotation[#, 
     VertexCoordinateRules -> {{1.4407023119537148`, 2.711910234265816}, {0., 
      2.0339326756993623`}, {0.677977558566454, 2.0339326756993623`}, {
      0.338988779283227, 1.355955117132908}, {1.0169663378496812`, 
      1.355955117132908}, {1.0169663378496812`, 0.6779775585664538}, {
      2.8814046239074296`, 2.0339326756993623`}, {1.6949438964161352`, 
      1.355955117132908}, {2.372921454982589, 1.355955117132908}, {
      1.6949438964161352`, 0.6779775585664538}, {2.372921454982589, 
      0.6779775585664538}, {2.372921454982589, 0.}, {3.050899013549043, 
      0.6779775585664538}, {3.050899013549043, 0.}, {4.067865351398725, 
      1.355955117132908}, {3.7288765721154973`, 0.6779775585664538}, {
      4.4068541306819515`, 0.6779775585664538}, {4.4068541306819515`, 0.}}]& ],
   AspectRatio->NCache[
    Rational[1, 3] Rational[5, 2]^Rational[1, 2], 0.5270462766947299],
   FormatType:>StandardForm,
   FrameTicks->Automatic,
   PlotRange->All,
   PlotRangePadding->Scaled[0.1]],
  TreeForm[
   $CellContext`Binary["C", 
    $CellContext`Unary["N", 
     $CellContext`Proposition["s"]], 
    $CellContext`Binary["A", 
     $CellContext`Binary["K", 
      $CellContext`Proposition["r"], 
      $CellContext`Proposition["p"]], 
     $CellContext`Unary["N", 
      $CellContext`Proposition["s"]]]]],
  Editable->False]], "Output",
 CellChangeTimes->{{3.549589611755105*^9, 3.549589638046609*^9}, 
   3.549633478200535*^9, 3.549634369906701*^9, 3.549634707390448*^9, 
   3.549634995706498*^9, 3.549636077068839*^9, 3.549652450001956*^9, 
   3.549652627695723*^9, 3.5499649125401287`*^9, 3.549965608251921*^9, 
   3.549970215369434*^9, 3.550067850677154*^9, 3.550146042958491*^9, 
   3.550146291139686*^9, 3.550148473710521*^9, 3.5501529413352313`*^9, 
   3.550153023088907*^9, 3.5501531565665417`*^9, 3.5502218142443604`*^9, 
   3.550224328032141*^9, 3.5503645251049595`*^9, 3.550412004505718*^9, 
   3.5507106196006365`*^9, 3.623410525156991*^9, 3.623888835744983*^9, 
   3.623890758200247*^9, 3.624409981666663*^9, 3.629583255382015*^9, 
   3.629584137389824*^9, 3.645653959299938*^9, 3.645656252021456*^9, 
   3.645749615702375*^9, 3.687638699830674*^9, 3.687638748498707*^9, 
   3.841155675248325*^9, 3.841163857896381*^9, 3.841164031211488*^9, 
   3.841164606612598*^9, 3.84116657047095*^9, 3.841166680084505*^9, 
   3.841166862703586*^9, 3.841166896812615*^9, 3.841220350354071*^9, 
   3.8412300869581213`*^9, 3.8412301958713017`*^9, 3.841248973239417*^9, 
   3.841249028882148*^9, 3.841249076009604*^9, 3.841318271278293*^9, 
   3.841322151513057*^9, 3.841322404239925*^9, 3.841324758547542*^9, 
   3.841324988101554*^9, 3.841332924774209*^9, 3.841350165009471*^9, 
   3.84135223884175*^9, 3.84139298265029*^9, 3.841403443585582*^9, {
   3.841405457102459*^9, 3.841405478877565*^9}, 3.84142236709439*^9, 
   3.911255353826024*^9, 3.911290461624345*^9, 3.912269603732813*^9, 
   3.912546353273975*^9, 3.912589071806869*^9, 3.912600351249364*^9, 
   3.912601706406639*^9, 3.9150508715719976`*^9, 3.915535457519359*^9},
 CellLabel->
  "Out[696]//TreeForm=",ExpressionUUID->"bfcf6755-4b05-4052-89d1-\
d092e8af2b46"]
}, Open  ]],

Cell[TextData[{
 "Using Jabelean\[CloseCurlyQuote]s solver (in ",
 StyleBox["JacquardSolver.m",
  FontSlant->"Italic"],
 " in the preliminary packages section of this document). KB is a \
\[OpenCurlyDoubleQuote]knowledge base\[CloseCurlyDoubleQuote] of facts and \
rules."
}], "Text",
 CellChangeTimes->{{3.5499661418724427`*^9, 3.549966160216492*^9}, {
  3.911291915679461*^9, 3.9112919253207703`*^9}, {3.915055188483041*^9, 
  3.915055206588687*^9}},ExpressionUUID->"9bebeb37-1f36-48f2-a8ba-\
fb5ad1dd2820"],

Cell[BoxData[
 RowBox[{
  RowBox[{"KB", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"rl", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", 
       RowBox[{"$p", "@", "\"\<CNsAKrpNs\>\""}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"rl", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", 
       RowBox[{"$p", "@", "\"\<CNCrpKNpAsr\>\""}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"rl", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", 
       RowBox[{"$p", "@", "\"\<CCpsCCsrCpr\>\""}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"rl", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", 
       RowBox[{"$p", "@", "\"\<CsCKpNsANqs\>\""}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"rl", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Binary", "[", 
          RowBox[{"\"\<C\>\"", ",", 
           RowBox[{"var", "[", "l", "]"}], ",", 
           RowBox[{"var", "[", "r", "]"}]}], "]"}], ",", 
         RowBox[{"var", "[", "l", "]"}]}], "}"}], ",", 
       RowBox[{"var", "[", "r", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.549589530038431*^9, 3.5495895820884085`*^9}, {
  3.549589657360714*^9, 3.549589725273598*^9}, {3.549590906922185*^9, 
  3.549590930433529*^9}, {3.5496192834072266`*^9, 3.54961935181614*^9}, {
  3.549634346766388*^9, 3.549634346780389*^9}},
 CellLabel->
  "In[697]:=",ExpressionUUID->"d69ea9e2-674c-406b-acc2-150266436460"],

Cell[BoxData[
 RowBox[{
  RowBox[{"prettifySolutions", "[", "solnss_", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"gridRules", "@", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"solns", "\[Function]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"soln", "\[Function]", 
          RowBox[{
           RowBox[{
           "soln", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           "\[Rule]", 
           RowBox[{"$u", "@", 
            RowBox[{
            "soln", "\[LeftDoubleBracket]", "2", 
             "\[RightDoubleBracket]"}]}]}]}], ")"}], "/@", 
        "\[IndentingNewLine]", "solns"}]}], ")"}], "/@", 
     "\[IndentingNewLine]", "solnss"}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.549619625854813*^9, 3.5496196647350373`*^9}, {
   3.54961979153529*^9, 3.549619896983321*^9}, 3.54963435819353*^9},
 CellLabel->
  "In[698]:=",ExpressionUUID->"32f95c3a-8de7-490a-ac89-e0641ce4d7bd"],

Cell["This next directly answers 2 on page 90. ", "Text",
 CellChangeTimes->{{3.5496178932517147`*^9, 
  3.54961794055542*^9}},ExpressionUUID->"36248010-e00b-4b5f-a6e7-\
757acad5d800"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solutions", "[", 
  RowBox[{
   RowBox[{"Binary", "[", 
    RowBox[{"\"\<C\>\"", ",", 
     RowBox[{"var", "[", "x", "]"}], ",", 
     RowBox[{"$p", "@", "\"\<AKrpNs\>\""}]}], "]"}], ",", "KB"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.841156866947777*^9, 3.841156883186057*^9}},
 CellLabel->
  "In[699]:=",ExpressionUUID->"41590731-6a11-42cb-8aec-63f4b61fc54e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"var", "[", "x", "]"}], "\[Rule]", 
    RowBox[{"Unary", "[", 
     RowBox[{"\<\"N\"\>", ",", 
      RowBox[{"Proposition", "[", "\<\"s\"\>", "]"}]}], "]"}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.841156884815205*^9, 3.841163857935345*^9, 3.841164031231531*^9, 
   3.841164606639488*^9, 3.841166570520498*^9, 3.841166680114772*^9, 
   3.841166862737678*^9, 3.841166896839199*^9, 3.841220350419345*^9, 
   3.84122969301336*^9, 3.841230087026437*^9, 3.841230195936064*^9, 
   3.841248973298525*^9, 3.841249028924769*^9, 3.841249076067811*^9, 
   3.841318271307928*^9, 3.841322151629236*^9, 3.841322404300349*^9, 
   3.841324758565084*^9, 3.841324988119433*^9, 3.841332924808366*^9, 
   3.841350165051751*^9, 3.841352238861322*^9, 3.841392982693714*^9, 
   3.84140344360027*^9, {3.841405457138151*^9, 3.8414054789118357`*^9}, 
   3.841422367147968*^9, 3.911255353845237*^9, 3.911290461644475*^9, 
   3.912269634188573*^9, 3.912546353291182*^9, 3.912589071825579*^9, 
   3.91260035126654*^9, 3.9126017064230757`*^9, 3.915050871589492*^9, 
   3.915535457535039*^9},
 CellLabel->
  "Out[699]=",ExpressionUUID->"028e63f4-0975-480d-8232-cdf89e83589b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"prettifySolutions", "@", 
  RowBox[{"Solutions", "[", 
   RowBox[{
    RowBox[{"Binary", "[", 
     RowBox[{"\"\<C\>\"", ",", 
      RowBox[{"var", "[", "x", "]"}], ",", 
      RowBox[{"$p", "@", "\"\<AKrpNs\>\""}]}], "]"}], ",", "KB"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.549620093789578*^9, 3.549620101814037*^9}, 
   3.5496343467873917`*^9},
 CellLabel->
  "In[700]:=",ExpressionUUID->"7ad93786-2a83-45cf-b94d-235e63993ee1"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[GridBox[{
        {
         TagBox[GridBox[{
            {
             StyleBox[
              TagBox[GridBox[{
                 {
                  StyleBox[
                   StyleBox[
                    TagBox[GridBox[{
                    {"var"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                   StripOnInput->False,
                   
                   LineColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   
                   FrontFaceColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   
                   BackFaceColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   
                   GraphicsColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   FontWeight->Bold,
                   
                   FontColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`]], 
                  StyleBox[
                   TagBox[GridBox[{
                    {"x"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   FontWeight->Bold]}
                },
                AutoDelete->False,
                FrameStyle->GrayLevel[0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"],
              StripOnInput->False,
              LineColor->GrayLevel[0],
              FrontFaceColor->GrayLevel[0],
              BackFaceColor->GrayLevel[0],
              GraphicsColor->GrayLevel[0],
              FontWeight->Bold,
              FontColor->GrayLevel[0]], 
             StyleBox[
              StyleBox[
               TagBox[GridBox[{
                  {"\<\"Ns\"\>"}
                 },
                 AutoDelete->False,
                 GridBoxAlignment->{"Columns" -> {{Left}}},
                 
                 GridBoxItemSize->{
                  "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                "Grid"],
               StripOnInput->False,
               LineColor->RGBColor[
                 Rational[2, 3], 0, 0],
               FrontFaceColor->RGBColor[
                 Rational[2, 3], 0, 0],
               BackFaceColor->RGBColor[
                 Rational[2, 3], 0, 0],
               GraphicsColor->RGBColor[
                 Rational[2, 3], 0, 0],
               FontWeight->Bold,
               FontColor->RGBColor[
                 Rational[2, 3], 0, 0]],
              StripOnInput->False,
              LineColor->RGBColor[0, 0, 1],
              FrontFaceColor->RGBColor[0, 0, 1],
              BackFaceColor->RGBColor[0, 0, 1],
              GraphicsColor->RGBColor[0, 0, 1],
              FontWeight->Bold,
              FontColor->RGBColor[0, 0, 1]]}
           },
           AutoDelete->False,
           FrameStyle->RGBColor[0, 0, 1],
           GridBoxAlignment->{"Columns" -> {{Left}}},
           GridBoxBackground->{"Columns" -> {
               RGBColor[1, 0.9, 0.8], {
                RGBColor[1, 1, 0.85]}}},
           GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
           GridBoxItemSize->{
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
          "Grid"]}
       },
       AutoDelete->False,
       FrameStyle->RGBColor[0, 
         Rational[2, 3], 0],
       GridBoxAlignment->{"Columns" -> {{Left}}},
       GridBoxBackground->{"Columns" -> {{
            RGBColor[0.88, 1, 0.88]}}},
       GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"]}
   },
   AutoDelete->False,
   FrameStyle->RGBColor[0, 
     Rational[2, 3], 0],
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxBackground->{"Columns" -> {{
        RGBColor[0.88, 1, 0.88]}}},
   GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{
  3.549620102443073*^9, 3.5496334782695417`*^9, 3.5496343699477057`*^9, 
   3.549634707429451*^9, 3.549634995745498*^9, 3.5496360771098394`*^9, 
   3.549652450062962*^9, 3.549964912657136*^9, 3.549965616269379*^9, 
   3.549970215420436*^9, 3.550067850831163*^9, 3.5501460513829746`*^9, 
   3.5501462912536926`*^9, 3.550148473779525*^9, 3.5501529414462376`*^9, 
   3.550153023146911*^9, 3.550153156602544*^9, 3.5502218144763746`*^9, 
   3.5502243281161456`*^9, 3.550364525225966*^9, 3.5504120046347237`*^9, 
   3.550710620335678*^9, 3.623888893429291*^9, 3.623890758428602*^9, 
   3.624409981768992*^9, 3.629583255432331*^9, 3.629584137561504*^9, 
   3.645653959498987*^9, 3.645656252100485*^9, 3.645749615805539*^9, 
   3.687638699910149*^9, 3.687638748584074*^9, 3.84115569406118*^9, 
   3.841163857955074*^9, 3.841164031246435*^9, 3.841164606663318*^9, 
   3.841166570536803*^9, 3.841166680131813*^9, 3.841166862760008*^9, 
   3.841166896854383*^9, 3.841220350443669*^9, 3.841230087079556*^9, 
   3.8412301959614553`*^9, 3.841248973330052*^9, 3.841249028947093*^9, 
   3.841249076091063*^9, 3.841318271335524*^9, 3.841322151664144*^9, 
   3.841322404335526*^9, 3.841324758586928*^9, 3.841324988140783*^9, 
   3.841332924830797*^9, 3.8413501650827208`*^9, 3.841352238895248*^9, 
   3.8413929827252903`*^9, 3.841403443626976*^9, {3.84140545716024*^9, 
   3.84140547893524*^9}, 3.841422367184815*^9, 3.91125535385675*^9, 
   3.911290461655885*^9, 3.912269637599197*^9, 3.912546353296571*^9, 
   3.912589071840873*^9, 3.912600351278044*^9, 3.912601706430937*^9, 
   3.915050871599963*^9, 3.915535457547518*^9},
 CellLabel->
  "Out[700]=",ExpressionUUID->"7d891349-dbb6-44cf-8d35-ac3a26e365cc"]
}, Open  ]],

Cell["It\[CloseCurlyQuote]s not able to dig inside terms looking for an A:", \
"Text",
 CellChangeTimes->{{3.549970363248892*^9, 3.549970369897272*^9}, {
  3.62388938413766*^9, 
  3.623889388513888*^9}},ExpressionUUID->"9f421dd3-f1be-43fc-b015-\
50fbd3a85185"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"prettifySolutions", "@", 
  RowBox[{"Solutions", "[", 
   RowBox[{
    RowBox[{"Binary", "[", 
     RowBox[{"\"\<A\>\"", ",", 
      RowBox[{"var", "[", "x", "]"}], ",", 
      RowBox[{"var", "[", "y", "]"}]}], "]"}], ",", "KB"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.549970337605425*^9, 3.549970356578511*^9}},
 CellLabel->
  "In[701]:=",ExpressionUUID->"8901db53-9ee3-4f3d-841d-e14c108ef6f3"],

Cell[BoxData[
 InterpretationBox[
  TagBox[GridBox[{
     {""}
    },
    AutoDelete->False,
    FrameStyle->RGBColor[0, 
      Rational[2, 3], 0],
    GridBoxAlignment->{"Columns" -> {{Left}}},
    GridBoxBackground->{"Columns" -> {{
         RGBColor[0.88, 1, 0.88]}}},
    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
    GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
   "Grid"],
  Grid[{}, Frame -> All, FrameStyle -> RGBColor[0, 
     Rational[2, 3], 0], Alignment -> Left, Background -> 
   RGBColor[0.88, 1, 0.88]]]], "Output",
 CellChangeTimes->{
  3.5499703574445596`*^9, 3.550067850878165*^9, 3.550146052803054*^9, 
   3.550146291301695*^9, 3.550148473824528*^9, 3.550152941479239*^9, 
   3.5501530231799126`*^9, 3.550153156623545*^9, 3.5502218145263786`*^9, 
   3.5502243281651487`*^9, 3.550364525270969*^9, 3.550412004683728*^9, 
   3.550710620392681*^9, 3.623888900030004*^9, 3.623890758482581*^9, 
   3.624409981836995*^9, 3.629583255474867*^9, 3.629584137591039*^9, 
   3.645653959546233*^9, 3.64565625218427*^9, 3.645749615862174*^9, 
   3.687638699975038*^9, 3.687638748616707*^9, 3.8411556975725813`*^9, 
   3.841163857980229*^9, 3.8411640312652884`*^9, 3.841164606691864*^9, 
   3.841166570557438*^9, 3.8411666801536303`*^9, 3.841166862785192*^9, 
   3.841166896876046*^9, 3.8412203504752903`*^9, 3.841230087131556*^9, 
   3.841230196002471*^9, 3.841248973372055*^9, 3.841249028980885*^9, 
   3.841249076124799*^9, 3.841318271395976*^9, 3.841322151698375*^9, 
   3.841322404365157*^9, 3.841324758608972*^9, 3.841324988162943*^9, 
   3.8413329248534307`*^9, 3.841350165112099*^9, 3.84135223892811*^9, 
   3.841392982754484*^9, 3.841403443661919*^9, {3.841405457192131*^9, 
   3.841405478971663*^9}, 3.841422367221302*^9, 3.911255353861545*^9, 
   3.911290461663369*^9, 3.9122696427074003`*^9, 3.912546353309037*^9, 
   3.912589071846133*^9, 3.912600351282496*^9, 3.912601706436289*^9, 
   3.915050871608832*^9, 3.915535457555871*^9},
 CellLabel->
  "Out[701]=",ExpressionUUID->"4fc851b2-8855-4579-9b21-5804736ad9bd"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Experiment with Cabrera\[CloseCurlyQuote]s solver", "Subsubsection",
 CellChangeTimes->{{3.5499659301603336`*^9, 3.549965934064557*^9}, {
  3.5499661249624753`*^9, 
  3.549966129752749*^9}},ExpressionUUID->"0015983c-8b1a-426b-a2fe-\
c8c74afbc89d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"Knowledge", ",", "Statements"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"SetAttributes", "[", 
  RowBox[{"Statements", ",", 
   RowBox[{"{", 
    RowBox[{"Flat", ",", "Orderless"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Knowledge", "=", 
   RowBox[{"Statements", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"$p", "@", "\"\<CNsAKrpNs\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{"$p", "@", "\"\<CNCrpKNpAsr\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{"$p", "@", "\"\<CCpsCCsrCpr\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{"$p", "@", "\"\<CsCKpNsANqs\>\""}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"$u", "/@", 
  RowBox[{"Question", "[", 
   RowBox[{"Knowledge", ",", " ", 
    RowBox[{"Binary", "[", 
     RowBox[{"\"\<C\>\"", ",", "X_", ",", 
      RowBox[{"$p", "@", "\"\<AKrpNs\>\""}]}], "]"}], ",", " ", "X"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.5499659486383905`*^9, 3.549965952641619*^9}, {
  3.549966245338361*^9, 3.549966274931053*^9}, {3.5499675226114182`*^9, 
  3.5499675904842987`*^9}, {3.549969999517087*^9, 3.54997008943823*^9}, {
  3.549970265494301*^9, 3.5499703000052743`*^9}, {3.549970378013736*^9, 
  3.549970433357901*^9}},
 CellLabel->
  "In[702]:=",ExpressionUUID->"cf1de138-3a7b-454e-8238-8b9894444d81"],

Cell[BoxData[
 RowBox[{"{", "\<\"Ns\"\>", "}"}]], "Output",
 CellChangeTimes->{{3.549970082175815*^9, 3.549970093047437*^9}, 
   3.549970215474439*^9, {3.549970273338749*^9, 3.549970300492302*^9}, {
   3.549970401804097*^9, 3.549970434337958*^9}, 3.550067850933169*^9, 
   3.550146055899231*^9, 3.550146291341698*^9, 3.55014847386453*^9, 
   3.550152941513242*^9, 3.550153023205914*^9, 3.550153156640546*^9, 
   3.55022181457538*^9, 3.550224328249153*^9, 3.550364525309971*^9, 
   3.550412004728731*^9, 3.550710620438684*^9, 3.623889397971205*^9, 
   3.623890758551268*^9, 3.624409981904126*^9, 3.629583255526259*^9, 
   3.6295841376348658`*^9, 3.645653959698553*^9, 3.645656252268764*^9, 
   3.645749615929789*^9, 3.687638700041197*^9, 3.687638748682486*^9, 
   3.841155700826645*^9, 3.841163858004865*^9, 3.841164031285356*^9, 
   3.841164606719225*^9, 3.841166570579256*^9, 3.841166680175883*^9, 
   3.841166862814389*^9, 3.841166896897442*^9, 3.841220350507476*^9, 
   3.841230087185186*^9, 3.841230196036467*^9, 3.841248973412641*^9, 
   3.841249029015648*^9, 3.841249076183624*^9, 3.841318271423656*^9, 
   3.841322151734547*^9, 3.841322404394279*^9, 3.841324758632641*^9, 
   3.8413249881848593`*^9, 3.841332924875368*^9, 3.841350165139616*^9, 
   3.84135223896281*^9, 3.8413929827852583`*^9, 3.841403443697567*^9, {
   3.841405457225233*^9, 3.84140547900976*^9}, 3.841422367262896*^9, 
   3.911255353872972*^9, 3.911290461671982*^9, 3.912269646395496*^9, 
   3.912546353312739*^9, 3.912589071856348*^9, 3.912600351290741*^9, 
   3.912601706448125*^9, 3.9150508716141977`*^9, 3.915535457559057*^9},
 CellLabel->
  "Out[705]=",ExpressionUUID->"2dfaa1b3-7297-4cbb-82ab-b5c6ac7484fc"]
}, Open  ]],

Cell[TextData[{
 "A limitation of Cabrera\[CloseCurlyQuote]s solver is that it eagerly \
expands rules into facts, explosively, perhaps even infinitely, consuming \
memory. Until we make this lazy, we\[CloseCurlyQuote]ll use Jabelean\
\[CloseCurlyQuote]s solver, which is slower than Cabrera\[CloseCurlyQuote]s \
because it does not use ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 "\[CloseCurlyQuote]s pattern matching."
}], "Text",
 CellChangeTimes->{{3.550067897475831*^9, 
  3.550068030444436*^9}},ExpressionUUID->"e900c724-94e0-465c-a2d2-\
e0229182a7aa"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Back to Jabelean\[CloseCurlyQuote]s solver", "Subsubsection",
 CellChangeTimes->{{3.549965922136874*^9, 3.549965926217108*^9}, {
  3.5499662220330276`*^9, 
  3.549966238568974*^9}},ExpressionUUID->"8a6859f3-1d66-4a96-bb8a-\
17ce7eec5881"],

Cell["This next shows that the solver is bi-directional:", "Text",
 CellChangeTimes->{{3.549618431604506*^9, 3.549618443580191*^9}, 
   3.841230073572063*^9},ExpressionUUID->"545d0f4f-ac90-4286-b3cf-\
0a1a37ddee6d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"prettifySolutions", "@", "\[IndentingNewLine]", 
  RowBox[{"Solutions", "[", 
   RowBox[{
    RowBox[{"Binary", "[", 
     RowBox[{"\"\<C\>\"", ",", 
      RowBox[{"$p", "@", "\"\<Ns\>\""}], ",", 
      RowBox[{"var", "[", "y", "]"}]}], "]"}], ",", "KB"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.549591768971491*^9, 3.549591810199849*^9}, {
   3.549591849329088*^9, 3.54959191563288*^9}, {3.549620113910728*^9, 
   3.5496201218621836`*^9}, 3.549634346959407*^9},
 CellLabel->
  "In[706]:=",ExpressionUUID->"fd1d6ad5-f584-4f55-911a-fa09edfa0daf"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[GridBox[{
        {
         TagBox[GridBox[{
            {
             StyleBox[
              TagBox[GridBox[{
                 {
                  StyleBox[
                   StyleBox[
                    TagBox[GridBox[{
                    {"var"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                   StripOnInput->False,
                   
                   LineColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   
                   FrontFaceColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   
                   BackFaceColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   
                   GraphicsColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   FontWeight->Bold,
                   
                   FontColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`]], 
                  StyleBox[
                   TagBox[GridBox[{
                    {"y"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   FontWeight->Bold]}
                },
                AutoDelete->False,
                FrameStyle->GrayLevel[0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"],
              StripOnInput->False,
              LineColor->GrayLevel[0],
              FrontFaceColor->GrayLevel[0],
              BackFaceColor->GrayLevel[0],
              GraphicsColor->GrayLevel[0],
              FontWeight->Bold,
              FontColor->GrayLevel[0]], 
             StyleBox[
              StyleBox[
               TagBox[GridBox[{
                  {"\<\"AKrpNs\"\>"}
                 },
                 AutoDelete->False,
                 GridBoxAlignment->{"Columns" -> {{Left}}},
                 
                 GridBoxItemSize->{
                  "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                "Grid"],
               StripOnInput->False,
               LineColor->RGBColor[
                 Rational[2, 3], 0, 0],
               FrontFaceColor->RGBColor[
                 Rational[2, 3], 0, 0],
               BackFaceColor->RGBColor[
                 Rational[2, 3], 0, 0],
               GraphicsColor->RGBColor[
                 Rational[2, 3], 0, 0],
               FontWeight->Bold,
               FontColor->RGBColor[
                 Rational[2, 3], 0, 0]],
              StripOnInput->False,
              LineColor->RGBColor[0, 0, 1],
              FrontFaceColor->RGBColor[0, 0, 1],
              BackFaceColor->RGBColor[0, 0, 1],
              GraphicsColor->RGBColor[0, 0, 1],
              FontWeight->Bold,
              FontColor->RGBColor[0, 0, 1]]}
           },
           AutoDelete->False,
           FrameStyle->RGBColor[0, 0, 1],
           GridBoxAlignment->{"Columns" -> {{Left}}},
           GridBoxBackground->{"Columns" -> {
               RGBColor[1, 0.9, 0.8], {
                RGBColor[1, 1, 0.85]}}},
           GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
           GridBoxItemSize->{
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
          "Grid"]}
       },
       AutoDelete->False,
       FrameStyle->RGBColor[0, 
         Rational[2, 3], 0],
       GridBoxAlignment->{"Columns" -> {{Left}}},
       GridBoxBackground->{"Columns" -> {{
            RGBColor[0.88, 1, 0.88]}}},
       GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"]}
   },
   AutoDelete->False,
   FrameStyle->RGBColor[0, 
     Rational[2, 3], 0],
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxBackground->{"Columns" -> {{
        RGBColor[0.88, 1, 0.88]}}},
   GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{
  3.549591814298084*^9, {3.549591862758856*^9, 3.549591916605935*^9}, 
   3.5496193564694057`*^9, 3.549620122530222*^9, 3.5496334782955446`*^9, 
   3.549634369982709*^9, 3.5496347074604554`*^9, 3.549634995776498*^9, 
   3.549636077140839*^9, 3.549652450098964*^9, 3.549964912701138*^9, 
   3.5499656182584934`*^9, 3.549970215561445*^9, 3.5500678509791718`*^9, 
   3.550146057817341*^9, 3.5501462913887*^9, 3.550148473951535*^9, 
   3.550152941548243*^9, 3.550153023237916*^9, 3.550153156656547*^9, 
   3.550221814636383*^9, 3.5502243282901554`*^9, 3.550364525351974*^9, 
   3.550412004773733*^9, 3.550710620503688*^9, 3.623889463066033*^9, 
   3.62389075861794*^9, 3.6244099820186453`*^9, 3.629583255575803*^9, 
   3.6295841376864786`*^9, 3.645653959945426*^9, 3.645656252350946*^9, 
   3.645749615995438*^9, 3.687638700108357*^9, 3.687638748748279*^9, 
   3.841155714378855*^9, 3.841163858030788*^9, 3.841164031336431*^9, 
   3.841164606747056*^9, 3.84116657060067*^9, 3.841166680201943*^9, 
   3.841166862841919*^9, 3.841166896918662*^9, 3.841220350540627*^9, 
   3.841230087235609*^9, 3.841230196070938*^9, 3.841248973454877*^9, 
   3.84124902905354*^9, 3.8412490762163153`*^9, 3.841318271452564*^9, 
   3.841322151772737*^9, 3.841322404449289*^9, 3.841324758657073*^9, 
   3.841324988206414*^9, 3.841332924897918*^9, 3.841350165168125*^9, 
   3.841352238996232*^9, 3.841392982815289*^9, 3.841403443734679*^9, {
   3.841405457257422*^9, 3.841405479047765*^9}, 3.841422367305785*^9, 
   3.911255353893387*^9, 3.911290461676383*^9, 3.912269666659086*^9, 
   3.912546353322255*^9, 3.912589071861429*^9, 3.9126003512977753`*^9, 
   3.912601706456826*^9, 3.915050871621491*^9, 3.915535457567483*^9},
 CellLabel->
  "Out[706]=",ExpressionUUID->"ff83476d-324c-40d0-9815-d6b959a880ac"]
}, Open  ]],

Cell["\<\
The next two show similar solutions for different L and R terms in a CLR.\
\>", "Text",
 CellChangeTimes->{{3.549618482451415*^9, 
  3.549618506883812*^9}},ExpressionUUID->"0a89cdfd-cad0-4309-823d-\
72abe9d83db9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"prettifySolutions", "@", "\[IndentingNewLine]", 
  RowBox[{"Solutions", "[", 
   RowBox[{
    RowBox[{"Binary", "[", 
     RowBox[{"\"\<C\>\"", ",", 
      RowBox[{"var", "[", "x", "]"}], ",", 
      RowBox[{"$p", "@", "\"\<KNpAsr\>\""}]}], "]"}], ",", "KB"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.5495901985776696`*^9, 3.5495902585521*^9}, {
   3.549590642761076*^9, 3.549590748417119*^9}, 3.5495908009531236`*^9, 
   3.549591934138938*^9, {3.549592210489744*^9, 3.549592235025148*^9}, {
   3.549620129977648*^9, 3.549620133725862*^9}, 3.549634346977409*^9},
 CellLabel->
  "In[707]:=",ExpressionUUID->"9229b6af-8e5b-4028-8696-9d5748fe3453"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[GridBox[{
        {
         TagBox[GridBox[{
            {
             StyleBox[
              TagBox[GridBox[{
                 {
                  StyleBox[
                   StyleBox[
                    TagBox[GridBox[{
                    {"var"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                   StripOnInput->False,
                   
                   LineColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   
                   FrontFaceColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   
                   BackFaceColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   
                   GraphicsColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   FontWeight->Bold,
                   
                   FontColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`]], 
                  StyleBox[
                   TagBox[GridBox[{
                    {"x"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   FontWeight->Bold]}
                },
                AutoDelete->False,
                FrameStyle->GrayLevel[0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"],
              StripOnInput->False,
              LineColor->GrayLevel[0],
              FrontFaceColor->GrayLevel[0],
              BackFaceColor->GrayLevel[0],
              GraphicsColor->GrayLevel[0],
              FontWeight->Bold,
              FontColor->GrayLevel[0]], 
             StyleBox[
              StyleBox[
               TagBox[GridBox[{
                  {"\<\"NCrp\"\>"}
                 },
                 AutoDelete->False,
                 GridBoxAlignment->{"Columns" -> {{Left}}},
                 
                 GridBoxItemSize->{
                  "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                "Grid"],
               StripOnInput->False,
               LineColor->RGBColor[
                 Rational[2, 3], 0, 0],
               FrontFaceColor->RGBColor[
                 Rational[2, 3], 0, 0],
               BackFaceColor->RGBColor[
                 Rational[2, 3], 0, 0],
               GraphicsColor->RGBColor[
                 Rational[2, 3], 0, 0],
               FontWeight->Bold,
               FontColor->RGBColor[
                 Rational[2, 3], 0, 0]],
              StripOnInput->False,
              LineColor->RGBColor[0, 0, 1],
              FrontFaceColor->RGBColor[0, 0, 1],
              BackFaceColor->RGBColor[0, 0, 1],
              GraphicsColor->RGBColor[0, 0, 1],
              FontWeight->Bold,
              FontColor->RGBColor[0, 0, 1]]}
           },
           AutoDelete->False,
           FrameStyle->RGBColor[0, 0, 1],
           GridBoxAlignment->{"Columns" -> {{Left}}},
           GridBoxBackground->{"Columns" -> {
               RGBColor[1, 0.9, 0.8], {
                RGBColor[1, 1, 0.85]}}},
           GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
           GridBoxItemSize->{
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
          "Grid"]}
       },
       AutoDelete->False,
       FrameStyle->RGBColor[0, 
         Rational[2, 3], 0],
       GridBoxAlignment->{"Columns" -> {{Left}}},
       GridBoxBackground->{"Columns" -> {{
            RGBColor[0.88, 1, 0.88]}}},
       GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"]}
   },
   AutoDelete->False,
   FrameStyle->RGBColor[0, 
     Rational[2, 3], 0],
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxBackground->{"Columns" -> {{
        RGBColor[0.88, 1, 0.88]}}},
   GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{
  3.549590259636162*^9, {3.549590673574838*^9, 3.5495907489451504`*^9}, 
   3.549590802146192*^9, 3.549590932651656*^9, {3.5495917442410784`*^9, 
   3.549591766735363*^9}, 3.549591935194999*^9, {3.549592212296848*^9, 
   3.5495922355991807`*^9}, 3.549619358090499*^9, 3.549620134453904*^9, 
   3.5496334783215475`*^9, 3.549634370016712*^9, 3.5496347074914584`*^9, 
   3.549634995808498*^9, 3.549636077171839*^9, 3.549652450136969*^9, 
   3.54996491274314*^9, 3.549965620345613*^9, 3.549970215601447*^9, 
   3.550067851025174*^9, 3.550146061407546*^9, 3.5501462914297023`*^9, 
   3.550148473991538*^9, 3.550152941582246*^9, 3.550153023265918*^9, 
   3.550153156674548*^9, 3.5502218146853857`*^9, 3.550224328331158*^9, 
   3.550364525391976*^9, 3.5504120048177357`*^9, 3.5507106206356955`*^9, 
   3.6238895406439977`*^9, 3.623890758684078*^9, 3.62440998218188*^9, 
   3.629583255622321*^9, 3.629584137739642*^9, 3.64565396012745*^9, 
   3.645656252433074*^9, 3.645749616062723*^9, 3.687638700175155*^9, 
   3.6876387488151426`*^9, 3.841155717882878*^9, 3.841163858053549*^9, 
   3.841164031351127*^9, 3.8411646067736883`*^9, 3.841166570622409*^9, 
   3.8411666802285957`*^9, 3.841166862872932*^9, 3.841166896940721*^9, 
   3.841220350572608*^9, 3.841230087280145*^9, 3.841230196110086*^9, 
   3.841248973495409*^9, 3.841249029090056*^9, 3.841249076256851*^9, 
   3.8413182714822*^9, 3.841322151818056*^9, 3.841322404476668*^9, 
   3.841324758680189*^9, 3.841324988229525*^9, 3.841332924920906*^9, 
   3.841350165198365*^9, 3.841352239027112*^9, 3.841392982856738*^9, 
   3.8414034437713203`*^9, {3.841405457288425*^9, 3.841405479082948*^9}, 
   3.841422367349701*^9, 3.911255353907058*^9, 3.911290461685396*^9, 
   3.91226967111408*^9, 3.912546353331176*^9, 3.912589071872653*^9, 
   3.912600351302206*^9, 3.912601706461608*^9, 3.915050871629156*^9, 
   3.9155354575760927`*^9},
 CellLabel->
  "Out[707]=",ExpressionUUID->"a0a0c41e-6e20-4f44-b9cd-c53ccf6f7a01"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"prettifySolutions", "@", "\[IndentingNewLine]", 
  RowBox[{"Solutions", "[", 
   RowBox[{
    RowBox[{"Binary", "[", 
     RowBox[{"\"\<C\>\"", ",", 
      RowBox[{"$p", "@", "\"\<NCrp\>\""}], ",", 
      RowBox[{"var", "[", "y", "]"}]}], "]"}], ",", "KB"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.549591768971491*^9, 3.549591810199849*^9}, {
   3.549591849329088*^9, 3.54959191563288*^9}, {3.549592241057494*^9, 
   3.54959224240057*^9}, {3.54962013931018*^9, 3.549620142334355*^9}, 
   3.549634346991411*^9},
 CellLabel->
  "In[708]:=",ExpressionUUID->"a59adf18-2558-432b-8683-113f79b9ccd1"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[GridBox[{
        {
         TagBox[GridBox[{
            {
             StyleBox[
              TagBox[GridBox[{
                 {
                  StyleBox[
                   StyleBox[
                    TagBox[GridBox[{
                    {"var"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                   StripOnInput->False,
                   
                   LineColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   
                   FrontFaceColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   
                   BackFaceColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   
                   GraphicsColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   FontWeight->Bold,
                   
                   FontColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`]], 
                  StyleBox[
                   TagBox[GridBox[{
                    {"y"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   FontWeight->Bold]}
                },
                AutoDelete->False,
                FrameStyle->GrayLevel[0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"],
              StripOnInput->False,
              LineColor->GrayLevel[0],
              FrontFaceColor->GrayLevel[0],
              BackFaceColor->GrayLevel[0],
              GraphicsColor->GrayLevel[0],
              FontWeight->Bold,
              FontColor->GrayLevel[0]], 
             StyleBox[
              StyleBox[
               TagBox[GridBox[{
                  {"\<\"KNpAsr\"\>"}
                 },
                 AutoDelete->False,
                 GridBoxAlignment->{"Columns" -> {{Left}}},
                 
                 GridBoxItemSize->{
                  "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                "Grid"],
               StripOnInput->False,
               LineColor->RGBColor[
                 Rational[2, 3], 0, 0],
               FrontFaceColor->RGBColor[
                 Rational[2, 3], 0, 0],
               BackFaceColor->RGBColor[
                 Rational[2, 3], 0, 0],
               GraphicsColor->RGBColor[
                 Rational[2, 3], 0, 0],
               FontWeight->Bold,
               FontColor->RGBColor[
                 Rational[2, 3], 0, 0]],
              StripOnInput->False,
              LineColor->RGBColor[0, 0, 1],
              FrontFaceColor->RGBColor[0, 0, 1],
              BackFaceColor->RGBColor[0, 0, 1],
              GraphicsColor->RGBColor[0, 0, 1],
              FontWeight->Bold,
              FontColor->RGBColor[0, 0, 1]]}
           },
           AutoDelete->False,
           FrameStyle->RGBColor[0, 0, 1],
           GridBoxAlignment->{"Columns" -> {{Left}}},
           GridBoxBackground->{"Columns" -> {
               RGBColor[1, 0.9, 0.8], {
                RGBColor[1, 1, 0.85]}}},
           GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
           GridBoxItemSize->{
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
          "Grid"]}
       },
       AutoDelete->False,
       FrameStyle->RGBColor[0, 
         Rational[2, 3], 0],
       GridBoxAlignment->{"Columns" -> {{Left}}},
       GridBoxBackground->{"Columns" -> {{
            RGBColor[0.88, 1, 0.88]}}},
       GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"]}
   },
   AutoDelete->False,
   FrameStyle->RGBColor[0, 
     Rational[2, 3], 0],
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxBackground->{"Columns" -> {{
        RGBColor[0.88, 1, 0.88]}}},
   GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{
  3.549591814298084*^9, {3.549591862758856*^9, 3.549591916605935*^9}, 
   3.549592242992605*^9, 3.549619359554582*^9, 3.549620143641429*^9, 
   3.5496334783475494`*^9, 3.5496343700487156`*^9, 3.54963470752346*^9, 
   3.549634995838498*^9, 3.5496360772038393`*^9, 3.549652450171973*^9, 
   3.549964912782143*^9, 3.549970215644449*^9, 3.550067851069177*^9, 
   3.5501460623435993`*^9, 3.550146291470705*^9, 3.55014847403154*^9, 
   3.5501529416142473`*^9, 3.5501530232959194`*^9, 3.5501531566915493`*^9, 
   3.550221814732389*^9, 3.5502243283781605`*^9, 3.550364525430978*^9, 
   3.550412004866739*^9, 3.5507106207146997`*^9, 3.623889546847598*^9, 
   3.623890758799959*^9, 3.624409982304157*^9, 3.629583255677812*^9, 
   3.629584138153145*^9, 3.645653960248599*^9, 3.6456562525190697`*^9, 
   3.645749616263808*^9, 3.6876387002415*^9, 3.687638748883099*^9, 
   3.84116385807663*^9, 3.841164031371324*^9, 3.841164606802634*^9, 
   3.841166570643704*^9, 3.841166680255487*^9, 3.841166862903439*^9, 
   3.841166896962224*^9, 3.841220350603385*^9, 3.841230087317925*^9, 
   3.841230196143314*^9, 3.841248973561405*^9, 3.841249029124283*^9, 
   3.841249076296672*^9, 3.841318271518054*^9, 3.841322151854548*^9, 
   3.841322404503237*^9, 3.841324758702313*^9, 3.841324988252839*^9, 
   3.841332924943151*^9, 3.841350165229889*^9, 3.841352239063861*^9, 
   3.841392982884927*^9, 3.841403443806791*^9, {3.841405457323619*^9, 
   3.841405479119999*^9}, 3.841422367385771*^9, 3.911255353912233*^9, 
   3.911290461689754*^9, 3.912269673335229*^9, 3.912546353340519*^9, 
   3.9125890718777857`*^9, 3.912600351312953*^9, 3.912601706474317*^9, 
   3.915050871636618*^9, 3.915535457584605*^9},
 CellLabel->
  "Out[708]=",ExpressionUUID->"df53a0c9-977f-48c3-8ca0-9cc55dcfc7d8"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Example 8 (3 on page 90 of WFF-n-Proof)", "Subsubsection",
 CellChangeTimes->{{3.549504744652985*^9, 3.549504761925973*^9}, 
   3.912601519178802*^9, 
   3.912601668607902*^9},ExpressionUUID->"aa41ccc5-f4b8-4ce2-81f3-\
ec77febcf07f"],

Cell["Can we find a CLR given an L and an R?", "Text",
 CellChangeTimes->{{3.549618549779265*^9, 
  3.549618563700062*^9}},ExpressionUUID->"affd6003-ca8a-4d9b-975f-\
7a241a005a30"],

Cell["\<\
We can find all CLRs in the fact base, then filter them down to the ones that \
match our given L and R. We\[CloseCurlyQuote]ll do the filtering with a \
post-processing phase, to the solver. The solver\[CloseCurlyQuote]s job is to \
give us all CLRs in the fact base.\
\>", "Text",
 CellChangeTimes->{{3.549618566651231*^9, 3.549618639388391*^9}, {
  3.6238895792012877`*^9, 
  3.623889584697032*^9}},ExpressionUUID->"087478bc-24cd-44a2-80ff-\
9f3ac6b56bbe"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"prettifySolutions", "@", "\[IndentingNewLine]", 
  RowBox[{"Solutions", "[", 
   RowBox[{
    RowBox[{"Binary", "[", 
     RowBox[{"\"\<C\>\"", ",", 
      RowBox[{"var", "[", "x", "]"}], ",", 
      RowBox[{"var", "[", "y", "]"}]}], "]"}], ",", "KB"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.549619411942579*^9, 3.54961958854268*^9}, {
  3.549619669727323*^9, 3.54961968243005*^9}},
 CellLabel->
  "In[709]:=",ExpressionUUID->"ff26f956-bd04-4672-a470-adfe0fefa246"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[GridBox[{
        {
         TagBox[GridBox[{
            {
             StyleBox[
              TagBox[GridBox[{
                 {
                  StyleBox[
                   StyleBox[
                    TagBox[GridBox[{
                    {"var"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                   StripOnInput->False,
                   
                   LineColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   
                   FrontFaceColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   
                   BackFaceColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   
                   GraphicsColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   FontWeight->Bold,
                   
                   FontColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`]], 
                  StyleBox[
                   TagBox[GridBox[{
                    {"x"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   FontWeight->Bold]}
                },
                AutoDelete->False,
                FrameStyle->GrayLevel[0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"],
              StripOnInput->False,
              LineColor->GrayLevel[0],
              FrontFaceColor->GrayLevel[0],
              BackFaceColor->GrayLevel[0],
              GraphicsColor->GrayLevel[0],
              FontWeight->Bold,
              FontColor->GrayLevel[0]], 
             StyleBox[
              StyleBox[
               TagBox[GridBox[{
                  {"\<\"Cps\"\>"}
                 },
                 AutoDelete->False,
                 GridBoxAlignment->{"Columns" -> {{Left}}},
                 
                 GridBoxItemSize->{
                  "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                "Grid"],
               StripOnInput->False,
               LineColor->RGBColor[
                 Rational[2, 3], 0, 0],
               FrontFaceColor->RGBColor[
                 Rational[2, 3], 0, 0],
               BackFaceColor->RGBColor[
                 Rational[2, 3], 0, 0],
               GraphicsColor->RGBColor[
                 Rational[2, 3], 0, 0],
               FontWeight->Bold,
               FontColor->RGBColor[
                 Rational[2, 3], 0, 0]],
              StripOnInput->False,
              LineColor->RGBColor[0, 0, 1],
              FrontFaceColor->RGBColor[0, 0, 1],
              BackFaceColor->RGBColor[0, 0, 1],
              GraphicsColor->RGBColor[0, 0, 1],
              FontWeight->Bold,
              FontColor->RGBColor[0, 0, 1]]},
            {
             StyleBox[
              TagBox[GridBox[{
                 {
                  StyleBox[
                   StyleBox[
                    TagBox[GridBox[{
                    {"var"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                   StripOnInput->False,
                   
                   LineColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   
                   FrontFaceColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   
                   BackFaceColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   
                   GraphicsColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   FontWeight->Bold,
                   
                   FontColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`]], 
                  StyleBox[
                   TagBox[GridBox[{
                    {"y"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   FontWeight->Bold]}
                },
                AutoDelete->False,
                FrameStyle->GrayLevel[0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"],
              StripOnInput->False,
              LineColor->GrayLevel[0],
              FrontFaceColor->GrayLevel[0],
              BackFaceColor->GrayLevel[0],
              GraphicsColor->GrayLevel[0],
              FontWeight->Bold,
              FontColor->GrayLevel[0]], 
             StyleBox[
              StyleBox[
               TagBox[GridBox[{
                  {"\<\"CCsrCpr\"\>"}
                 },
                 AutoDelete->False,
                 GridBoxAlignment->{"Columns" -> {{Left}}},
                 
                 GridBoxItemSize->{
                  "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                "Grid"],
               StripOnInput->False,
               LineColor->RGBColor[
                 Rational[2, 3], 0, 0],
               FrontFaceColor->RGBColor[
                 Rational[2, 3], 0, 0],
               BackFaceColor->RGBColor[
                 Rational[2, 3], 0, 0],
               GraphicsColor->RGBColor[
                 Rational[2, 3], 0, 0],
               FontWeight->Bold,
               FontColor->RGBColor[
                 Rational[2, 3], 0, 0]],
              StripOnInput->False,
              LineColor->RGBColor[0, 0, 1],
              FrontFaceColor->RGBColor[0, 0, 1],
              BackFaceColor->RGBColor[0, 0, 1],
              GraphicsColor->RGBColor[0, 0, 1],
              FontWeight->Bold,
              FontColor->RGBColor[0, 0, 1]]}
           },
           AutoDelete->False,
           FrameStyle->RGBColor[0, 0, 1],
           GridBoxAlignment->{"Columns" -> {{Left}}},
           GridBoxBackground->{"Columns" -> {
               RGBColor[1, 0.9, 0.8], {
                RGBColor[1, 1, 0.85]}}},
           GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
           
           GridBoxItemSize->{
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
          "Grid"]}
       },
       AutoDelete->False,
       FrameStyle->RGBColor[0, 
         Rational[2, 3], 0],
       GridBoxAlignment->{"Columns" -> {{Left}}},
       GridBoxBackground->{"Columns" -> {{
            RGBColor[0.88, 1, 0.88]}}},
       GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"]},
    {
     TagBox[GridBox[{
        {
         TagBox[GridBox[{
            {
             StyleBox[
              TagBox[GridBox[{
                 {
                  StyleBox[
                   StyleBox[
                    TagBox[GridBox[{
                    {"var"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                   StripOnInput->False,
                   
                   LineColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   
                   FrontFaceColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   
                   BackFaceColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   
                   GraphicsColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   FontWeight->Bold,
                   
                   FontColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`]], 
                  StyleBox[
                   TagBox[GridBox[{
                    {"x"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   FontWeight->Bold]}
                },
                AutoDelete->False,
                FrameStyle->GrayLevel[0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"],
              StripOnInput->False,
              LineColor->GrayLevel[0],
              FrontFaceColor->GrayLevel[0],
              BackFaceColor->GrayLevel[0],
              GraphicsColor->GrayLevel[0],
              FontWeight->Bold,
              FontColor->GrayLevel[0]], 
             StyleBox[
              StyleBox[
               TagBox[GridBox[{
                  {"\<\"s\"\>"}
                 },
                 AutoDelete->False,
                 GridBoxAlignment->{"Columns" -> {{Left}}},
                 
                 GridBoxItemSize->{
                  "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                "Grid"],
               StripOnInput->False,
               LineColor->RGBColor[
                 Rational[2, 3], 0, 0],
               FrontFaceColor->RGBColor[
                 Rational[2, 3], 0, 0],
               BackFaceColor->RGBColor[
                 Rational[2, 3], 0, 0],
               GraphicsColor->RGBColor[
                 Rational[2, 3], 0, 0],
               FontWeight->Bold,
               FontColor->RGBColor[
                 Rational[2, 3], 0, 0]],
              StripOnInput->False,
              LineColor->RGBColor[0, 0, 1],
              FrontFaceColor->RGBColor[0, 0, 1],
              BackFaceColor->RGBColor[0, 0, 1],
              GraphicsColor->RGBColor[0, 0, 1],
              FontWeight->Bold,
              FontColor->RGBColor[0, 0, 1]]},
            {
             StyleBox[
              TagBox[GridBox[{
                 {
                  StyleBox[
                   StyleBox[
                    TagBox[GridBox[{
                    {"var"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                   StripOnInput->False,
                   
                   LineColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   
                   FrontFaceColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   
                   BackFaceColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   
                   GraphicsColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   FontWeight->Bold,
                   
                   FontColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`]], 
                  StyleBox[
                   TagBox[GridBox[{
                    {"y"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   FontWeight->Bold]}
                },
                AutoDelete->False,
                FrameStyle->GrayLevel[0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"],
              StripOnInput->False,
              LineColor->GrayLevel[0],
              FrontFaceColor->GrayLevel[0],
              BackFaceColor->GrayLevel[0],
              GraphicsColor->GrayLevel[0],
              FontWeight->Bold,
              FontColor->GrayLevel[0]], 
             StyleBox[
              StyleBox[
               TagBox[GridBox[{
                  {"\<\"CKpNsANqs\"\>"}
                 },
                 AutoDelete->False,
                 GridBoxAlignment->{"Columns" -> {{Left}}},
                 
                 GridBoxItemSize->{
                  "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                "Grid"],
               StripOnInput->False,
               LineColor->RGBColor[
                 Rational[2, 3], 0, 0],
               FrontFaceColor->RGBColor[
                 Rational[2, 3], 0, 0],
               BackFaceColor->RGBColor[
                 Rational[2, 3], 0, 0],
               GraphicsColor->RGBColor[
                 Rational[2, 3], 0, 0],
               FontWeight->Bold,
               FontColor->RGBColor[
                 Rational[2, 3], 0, 0]],
              StripOnInput->False,
              LineColor->RGBColor[0, 0, 1],
              FrontFaceColor->RGBColor[0, 0, 1],
              BackFaceColor->RGBColor[0, 0, 1],
              GraphicsColor->RGBColor[0, 0, 1],
              FontWeight->Bold,
              FontColor->RGBColor[0, 0, 1]]}
           },
           AutoDelete->False,
           FrameStyle->RGBColor[0, 0, 1],
           GridBoxAlignment->{"Columns" -> {{Left}}},
           GridBoxBackground->{"Columns" -> {
               RGBColor[1, 0.9, 0.8], {
                RGBColor[1, 1, 0.85]}}},
           GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
           
           GridBoxItemSize->{
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
          "Grid"]}
       },
       AutoDelete->False,
       FrameStyle->RGBColor[0, 
         Rational[2, 3], 0],
       GridBoxAlignment->{"Columns" -> {{Left}}},
       GridBoxBackground->{"Columns" -> {{
            RGBColor[0.88, 1, 0.88]}}},
       GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"]},
    {
     TagBox[GridBox[{
        {
         TagBox[GridBox[{
            {
             StyleBox[
              TagBox[GridBox[{
                 {
                  StyleBox[
                   StyleBox[
                    TagBox[GridBox[{
                    {"var"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                   StripOnInput->False,
                   
                   LineColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   
                   FrontFaceColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   
                   BackFaceColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   
                   GraphicsColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   FontWeight->Bold,
                   
                   FontColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`]], 
                  StyleBox[
                   TagBox[GridBox[{
                    {"x"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   FontWeight->Bold]}
                },
                AutoDelete->False,
                FrameStyle->GrayLevel[0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"],
              StripOnInput->False,
              LineColor->GrayLevel[0],
              FrontFaceColor->GrayLevel[0],
              BackFaceColor->GrayLevel[0],
              GraphicsColor->GrayLevel[0],
              FontWeight->Bold,
              FontColor->GrayLevel[0]], 
             StyleBox[
              StyleBox[
               TagBox[GridBox[{
                  {"\<\"NCrp\"\>"}
                 },
                 AutoDelete->False,
                 GridBoxAlignment->{"Columns" -> {{Left}}},
                 
                 GridBoxItemSize->{
                  "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                "Grid"],
               StripOnInput->False,
               LineColor->RGBColor[
                 Rational[2, 3], 0, 0],
               FrontFaceColor->RGBColor[
                 Rational[2, 3], 0, 0],
               BackFaceColor->RGBColor[
                 Rational[2, 3], 0, 0],
               GraphicsColor->RGBColor[
                 Rational[2, 3], 0, 0],
               FontWeight->Bold,
               FontColor->RGBColor[
                 Rational[2, 3], 0, 0]],
              StripOnInput->False,
              LineColor->RGBColor[0, 0, 1],
              FrontFaceColor->RGBColor[0, 0, 1],
              BackFaceColor->RGBColor[0, 0, 1],
              GraphicsColor->RGBColor[0, 0, 1],
              FontWeight->Bold,
              FontColor->RGBColor[0, 0, 1]]},
            {
             StyleBox[
              TagBox[GridBox[{
                 {
                  StyleBox[
                   StyleBox[
                    TagBox[GridBox[{
                    {"var"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                   StripOnInput->False,
                   
                   LineColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   
                   FrontFaceColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   
                   BackFaceColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   
                   GraphicsColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   FontWeight->Bold,
                   
                   FontColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`]], 
                  StyleBox[
                   TagBox[GridBox[{
                    {"y"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   FontWeight->Bold]}
                },
                AutoDelete->False,
                FrameStyle->GrayLevel[0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"],
              StripOnInput->False,
              LineColor->GrayLevel[0],
              FrontFaceColor->GrayLevel[0],
              BackFaceColor->GrayLevel[0],
              GraphicsColor->GrayLevel[0],
              FontWeight->Bold,
              FontColor->GrayLevel[0]], 
             StyleBox[
              StyleBox[
               TagBox[GridBox[{
                  {"\<\"KNpAsr\"\>"}
                 },
                 AutoDelete->False,
                 GridBoxAlignment->{"Columns" -> {{Left}}},
                 
                 GridBoxItemSize->{
                  "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                "Grid"],
               StripOnInput->False,
               LineColor->RGBColor[
                 Rational[2, 3], 0, 0],
               FrontFaceColor->RGBColor[
                 Rational[2, 3], 0, 0],
               BackFaceColor->RGBColor[
                 Rational[2, 3], 0, 0],
               GraphicsColor->RGBColor[
                 Rational[2, 3], 0, 0],
               FontWeight->Bold,
               FontColor->RGBColor[
                 Rational[2, 3], 0, 0]],
              StripOnInput->False,
              LineColor->RGBColor[0, 0, 1],
              FrontFaceColor->RGBColor[0, 0, 1],
              BackFaceColor->RGBColor[0, 0, 1],
              GraphicsColor->RGBColor[0, 0, 1],
              FontWeight->Bold,
              FontColor->RGBColor[0, 0, 1]]}
           },
           AutoDelete->False,
           FrameStyle->RGBColor[0, 0, 1],
           GridBoxAlignment->{"Columns" -> {{Left}}},
           GridBoxBackground->{"Columns" -> {
               RGBColor[1, 0.9, 0.8], {
                RGBColor[1, 1, 0.85]}}},
           GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
           
           GridBoxItemSize->{
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
          "Grid"]}
       },
       AutoDelete->False,
       FrameStyle->RGBColor[0, 
         Rational[2, 3], 0],
       GridBoxAlignment->{"Columns" -> {{Left}}},
       GridBoxBackground->{"Columns" -> {{
            RGBColor[0.88, 1, 0.88]}}},
       GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"]},
    {
     TagBox[GridBox[{
        {
         TagBox[GridBox[{
            {
             StyleBox[
              TagBox[GridBox[{
                 {
                  StyleBox[
                   StyleBox[
                    TagBox[GridBox[{
                    {"var"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                   StripOnInput->False,
                   
                   LineColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   
                   FrontFaceColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   
                   BackFaceColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   
                   GraphicsColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   FontWeight->Bold,
                   
                   FontColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`]], 
                  StyleBox[
                   TagBox[GridBox[{
                    {"x"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   FontWeight->Bold]}
                },
                AutoDelete->False,
                FrameStyle->GrayLevel[0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"],
              StripOnInput->False,
              LineColor->GrayLevel[0],
              FrontFaceColor->GrayLevel[0],
              BackFaceColor->GrayLevel[0],
              GraphicsColor->GrayLevel[0],
              FontWeight->Bold,
              FontColor->GrayLevel[0]], 
             StyleBox[
              StyleBox[
               TagBox[GridBox[{
                  {"\<\"Ns\"\>"}
                 },
                 AutoDelete->False,
                 GridBoxAlignment->{"Columns" -> {{Left}}},
                 
                 GridBoxItemSize->{
                  "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                "Grid"],
               StripOnInput->False,
               LineColor->RGBColor[
                 Rational[2, 3], 0, 0],
               FrontFaceColor->RGBColor[
                 Rational[2, 3], 0, 0],
               BackFaceColor->RGBColor[
                 Rational[2, 3], 0, 0],
               GraphicsColor->RGBColor[
                 Rational[2, 3], 0, 0],
               FontWeight->Bold,
               FontColor->RGBColor[
                 Rational[2, 3], 0, 0]],
              StripOnInput->False,
              LineColor->RGBColor[0, 0, 1],
              FrontFaceColor->RGBColor[0, 0, 1],
              BackFaceColor->RGBColor[0, 0, 1],
              GraphicsColor->RGBColor[0, 0, 1],
              FontWeight->Bold,
              FontColor->RGBColor[0, 0, 1]]},
            {
             StyleBox[
              TagBox[GridBox[{
                 {
                  StyleBox[
                   StyleBox[
                    TagBox[GridBox[{
                    {"var"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                   StripOnInput->False,
                   
                   LineColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   
                   FrontFaceColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   
                   BackFaceColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   
                   GraphicsColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   FontWeight->Bold,
                   
                   FontColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`]], 
                  StyleBox[
                   TagBox[GridBox[{
                    {"y"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   FontWeight->Bold]}
                },
                AutoDelete->False,
                FrameStyle->GrayLevel[0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"],
              StripOnInput->False,
              LineColor->GrayLevel[0],
              FrontFaceColor->GrayLevel[0],
              BackFaceColor->GrayLevel[0],
              GraphicsColor->GrayLevel[0],
              FontWeight->Bold,
              FontColor->GrayLevel[0]], 
             StyleBox[
              StyleBox[
               TagBox[GridBox[{
                  {"\<\"AKrpNs\"\>"}
                 },
                 AutoDelete->False,
                 GridBoxAlignment->{"Columns" -> {{Left}}},
                 
                 GridBoxItemSize->{
                  "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                "Grid"],
               StripOnInput->False,
               LineColor->RGBColor[
                 Rational[2, 3], 0, 0],
               FrontFaceColor->RGBColor[
                 Rational[2, 3], 0, 0],
               BackFaceColor->RGBColor[
                 Rational[2, 3], 0, 0],
               GraphicsColor->RGBColor[
                 Rational[2, 3], 0, 0],
               FontWeight->Bold,
               FontColor->RGBColor[
                 Rational[2, 3], 0, 0]],
              StripOnInput->False,
              LineColor->RGBColor[0, 0, 1],
              FrontFaceColor->RGBColor[0, 0, 1],
              BackFaceColor->RGBColor[0, 0, 1],
              GraphicsColor->RGBColor[0, 0, 1],
              FontWeight->Bold,
              FontColor->RGBColor[0, 0, 1]]}
           },
           AutoDelete->False,
           FrameStyle->RGBColor[0, 0, 1],
           GridBoxAlignment->{"Columns" -> {{Left}}},
           GridBoxBackground->{"Columns" -> {
               RGBColor[1, 0.9, 0.8], {
                RGBColor[1, 1, 0.85]}}},
           GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
           
           GridBoxItemSize->{
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
          "Grid"]}
       },
       AutoDelete->False,
       FrameStyle->RGBColor[0, 
         Rational[2, 3], 0],
       GridBoxAlignment->{"Columns" -> {{Left}}},
       GridBoxBackground->{"Columns" -> {{
            RGBColor[0.88, 1, 0.88]}}},
       GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"]}
   },
   AutoDelete->False,
   FrameStyle->RGBColor[0, 
     Rational[2, 3], 0],
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxBackground->{"Columns" -> {{
        RGBColor[0.88, 1, 0.88]}}},
   GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{
  3.5496196832190943`*^9, {3.549619813325537*^9, 3.549619823983145*^9}, {
   3.549619876644158*^9, 3.549619902854657*^9}, 3.549633478389554*^9, 
   3.54963437009172*^9, 3.549634707564464*^9, 3.549634995881499*^9, 
   3.5496360772498393`*^9, 3.5496524502199774`*^9, 3.5499649128431463`*^9, 
   3.549965635311469*^9, 3.549970215700454*^9, 3.550067851141181*^9, 
   3.550146065835799*^9, 3.5501462915317087`*^9, 3.550148474085543*^9, 
   3.550152941650249*^9, 3.55015302332392*^9, 3.5501531567185507`*^9, 
   3.550221814795392*^9, 3.550224328433163*^9, 3.550364525489981*^9, 
   3.5504120049377427`*^9, 3.550710620785704*^9, 3.623889589410771*^9, 
   3.62389075906765*^9, 3.62440998276149*^9, 3.629583255725997*^9, 
   3.62958413835722*^9, 3.6456539603636*^9, 3.645656252599119*^9, 
   3.6457496163287373`*^9, 3.687638700307934*^9, 3.687638748949192*^9, 
   3.841155724651327*^9, 3.841163858107297*^9, 3.841164031400511*^9, 
   3.841164606835092*^9, 3.841166570676539*^9, 3.841166680295678*^9, 
   3.8411668629574356`*^9, 3.8411668970029*^9, 3.841220350644753*^9, 
   3.8412300873548*^9, 3.841230196180963*^9, 3.841248973599062*^9, 
   3.841249029171968*^9, 3.841249076342052*^9, 3.841318271566*^9, 
   3.841322151897359*^9, 3.841322404546452*^9, 3.841324758732335*^9, 
   3.84132498828168*^9, 3.841332924974142*^9, 3.841350165264238*^9, 
   3.841352239098947*^9, 3.841392982917884*^9, 3.841403443850339*^9, {
   3.841405457357828*^9, 3.841405479157715*^9}, 3.841422367428705*^9, 
   3.911255353925501*^9, 3.911290461701888*^9, 3.912269682627261*^9, 
   3.9125463533573728`*^9, 3.9125890718916283`*^9, 3.912600351326565*^9, 
   3.912601706492103*^9, 3.9150508716505833`*^9, 3.915535457601885*^9},
 CellLabel->
  "Out[709]=",ExpressionUUID->"8b116e08-865b-4fe9-8e71-f67317911d31"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"select", "[", 
   RowBox[{"L_String", ",", "R_String"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"soln", "\[Function]", "\[IndentingNewLine]", 
   RowBox[{"Select", "[", 
    RowBox[{"soln", ",", "\[IndentingNewLine]", 
     RowBox[{"rules", "\[Function]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"$u", "@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"var", "[", "x", "]"}], "/.", "rules"}], ")"}]}], "===", 
        "L"}], "&&", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"$u", "@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"var", "[", "y", "]"}], "/.", "rules"}], ")"}]}], "===", 
        "R"}]}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.5496209193918*^9, 3.549620983951493*^9}, {
  3.549634358203532*^9, 3.549634358212532*^9}},
 CellLabel->
  "In[710]:=",ExpressionUUID->"96d7efbc-667e-491b-bb26-7b001722106d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"prettifySolutions", "@", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"select", "[", 
    RowBox[{"\"\<NCrp\>\"", ",", "\"\<KNpAsr\>\""}], "]"}], "@", 
   RowBox[{"Solutions", "[", 
    RowBox[{
     RowBox[{"Binary", "[", 
      RowBox[{"\"\<C\>\"", ",", 
       RowBox[{"var", "[", "x", "]"}], ",", 
       RowBox[{"var", "[", "y", "]"}]}], "]"}], ",", "KB"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.549590299585448*^9, 3.549590308295945*^9}, {
  3.54959034631212*^9, 3.549590360743945*^9}, {3.549590399424157*^9, 
  3.5495904166881447`*^9}, {3.549590465967965*^9, 3.54959046748005*^9}, {
  3.549590781554014*^9, 3.549590830236799*^9}, {3.549618840800911*^9, 
  3.549619014207829*^9}, {3.549619685608231*^9, 3.5496197201122046`*^9}, {
  3.549620988879774*^9, 3.54962101135806*^9}},
 CellLabel->
  "In[711]:=",ExpressionUUID->"a3321495-eb4c-45a5-8835-d8fad932d642"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[GridBox[{
        {
         TagBox[GridBox[{
            {
             StyleBox[
              TagBox[GridBox[{
                 {
                  StyleBox[
                   StyleBox[
                    TagBox[GridBox[{
                    {"var"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                   StripOnInput->False,
                   
                   LineColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   
                   FrontFaceColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   
                   BackFaceColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   
                   GraphicsColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   FontWeight->Bold,
                   
                   FontColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`]], 
                  StyleBox[
                   TagBox[GridBox[{
                    {"x"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   FontWeight->Bold]}
                },
                AutoDelete->False,
                FrameStyle->GrayLevel[0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"],
              StripOnInput->False,
              LineColor->GrayLevel[0],
              FrontFaceColor->GrayLevel[0],
              BackFaceColor->GrayLevel[0],
              GraphicsColor->GrayLevel[0],
              FontWeight->Bold,
              FontColor->GrayLevel[0]], 
             StyleBox[
              StyleBox[
               TagBox[GridBox[{
                  {"\<\"NCrp\"\>"}
                 },
                 AutoDelete->False,
                 GridBoxAlignment->{"Columns" -> {{Left}}},
                 
                 GridBoxItemSize->{
                  "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                "Grid"],
               StripOnInput->False,
               LineColor->RGBColor[
                 Rational[2, 3], 0, 0],
               FrontFaceColor->RGBColor[
                 Rational[2, 3], 0, 0],
               BackFaceColor->RGBColor[
                 Rational[2, 3], 0, 0],
               GraphicsColor->RGBColor[
                 Rational[2, 3], 0, 0],
               FontWeight->Bold,
               FontColor->RGBColor[
                 Rational[2, 3], 0, 0]],
              StripOnInput->False,
              LineColor->RGBColor[0, 0, 1],
              FrontFaceColor->RGBColor[0, 0, 1],
              BackFaceColor->RGBColor[0, 0, 1],
              GraphicsColor->RGBColor[0, 0, 1],
              FontWeight->Bold,
              FontColor->RGBColor[0, 0, 1]]},
            {
             StyleBox[
              TagBox[GridBox[{
                 {
                  StyleBox[
                   StyleBox[
                    TagBox[GridBox[{
                    {"var"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                   StripOnInput->False,
                   
                   LineColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   
                   FrontFaceColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   
                   BackFaceColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   
                   GraphicsColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   FontWeight->Bold,
                   
                   FontColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`]], 
                  StyleBox[
                   TagBox[GridBox[{
                    {"y"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   FontWeight->Bold]}
                },
                AutoDelete->False,
                FrameStyle->GrayLevel[0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"],
              StripOnInput->False,
              LineColor->GrayLevel[0],
              FrontFaceColor->GrayLevel[0],
              BackFaceColor->GrayLevel[0],
              GraphicsColor->GrayLevel[0],
              FontWeight->Bold,
              FontColor->GrayLevel[0]], 
             StyleBox[
              StyleBox[
               TagBox[GridBox[{
                  {"\<\"KNpAsr\"\>"}
                 },
                 AutoDelete->False,
                 GridBoxAlignment->{"Columns" -> {{Left}}},
                 
                 GridBoxItemSize->{
                  "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                "Grid"],
               StripOnInput->False,
               LineColor->RGBColor[
                 Rational[2, 3], 0, 0],
               FrontFaceColor->RGBColor[
                 Rational[2, 3], 0, 0],
               BackFaceColor->RGBColor[
                 Rational[2, 3], 0, 0],
               GraphicsColor->RGBColor[
                 Rational[2, 3], 0, 0],
               FontWeight->Bold,
               FontColor->RGBColor[
                 Rational[2, 3], 0, 0]],
              StripOnInput->False,
              LineColor->RGBColor[0, 0, 1],
              FrontFaceColor->RGBColor[0, 0, 1],
              BackFaceColor->RGBColor[0, 0, 1],
              GraphicsColor->RGBColor[0, 0, 1],
              FontWeight->Bold,
              FontColor->RGBColor[0, 0, 1]]}
           },
           AutoDelete->False,
           FrameStyle->RGBColor[0, 0, 1],
           GridBoxAlignment->{"Columns" -> {{Left}}},
           GridBoxBackground->{"Columns" -> {
               RGBColor[1, 0.9, 0.8], {
                RGBColor[1, 1, 0.85]}}},
           GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
           
           GridBoxItemSize->{
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
          "Grid"]}
       },
       AutoDelete->False,
       FrameStyle->RGBColor[0, 
         Rational[2, 3], 0],
       GridBoxAlignment->{"Columns" -> {{Left}}},
       GridBoxBackground->{"Columns" -> {{
            RGBColor[0.88, 1, 0.88]}}},
       GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"]}
   },
   AutoDelete->False,
   FrameStyle->RGBColor[0, 
     Rational[2, 3], 0],
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxBackground->{"Columns" -> {{
        RGBColor[0.88, 1, 0.88]}}},
   GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{
  3.549590468612115*^9, {3.549590783274113*^9, 3.549590791651593*^9}, {
   3.54959082449247*^9, 3.549590830771829*^9}, 3.54959102642502*^9, {
   3.54961889637809*^9, 3.549618915652192*^9}, 3.549619014906869*^9, 
   3.549619362777766*^9, {3.549619691855589*^9, 3.549619721182266*^9}, 
   3.549619904084727*^9, 3.549621012336116*^9, 3.549633478434559*^9, 
   3.5496343701797285`*^9, 3.549634707651472*^9, 3.5496349959284987`*^9, 
   3.549636077346839*^9, 3.549652450274983*^9, 3.5499649129081497`*^9, 
   3.549965639041682*^9, 3.549970215763457*^9, 3.5500678512491865`*^9, 
   3.5501460705850706`*^9, 3.550146291597712*^9, 3.550148474147547*^9, 
   3.550152941717253*^9, 3.5501530233679233`*^9, 3.550153156751553*^9, 
   3.550221814866396*^9, 3.5502243285041676`*^9, 3.550364525582987*^9, 
   3.550412005011747*^9, 3.5507106208777094`*^9, 3.623889612369429*^9, 
   3.623890759287945*^9, 3.624409982999831*^9, 3.629583255804982*^9, 
   3.629584138569402*^9, 3.645653960552623*^9, 3.645656252720332*^9, 
   3.645749616419733*^9, 3.687638700394322*^9, 3.687638749019627*^9, 
   3.84115572912545*^9, 3.841163858146003*^9, 3.8411640314378233`*^9, 
   3.841164606879551*^9, 3.841166570713299*^9, 3.841166680332964*^9, 
   3.8411668630061207`*^9, 3.841166897037796*^9, 3.841220350696091*^9, 
   3.841230087410098*^9, 3.8412301962343073`*^9, 3.841248973666*^9, 
   3.841249029236257*^9, 3.841249076403649*^9, 3.841318271605097*^9, 
   3.841322151957225*^9, 3.841322404597035*^9, 3.841324758772872*^9, 
   3.841324988320959*^9, 3.841332925020794*^9, 3.841350165311741*^9, 
   3.841352239151743*^9, 3.841392982962558*^9, 3.841403443922298*^9, {
   3.841405457413999*^9, 3.841405479213163*^9}, 3.841422367498199*^9, 
   3.911255353941936*^9, 3.911290461712981*^9, 3.912269703146575*^9, 
   3.9125463533756*^9, 3.9125890719075813`*^9, 3.912600351336279*^9, 
   3.912601706506048*^9, 3.91505087166188*^9, 3.9155354576128607`*^9},
 CellLabel->
  "Out[711]=",ExpressionUUID->"357681e3-eb8a-4a61-8276-a6bc98ae757f"]
}, Open  ]],

Cell["\<\
We can also do it much faster and shorter by the direct but \
\[OpenCurlyDoubleQuote]out-of-the-box\[CloseCurlyDoubleQuote] \
pseudo-inference rule CoR:\
\>", "Text",
 CellChangeTimes->{{3.549618777564294*^9, 3.549618832300424*^9}, {
  3.549619033500933*^9, 3.549619048876813*^9}, {3.623889627071212*^9, 
  3.6238896362869477`*^9}},ExpressionUUID->"84633997-60f3-4703-b5e9-\
38245a7a5856"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"And", "[", 
    RowBox[{
     RowBox[{"$p", "@", "\"\<NCrp\>\""}], ",", 
     RowBox[{"$p", "@", "\"\<KNpAsr\>\""}]}], "]"}], "/.", "CoR"}], "//", 
  "$u"}]], "Input",
 CellChangeTimes->{{3.549504768651357*^9, 3.549504803130329*^9}, {
   3.5496343470014133`*^9, 3.549634358221533*^9}, 3.549634979904498*^9, 
   3.549635299529498*^9},
 CellLabel->
  "In[712]:=",ExpressionUUID->"3ca0ed18-82ae-4187-9540-471ca8cd2ca5"],

Cell[BoxData["\<\"CNCrpKNpAsr\"\>"], "Output",
 CellChangeTimes->{
  3.549504803939376*^9, 3.549589119760965*^9, 3.549589322420556*^9, 
   3.549618772602011*^9, 3.549619365497922*^9, 3.5496199262579956`*^9, 
   3.549621034315373*^9, 3.549633478459561*^9, 3.549634370211732*^9, 
   3.5496347076824775`*^9, 3.549634995958498*^9, 3.549636077377839*^9, 
   3.5496524503069863`*^9, 3.549964912951153*^9, 3.549965641356815*^9, 
   3.549970215804458*^9, 3.550067851291189*^9, 3.550146072212164*^9, 
   3.5501462916417146`*^9, 3.550148474187549*^9, 3.550152941748255*^9, 
   3.550153023390924*^9, 3.550153156766553*^9, 3.550221814909398*^9, 
   3.550224328545171*^9, 3.550364525620989*^9, 3.55041200506375*^9, 
   3.550710620932713*^9, 3.623889641305168*^9, 3.623890759423791*^9, 
   3.62440998312167*^9, 3.629583255863795*^9, 3.6295841386237698`*^9, 
   3.645653960631884*^9, 3.645656252800624*^9, 3.645749616477683*^9, 
   3.6876387004289737`*^9, 3.687638749081897*^9, 3.841155732425879*^9, 
   3.841163858162801*^9, 3.841164031456076*^9, 3.841164606906225*^9, 
   3.841166570731297*^9, 3.841166680352346*^9, 3.8411668630272303`*^9, 
   3.84116689705366*^9, 3.841220350722771*^9, 3.841230087434889*^9, 
   3.841230196258788*^9, 3.841248973687826*^9, 3.841249029260064*^9, 
   3.841249076426243*^9, 3.841318271624418*^9, 3.841322151990868*^9, 
   3.8413224046255283`*^9, 3.841324758796323*^9, 3.841324988343732*^9, 
   3.841332925044898*^9, 3.8413501653415422`*^9, 3.841352239187785*^9, 
   3.841392982991304*^9, 3.841403443948924*^9, {3.841405457437096*^9, 
   3.841405479237912*^9}, 3.841422367530589*^9, 3.911255353946305*^9, 
   3.9112904617163687`*^9, 3.912269719086083*^9, 3.912546353378942*^9, 
   3.912589071911218*^9, 3.9126003513395357`*^9, 3.912601706509663*^9, 
   3.91505087166558*^9, 3.9155354576236143`*^9},
 CellLabel->
  "Out[712]=",ExpressionUUID->"8494a3c1-f9cf-4dae-990d-1ad93ca37739"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Page 91 of WFF-n-Proof", "Subsubsection",
 CellChangeTimes->{{3.5496190818036957`*^9, 3.54961908781204*^9}, 
   3.912601519183931*^9, 
   3.912601668837387*^9},ExpressionUUID->"5b9c6ac3-0dbf-432f-8387-\
75dfc55219a5"],

Cell["\<\
The first one is a proper application of the true inference rule Co:\
\>", "Text",
 CellChangeTimes->{{3.549620767300101*^9, 
  3.549620780507856*^9}},ExpressionUUID->"7b02f625-1cff-4fe3-b4df-\
02dc22353d95"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"And", "[", 
    RowBox[{
     RowBox[{"$p", "@", "\"\<CKNprs\>\""}], ",", 
     RowBox[{"$p", "@", "\"\<KNpr\>\""}]}], "]"}], "/.", "Co"}], "//", 
  "$u"}]], "Input",
 CellChangeTimes->{{3.549619208352934*^9, 3.549619265438199*^9}, {
   3.549634347015414*^9, 3.549634358231534*^9}, 3.549634981299498*^9, 
   3.549635299537498*^9},
 CellLabel->
  "In[713]:=",ExpressionUUID->"ad16d26e-0764-421f-a1e6-10b6d6e5a611"],

Cell[BoxData["\<\"s\"\>"], "Output",
 CellChangeTimes->{
  3.549619266048234*^9, 3.549619927784083*^9, 3.549633478486564*^9, 
   3.549634370241735*^9, 3.549634707713479*^9, 3.549634995991498*^9, 
   3.549636077412839*^9, 3.54965245034299*^9, 3.549964912992155*^9, 
   3.549965643862958*^9, 3.5499702158444605`*^9, 3.550067851335192*^9, 
   3.550146074309284*^9, 3.5501462916897173`*^9, 3.550148474226551*^9, 
   3.550152941777257*^9, 3.550153023415926*^9, 3.5501531567895546`*^9, 
   3.550221814956401*^9, 3.550224328598173*^9, 3.550364525658991*^9, 
   3.550412005107753*^9, 3.550710621000716*^9, 3.623889657491452*^9, 
   3.62389075944634*^9, 3.624409983334169*^9, 3.629583256210643*^9, 
   3.6295841386735697`*^9, 3.645653960694938*^9, 3.645656252884464*^9, 
   3.64574961654528*^9, 3.687638700487838*^9, 3.687638749148224*^9, 
   3.841155735802177*^9, 3.841163858185515*^9, 3.841164031478125*^9, 
   3.841164606962198*^9, 3.841166570751751*^9, 3.84116668037614*^9, 
   3.841166863051395*^9, 3.841166897072412*^9, 3.8412203507558947`*^9, 
   3.841230087468492*^9, 3.8412301962902527`*^9, 3.841248973715693*^9, 
   3.841249029295083*^9, 3.841249076454795*^9, 3.8413182716437063`*^9, 
   3.841322152025036*^9, 3.841322404650823*^9, 3.841324758819227*^9, 
   3.841324988364405*^9, 3.84133292506925*^9, 3.84135016537126*^9, 
   3.841352239223578*^9, 3.84139298302027*^9, 3.841403443983841*^9, {
   3.841405457472875*^9, 3.841405479271968*^9}, 3.8414223675701303`*^9, 
   3.911255353957252*^9, 3.911290461725525*^9, 3.912269727452628*^9, 
   3.912546353390113*^9, 3.9125890719236393`*^9, 3.912600351348434*^9, 
   3.912601706516912*^9, 3.9150508716725483`*^9, 3.9155354576265373`*^9},
 CellLabel->
  "Out[713]=",ExpressionUUID->"d2e32b61-0942-4b64-8f91-bb83ad831e1e"]
}, Open  ]],

Cell["\<\
The second one requires a solution, that is, finding a CLR and L that would \
imply R\
\>", "Text",
 CellChangeTimes->{{3.549620789308359*^9, 3.549620857724273*^9}, {
  3.5496210442609415`*^9, 3.5496210632440276`*^9}, {3.623889677157141*^9, 
  3.6238896879969273`*^9}},ExpressionUUID->"23e0ec28-17f5-405e-a360-\
e561581c86cd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"prettifySolutions", "@", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"select", "[", 
    RowBox[{"\"\<Cps\>\"", ",", "\"\<CCsrCpr\>\""}], "]"}], "@", 
   "\[IndentingNewLine]", 
   RowBox[{"Solutions", "[", 
    RowBox[{
     RowBox[{"Binary", "[", 
      RowBox[{"\"\<C\>\"", ",", 
       RowBox[{"var", "[", "x", "]"}], ",", 
       RowBox[{"var", "[", "y", "]"}]}], "]"}], ",", "KB"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.5496199613220015`*^9, 3.549620021190426*^9}, {
  3.549620879750532*^9, 3.549620880837595*^9}, {3.549621073925638*^9, 
  3.5496211323909826`*^9}},
 CellLabel->
  "In[714]:=",ExpressionUUID->"30cc3c8b-28f5-43f5-a611-2a29c88110ba"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[GridBox[{
        {
         TagBox[GridBox[{
            {
             StyleBox[
              TagBox[GridBox[{
                 {
                  StyleBox[
                   StyleBox[
                    TagBox[GridBox[{
                    {"var"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                   StripOnInput->False,
                   
                   LineColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   
                   FrontFaceColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   
                   BackFaceColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   
                   GraphicsColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   FontWeight->Bold,
                   
                   FontColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`]], 
                  StyleBox[
                   TagBox[GridBox[{
                    {"x"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   FontWeight->Bold]}
                },
                AutoDelete->False,
                FrameStyle->GrayLevel[0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"],
              StripOnInput->False,
              LineColor->GrayLevel[0],
              FrontFaceColor->GrayLevel[0],
              BackFaceColor->GrayLevel[0],
              GraphicsColor->GrayLevel[0],
              FontWeight->Bold,
              FontColor->GrayLevel[0]], 
             StyleBox[
              StyleBox[
               TagBox[GridBox[{
                  {"\<\"Cps\"\>"}
                 },
                 AutoDelete->False,
                 GridBoxAlignment->{"Columns" -> {{Left}}},
                 
                 GridBoxItemSize->{
                  "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                "Grid"],
               StripOnInput->False,
               LineColor->RGBColor[
                 Rational[2, 3], 0, 0],
               FrontFaceColor->RGBColor[
                 Rational[2, 3], 0, 0],
               BackFaceColor->RGBColor[
                 Rational[2, 3], 0, 0],
               GraphicsColor->RGBColor[
                 Rational[2, 3], 0, 0],
               FontWeight->Bold,
               FontColor->RGBColor[
                 Rational[2, 3], 0, 0]],
              StripOnInput->False,
              LineColor->RGBColor[0, 0, 1],
              FrontFaceColor->RGBColor[0, 0, 1],
              BackFaceColor->RGBColor[0, 0, 1],
              GraphicsColor->RGBColor[0, 0, 1],
              FontWeight->Bold,
              FontColor->RGBColor[0, 0, 1]]},
            {
             StyleBox[
              TagBox[GridBox[{
                 {
                  StyleBox[
                   StyleBox[
                    TagBox[GridBox[{
                    {"var"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                   StripOnInput->False,
                   
                   LineColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   
                   FrontFaceColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   
                   BackFaceColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   
                   GraphicsColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   FontWeight->Bold,
                   
                   FontColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`]], 
                  StyleBox[
                   TagBox[GridBox[{
                    {"y"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   FontWeight->Bold]}
                },
                AutoDelete->False,
                FrameStyle->GrayLevel[0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"],
              StripOnInput->False,
              LineColor->GrayLevel[0],
              FrontFaceColor->GrayLevel[0],
              BackFaceColor->GrayLevel[0],
              GraphicsColor->GrayLevel[0],
              FontWeight->Bold,
              FontColor->GrayLevel[0]], 
             StyleBox[
              StyleBox[
               TagBox[GridBox[{
                  {"\<\"CCsrCpr\"\>"}
                 },
                 AutoDelete->False,
                 GridBoxAlignment->{"Columns" -> {{Left}}},
                 
                 GridBoxItemSize->{
                  "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                "Grid"],
               StripOnInput->False,
               LineColor->RGBColor[
                 Rational[2, 3], 0, 0],
               FrontFaceColor->RGBColor[
                 Rational[2, 3], 0, 0],
               BackFaceColor->RGBColor[
                 Rational[2, 3], 0, 0],
               GraphicsColor->RGBColor[
                 Rational[2, 3], 0, 0],
               FontWeight->Bold,
               FontColor->RGBColor[
                 Rational[2, 3], 0, 0]],
              StripOnInput->False,
              LineColor->RGBColor[0, 0, 1],
              FrontFaceColor->RGBColor[0, 0, 1],
              BackFaceColor->RGBColor[0, 0, 1],
              GraphicsColor->RGBColor[0, 0, 1],
              FontWeight->Bold,
              FontColor->RGBColor[0, 0, 1]]}
           },
           AutoDelete->False,
           FrameStyle->RGBColor[0, 0, 1],
           GridBoxAlignment->{"Columns" -> {{Left}}},
           GridBoxBackground->{"Columns" -> {
               RGBColor[1, 0.9, 0.8], {
                RGBColor[1, 1, 0.85]}}},
           GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
           
           GridBoxItemSize->{
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
          "Grid"]}
       },
       AutoDelete->False,
       FrameStyle->RGBColor[0, 
         Rational[2, 3], 0],
       GridBoxAlignment->{"Columns" -> {{Left}}},
       GridBoxBackground->{"Columns" -> {{
            RGBColor[0.88, 1, 0.88]}}},
       GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"]}
   },
   AutoDelete->False,
   FrameStyle->RGBColor[0, 
     Rational[2, 3], 0],
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxBackground->{"Columns" -> {{
        RGBColor[0.88, 1, 0.88]}}},
   GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{{3.5496200131599665`*^9, 3.549620021871465*^9}, 
   3.5496208813106213`*^9, 3.549621069627393*^9, {3.549621103618337*^9, 
   3.549621133125024*^9}, 3.5496334785195665`*^9, 3.549634370282739*^9, 
   3.549634707758483*^9, 3.549634996030498*^9, 3.5496360774518394`*^9, 
   3.549652450383994*^9, 3.549964913056158*^9, 3.549965645734065*^9, 
   3.5499702159204645`*^9, 3.5500678513871946`*^9, 3.55014607703144*^9, 
   3.5501462917397203`*^9, 3.5501484742755537`*^9, 3.5501529418092585`*^9, 
   3.5501530234429274`*^9, 3.550153156819556*^9, 3.5502218150134044`*^9, 
   3.550224328661178*^9, 3.550364525710994*^9, 3.550412005162755*^9, 
   3.550710621080721*^9, 3.623889692991663*^9, 3.623890759499704*^9, 
   3.624409983601408*^9, 3.629583256392281*^9, 3.629584138723393*^9, 
   3.6456539607617683`*^9, 3.645656253035593*^9, 3.645749616611884*^9, 
   3.687638700558595*^9, 3.6876387492152*^9, 3.841155737980667*^9, 
   3.841163858208699*^9, 3.84116403150202*^9, 3.841164606988896*^9, 
   3.841166570774404*^9, 3.841166680404189*^9, 3.8411668630864162`*^9, 
   3.84116689709389*^9, 3.841220350791156*^9, 3.841230087503078*^9, 
   3.841230196322653*^9, 3.841248973743108*^9, 3.84124902932975*^9, 
   3.841249076483406*^9, 3.841318271663468*^9, 3.841322152065342*^9, 
   3.841322404679777*^9, 3.841324758841539*^9, 3.841324988386744*^9, 
   3.84133292509574*^9, 3.841350165401829*^9, 3.841352239259143*^9, 
   3.841392983050316*^9, 3.841403444020969*^9, {3.841405457504401*^9, 
   3.841405479340723*^9}, 3.841422367631053*^9, 3.911255353970044*^9, 
   3.9112904617344427`*^9, 3.9122697320704*^9, 3.912546353403109*^9, 
   3.912589071937867*^9, 3.912600351356119*^9, 3.912601706525238*^9, 
   3.9150508716839523`*^9, 3.915535457635305*^9},
 CellLabel->
  "Out[714]=",ExpressionUUID->"6581a3fc-be7f-46fc-b35d-80e12bc06f54"]
}, Open  ]],

Cell["Or writing it all out", "Text",
 CellChangeTimes->{{3.549621769516424*^9, 3.549621788084486*^9}, {
  3.623889726163084*^9, 
  3.62388972901102*^9}},ExpressionUUID->"09703189-fd9a-4fe4-b9ca-\
b6170ba4667c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Binary", "[", 
     RowBox[{"\"\<C\>\"", ",", 
      RowBox[{"var", "[", "x", "]"}], ",", 
      RowBox[{"var", "[", "y", "]"}]}], "]"}], "/.", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"select", "[", 
        RowBox[{"\"\<Cps\>\"", ",", "\"\<CCsrCpr\>\""}], "]"}], "@", 
       "\[IndentingNewLine]", 
       RowBox[{"Solutions", "[", 
        RowBox[{
         RowBox[{"Binary", "[", 
          RowBox[{"\"\<C\>\"", ",", 
           RowBox[{"var", "[", "x", "]"}], ",", 
           RowBox[{"var", "[", "y", "]"}]}], "]"}], ",", "KB"}], "]"}]}], 
      ")"}], "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ")"}], 
  "//", "\[IndentingNewLine]", "$u"}]], "Input",
 CellChangeTimes->{{3.549621789653576*^9, 3.549621862022715*^9}, {
   3.549621897830763*^9, 3.549621902190013*^9}, {3.549621983482662*^9, 
   3.5496220000626106`*^9}, 3.549634358239535*^9, {3.549636502561965*^9, 
   3.549636513708079*^9}},
 CellLabel->
  "In[715]:=",ExpressionUUID->"6d52799b-af8d-4f66-96c4-9c53c6ff71f9"],

Cell[BoxData["\<\"CCpsCCsrCpr\"\>"], "Output",
 CellChangeTimes->{{3.549621813542942*^9, 3.549621863844819*^9}, 
   3.549621902703042*^9, {3.549621985362769*^9, 3.549622005670931*^9}, 
   3.549633478552571*^9, 3.549634370319743*^9, 3.549634707806488*^9, 
   3.549634996067498*^9, 3.549636077487839*^9, 3.549636514578166*^9, 
   3.549652450423998*^9, 3.549964913103161*^9, 3.549965647632174*^9, 
   3.549970215979469*^9, 3.550067851435198*^9, 3.55014607825451*^9, 
   3.5501462917877226`*^9, 3.5501484743225565`*^9, 3.5501529418412604`*^9, 
   3.550153023472929*^9, 3.550153156841558*^9, 3.5502218150684075`*^9, 
   3.55022432871418*^9, 3.550364525759997*^9, 3.550412005218758*^9, 
   3.550710621145725*^9, 3.623889730902649*^9, 3.623890759567732*^9, 
   3.6244099836708307`*^9, 3.629583256544807*^9, 3.629584138770197*^9, 
   3.64565396083196*^9, 3.645656253117339*^9, 3.6457496166793413`*^9, 
   3.687638700677164*^9, 3.687638749334735*^9, 3.84115574093369*^9, 
   3.841163858231936*^9, 3.841164031524525*^9, 3.841164607020187*^9, 
   3.841166570795765*^9, 3.841166680431796*^9, 3.841166863119997*^9, 
   3.841166897113339*^9, 3.841220350845321*^9, 3.84123008753587*^9, 
   3.841230196356863*^9, 3.841248973769541*^9, 3.841249029357216*^9, 
   3.84124907651265*^9, 3.841318271683331*^9, 3.841322152105307*^9, 
   3.841322404703893*^9, 3.841324758862535*^9, 3.841324988408468*^9, 
   3.841332925121966*^9, 3.8413501654334517`*^9, 3.841352239293759*^9, 
   3.841392983079488*^9, 3.841403444055154*^9, {3.841405457536594*^9, 
   3.84140547936538*^9}, 3.841422367655087*^9, 3.91125535397526*^9, 
   3.911290461743178*^9, 3.912269735038632*^9, 3.912546353413999*^9, 
   3.912589071950042*^9, 3.912600351364601*^9, 3.9126017065386953`*^9, 
   3.915050871691689*^9, 3.915535457643853*^9},
 CellLabel->
  "Out[715]=",ExpressionUUID->"4f7db43a-97e5-434e-9c33-7e03a2f51aa4"]
}, Open  ]],

Cell["We can do the same with the bogus pseudorule CoR", "Text",
 CellChangeTimes->{{3.549621417164271*^9, 3.5496214351162977`*^9}, {
  3.549621529116674*^9, 
  3.549621529851716*^9}},ExpressionUUID->"85fc9dac-a7cd-4cbe-91d4-\
20b4dcedf87d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"And", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"$p", "@", "\"\<Cps\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{"$p", "@", "\"\<CCsrCpr\>\""}]}], "]"}], "/.", "CoR"}], "//", 
  "$u"}]], "Input",
 CellChangeTimes->{{3.549621439983576*^9, 3.5496215247784257`*^9}, {
   3.5496217375825996`*^9, 3.549621739597713*^9}, {3.549634347031414*^9, 
   3.549634358249536*^9}, 3.549634982552498*^9, 3.549635299545498*^9},
 CellLabel->
  "In[716]:=",ExpressionUUID->"335d266a-d0a5-4653-bd8a-de454b453b62"],

Cell[BoxData["\<\"CCpsCCsrCpr\"\>"], "Output",
 CellChangeTimes->{{3.549621470408316*^9, 3.549621525353459*^9}, 
   3.549621742069855*^9, 3.549633478577573*^9, 3.549634370350746*^9, 
   3.549634707838492*^9, 3.5496349960984983`*^9, 3.5496360775198393`*^9, 
   3.5496365380795155`*^9, 3.549652450525008*^9, 3.5499649131421633`*^9, 
   3.549965649574284*^9, 3.549970216027471*^9, 3.5500678514762*^9, 
   3.5501460798626013`*^9, 3.5501462918277254`*^9, 3.550148474360559*^9, 
   3.550152941868262*^9, 3.5501530234959307`*^9, 3.550153156857559*^9, 
   3.55022181511441*^9, 3.550224328764183*^9, 3.550364525797999*^9, 
   3.550412005260761*^9, 3.5507106211887274`*^9, 3.623889759570019*^9, 
   3.623890759634218*^9, 3.624409983733563*^9, 3.629583256641654*^9, 
   3.6295841388576136`*^9, 3.645653960947741*^9, 3.645656253201724*^9, 
   3.645749616745098*^9, 3.6876387007397346`*^9, 3.687638749401643*^9, 
   3.841155750213393*^9, 3.841163858253831*^9, 3.841164031547762*^9, 
   3.841164607050365*^9, 3.8411665708162518`*^9, 3.841166680456435*^9, 
   3.841166863155229*^9, 3.841166897133594*^9, 3.841220350870846*^9, 
   3.8412300875654697`*^9, 3.841230196392829*^9, 3.841248973796415*^9, 
   3.841249029385676*^9, 3.841249076541088*^9, 3.841318271702766*^9, 
   3.841322152141834*^9, 3.8413224047264347`*^9, 3.841324758885751*^9, 
   3.841324988429241*^9, 3.841332925146586*^9, 3.841350165462617*^9, 
   3.841352239341527*^9, 3.841392983108292*^9, 3.84140344409013*^9, {
   3.841405457570717*^9, 3.84140547938024*^9}, 3.841422367681868*^9, 
   3.91125535399498*^9, 3.911290461746359*^9, 3.912269741271343*^9, 
   3.912546353417276*^9, 3.912589071956002*^9, 3.912600351368129*^9, 
   3.9126017065418587`*^9, 3.915050871696341*^9, 3.915535457646899*^9},
 CellLabel->
  "Out[716]=",ExpressionUUID->"2c636458-7c95-4f83-bc4d-a63d1afa224b"]
}, Open  ]],

Cell["The third one also requires a solution:", "Text",
 CellChangeTimes->{{3.5496211449407005`*^9, 
  3.54962115471626*^9}},ExpressionUUID->"18d56511-e934-45e3-8203-\
a4f202c2a660"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"prettifySolutions", "@", "\[IndentingNewLine]", 
  RowBox[{"Solutions", "[", 
   RowBox[{
    RowBox[{"Binary", "[", 
     RowBox[{"\"\<C\>\"", ",", 
      RowBox[{"var", "[", "x", "]"}], ",", 
      RowBox[{"$p", "@", "\"\<CKpNsANqs\>\""}]}], "]"}], ",", "KB"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.549621216454791*^9, 3.549621239438105*^9}, {
   3.5496213052988725`*^9, 3.549621309558116*^9}, 3.549634347050416*^9},
 CellLabel->
  "In[717]:=",ExpressionUUID->"cad6961e-7b19-4736-96a7-11476714f821"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[GridBox[{
        {
         TagBox[GridBox[{
            {
             StyleBox[
              TagBox[GridBox[{
                 {
                  StyleBox[
                   StyleBox[
                    TagBox[GridBox[{
                    {"var"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                   StripOnInput->False,
                   
                   LineColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   
                   FrontFaceColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   
                   BackFaceColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   
                   GraphicsColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                   FontWeight->Bold,
                   
                   FontColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`]], 
                  StyleBox[
                   TagBox[GridBox[{
                    {"x"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   FontWeight->Bold]}
                },
                AutoDelete->False,
                FrameStyle->GrayLevel[0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"],
              StripOnInput->False,
              LineColor->GrayLevel[0],
              FrontFaceColor->GrayLevel[0],
              BackFaceColor->GrayLevel[0],
              GraphicsColor->GrayLevel[0],
              FontWeight->Bold,
              FontColor->GrayLevel[0]], 
             StyleBox[
              StyleBox[
               TagBox[GridBox[{
                  {"\<\"s\"\>"}
                 },
                 AutoDelete->False,
                 GridBoxAlignment->{"Columns" -> {{Left}}},
                 
                 GridBoxItemSize->{
                  "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                "Grid"],
               StripOnInput->False,
               LineColor->RGBColor[
                 Rational[2, 3], 0, 0],
               FrontFaceColor->RGBColor[
                 Rational[2, 3], 0, 0],
               BackFaceColor->RGBColor[
                 Rational[2, 3], 0, 0],
               GraphicsColor->RGBColor[
                 Rational[2, 3], 0, 0],
               FontWeight->Bold,
               FontColor->RGBColor[
                 Rational[2, 3], 0, 0]],
              StripOnInput->False,
              LineColor->RGBColor[0, 0, 1],
              FrontFaceColor->RGBColor[0, 0, 1],
              BackFaceColor->RGBColor[0, 0, 1],
              GraphicsColor->RGBColor[0, 0, 1],
              FontWeight->Bold,
              FontColor->RGBColor[0, 0, 1]]}
           },
           AutoDelete->False,
           FrameStyle->RGBColor[0, 0, 1],
           GridBoxAlignment->{"Columns" -> {{Left}}},
           GridBoxBackground->{"Columns" -> {
               RGBColor[1, 0.9, 0.8], {
                RGBColor[1, 1, 0.85]}}},
           GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
           GridBoxItemSize->{
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
          "Grid"]}
       },
       AutoDelete->False,
       FrameStyle->RGBColor[0, 
         Rational[2, 3], 0],
       GridBoxAlignment->{"Columns" -> {{Left}}},
       GridBoxBackground->{"Columns" -> {{
            RGBColor[0.88, 1, 0.88]}}},
       GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"]}
   },
   AutoDelete->False,
   FrameStyle->RGBColor[0, 
     Rational[2, 3], 0],
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxBackground->{"Columns" -> {{
        RGBColor[0.88, 1, 0.88]}}},
   GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{{3.549621222985164*^9, 3.54962124003914*^9}, 
   3.549621310247155*^9, 3.549633478604575*^9, 3.549634370385749*^9, 
   3.5496347078714957`*^9, 3.549634996128498*^9, 3.54963607755284*^9, 
   3.549636539872695*^9, 3.5496524505660124`*^9, 3.549964913182165*^9, 
   3.549965651207379*^9, 3.5499702160764756`*^9, 3.5500678515242023`*^9, 
   3.550146083939834*^9, 3.550146291867728*^9, 3.550148474401561*^9, 
   3.5501529419012637`*^9, 3.5501530235249324`*^9, 3.55015315688056*^9, 
   3.550221815158413*^9, 3.5502243288111854`*^9, 3.550364525837001*^9, 
   3.550412005305764*^9, 3.550710621246731*^9, 3.623889763815213*^9, 
   3.623890759700827*^9, 3.624409983853881*^9, 3.629583256689357*^9, 
   3.629584138906759*^9, 3.6456539611831503`*^9, 3.645656253284213*^9, 
   3.645749616811013*^9, 3.68763870081024*^9, 3.687638749467762*^9, 
   3.841155755768589*^9, 3.841163858276607*^9, 3.8411640315714912`*^9, 
   3.8411646070832663`*^9, 3.841166570839032*^9, 3.841166680498705*^9, 
   3.841166863186227*^9, 3.841166897154078*^9, 3.841220350904914*^9, 
   3.841230087595718*^9, 3.841230196426979*^9, 3.841248973823803*^9, 
   3.841249029413478*^9, 3.841249076571096*^9, 3.8413182717227697`*^9, 
   3.841322152180637*^9, 3.841322404750579*^9, 3.84132475890908*^9, 
   3.84132498846342*^9, 3.841332925174553*^9, 3.841350165494119*^9, 
   3.8413522393794737`*^9, 3.841392983137855*^9, 3.841403444127329*^9, {
   3.841405457604166*^9, 3.841405479414577*^9}, 3.8414223677081823`*^9, 
   3.911255353999177*^9, 3.9112904617504673`*^9, 3.912269744478005*^9, 
   3.912546353426798*^9, 3.912589071966626*^9, 3.912600351374929*^9, 
   3.912601706549243*^9, 3.915050871703785*^9, 3.915535457655734*^9},
 CellLabel->
  "Out[717]=",ExpressionUUID->"93f486f9-7425-4623-8057-0149c4c4bd5e"]
}, Open  ]],

Cell["or an application of the bogus pseudorule CoL", "Text",
 CellChangeTimes->{{3.549621536508097*^9, 
  3.5496215482117667`*^9}},ExpressionUUID->"22c0c9ec-03d3-4706-9a08-\
c58c8cc2d8be"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"And", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"$p", "@", "\"\<CsCKpNsANqs\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{"$p", "@", "\"\<CKpNsANqs\>\""}]}], "]"}], "/.", "CoL"}], "//", 
  "$u"}]], "Input",
 CellChangeTimes->{{3.549621593521358*^9, 3.549621607414152*^9}, {
   3.549621658524076*^9, 3.549621726213948*^9}, {3.549634347058417*^9, 
   3.549634358258537*^9}, 3.549634984747498*^9, 3.549635299552498*^9},
 CellLabel->
  "In[718]:=",ExpressionUUID->"3c39f1db-94a4-42c2-bfdb-295d5742fc7d"],

Cell[BoxData["\<\"s\"\>"], "Output",
 CellChangeTimes->{
  3.549621726732977*^9, 3.549633478631578*^9, 3.549634370416753*^9, 
   3.549634707904498*^9, 3.549634996165498*^9, 3.5496360775838394`*^9, 
   3.549636542974005*^9, 3.549652450600015*^9, 3.549964913223168*^9, 
   3.549965652975479*^9, 3.549970216199481*^9, 3.550067851568205*^9, 
   3.550146085192907*^9, 3.55014629191173*^9, 3.550148474439563*^9, 
   3.550152941930265*^9, 3.550153023550934*^9, 3.550153156896561*^9, 
   3.550221815201415*^9, 3.5502243288521876`*^9, 3.550364525875003*^9, 
   3.550412005348766*^9, 3.5507106213017335`*^9, 3.623889807465337*^9, 
   3.6238907597664843`*^9, 3.624409983970237*^9, 3.629583256755312*^9, 
   3.629584138952481*^9, 3.645653961378641*^9, 3.645656253367549*^9, 
   3.645749616879237*^9, 3.687638700872143*^9, 3.687638749535985*^9, 
   3.841155759499539*^9, 3.84116385829735*^9, 3.841164031593512*^9, 
   3.841164607114218*^9, 3.841166570860351*^9, 3.841166680519195*^9, 
   3.841166863216479*^9, 3.841166897178625*^9, 3.841220350936635*^9, 
   3.841230087625174*^9, 3.841230196457199*^9, 3.841248973848724*^9, 
   3.841249029440118*^9, 3.841249076597314*^9, 3.841318271741789*^9, 
   3.841322152217898*^9, 3.841322404771936*^9, 3.841324758932757*^9, 
   3.841324988484271*^9, 3.84133292520002*^9, 3.841350165523614*^9, 
   3.841352239416543*^9, 3.8413929831666937`*^9, 3.841403444161812*^9, {
   3.84140545763812*^9, 3.841405479439283*^9}, 3.841422367739043*^9, 
   3.91125535402127*^9, 3.91129046175926*^9, 3.912269747881442*^9, 
   3.912546353430529*^9, 3.91258907197053*^9, 3.912600351378216*^9, 
   3.912601706553334*^9, 3.91505087170712*^9, 3.915535457658695*^9},
 CellLabel->
  "Out[718]=",ExpressionUUID->"8a67ab63-6adf-40e5-aab2-0dcffc0ede72"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Proofs (page 92 ff)", "Subsection",
 CellChangeTimes->{{3.549633628477561*^9, 
  3.549633633525066*^9}},ExpressionUUID->"600d6d7e-8a2d-4247-aab7-\
0ae5a0a915e1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"inferStep", ",", "writeStep", ",", "writeProof"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"inferStep", "[", 
    RowBox[{"truths_", ",", 
     RowBox[{"premise_", "?", "AtomQ"}], ",", "rule_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
     "truths", "\[LeftDoubleBracket]", "premise", "\[RightDoubleBracket]"}], 
     ")"}], "/.", "rule"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"inferStep", "[", 
    RowBox[{"truths_", ",", "premises_", ",", "rule_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
      "truths", "\[LeftDoubleBracket]", "#", "\[RightDoubleBracket]"}], "&"}],
      "/@", "premises"}], "/.", "rule"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"writeStep", ",", "HoldAll"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"writeStep", "[", 
    RowBox[{"truths_", ",", 
     RowBox[{"{", 
      RowBox[{"piPair", ":", 
       RowBox[{"{", 
        RowBox[{"premise_", ",", "rule_"}], "}"}]}], "}"}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"$u", "/@", 
    RowBox[{"Append", "[", 
     RowBox[{"truths", ",", 
      RowBox[{"inferStep", "[", 
       RowBox[{"truths", ",", "premise", ",", "rule"}], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"writeStep", "[", 
    RowBox[{"truths_", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"piPair", ":", 
        RowBox[{"{", 
         RowBox[{"premise_", ",", "rule_"}], "}"}]}], ",", "morePairs__"}], 
      "}"}]}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"writeStep", "[", 
    RowBox[{
     RowBox[{"Append", "[", 
      RowBox[{"truths", ",", 
       RowBox[{"inferStep", "[", 
        RowBox[{"truths", ",", "premise", ",", "rule"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", "morePairs", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"writeProof", ",", "HoldAll"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"writeProof", "[", 
    RowBox[{"suppositions_List", ",", "pairs_List"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"writeStep", "[", 
    RowBox[{
     RowBox[{"$p", "/@", "suppositions"}], ",", "pairs"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.5501012002698803`*^9, 3.550101220814422*^9}, {
   3.550101256911189*^9, 3.55010137115913*^9}, {3.550101446943637*^9, 
   3.550101556607698*^9}, {3.550101588903288*^9, 3.550101753121354*^9}, {
   3.550102882458104*^9, 3.5501029042433505`*^9}, {3.550102953675909*^9, 
   3.550103077733405*^9}, {3.550103137293708*^9, 3.550103158773512*^9}, {
   3.55010331599836*^9, 3.550103446606768*^9}, {3.550103540781959*^9, 
   3.550103596885617*^9}, {3.5501036352384944`*^9, 3.550103686046177*^9}, {
   3.5501038372383485`*^9, 3.550103894790345*^9}, {3.550117101678849*^9, 
   3.5501171207661233`*^9}, {3.5501171536390033`*^9, 3.550117181405311*^9}, {
   3.550117346800617*^9, 3.550117405763959*^9}, {3.5501175104359455`*^9, 
   3.550117523588272*^9}, {3.550117594804183*^9, 3.550117679638975*^9}, {
   3.550117736381403*^9, 3.550117772937494*^9}, {3.5501180798175845`*^9, 
   3.550118099161087*^9}, {3.55011818449791*^9, 3.550118261098058*^9}, {
   3.550137883651805*^9, 3.550138399977337*^9}, {3.550138432009169*^9, 
   3.550138437808501*^9}, 3.5501385265935793`*^9, {3.550138607241192*^9, 
   3.550138676914177*^9}, {3.550138747237201*^9, 3.550138812991961*^9}, {
   3.550144119601481*^9, 3.5501441218326087`*^9}},
 CellLabel->
  "In[719]:=",ExpressionUUID->"4ffd2518-bd32-4add-88de-8fa5a272ea0d"],

Cell[CellGroupData[{

Cell["P1 \[LongDash] page 92", "Subsubsection",
 CellChangeTimes->{{3.549633743843097*^9, 3.549633744210134*^9}, {
   3.550069856400738*^9, 3.550069858675865*^9}, 
   3.911290356068561*^9},ExpressionUUID->"1f8f1751-2a45-4646-bbed-\
3b7d6ec54336"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"writeProof", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\"\<Cpr\>\"", ",", "\"\<Kpq\>\""}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "KoL"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "&&", "3"}], ",", "Co"}], "}"}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.5501031172496166`*^9, 3.550103118926657*^9}, {
  3.550103190623333*^9, 3.5501032664886484`*^9}, {3.550117071970004*^9, 
  3.550117080792508*^9}, {3.550117188088693*^9, 3.5501171894087677`*^9}, {
  3.550117435926684*^9, 3.5501174571929*^9}, {3.550117490432801*^9, 
  3.550117490600811*^9}, {3.5501175291531115`*^9, 3.55011755619259*^9}, {
  3.550117654952564*^9, 3.5501176573687015`*^9}, {3.550138597809653*^9, 
  3.5501386032659645`*^9}},
 CellLabel->
  "In[727]:=",ExpressionUUID->"d72a73b8-cb0b-4873-af42-79900fe42577"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"Cpr\"\>", ",", "\<\"Kpq\"\>", ",", "\<\"p\"\>", 
   ",", "\<\"r\"\>"}], "}"}]], "Output",
 CellChangeTimes->{
  3.550103268352755*^9, 3.550103372276348*^9, 3.550103418539772*^9, 
   3.5501034490589075`*^9, 3.550103553687697*^9, 3.550103603577386*^9, {
   3.550103640007767*^9, 3.550103687789203*^9}, 3.5501171904058247`*^9, {
   3.5501174199007673`*^9, 3.550117458015948*^9}, 3.550117491275849*^9, {
   3.5501175326522436`*^9, 3.550117557733679*^9}, {3.550117657889732*^9, 
   3.5501176835221972`*^9}, 3.550117775402635*^9, {3.5501180669668493`*^9, 
   3.550118082571742*^9}, 3.550118200884847*^9, 3.550118264338242*^9, 
   3.550137845688634*^9, 3.550138402978509*^9, {3.550138580541665*^9, 
   3.550138599434746*^9}, 3.5501386794063196`*^9, {3.550138794467901*^9, 
   3.550138818012247*^9}, 3.5501460898291717`*^9, 3.550146291962734*^9, 
   3.550148474500567*^9, 3.5501529419712677`*^9, 3.550153023586936*^9, 
   3.5501531569335628`*^9, 3.550221815261419*^9, 3.550224328907191*^9, 
   3.550364525932007*^9, 3.550412005406769*^9, 3.5507106213807383`*^9, 
   3.6238898197836447`*^9, 3.623889868007003*^9, 3.623890760034802*^9, 
   3.624409984270549*^9, 3.629583256833435*^9, 3.629584139031392*^9, 
   3.645653961628765*^9, 3.6456562534878693`*^9, 3.645749616967854*^9, 
   3.687638700960908*^9, 3.687638749628849*^9, 3.841155764741129*^9, 
   3.841163858374486*^9, 3.841164031626267*^9, 3.841164607153088*^9, 
   3.8411665708904657`*^9, 3.841166680553329*^9, 3.841166863255348*^9, 
   3.841166897212791*^9, 3.841220350993013*^9, 3.841230087717557*^9, 
   3.8412301965250463`*^9, 3.841248973896242*^9, 3.84124902948796*^9, 
   3.841249076644374*^9, 3.841318271769043*^9, 3.8413221522646503`*^9, 
   3.841322404804778*^9, 3.841324758964776*^9, 3.841324988532289*^9, 
   3.8413329252440863`*^9, 3.841350165560964*^9, 3.841352239463877*^9, 
   3.841392983210291*^9, 3.841403444212488*^9, {3.841405457690169*^9, 
   3.841405479486033*^9}, 3.841422367782155*^9, 3.911255354037214*^9, 
   3.911290461769045*^9, 3.9122697545817347`*^9, 3.91254635344363*^9, 
   3.912589071983334*^9, 3.91260035138664*^9, 3.912601706563037*^9, 
   3.915050871719246*^9, 3.915535457668971*^9},
 CellLabel->
  "Out[727]=",ExpressionUUID->"a005c420-a6c0-40d2-878d-f411b4b9555e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["P2 \[LongDash] page 93", "Subsubsection",
 CellChangeTimes->{{3.549633758538566*^9, 3.549633759051617*^9}, 
   3.550069916927473*^9, {3.550148517296015*^9, 3.5501485180810595`*^9}, 
   3.911290356771242*^9},ExpressionUUID->"bf32541e-c64a-49cd-bc59-\
394f4fd0bdb2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"writeProof", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\"\<p\>\"", ",", "\"\<KsCpr\>\""}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "KoL"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "KoR"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"4", "&&", "1"}], ",", "Co"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"3", "&&", "5"}], ",", "Ki"}], "}"}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.550103699208365*^9, 3.550103707702852*^9}, {
  3.550103776054882*^9, 3.5501037873563046`*^9}, {3.550103821959476*^9, 
  3.550103825407673*^9}, {3.5501182913287864`*^9, 3.550118302360418*^9}, {
  3.550118344832455*^9, 3.5501183854007745`*^9}},
 CellLabel->
  "In[728]:=",ExpressionUUID->"67fc4a1d-e251-4d4c-8e98-3b65661378c0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"p\"\>", ",", "\<\"KsCpr\"\>", ",", "\<\"s\"\>", 
   ",", "\<\"Cpr\"\>", ",", "\<\"r\"\>", ",", "\<\"Ksr\"\>"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.550118386088814*^9, 3.5501388230835376`*^9, 3.550146091270254*^9, 
   3.550146292006736*^9, 3.550148474540569*^9, 3.550152941999269*^9, 
   3.550153023614938*^9, 3.5501531569645643`*^9, 3.550221815308421*^9, 
   3.5502243289481936`*^9, 3.550364525970009*^9, 3.5504120054507723`*^9, 
   3.550710621433741*^9, 3.6238899033017397`*^9, 3.623890760200803*^9, 
   3.624409984387712*^9, 3.629583256859104*^9, 3.6295841390576057`*^9, 
   3.645653961700582*^9, 3.64565625356686*^9, 3.645749617001995*^9, 
   3.687638701019917*^9, 3.687638749682617*^9, 3.841155767221447*^9, 
   3.841163858388921*^9, 3.8411640316420116`*^9, 3.841164607176243*^9, 
   3.841166570906069*^9, 3.841166680572815*^9, 3.841166863278789*^9, 
   3.841166897233523*^9, 3.841220351016015*^9, 3.841230087742715*^9, 
   3.841230196551715*^9, 3.841248973912127*^9, 3.8412490295053177`*^9, 
   3.8412490766612*^9, 3.841318271788425*^9, 3.841322152300504*^9, 
   3.841322404825947*^9, 3.841324758985849*^9, 3.841324988559947*^9, 
   3.841332925266554*^9, 3.841350165588279*^9, 3.841352239503208*^9, 
   3.841392983238768*^9, 3.841403444238195*^9, {3.84140545771179*^9, 
   3.841405479511269*^9}, 3.841422367809865*^9, 3.9112553540402093`*^9, 
   3.911290461772333*^9, 3.912269757280579*^9, 3.912546353451826*^9, 
   3.912589071993266*^9, 3.912600351393772*^9, 3.912601706570448*^9, 
   3.915050871726512*^9, 3.915535457676579*^9},
 CellLabel->
  "Out[728]=",ExpressionUUID->"c3fcae0e-e3d2-4850-9e8f-c60bb4ef8e0f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["P3 \[LongDash] page 93", "Subsubsection",
 CellChangeTimes->{{3.54963427247896*^9, 3.5496342727119837`*^9}, {
   3.550069918676368*^9, 3.550069920380464*^9}, {3.550148521856275*^9, 
   3.550148522712324*^9}, 
   3.911290357388853*^9},ExpressionUUID->"300f2711-7dcf-47b9-900b-\
41a1f40d543b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"writeProof", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\"\<p\>\"", ",", "\"\<Crs\>\"", ",", "\"\<Cpr\>\""}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"3", "&&", "1"}], ",", "Co"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"2", "&&", "4"}], ",", "Co"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "&&", "5"}], ",", "Ki"}], "}"}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.5501184286350417`*^9, 3.55011849575688*^9}},
 CellLabel->
  "In[729]:=",ExpressionUUID->"088bdad2-0ef5-4779-bd82-3fce412fda2f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"p\"\>", ",", "\<\"Crs\"\>", ",", "\<\"Cpr\"\>", 
   ",", "\<\"r\"\>", ",", "\<\"s\"\>", ",", "\<\"Kps\"\>"}], "}"}]], "Output",
 CellChangeTimes->{
  3.5501184969699507`*^9, 3.55013883327412*^9, 3.5501460924463215`*^9, 
   3.550146292045738*^9, 3.550148474584572*^9, 3.550152942027271*^9, 
   3.550153023638939*^9, 3.550153156991566*^9, 3.550221815356425*^9, 
   3.5502243290061965`*^9, 3.550364526007011*^9, 3.550412005498774*^9, 
   3.550710621502745*^9, 3.623889906191921*^9, 3.623890760316577*^9, 
   3.624409984700429*^9, 3.629583256908975*^9, 3.629584139106412*^9, 
   3.645653961777708*^9, 3.645656253651699*^9, 3.645749617061569*^9, 
   3.687638701071732*^9, 3.687638749744595*^9, 3.841155769793108*^9, 
   3.84116385840844*^9, 3.841164031663886*^9, 3.8411646072055817`*^9, 
   3.841166570928496*^9, 3.841166680596115*^9, 3.841166863309449*^9, 
   3.8411668972566843`*^9, 3.841220351047783*^9, 3.841230087757716*^9, 
   3.841230196599412*^9, 3.841248973937182*^9, 3.841249029531339*^9, 
   3.841249076685875*^9, 3.841318271807955*^9, 3.841322152338618*^9, 
   3.8413224048483543`*^9, 3.841324759008374*^9, 3.841324988585621*^9, 
   3.841332925289171*^9, 3.8413501656150084`*^9, 3.841352239540401*^9, 
   3.841392983267412*^9, 3.8414034442734127`*^9, {3.841405457747921*^9, 
   3.841405479547908*^9}, 3.841422367832168*^9, 3.911255354042603*^9, 
   3.911290461775208*^9, 3.912269761819351*^9, 3.912546353457407*^9, 
   3.912589071996993*^9, 3.91260035139706*^9, 3.912601706573587*^9, 
   3.9150508717304487`*^9, 3.9155354576796503`*^9},
 CellLabel->
  "Out[729]=",ExpressionUUID->"5aef6484-251d-4535-bcbf-23b53dbfc048"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["P4 \[LongDash] page 93", "Subsubsection",
 CellChangeTimes->{{3.549637932693631*^9, 3.5496379651396313`*^9}, {
   3.549638333618631*^9, 3.549638347517632*^9}, {3.5500699252923346`*^9, 
   3.550069928611317*^9}, {3.5501485295767174`*^9, 3.550148530528771*^9}, 
   3.911290358054441*^9},ExpressionUUID->"913a2136-ce9c-4721-9e06-\
3e6c1421457c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"writeProof", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\"\<KsCNqNr\>\"", ",", "\"\<Csp\>\"", ",", "\"\<CpNq\>\""}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "KoL"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"2", "&&", "4"}], ",", "Co"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"3", "&&", "5"}], ",", "Co"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "KoR"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"7", "&&", "6"}], ",", "Co"}], "}"}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.550138867260064*^9, 3.550138948321701*^9}},
 CellLabel->
  "In[730]:=",ExpressionUUID->"4b4253ac-c220-4d38-9510-393d7d95b822"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"KsCNqNr\"\>", ",", "\<\"Csp\"\>", ",", "\<\"CpNq\"\>", 
   ",", "\<\"s\"\>", ",", "\<\"p\"\>", ",", "\<\"Nq\"\>", 
   ",", "\<\"CNqNr\"\>", ",", "\<\"Nr\"\>"}], "}"}]], "Output",
 CellChangeTimes->{{3.550138938396133*^9, 3.550138948872732*^9}, 
   3.5501460936713915`*^9, 3.5501462920897403`*^9, 3.550148474630574*^9, 
   3.550152942057273*^9, 3.5501530236669407`*^9, 3.5501531570265684`*^9, 
   3.550221815409427*^9, 3.550224329059199*^9, 3.550364526048013*^9, 
   3.5504120055457773`*^9, 3.550710621578749*^9, 3.6238899088103*^9, 
   3.623890760516942*^9, 3.624409984937202*^9, 3.62958325699986*^9, 
   3.629584139155813*^9, 3.645653961849835*^9, 3.6456562537346067`*^9, 
   3.645749617129128*^9, 3.687638701143031*^9, 3.687638749814416*^9, 
   3.8411557719149*^9, 3.841163858427956*^9, 3.841164031685945*^9, 
   3.8411646072334013`*^9, 3.8411665709508953`*^9, 3.8411666806216917`*^9, 
   3.841166863337286*^9, 3.841166897278064*^9, 3.84122035108*^9, 
   3.841230087787056*^9, 3.84123019663225*^9, 3.841248973962242*^9, 
   3.841249029558305*^9, 3.84124907671113*^9, 3.8413182718272*^9, 
   3.8413221523765497`*^9, 3.841322404871027*^9, 3.841324759029497*^9, 
   3.841324988612764*^9, 3.841332925312035*^9, 3.841350165642977*^9, 
   3.84135223957749*^9, 3.841392983296653*^9, 3.84140344430988*^9, {
   3.841405457781158*^9, 3.841405479585355*^9}, 3.841422367858124*^9, 
   3.911255354053632*^9, 3.911290461779086*^9, 3.912269763791157*^9, 
   3.91254635346859*^9, 3.912589072010941*^9, 3.91260035140133*^9, 
   3.912601706581002*^9, 3.915050871737358*^9, 3.915535457689021*^9},
 CellLabel->
  "Out[730]=",ExpressionUUID->"a150159b-68db-4222-bec3-963ab79a8107"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["P5 \[LongDash] page 93", "Subsubsection",
 CellChangeTimes->{{3.550069959987486*^9, 3.5500699626934366`*^9}, 
   3.550100753333807*^9, {3.550148543512514*^9, 3.5501485443205605`*^9}, 
   3.911290358703435*^9},ExpressionUUID->"eb818e05-97da-4e7c-8381-\
a59eb84a8525"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"writeProof", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\"\<Kpq\>\"", ",", "\"\<Cpr\>\"", ",", "\"\<Cqs\>\""}], "}"}], 
   ",", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "KoL"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"2", "&&", "4"}], ",", "Co"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"1", ",", "KoR"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"3", "&&", "6"}], ",", "Co"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"5", "&&", "7"}], ",", "Ki"}], "}"}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.550138966013713*^9, 3.55013906859458*^9}},
 CellLabel->
  "In[731]:=",ExpressionUUID->"52ee4449-b56b-4eeb-ac7b-652f375bd619"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"Kpq\"\>", ",", "\<\"Cpr\"\>", ",", "\<\"Cqs\"\>", 
   ",", "\<\"p\"\>", ",", "\<\"r\"\>", ",", "\<\"q\"\>", ",", "\<\"s\"\>", 
   ",", "\<\"Krs\"\>"}], "}"}]], "Output",
 CellChangeTimes->{{3.550139044332194*^9, 3.5501390719107695`*^9}, 
   3.550146094982467*^9, 3.5501462921297426`*^9, 3.550148474672577*^9, 
   3.550152942086274*^9, 3.550153023691942*^9, 3.55015315705757*^9, 
   3.550221815508433*^9, 3.550224329099202*^9, 3.550364526087015*^9, 
   3.5504120055977807`*^9, 3.550710621624752*^9, 3.623889910914221*^9, 
   3.623890760583973*^9, 3.6244099851339273`*^9, 3.629583257092306*^9, 
   3.629584139207279*^9, 3.6456539619289618`*^9, 3.645656253818129*^9, 
   3.645749617269753*^9, 3.687638701208647*^9, 3.687638749881*^9, 
   3.841155774204025*^9, 3.841163858447229*^9, 3.84116403170837*^9, 
   3.8411646072634687`*^9, 3.841166570973856*^9, 3.841166680646319*^9, 
   3.841166863364983*^9, 3.84116689729946*^9, 3.841220351110856*^9, 
   3.841230087812554*^9, 3.841230196663949*^9, 3.841248973989454*^9, 
   3.841249029585376*^9, 3.841249076736861*^9, 3.841318271846274*^9, 
   3.841322152412521*^9, 3.841322404894561*^9, 3.841324759051162*^9, 
   3.841324988638578*^9, 3.8413329253353*^9, 3.841350165680566*^9, 
   3.841352239614873*^9, 3.8413929833265553`*^9, 3.84140344434676*^9, {
   3.841405457815924*^9, 3.841405479622859*^9}, 3.841422367886*^9, 
   3.911255354056449*^9, 3.911290461787949*^9, 3.912269765748445*^9, 
   3.912546353479742*^9, 3.912589072021374*^9, 3.912600351411191*^9, 
   3.912601706587174*^9, 3.915050871740892*^9, 3.915535457692298*^9},
 CellLabel->
  "Out[731]=",ExpressionUUID->"80902113-dba4-4a2e-9c7b-ccf3535639ec"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["P6 \[LongDash] page 94", "Subsubsection",
 CellChangeTimes->{{3.550100712190454*^9, 3.5501007223420353`*^9}, 
   3.550100765005926*^9, {3.5501397416160755`*^9, 3.550139742248111*^9}, 
   3.911290359308099*^9},ExpressionUUID->"cb0341e8-2fab-4fb5-88cc-\
a7a769c07df0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"writeProof", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\"\<KpCqr\>\"", ",", "\"\<KCsqCps\>\""}], "}"}], ",", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "KoL"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"2", ",", "KoR"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"4", "&&", "3"}], ",", "Co"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"2", ",", "KoL"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"6", "&&", "5"}], ",", "Co"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"1", ",", "KoR"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"8", "&&", "7"}], ",", "Co"}], "}"}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.550139074661927*^9, 3.550139146419031*^9}, {
  3.550139487083516*^9, 3.550139496555058*^9}},
 CellLabel->
  "In[732]:=",ExpressionUUID->"bead8975-3320-4516-bc7b-4ab9a955b4b8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"KpCqr\"\>", ",", "\<\"KCsqCps\"\>", ",", "\<\"p\"\>", 
   ",", "\<\"Cps\"\>", ",", "\<\"s\"\>", ",", "\<\"Csq\"\>", ",", "\<\"q\"\>",
    ",", "\<\"Cqr\"\>", ",", "\<\"r\"\>"}], "}"}]], "Output",
 CellChangeTimes->{
  3.5501391476611037`*^9, 3.550139501557344*^9, 3.5501460965045533`*^9, 
   3.5501462921987467`*^9, 3.550148474740579*^9, 3.550152942132277*^9, 
   3.550153023733944*^9, 3.550153157102573*^9, 3.550221815583437*^9, 
   3.550224329175206*^9, 3.5503645261540194`*^9, 3.550412005682785*^9, 
   3.550710621709757*^9, 3.623889912792553*^9, 3.62389076065167*^9, 
   3.624409985266419*^9, 3.629583257192906*^9, 3.629584139263118*^9, 
   3.6456539619981737`*^9, 3.6456562539015408`*^9, 3.645749617331192*^9, 
   3.687638701277218*^9, 3.687638749948425*^9, 3.84115577682085*^9, 
   3.841163858467868*^9, 3.8411640317302113`*^9, 3.841164607291508*^9, 
   3.841166571018067*^9, 3.8411666806687737`*^9, 3.841166863432304*^9, 
   3.841166897321756*^9, 3.841220351142566*^9, 3.841230087845157*^9, 
   3.841230196699483*^9, 3.841248974017051*^9, 3.841249029611762*^9, 
   3.841249076763782*^9, 3.841318271868399*^9, 3.841322152446725*^9, 
   3.841322404922512*^9, 3.841324759073441*^9, 3.841324988663101*^9, 
   3.841332925357861*^9, 3.841350165710404*^9, 3.841352239649817*^9, 
   3.841392983354336*^9, 3.841403444383059*^9, {3.841405457849326*^9, 
   3.84140547965863*^9}, 3.841422367913432*^9, 3.91125535406916*^9, 
   3.911290461799328*^9, 3.912269768193898*^9, 3.912546353493384*^9, 
   3.9125890720371513`*^9, 3.9126003514215508`*^9, 3.912601706596449*^9, 
   3.915050871758029*^9, 3.9155354577082148`*^9},
 CellLabel->
  "Out[732]=",ExpressionUUID->"d183a2dd-f21e-4ff5-9278-e6795f95200d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["P7 \[LongDash] page 94", "Subsubsection",
 CellChangeTimes->{{3.550139721863945*^9, 3.55013973646378*^9}, 
   3.911290359877523*^9},ExpressionUUID->"c05a3fc3-d16b-4b59-84de-\
4dac3d84929f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"writeProof", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\"\<CpKqCsr\>\"", ",", "\"\<KpCqs\>\""}], "}"}], ",", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "KoL"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "&&", "3"}], ",", "Co"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"4", ",", "KoL"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"2", ",", "KoR"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"6", "&&", "5"}], ",", "Co"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"4", ",", "KoR"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"8", "&&", "7"}], ",", "Co"}], "}"}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.5501395702782745`*^9, 3.550139709851258*^9}},
 CellLabel->
  "In[733]:=",ExpressionUUID->"3bb25496-5d45-4223-993e-e7bc05053500"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"CpKqCsr\"\>", ",", "\<\"KpCqs\"\>", ",", "\<\"p\"\>", 
   ",", "\<\"KqCsr\"\>", ",", "\<\"q\"\>", ",", "\<\"Cqs\"\>", 
   ",", "\<\"s\"\>", ",", "\<\"Csr\"\>", ",", "\<\"r\"\>"}], "}"}]], "Output",
 CellChangeTimes->{
  3.550139670968034*^9, 3.550139710341286*^9, 3.550146097881632*^9, 
   3.550146292310753*^9, 3.550148474808584*^9, 3.550152942217282*^9, 
   3.5501530237759466`*^9, 3.550153157178577*^9, 3.550221815661442*^9, 
   3.5502243292492104`*^9, 3.5503645262230234`*^9, 3.55041200576079*^9, 
   3.550710621829764*^9, 3.623889914794199*^9, 3.623890760717856*^9, 
   3.624409985399435*^9, 3.629583257360507*^9, 3.629584139328287*^9, 
   3.645653962117434*^9, 3.645656254018378*^9, 3.645749617394463*^9, 
   3.687638701342461*^9, 3.687638750009959*^9, 3.8411557793826237`*^9, 
   3.841163858488873*^9, 3.841164031752164*^9, 3.841164607321348*^9, 
   3.841166571035369*^9, 3.841166680697307*^9, 3.8411668634586983`*^9, 
   3.841166897347533*^9, 3.841220351176005*^9, 3.8412300878836*^9, 
   3.841230196735153*^9, 3.841248974045198*^9, 3.841249029638233*^9, 
   3.841249076790155*^9, 3.841318271896558*^9, 3.84132215248341*^9, 
   3.841322404949841*^9, 3.841324759097815*^9, 3.841324988687048*^9, 
   3.84133292538006*^9, 3.841350165738391*^9, 3.841352239684863*^9, 
   3.841392983382994*^9, 3.841403444418635*^9, {3.841405457882615*^9, 
   3.841405479697251*^9}, 3.841422367940485*^9, 3.911255354093422*^9, 
   3.9112904618097143`*^9, 3.912269770209818*^9, 3.912546353505145*^9, 
   3.9125890720482388`*^9, 3.9126003514309387`*^9, 3.912601706607957*^9, 
   3.9150508717675*^9, 3.91553545771875*^9},
 CellLabel->
  "Out[733]=",ExpressionUUID->"ddf5bbe6-3ccf-44d2-9d3c-aa66b5700db8"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["P8 \[LongDash] page 95", "Subsubsection",
 CellChangeTimes->{{3.550139772207825*^9, 3.5501397787201977`*^9}, 
   3.911290360476539*^9},ExpressionUUID->"07b19590-2a31-41d1-8523-\
076c28fcd6c7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"writeProof", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\"\<KpCKpqr\>\"", ",", "\"\<Kqs\>\""}], "}"}], ",", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "KoL"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"2", ",", "KoL"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"3", "&&", "4"}], ",", "Ki"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"1", ",", "KoR"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"6", "&&", "5"}], ",", "Co"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"2", ",", "KoR"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"7", "&&", "8"}], ",", "Ki"}], "}"}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.550139784267514*^9, 3.5501398783148932`*^9}},
 CellLabel->
  "In[734]:=",ExpressionUUID->"de3b629c-3e6d-412f-876a-60b4893d6a12"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"KpCKpqr\"\>", ",", "\<\"Kqs\"\>", ",", "\<\"p\"\>", 
   ",", "\<\"q\"\>", ",", "\<\"Kpq\"\>", ",", "\<\"CKpqr\"\>", 
   ",", "\<\"r\"\>", ",", "\<\"s\"\>", ",", "\<\"Krs\"\>"}], "}"}]], "Output",
 CellChangeTimes->{
  3.550139878920928*^9, 3.550146099226709*^9, 3.5501462923787565`*^9, 
   3.550148474871588*^9, 3.5501529422602844`*^9, 3.550153023815949*^9, 
   3.550153157217579*^9, 3.550221815731446*^9, 3.550224329349216*^9, 
   3.5503645262850266`*^9, 3.5504120058307943`*^9, 3.55071062194077*^9, 
   3.623889916460291*^9, 3.623890760784313*^9, 3.624409985600132*^9, 
   3.629583257497715*^9, 3.629584139379299*^9, 3.645653962365212*^9, 
   3.6456562541014853`*^9, 3.645749617467044*^9, 3.687638701408637*^9, 
   3.68763875006126*^9, 3.8411557815959272`*^9, 3.841163858512082*^9, 
   3.841164031773117*^9, 3.841164607349883*^9, 3.8411665710548067`*^9, 
   3.841166680712143*^9, 3.841166863485134*^9, 3.8411668973695498`*^9, 
   3.8412203512080297`*^9, 3.841230087918641*^9, 3.841230196769907*^9, 
   3.841248974072406*^9, 3.84124902966428*^9, 3.841249076818111*^9, 
   3.841318271917609*^9, 3.841322152519865*^9, 3.841322404974889*^9, 
   3.841324759119224*^9, 3.841324988716114*^9, 3.841332925402224*^9, 
   3.841350165765828*^9, 3.841352239720584*^9, 3.8413929834122667`*^9, 
   3.841403444454626*^9, {3.84140545791543*^9, 3.841405479734984*^9}, 
   3.841422367965718*^9, 3.9112553541052074`*^9, 3.91129046181745*^9, 
   3.912269772050829*^9, 3.912546353513922*^9, 3.9125890720586023`*^9, 
   3.912600351438966*^9, 3.9126017066185503`*^9, 3.9150508717761292`*^9, 
   3.9155354577271957`*^9},
 CellLabel->
  "Out[734]=",ExpressionUUID->"464aa625-3ce2-4251-b2c9-759784fc5c89"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["P9 \[LongDash] page 95", "Subsubsection",
 CellChangeTimes->{{3.55013988682338*^9, 3.550139891391641*^9}, 
   3.911290361038123*^9},ExpressionUUID->"2b488a47-0063-45e4-95ac-\
a0a3301dc4a2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"writeProof", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\"\<CpCqCrs\>\"", ",", "\"\<Kpq\>\"", ",", "\"\<r\>\""}], "}"}], 
   ",", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "KoL"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "&&", "4"}], ",", "Co"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"2", ",", "KoR"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"5", "&&", "6"}], ",", "Co"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"7", "&&", "3"}], ",", "Co"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"8", "&&", "3"}], ",", "Ki"}], "}"}]}], "\[IndentingNewLine]", 
    "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.550139904701403*^9, 3.550140003931078*^9}},
 CellLabel->
  "In[735]:=",ExpressionUUID->"ca8c7b38-6dbc-4db6-83b8-8852a7608bdb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"CpCqCrs\"\>", ",", "\<\"Kpq\"\>", ",", "\<\"r\"\>", 
   ",", "\<\"p\"\>", ",", "\<\"CqCrs\"\>", ",", "\<\"q\"\>", 
   ",", "\<\"Crs\"\>", ",", "\<\"s\"\>", ",", "\<\"Ksr\"\>"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.550140004864132*^9, 3.550146100508782*^9, 3.55014629243176*^9, 
   3.550148474920591*^9, 3.5501529422942863`*^9, 3.550153023886954*^9, 
   3.5501531572455807`*^9, 3.5502218157844486`*^9, 3.550224329403219*^9, 
   3.5503645263330297`*^9, 3.550412005884797*^9, 3.550710622025775*^9, 
   3.623889917942543*^9, 3.623890760851582*^9, 3.6244099859857597`*^9, 
   3.629583257607992*^9, 3.629584139454266*^9, 3.645653962583054*^9, 
   3.645656254183936*^9, 3.645749617529274*^9, 3.687638701472199*^9, 
   3.687638750132636*^9, 3.841155783848331*^9, 3.841163858535945*^9, 
   3.841164031796327*^9, 3.841164607381776*^9, 3.841166571077417*^9, 
   3.841166680732214*^9, 3.841166863513633*^9, 3.8411668973916693`*^9, 
   3.841220351240369*^9, 3.841230087976218*^9, 3.841230196824182*^9, 
   3.841248974097886*^9, 3.841249029690119*^9, 3.841249076845037*^9, 
   3.841318271938225*^9, 3.841322152557658*^9, 3.841322404995943*^9, 
   3.841324759141368*^9, 3.841324988740244*^9, 3.841332925424775*^9, 
   3.841350165793421*^9, 3.8413522397556*^9, 3.841392983442085*^9, 
   3.841403444490148*^9, {3.841405457948795*^9, 3.841405479771435*^9}, 
   3.841422367990932*^9, 3.911255354109906*^9, 3.9112904618264017`*^9, 
   3.91226977375274*^9, 3.9125463535199547`*^9, 3.912589072072932*^9, 
   3.912600351447381*^9, 3.912601706627249*^9, 3.915050871784542*^9, 
   3.915535457732593*^9},
 CellLabel->
  "Out[735]=",ExpressionUUID->"c7a64cc7-a0ed-4845-9dc1-3485cd885ce3"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["P10 \[LongDash] page 95", "Subsubsection",
 CellChangeTimes->{{3.550140080135437*^9, 3.550140087383851*^9}, 
   3.911290361549983*^9},ExpressionUUID->"23059900-68ff-4168-8e37-\
0d46e6bb8421"],

Cell["Now do a little more to make them pretty:", "Text",
 CellChangeTimes->{{3.550140615400052*^9, 
  3.55014062287948*^9}},ExpressionUUID->"688715bd-a1c5-44c1-8013-\
962f46321161"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Zip", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Range", "[", "10", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"writeProof", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<KsCsq\>\"", ",", "\"\<CqCsr\>\""}], "}"}], ",", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "KoL"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"1", ",", "KoR"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"4", "&&", "3"}], ",", "Co"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"2", "&&", "5"}], ",", "Co"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"6", "&&", "3"}], ",", "Co"}], "}"}]}], "}"}]}], "]"}], ",",
     "\[IndentingNewLine]", "List"}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.550140090323019*^9, 3.55014016062504*^9}, {
   3.55014054088279*^9, 3.550140584033258*^9}, 3.550140938651541*^9},
 CellLabel->
  "In[736]:=",ExpressionUUID->"b66a466c-a69e-4222-b893-fd2c696f5279"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "\<\"KsCsq\"\>"},
     {"2", "\<\"CqCsr\"\>"},
     {"3", "\<\"s\"\>"},
     {"4", "\<\"Csq\"\>"},
     {"5", "\<\"q\"\>"},
     {"6", "\<\"Csr\"\>"},
     {"7", "\<\"r\"\>"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.5501401612270746`*^9, {3.550140578021915*^9, 3.550140584484284*^9}, 
   3.5501409391725707`*^9, 3.550146102668906*^9, 3.550146292478762*^9, 
   3.550148475005596*^9, 3.550152942345289*^9, 3.5501530239139547`*^9, 
   3.550153157272582*^9, 3.550221815839452*^9, 3.5502243294592223`*^9, 
   3.550364526380032*^9, 3.550412005927799*^9, 3.550710622654811*^9, 
   3.623889923216627*^9, 3.623890760967881*^9, 3.624409986054551*^9, 
   3.62958325770999*^9, 3.629584139497182*^9, 3.6456539627768917`*^9, 
   3.645656254268609*^9, 3.645749617596779*^9, 3.687638701537973*^9, 
   3.687638750199483*^9, 3.841155787023384*^9, 3.841163858558638*^9, 
   3.841164031818919*^9, 3.84116460741338*^9, 3.84116657109914*^9, 
   3.841166680752436*^9, 3.841166863543995*^9, 3.841166897412919*^9, 
   3.841220351270088*^9, 3.84123008803337*^9, 3.841230196865945*^9, 
   3.841248974125243*^9, 3.841249029715407*^9, 3.841249076872714*^9, 
   3.841318271960297*^9, 3.841322152595551*^9, 3.841322405018623*^9, 
   3.841324759165822*^9, 3.841324988767981*^9, 3.841332925448517*^9, 
   3.841350165820651*^9, 3.841352239791165*^9, 3.841392983471813*^9, 
   3.841403444526795*^9, {3.841405457980918*^9, 3.841405479808433*^9}, 
   3.841422368014985*^9, 3.91125535412224*^9, 3.911290461830449*^9, 
   3.9122697772564077`*^9, 3.912546353531622*^9, 3.912589072078117*^9, 
   3.912600351451486*^9, 3.912601706637619*^9, 3.9150508717922*^9, 
   3.915535457740786*^9},
 CellLabel->
  "Out[736]//MatrixForm=",ExpressionUUID->"edc547f0-a373-4187-a6d2-\
2c492c3c86c8"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Page 101 \[LongDash] need to modify write-proof to handle symbolic indices\
\>", "Subsubsection",
 CellChangeTimes->{{3.55014111678473*^9, 3.550141137959941*^9}, 
   3.9112903624985*^9},ExpressionUUID->"2082e808-2ff9-4c15-a69a-bc713c6960d9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Zip", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Range", "[", "10", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"writeProof", "[", 
     RowBox[{
      RowBox[{"{", "\"\<Kqp\>\"", "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "KoL"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "KoR"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"2", "&&", "3"}], ",", "Ki"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "\[RuleDelayed]", "4"}], ",", "Ci"}], "}"}]}], "}"}]}],
      "]"}], ",", "\[IndentingNewLine]", "List"}], "\[IndentingNewLine]", 
   "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.550140943516819*^9, 3.550141084946909*^9}},
 CellLabel->
  "In[737]:=",ExpressionUUID->"08f267f3-7056-4f09-8a49-564d4c3590d2"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "\<\"Kqp\"\>"},
     {"2", "\<\"q\"\>"},
     {"3", "\<\"p\"\>"},
     {"4", "\<\"Kqp\"\>"},
     {"5", "\<\"CKqpKqp\"\>"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.550141052408048*^9, 3.55014108549494*^9, 3.550146104638018*^9, 
   3.550146292536766*^9, 3.550148475045598*^9, 3.550152942376291*^9, 
   3.550153023937956*^9, 3.550153157296584*^9, 3.550221815892455*^9, 
   3.550224329501224*^9, 3.550364526420035*^9, 3.550412005972802*^9, 
   3.550710622697814*^9, {3.623889971543635*^9, 3.623889977435397*^9}, 
   3.623890761134897*^9, 3.624409986167101*^9, 3.629583257759702*^9, 
   3.629584139547062*^9, 3.645653962869542*^9, 3.645656254350357*^9, 
   3.64574961766232*^9, 3.6876387016017957`*^9, 3.687638750262453*^9, 
   3.841155791988202*^9, 3.841163858581605*^9, 3.8411640318416758`*^9, 
   3.841164607445587*^9, 3.841166571121959*^9, 3.841166680772958*^9, 
   3.8411668635810003`*^9, 3.841166897443383*^9, 3.841220351300428*^9, 
   3.841230088068041*^9, 3.841230196906602*^9, 3.841248974152032*^9, 
   3.841249029742811*^9, 3.841249076899596*^9, 3.841318271981735*^9, 
   3.84132215262777*^9, 3.841322405041355*^9, 3.841324759189809*^9, 
   3.841324988794772*^9, 3.841332925471105*^9, 3.841350165847509*^9, 
   3.841352239825854*^9, 3.8413929835013103`*^9, 3.841403444562307*^9, {
   3.841405458015051*^9, 3.841405479841736*^9}, 3.841422368040756*^9, 
   3.911255354125658*^9, 3.911290461833672*^9, 3.912269783290126*^9, 
   3.91254635353531*^9, 3.912589072091907*^9, 3.912600351458242*^9, 
   3.912601706641095*^9, 3.915050871797033*^9, 3.9155354577440157`*^9},
 CellLabel->
  "Out[737]//MatrixForm=",ExpressionUUID->"0a539ac6-649d-497a-a578-\
138497e1ab78"]
}, Open  ]],

Cell[TextData[{
 "Format a truth as a quadruple of an ",
 StyleBox["index",
  FontWeight->"Bold"],
 ", a ",
 StyleBox["premise",
  FontWeight->"Bold"],
 " form \[LongDash] a combination of indices, a ",
 StyleBox["rule",
  FontWeight->"Bold"],
 ", and an ",
 StyleBox["output",
  FontWeight->"Bold"],
 ". A step consists in writing a new truth into the table of truths."
}], "Text",
 CellChangeTimes->{{3.5501414921682*^9, 3.550141495063366*^9}, {
   3.550142136376047*^9, 3.550142219799818*^9}, {3.550142255599866*^9, 
   3.5501422714157705`*^9}, {3.550148665521493*^9, 3.5501486723928857`*^9}, 
   3.9112903638083277`*^9},ExpressionUUID->"32693f53-4234-49a8-bdef-\
3e247061ee96"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"inferStep2", ",", "writeStep2", ",", "writeProof2"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.5501012002698803`*^9, 3.550101220814422*^9}, {
   3.550101256911189*^9, 3.55010137115913*^9}, {3.550101446943637*^9, 
   3.550101556607698*^9}, {3.550101588903288*^9, 3.550101753121354*^9}, {
   3.550102882458104*^9, 3.5501029042433505`*^9}, {3.550102953675909*^9, 
   3.550103077733405*^9}, {3.550103137293708*^9, 3.550103158773512*^9}, {
   3.55010331599836*^9, 3.550103446606768*^9}, {3.550103540781959*^9, 
   3.550103596885617*^9}, {3.5501036352384944`*^9, 3.550103686046177*^9}, {
   3.5501038372383485`*^9, 3.550103894790345*^9}, {3.550117101678849*^9, 
   3.5501171207661233`*^9}, {3.5501171536390033`*^9, 3.550117181405311*^9}, {
   3.550117346800617*^9, 3.550117405763959*^9}, {3.5501175104359455`*^9, 
   3.550117523588272*^9}, {3.550117594804183*^9, 3.550117679638975*^9}, {
   3.550117736381403*^9, 3.550117772937494*^9}, {3.5501180798175845`*^9, 
   3.550118099161087*^9}, {3.55011818449791*^9, 3.550118261098058*^9}, {
   3.550137883651805*^9, 3.550138399977337*^9}, {3.550138432009169*^9, 
   3.550138437808501*^9}, 3.5501385265935793`*^9, {3.550138607241192*^9, 
   3.550138676914177*^9}, {3.550138747237201*^9, 3.550138812991961*^9}, {
   3.5501412574727783`*^9, 3.550141295711964*^9}, {3.550141335656248*^9, 
   3.550141342712652*^9}, {3.5501423078338537`*^9, 3.550142490664311*^9}, {
   3.550142578696347*^9, 3.550142583000592*^9}, {3.550142626760095*^9, 
   3.550142792865596*^9}, {3.5501428242343903`*^9, 3.550142866274794*^9}, {
   3.550142943985239*^9, 3.550142952514727*^9}, {3.5501430389466715`*^9, 
   3.550143044066964*^9}, {3.550143162474736*^9, 3.5501431694101334`*^9}, {
   3.550143201617975*^9, 3.5501433086680984`*^9}, {3.550143402501465*^9, 
   3.550143511253686*^9}, {3.5501435438775516`*^9, 3.5501435939834175`*^9}, {
   3.5501436252722073`*^9, 3.550143641295123*^9}, {3.5501437051757774`*^9, 
   3.550143708479966*^9}, {3.550143758087804*^9, 3.550143865756962*^9}, {
   3.550143917924946*^9, 3.55014391852598*^9}, {3.550143950564813*^9, 
   3.5501440200517874`*^9}, {3.550144094678056*^9, 3.550144097565221*^9}, {
   3.550144325508258*^9, 3.5501443766991863`*^9}, {3.550144447333226*^9, 
   3.550144505500553*^9}, {3.5501447037648935`*^9, 3.550144765229409*^9}, {
   3.5501447991173472`*^9, 3.550144820093547*^9}, {3.55014491071873*^9, 
   3.550144912877854*^9}, {3.550145004118072*^9, 3.550145042702279*^9}, {
   3.550145273942506*^9, 3.550145276229636*^9}, {3.5501461266872797`*^9, 
   3.550146193690112*^9}, {3.550146788641141*^9, 3.550146879377332*^9}, {
   3.550195549188509*^9, 3.550195644101938*^9}, {3.550195833582775*^9, 
   3.550195872044976*^9}, 3.623890009313631*^9},
 CellLabel->
  "In[738]:=",ExpressionUUID->"37f94f28-d7b2-4f45-8531-ebea88425d00"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"InferenceRuleNames", "[", "Supp", "]"}], "=", "\"\<Supp\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"inferStep2", "[", 
    RowBox[{"truths_", ",", 
     RowBox[{"premise_", "?", "AtomQ"}], ",", "rule_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"truths", "[", "premise", "]"}], "\[LeftDoubleBracket]", "4", 
      "\[RightDoubleBracket]"}], ")"}], "/.", "rule"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"inferStep2", "[", 
    RowBox[{"truths_", ",", "premises_", ",", "rule_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"truths", "[", "#", "]"}], "\[LeftDoubleBracket]", "4", 
       "\[RightDoubleBracket]"}], "&"}], "/@", "premises"}], "/.", "rule"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"writeStep2", ",", "HoldAll"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"writeStep2", "[", 
    RowBox[{"truths_", ",", 
     RowBox[{"{", 
      RowBox[{"triple", ":", 
       RowBox[{"{", 
        RowBox[{
        "index_", ",", "premise_", ",", "rule_", ",", "commentary___"}], 
        "}"}]}], "}"}]}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"truths", "[", "index", "]"}], "=", 
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"triple", "\[LeftDoubleBracket]", 
         RowBox[{"1", ";;", "3"}], "\[RightDoubleBracket]"}], 
        RowBox[{"(*", " ", 
         RowBox[{"discard", " ", "commentary"}], " ", "*)"}], ",", 
        RowBox[{"inferStep2", "[", 
         RowBox[{"truths", ",", "premise", ",", "rule"}], "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"d", "=", 
         RowBox[{"DownValues", "[", "truths", "]"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"#", "\[LeftDoubleBracket]", 
             RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
            RowBox[{"$u", "@", 
             RowBox[{"#", "\[LeftDoubleBracket]", 
              RowBox[{"2", ",", "4"}], "\[RightDoubleBracket]"}]}], ",", 
            RowBox[{"#", "\[LeftDoubleBracket]", 
             RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
            RowBox[{"InferenceRuleNames", "[", 
             RowBox[{"#", "\[LeftDoubleBracket]", 
              RowBox[{"2", ",", "3"}], "\[RightDoubleBracket]"}], "]"}]}], 
           "}"}], "&"}], "/@", "d"}], "//", "MatrixForm"}]}], "]"}]}], 
    ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"writeStep2", "[", 
    RowBox[{"truths_", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"triple", ":", 
        RowBox[{"{", 
         RowBox[{
         "index_", ",", "premise_", ",", "rule_", ",", "commentary___"}], 
         "}"}]}], ",", "more__"}], "}"}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"truths", "[", "index", "]"}], "=", 
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"triple", "\[LeftDoubleBracket]", 
         RowBox[{"1", ";;", "3"}], "\[RightDoubleBracket]"}], 
        RowBox[{"(*", " ", 
         RowBox[{"discard", " ", "commentary"}], " ", "*)"}], ",", 
        RowBox[{"inferStep2", "[", 
         RowBox[{"truths", ",", "premise", ",", "rule"}], "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"writeStep2", "[", 
      RowBox[{"truths", ",", 
       RowBox[{"{", "more", "}"}]}], "]"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"writeProof2", ",", "HoldAll"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"writeProof2", "[", 
    RowBox[{"supps_List", ",", "triples_List"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "truths", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Map", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"s", "\[Function]", 
         RowBox[{
          RowBox[{"truths", "[", 
           RowBox[{
           "s", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "]"}],
           "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
            "s", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
            RowBox[{
            "s", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
            "Supp", ",", 
            RowBox[{"$p", "@", 
             RowBox[{
             "s", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}], 
           "}"}]}]}], ",", "supps"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"writeStep2", "[", 
       RowBox[{"truths", ",", "triples"}], "]"}]}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.5501012002698803`*^9, 3.550101220814422*^9}, {
   3.550101256911189*^9, 3.55010137115913*^9}, {3.550101446943637*^9, 
   3.550101556607698*^9}, {3.550101588903288*^9, 3.550101753121354*^9}, {
   3.550102882458104*^9, 3.5501029042433505`*^9}, {3.550102953675909*^9, 
   3.550103077733405*^9}, {3.550103137293708*^9, 3.550103158773512*^9}, {
   3.55010331599836*^9, 3.550103446606768*^9}, {3.550103540781959*^9, 
   3.550103596885617*^9}, {3.5501036352384944`*^9, 3.550103686046177*^9}, {
   3.5501038372383485`*^9, 3.550103894790345*^9}, {3.550117101678849*^9, 
   3.5501171207661233`*^9}, {3.5501171536390033`*^9, 3.550117181405311*^9}, {
   3.550117346800617*^9, 3.550117405763959*^9}, {3.5501175104359455`*^9, 
   3.550117523588272*^9}, {3.550117594804183*^9, 3.550117679638975*^9}, {
   3.550117736381403*^9, 3.550117772937494*^9}, {3.5501180798175845`*^9, 
   3.550118099161087*^9}, {3.55011818449791*^9, 3.550118261098058*^9}, {
   3.550137883651805*^9, 3.550138399977337*^9}, {3.550138432009169*^9, 
   3.550138437808501*^9}, 3.5501385265935793`*^9, {3.550138607241192*^9, 
   3.550138676914177*^9}, {3.550138747237201*^9, 3.550138812991961*^9}, {
   3.5501412574727783`*^9, 3.550141295711964*^9}, {3.550141335656248*^9, 
   3.550141342712652*^9}, {3.5501423078338537`*^9, 3.550142490664311*^9}, {
   3.550142578696347*^9, 3.550142583000592*^9}, {3.550142626760095*^9, 
   3.550142792865596*^9}, {3.5501428242343903`*^9, 3.550142866274794*^9}, {
   3.550142943985239*^9, 3.550142952514727*^9}, {3.5501430389466715`*^9, 
   3.550143044066964*^9}, {3.550143162474736*^9, 3.5501431694101334`*^9}, {
   3.550143201617975*^9, 3.5501433086680984`*^9}, {3.550143402501465*^9, 
   3.550143511253686*^9}, {3.5501435438775516`*^9, 3.5501435939834175`*^9}, {
   3.5501436252722073`*^9, 3.550143641295123*^9}, {3.5501437051757774`*^9, 
   3.550143708479966*^9}, {3.550143758087804*^9, 3.550143865756962*^9}, {
   3.550143917924946*^9, 3.55014391852598*^9}, {3.550143950564813*^9, 
   3.5501440200517874`*^9}, {3.550144094678056*^9, 3.550144097565221*^9}, {
   3.550144325508258*^9, 3.5501443766991863`*^9}, {3.550144447333226*^9, 
   3.550144505500553*^9}, {3.5501447037648935`*^9, 3.550144765229409*^9}, {
   3.5501447991173472`*^9, 3.550144820093547*^9}, {3.55014491071873*^9, 
   3.550144912877854*^9}, {3.550145004118072*^9, 3.550145042702279*^9}, {
   3.550145273942506*^9, 3.550145276229636*^9}, {3.5501461266872797`*^9, 
   3.550146193690112*^9}, {3.550146788641141*^9, 3.550146879377332*^9}, {
   3.550195549188509*^9, 3.550195644101938*^9}, {3.550195833582775*^9, 
   3.550195872044976*^9}, 3.623890009313631*^9},
 CellLabel->
  "In[739]:=",ExpressionUUID->"053fa2cd-6da6-4a86-bd5d-df68b2439722"]
}, Open  ]],

Cell[CellGroupData[{

Cell["P1 \[LongDash] page 101, written prettily", "Subsubsection",
 CellChangeTimes->{{3.5501474791526365`*^9, 3.550147486344047*^9}, 
   3.9112903653555393`*^9},ExpressionUUID->"7124ee21-5068-4c67-b6b0-\
eb9e4aea84a2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"writeProof2", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"\"\<1a\>\"", ",", "\"\<Kqp\>\""}], "}"}], "}"}], ",", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<1b\>\"", ",", "\"\<1a\>\"", ",", "KoL"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<1c\>\"", ",", "\"\<1a\>\"", ",", "KoR"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<1d\>\"", ",", 
       RowBox[{"\"\<1c\>\"", "&&", "\"\<1b\>\""}], ",", "Ki"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<2\>\"", ",", 
       RowBox[{"\"\<1a\>\"", "\[RuleDelayed]", "\"\<1d\>\""}], ",", "Ci"}], 
      "}"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.550143135139173*^9, 3.550143140674489*^9}, {
  3.550143365426345*^9, 3.550143374921888*^9}, {3.550144052242628*^9, 
  3.550144077514074*^9}, {3.550144839346648*^9, 3.550144884451228*^9}, {
  3.550145088066874*^9, 3.550145090026986*^9}, {3.55014531284373*^9, 
  3.550145407716157*^9}, {3.550146248267234*^9, 3.550146252195459*^9}, {
  3.550146771684172*^9, 3.550146778875583*^9}},
 CellLabel->
  "In[747]:=",ExpressionUUID->"937c1f57-7f0e-4fe8-9ca2-ca4f07875fc0"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"1a\"\>", "\<\"Kqp\"\>", "\<\"1a\"\>", "\<\"Supp\"\>"},
     {"\<\"1b\"\>", "\<\"q\"\>", "\<\"1a\"\>", "\<\"KoL\"\>"},
     {"\<\"1c\"\>", "\<\"p\"\>", "\<\"1a\"\>", "\<\"KoR\"\>"},
     {"\<\"1d\"\>", "\<\"Kpq\"\>", 
      RowBox[{"\<\"1c\"\>", "&&", "\<\"1b\"\>"}], "\<\"Ki\"\>"},
     {"\<\"2\"\>", "\<\"CKqpKpq\"\>", 
      RowBox[{"\<\"1a\"\>", "\[RuleDelayed]", "\<\"1d\"\>"}], "\<\"Ci\"\>"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.550143135983221*^9, 3.550143141064513*^9}, 
   3.550143312526319*^9, 3.5501433758549414`*^9, 3.550143430307055*^9, 
   3.550143513323804*^9, 3.550143596458559*^9, 3.5501436427672076`*^9, 
   3.550143732083316*^9, 3.5501437674733405`*^9, 3.550143820842393*^9, 
   3.5501438757685347`*^9, {3.550144025564102*^9, 3.550144073685855*^9}, 
   3.550144220892275*^9, 3.550144336580891*^9, 3.550144379143326*^9, {
   3.550144495050956*^9, 3.5501445084287205`*^9}, 3.550144734363643*^9, 
   3.550144766835501*^9, {3.550144821492627*^9, 3.5501448868683662`*^9}, {
   3.550145054156935*^9, 3.55014505931923*^9}, 3.5501450908660345`*^9, {
   3.5501452978438725`*^9, 3.550145361857534*^9}, {3.550145394881423*^9, 
   3.550145408247187*^9}, 3.550146161272258*^9, 3.550146225162913*^9, 
   3.5501462611689715`*^9, 3.55014629260777*^9, 3.550146850879701*^9, 
   3.55014688128244*^9, 3.550148475100601*^9, 3.550152942418293*^9, 
   3.5501530239869585`*^9, 3.550153157329585*^9, 3.550195592502987*^9, {
   3.550195623470757*^9, 3.550195649275234*^9}, 3.550221815964459*^9, 
   3.550224329559228*^9, 3.550364526477038*^9, 3.550412006030805*^9, 
   3.550710622838821*^9, 3.623890020348304*^9, 3.623890761539315*^9, 
   3.624409986567284*^9, 3.629583257844857*^9, 3.629584139629488*^9, 
   3.645653963199998*^9, 3.645656254504409*^9, 3.645749617761639*^9, 
   3.68763870168893*^9, 3.687638750360877*^9, 3.841155807515205*^9, 
   3.841163858619099*^9, 3.841164031877832*^9, 3.84116460750887*^9, 
   3.841166571159555*^9, 3.841166680810659*^9, 3.84116686363627*^9, 
   3.841166897475518*^9, 3.841220351353648*^9, 3.841230088121828*^9, 
   3.841230196969765*^9, 3.841248974197336*^9, 3.8412490297866364`*^9, 
   3.841249076943553*^9, 3.841318272463642*^9, 3.84132215268384*^9, 
   3.841322405077504*^9, 3.841324759225406*^9, 3.841324988837438*^9, 
   3.841332925505995*^9, 3.841350165887929*^9, 3.841352239874258*^9, 
   3.841392983546168*^9, 3.841403444621492*^9, {3.841405458066324*^9, 
   3.841405479894429*^9}, 3.841422368082367*^9, 3.911255354142613*^9, 
   3.911290461847434*^9, 3.912269795028239*^9, 3.912546353552136*^9, 
   3.912589072108333*^9, 3.912600351469336*^9, 3.912601706657755*^9, 
   3.9150508718089037`*^9, 3.915535457756647*^9},
 CellLabel->
  "Out[747]//MatrixForm=",ExpressionUUID->"6f4aebcc-8eb9-4c27-87e6-\
d3b5172d32bd"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["P8 \[LongDash] page 95, even prettier", "Subsubsection",
 CellChangeTimes->{{3.550139772207825*^9, 3.5501397787201977`*^9}, {
   3.550148755800657*^9, 3.550148758631819*^9}, 
   3.911290365999523*^9},ExpressionUUID->"a44e780d-c00d-4d01-9f05-\
a016a6959211"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"writeProof2", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "\"\<KpCKpqr\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "\"\<Kqs\>\""}], "}"}]}], "}"}], ",", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", "1", ",", "KoL"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"4", ",", "2", ",", "KoL"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"5", ",", 
       RowBox[{"3", "&&", "4"}], ",", "Ki"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"6", ",", "1", ",", "KoR"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"7", ",", 
       RowBox[{"6", "&&", "5"}], ",", "Co"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"8", ",", "2", ",", "KoR"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"9", ",", 
       RowBox[{"7", "&&", "8"}], ",", "Ki"}], "}"}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.550139784267514*^9, 3.5501398783148932`*^9}, {
  3.550148705763794*^9, 3.550148730140188*^9}},
 CellLabel->
  "In[748]:=",ExpressionUUID->"0f788a3e-3def-4873-9f79-8d383bf8d056"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "\<\"KpCKpqr\"\>", "1", "\<\"Supp\"\>"},
     {"2", "\<\"Kqs\"\>", "2", "\<\"Supp\"\>"},
     {"3", "\<\"p\"\>", "1", "\<\"KoL\"\>"},
     {"4", "\<\"q\"\>", "2", "\<\"KoL\"\>"},
     {"5", "\<\"Kpq\"\>", 
      RowBox[{"3", "&&", "4"}], "\<\"Ki\"\>"},
     {"6", "\<\"CKpqr\"\>", "1", "\<\"KoR\"\>"},
     {"7", "\<\"r\"\>", 
      RowBox[{"6", "&&", "5"}], "\<\"Co\"\>"},
     {"8", "\<\"s\"\>", "2", "\<\"KoR\"\>"},
     {"9", "\<\"Krs\"\>", 
      RowBox[{"7", "&&", "8"}], "\<\"Ki\"\>"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.550139878920928*^9, 3.550146099226709*^9, 3.5501462923787565`*^9, 
   3.550148474871588*^9, 3.550148731064241*^9, 3.550152942449295*^9, 
   3.55015302401196*^9, 3.5501531573545866`*^9, 3.5501956547555466`*^9, 
   3.550221816015462*^9, 3.55022432960023*^9, 3.55036452651904*^9, 
   3.550412006086808*^9, 3.5507106229078255`*^9, 3.6238900451074057`*^9, 
   3.623890761600806*^9, 3.624409986737896*^9, 3.629583257889316*^9, 
   3.629584139680786*^9, 3.645653963379758*^9, 3.645656254583931*^9, 
   3.645749617828364*^9, 3.687638701755137*^9, 3.687638750432423*^9, 
   3.84115581063692*^9, 3.841163858637259*^9, 3.841164031895487*^9, 
   3.841164607540145*^9, 3.841166571176982*^9, 3.841166680831233*^9, 
   3.841166863657711*^9, 3.841166897500014*^9, 3.841220351377447*^9, 
   3.841230088146031*^9, 3.8412301969985228`*^9, 3.841248974215322*^9, 
   3.84124902980371*^9, 3.84124907696261*^9, 3.841318272486128*^9, 
   3.841322152717455*^9, 3.8413224050983973`*^9, 3.84132475924681*^9, 
   3.841324988865685*^9, 3.841332925533552*^9, 3.841350165916012*^9, 
   3.841352239910612*^9, 3.841392983576789*^9, 3.841403444648174*^9, {
   3.841405458086261*^9, 3.841405479917446*^9}, 3.841422368103741*^9, 
   3.911255354146683*^9, 3.911290461857411*^9, 3.912269803288194*^9, 
   3.912546353556451*^9, 3.912589072117753*^9, 3.912600351476346*^9, 
   3.9126017066612873`*^9, 3.9150508718180523`*^9, 3.915535457759811*^9},
 CellLabel->
  "Out[748]//MatrixForm=",ExpressionUUID->"0c6c4346-2dad-4693-ba9a-\
f8f266a6d4bf"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["P9 \[LongDash] page 95, even prettier", "Subsubsection",
 CellChangeTimes->{{3.55013988682338*^9, 3.550139891391641*^9}, {
   3.55014876249604*^9, 3.550148765568215*^9}, 
   3.911290366608235*^9},ExpressionUUID->"59bb1290-1cd8-4d78-a4c3-\
3352f574abfe"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"writeProof2", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "\"\<CpCqCrs\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "\"\<Kpq\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "\"\<r\>\""}], "}"}]}], "}"}], ",", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"4", ",", "2", ",", "KoL"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"5", ",", 
       RowBox[{"1", "&&", "4"}], ",", "Co"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"6", ",", "2", ",", "KoR"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"7", ",", 
       RowBox[{"5", "&&", "6"}], ",", "Co"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"8", ",", 
       RowBox[{"7", "&&", "3"}], ",", "Co"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"9", ",", 
       RowBox[{"8", "&&", "3"}], ",", "Ki"}], "}"}]}], "\[IndentingNewLine]", 
    "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.550139904701403*^9, 3.550140003931078*^9}, {
  3.550148768380376*^9, 3.5501487897565985`*^9}},
 CellLabel->
  "In[749]:=",ExpressionUUID->"fa3e076b-e02d-4d64-b184-80a0f1e387aa"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "\<\"CpCqCrs\"\>", "1", "\<\"Supp\"\>"},
     {"2", "\<\"Kpq\"\>", "2", "\<\"Supp\"\>"},
     {"3", "\<\"r\"\>", "3", "\<\"Supp\"\>"},
     {"4", "\<\"p\"\>", "2", "\<\"KoL\"\>"},
     {"5", "\<\"CqCrs\"\>", 
      RowBox[{"1", "&&", "4"}], "\<\"Co\"\>"},
     {"6", "\<\"q\"\>", "2", "\<\"KoR\"\>"},
     {"7", "\<\"Crs\"\>", 
      RowBox[{"5", "&&", "6"}], "\<\"Co\"\>"},
     {"8", "\<\"s\"\>", 
      RowBox[{"7", "&&", "3"}], "\<\"Co\"\>"},
     {"9", "\<\"Ksr\"\>", 
      RowBox[{"8", "&&", "3"}], "\<\"Ki\"\>"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.550140004864132*^9, 3.550146100508782*^9, 3.55014629243176*^9, 
   3.550148474920591*^9, 3.550148790494641*^9, 3.550152942477297*^9, 
   3.550153024038961*^9, 3.550153157379588*^9, 3.550195658985789*^9, 
   3.550221816070465*^9, 3.550224329647233*^9, 3.550364526588044*^9, 
   3.550412006131811*^9, 3.55071062297983*^9, 3.623890086974105*^9, 
   3.623890761667296*^9, 3.62440998716683*^9, 3.629583257942844*^9, 
   3.62958413973129*^9, 3.645653963512117*^9, 3.645656254667455*^9, 
   3.645749617895778*^9, 3.687638701817122*^9, 3.68763875049979*^9, 
   3.84115581795723*^9, 3.841163858659978*^9, 3.8411640319174147`*^9, 
   3.841164607564695*^9, 3.841166571199049*^9, 3.8411666808567553`*^9, 
   3.841166863684614*^9, 3.841166897521707*^9, 3.8412203514095097`*^9, 
   3.84123008818793*^9, 3.841230197037017*^9, 3.841248974241742*^9, 
   3.841249029830404*^9, 3.841249076989365*^9, 3.841318272507357*^9, 
   3.841322152752404*^9, 3.8413224051203117`*^9, 3.84132475926947*^9, 
   3.84132498889616*^9, 3.841332925557436*^9, 3.841350165943079*^9, 
   3.84135223994696*^9, 3.841392983605385*^9, 3.841403444684425*^9, {
   3.841405458123259*^9, 3.841405479948497*^9}, 3.841422368128373*^9, 
   3.911255354158116*^9, 3.911290461862075*^9, 3.912269810748727*^9, 
   3.912546353565527*^9, 3.912589072122479*^9, 3.912600351479911*^9, 
   3.912601706669525*^9, 3.915050871821807*^9, 3.915535457768489*^9},
 CellLabel->
  "Out[749]//MatrixForm=",ExpressionUUID->"66c372ce-b04d-4057-a55f-\
777882e785ee"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["P10 \[LongDash] page 95, even prettier", "Subsubsection",
 CellChangeTimes->{{3.550147456976368*^9, 3.5501474654398513`*^9}, 
   3.911290367197214*^9},ExpressionUUID->"1558a096-fa42-4232-9682-\
c4f50e279655"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"writeProof2", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "\"\<KsCsq\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "\"\<CqCsr\>\""}], "}"}]}], "}"}], ",", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", "1", ",", "KoL"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"4", ",", "1", ",", "KoR"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"5", ",", 
       RowBox[{"4", "&&", "3"}], ",", "Co"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"6", ",", 
       RowBox[{"2", "&&", "5"}], ",", "Co"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"7", ",", 
       RowBox[{"6", "&&", "3"}], ",", "Co"}], "}"}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.550146585259508*^9, 3.5501466561395626`*^9}, {
  3.550147398572027*^9, 3.5501474163160424`*^9}},
 CellLabel->
  "In[750]:=",ExpressionUUID->"c3e93c60-44d1-4b40-946a-bd1615bb42dc"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "\<\"KsCsq\"\>", "1", "\<\"Supp\"\>"},
     {"2", "\<\"CqCsr\"\>", "2", "\<\"Supp\"\>"},
     {"3", "\<\"s\"\>", "1", "\<\"KoL\"\>"},
     {"4", "\<\"Csq\"\>", "1", "\<\"KoR\"\>"},
     {"5", "\<\"q\"\>", 
      RowBox[{"4", "&&", "3"}], "\<\"Co\"\>"},
     {"6", "\<\"Csr\"\>", 
      RowBox[{"2", "&&", "5"}], "\<\"Co\"\>"},
     {"7", "\<\"r\"\>", 
      RowBox[{"6", "&&", "3"}], "\<\"Co\"\>"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.5501465861825614`*^9, {3.550146627680935*^9, 3.550146656948609*^9}, 
   3.550147416917077*^9, 3.550148475146604*^9, 3.5501529425072985`*^9, 
   3.550153024063963*^9, 3.550153157403589*^9, 3.550195662586995*^9, 
   3.550221816124468*^9, 3.550224329688235*^9, 3.550364526627046*^9, 
   3.550412006181814*^9, 3.5507106230578337`*^9, 3.623890091946569*^9, 
   3.623890761733966*^9, 3.624409987233912*^9, 3.629583258057108*^9, 
   3.629584139781361*^9, 3.645653963628002*^9, 3.645656254751715*^9, 
   3.645749617965494*^9, 3.68763870190853*^9, 3.68763875056565*^9, 
   3.841155821725185*^9, 3.841163858683683*^9, 3.84116403193911*^9, 
   3.841164607593161*^9, 3.841166571220979*^9, 3.841166680881311*^9, 
   3.841166863708239*^9, 3.8411668975456257`*^9, 3.841220351441807*^9, 
   3.841230088225177*^9, 3.841230197076991*^9, 3.8412489742674*^9, 
   3.841249029857429*^9, 3.84124907701606*^9, 3.841318272526843*^9, 
   3.841322152789605*^9, 3.8413224051426697`*^9, 3.84132475929174*^9, 
   3.841324988923498*^9, 3.841332925581616*^9, 3.841350165970407*^9, 
   3.84135223998317*^9, 3.841392983634832*^9, 3.8414034447204647`*^9, {
   3.841405458160177*^9, 3.841405479980447*^9}, 3.841422368154907*^9, 
   3.9112553541629753`*^9, 3.911290461871478*^9, 3.912269814221792*^9, 
   3.912546353569041*^9, 3.912589072132248*^9, 3.912600351486637*^9, 
   3.9126017066733713`*^9, 3.915050871828939*^9, 3.9155354577719717`*^9},
 CellLabel->
  "Out[750]//MatrixForm=",ExpressionUUID->"448b4a53-2b6e-4d1e-9f0f-\
b7e04403cce7"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Deeper Deductions", "Subsection",
 CellChangeTimes->{{3.550149327248341*^9, 
  3.550149333584703*^9}},ExpressionUUID->"2906ff61-be3e-4960-a1f9-\
13476e2a59cd"],

Cell[CellGroupData[{

Cell["P2 \[LongDash] page 103", "Subsubsection",
 CellChangeTimes->{{3.550149371959899*^9, 3.5501493759361258`*^9}, 
   3.911290367774761*^9},ExpressionUUID->"d0791ed6-e194-470c-b374-\
ac2732c21cc5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"writeProof2", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<1a\>\"", ",", "\"\<q\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<1b1\>\"", ",", "\"\<KrCrs\>\""}], "}"}]}], "}"}], ",", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<1b2\>\"", ",", "\"\<1b1\>\"", ",", "KoL"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<1b3\>\"", ",", "\"\<1b1\>\"", ",", "KoR"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<1b4\>\"", ",", 
       RowBox[{"\"\<1b3\>\"", "&&", "\"\<1b2\>\""}], ",", "Co"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<1c\>\"", ",", 
       RowBox[{"\"\<1b1\>\"", "\[RuleDelayed]", "\"\<1b4\>\""}], ",", "Ci"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<2\>\"", ",", 
       RowBox[{"\"\<1a\>\"", "\[RuleDelayed]", "\"\<1c\>\""}], ",", "Ci"}], 
      "}"}]}], "\[IndentingNewLine]", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.5501490636762643`*^9, 3.5501493103243732`*^9}},
 CellLabel->
  "In[751]:=",ExpressionUUID->"ce8b4ab8-a8dd-4eec-81f8-d5377826e767"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"1a\"\>", "\<\"q\"\>", "\<\"1a\"\>", "\<\"Supp\"\>"},
     {"\<\"1b1\"\>", "\<\"KrCrs\"\>", "\<\"1b1\"\>", "\<\"Supp\"\>"},
     {"\<\"1b2\"\>", "\<\"r\"\>", "\<\"1b1\"\>", "\<\"KoL\"\>"},
     {"\<\"1b3\"\>", "\<\"Crs\"\>", "\<\"1b1\"\>", "\<\"KoR\"\>"},
     {"\<\"1b4\"\>", "\<\"s\"\>", 
      RowBox[{"\<\"1b3\"\>", "&&", "\<\"1b2\"\>"}], "\<\"Co\"\>"},
     {"\<\"1c\"\>", "\<\"CKrCrss\"\>", 
      RowBox[{"\<\"1b1\"\>", "\[RuleDelayed]", "\<\"1b4\"\>"}], "\<\"Ci\"\>"},
     {"\<\"2\"\>", "\<\"CqCKrCrss\"\>", 
      RowBox[{"\<\"1a\"\>", "\[RuleDelayed]", "\<\"1c\"\>"}], "\<\"Ci\"\>"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.550149311083417*^9, 3.5501529425383*^9, 3.550153024087964*^9, 
   3.550153157430591*^9, 3.5501956666852293`*^9, 3.550221816177472*^9, 
   3.550224329730238*^9, 3.550364526670049*^9, 3.550412006230817*^9, 
   3.550710623117838*^9, 3.623890098114999*^9, 3.623890761801638*^9, 
   3.624409987304507*^9, 3.629583258088455*^9, 3.629584139905136*^9, 
   3.645653963776599*^9, 3.645656254834193*^9, 3.6457496180338593`*^9, 
   3.68763870202207*^9, 3.687638750650043*^9, 3.841155825014824*^9, 
   3.841163858707116*^9, 3.841164031962351*^9, 3.841164607622332*^9, 
   3.841166571241744*^9, 3.841166680906639*^9, 3.841166863730418*^9, 
   3.8411668975684557`*^9, 3.841220351474074*^9, 3.841230088258852*^9, 
   3.841230197111166*^9, 3.841248974293928*^9, 3.841249029883412*^9, 
   3.84124907704349*^9, 3.841318272546237*^9, 3.841322152833858*^9, 
   3.841322405164618*^9, 3.841324759314932*^9, 3.84132498895781*^9, 
   3.8413329256045*^9, 3.841350165998268*^9, 3.841352240021859*^9, 
   3.84139298366445*^9, 3.841403444756873*^9, {3.84140545819562*^9, 
   3.841405480013289*^9}, 3.841422368180399*^9, 3.911255354174237*^9, 
   3.911290461875149*^9, 3.91226981771023*^9, 3.912546353578757*^9, 
   3.912589072136329*^9, 3.912600351490101*^9, 3.912601706680973*^9, 
   3.915050871832758*^9, 3.915535457774925*^9},
 CellLabel->
  "Out[751]//MatrixForm=",ExpressionUUID->"519ff0d2-cdac-40c2-9105-\
bbd9af7189ba"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["P3 \[LongDash] page 110", "Subsubsection",
 CellChangeTimes->{{3.5501496915601788`*^9, 3.550149697392513*^9}, 
   3.911290368452724*^9},ExpressionUUID->"539e4e07-bb91-4c92-aa7f-\
c6651bf1209c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"writeProof2", "[", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"\"\<1a\>\"", ",", "\"\<Krs\>\""}], "}"}], "\[IndentingNewLine]",
     "}"}], ",", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<1b\>\"", ",", "\"\<1a\>\"", ",", "KoL"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<1c\>\"", ",", "\"\<1a\>\"", ",", "KoL"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<1d\>\"", ",", "\"\<1a\>\"", ",", "KoR"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<1e\>\"", ",", 
       RowBox[{"\"\<1b\>\"", "&&", "\"\<1c\>\""}], ",", "Ki"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<1f\>\"", ",", 
       RowBox[{"\"\<1d\>\"", "&&", "\"\<1e\>\""}], ",", "Ki"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<2\>\"", ",", 
       RowBox[{"\"\<1a\>\"", "\[RuleDelayed]", "\"\<1f\>\""}], ",", "Ci"}], 
      "}"}]}], "\[IndentingNewLine]", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.55014970470193*^9, 3.5501497366977606`*^9}, {
  3.550153436021526*^9, 3.550153461466981*^9}, {3.5501536110645375`*^9, 
  3.5501536634775352`*^9}, {3.55015577955589*^9, 3.550155792846372*^9}, {
  3.550156070532614*^9, 3.550156221008236*^9}, {3.550156629191199*^9, 
  3.550156630242199*^9}},
 CellLabel->
  "In[752]:=",ExpressionUUID->"a8216bfe-d372-4f56-b63d-dd8a124cdd9e"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"1a\"\>", "\<\"Krs\"\>", "\<\"1a\"\>", "\<\"Supp\"\>"},
     {"\<\"1b\"\>", "\<\"r\"\>", "\<\"1a\"\>", "\<\"KoL\"\>"},
     {"\<\"1c\"\>", "\<\"r\"\>", "\<\"1a\"\>", "\<\"KoL\"\>"},
     {"\<\"1d\"\>", "\<\"s\"\>", "\<\"1a\"\>", "\<\"KoR\"\>"},
     {"\<\"1e\"\>", "\<\"Krr\"\>", 
      RowBox[{"\<\"1b\"\>", "&&", "\<\"1c\"\>"}], "\<\"Ki\"\>"},
     {"\<\"1f\"\>", "\<\"KsKrr\"\>", 
      RowBox[{"\<\"1d\"\>", "&&", "\<\"1e\"\>"}], "\<\"Ki\"\>"},
     {"\<\"2\"\>", "\<\"CKrsKsKrr\"\>", 
      RowBox[{"\<\"1a\"\>", "\[RuleDelayed]", "\<\"1f\"\>"}], "\<\"Ci\"\>"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.550149791146875*^9, 3.550152942567302*^9, 3.550153024117966*^9, 
   3.550153157491595*^9, {3.550153627311467*^9, 3.550153665219635*^9}, {
   3.55015610476686*^9, 3.55015612283986*^9}, 3.550156154027801*^9, {
   3.5501562075132356`*^9, 3.550156222114236*^9}, 3.550195670743461*^9, 
   3.550221816230474*^9, 3.55022432977124*^9, 3.550364526709051*^9, 
   3.550412006274819*^9, 3.55071062317084*^9, 3.623890101996791*^9, 
   3.623890761868849*^9, 3.624409987368548*^9, 3.629583258138788*^9, 
   3.629584139932274*^9, 3.645653963846485*^9, 3.64565625491678*^9, 
   3.6457496180960093`*^9, 3.687638702238662*^9, 3.687638750685608*^9, 
   3.841155827620228*^9, 3.841163858728776*^9, 3.841164031984845*^9, 
   3.841164607651233*^9, 3.841166571264606*^9, 3.841166680930355*^9, 
   3.8411668637565536`*^9, 3.841166897591066*^9, 3.841220351507031*^9, 
   3.84123008830284*^9, 3.841230197147008*^9, 3.841248974320475*^9, 
   3.841249029909364*^9, 3.841249077070984*^9, 3.841318272566951*^9, 
   3.841322152866282*^9, 3.8413224051863403`*^9, 3.841324759336786*^9, 
   3.8413249889879856`*^9, 3.841332925628758*^9, 3.841350166025565*^9, 
   3.841352240057962*^9, 3.841392983694572*^9, 3.8414034447921753`*^9, {
   3.841405458227999*^9, 3.841405480044945*^9}, 3.841422368206719*^9, 
   3.911255354178421*^9, 3.911290461884638*^9, 3.9122698219375763`*^9, 
   3.9125463535824947`*^9, 3.912589072146248*^9, 3.9126003514981937`*^9, 
   3.912601706687392*^9, 3.9150508718396463`*^9, 3.915535457777964*^9},
 CellLabel->
  "Out[752]//MatrixForm=",ExpressionUUID->"a494496c-31c8-44f4-b1d5-\
fa15576f103b"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["P4 \[LongDash] page 112", "Subsubsection",
 CellChangeTimes->{{3.5501566145498986`*^9, 3.5501566186839*^9}, 
   3.911290369138231*^9},ExpressionUUID->"75f1c7fa-89fa-4b50-9e4e-\
9f6c4913bfff"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"writeProof2", "[", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"\"\<1a\>\"", ",", "\"\<KpCpq\>\""}], "}"}], 
    "\[IndentingNewLine]", "}"}], ",", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<1b\>\"", ",", "\"\<1a\>\"", ",", "KoL"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<1c\>\"", ",", "\"\<1a\>\"", ",", "KoR"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<1d\>\"", ",", 
       RowBox[{"\"\<1c\>\"", "&&", "\"\<1b\>\""}], ",", "Co"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<2\>\"", ",", 
       RowBox[{"\"\<1a\>\"", "\[RuleDelayed]", "\"\<1d\>\""}], ",", "Ci"}], 
      "}"}]}], "\[IndentingNewLine]", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.550156633399199*^9, 3.550156643779198*^9}, {
   3.550156788952645*^9, 3.5501569553113403`*^9}, {3.550195781126775*^9, 
   3.550195797872733*^9}, {3.5501958973684235`*^9, 3.550195900321593*^9}, 
   3.5501959363076506`*^9},
 CellLabel->
  "In[753]:=",ExpressionUUID->"fca0f141-d2f9-4345-ab32-76af85d7c293"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"1a\"\>", "\<\"KpCpq\"\>", "\<\"1a\"\>", "\<\"Supp\"\>"},
     {"\<\"1b\"\>", "\<\"p\"\>", "\<\"1a\"\>", "\<\"KoL\"\>"},
     {"\<\"1c\"\>", "\<\"Cpq\"\>", "\<\"1a\"\>", "\<\"KoR\"\>"},
     {"\<\"1d\"\>", "\<\"q\"\>", 
      RowBox[{"\<\"1c\"\>", "&&", "\<\"1b\"\>"}], "\<\"Co\"\>"},
     {"\<\"2\"\>", "\<\"CKpCpqq\"\>", 
      RowBox[{"\<\"1a\"\>", "\[RuleDelayed]", "\<\"1d\"\>"}], "\<\"Ci\"\>"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.550156645957199*^9, 3.550156956027483*^9, 3.5501956749247007`*^9, {
   3.550195786515084*^9, 3.550195798225753*^9}, {3.5501958936882133`*^9, 
   3.5501959013026485`*^9}, 3.550221816288477*^9, 3.550224329813243*^9, 
   3.550364526750054*^9, 3.5504120063198223`*^9, 3.550710623286847*^9, 
   3.623890105725562*^9, 3.623890761934475*^9, 3.624409987434046*^9, 
   3.629583258188959*^9, 3.629584139980544*^9, 3.6456539639122267`*^9, 
   3.645656255001957*^9, 3.645749618161721*^9, 3.687638702409033*^9, 
   3.687638750749044*^9, 3.841155831370639*^9, 3.841163858749777*^9, 
   3.841164032006034*^9, 3.841164607679962*^9, 3.841166571286734*^9, 
   3.841166680954363*^9, 3.8411668637843857`*^9, 3.841166897613104*^9, 
   3.841220351539184*^9, 3.841230088336116*^9, 3.8412301971846437`*^9, 
   3.841248974346853*^9, 3.841249029933997*^9, 3.841249077097698*^9, 
   3.841318272586746*^9, 3.841322152898039*^9, 3.8413224051980867`*^9, 
   3.841324759359452*^9, 3.841324989018673*^9, 3.8413329256542377`*^9, 
   3.841350166057065*^9, 3.841352240094314*^9, 3.841392983727219*^9, 
   3.841403444826292*^9, {3.841405458262731*^9, 3.841405480076646*^9}, 
   3.8414223682352853`*^9, 3.911255354197774*^9, 3.911290461888425*^9, 
   3.912269823963023*^9, 3.912546353592676*^9, 3.912589072149839*^9, 
   3.9126003515016537`*^9, 3.912601706695298*^9, 3.915050871843533*^9, 
   3.915535457787458*^9},
 CellLabel->
  "Out[753]//MatrixForm=",ExpressionUUID->"436fc7eb-ea02-412a-9f85-\
922fdb05bbb9"]
}, Open  ]],

Cell[TextData[{
 "Proper use of the Ci-practice form would require us to parse the names of \
the inferences in the first columns of the displays. All the items marked 1a \
through 1d in P4 above, for example, constitute a lemma (called a sub-proof \
in the game manual). Proper use of Ci in the game is to cite the lemma as \
justification, rather than to cite individual lines in it. For instance, in \
line 2 of P4 above, we should say \[OpenCurlyDoubleQuote]",
 StyleBox["1", "Input"],
 "\[CloseCurlyDoubleQuote] instead of \[OpenCurlyDoubleQuote]",
 StyleBox["1a:>1d", "Input"],
 "\[CloseCurlyDoubleQuote]. To implement such in our game would require \
introducing substructure into the naming of lines of inference. (UNDONE)."
}], "Text",
 CellChangeTimes->{{3.550156982613694*^9, 3.550157074694523*^9}, {
   3.550175646720868*^9, 3.5501757992515917`*^9}, {3.550175837192673*^9, 
   3.5501758821231833`*^9}, 
   3.5501761946933784`*^9},ExpressionUUID->"ef3220f4-7df2-40de-a19d-\
fe11222b5c7d"],

Cell["\<\
The following example illustrates even one more level of sub-structure. \
\>", "Text",
 CellChangeTimes->{{3.550176197037513*^9, 
  3.5501762190447717`*^9}},ExpressionUUID->"6993b8b0-68a2-4b84-bc48-\
96a1e50a78ec"],

Cell["Add another slot on each inference line for commentary.", "Text",
 CellChangeTimes->{{3.5501960487910852`*^9, 3.550196049719138*^9}, {
  3.55019608664925*^9, 
  3.550196105808346*^9}},ExpressionUUID->"47238d23-b5a0-48ff-840e-\
e747af82b97c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["P5 \[LongDash] page 114", "Subsubsection",
 CellChangeTimes->{{3.5501759334706073`*^9, 3.550175937586843*^9}, 
   3.9112903697748327`*^9},ExpressionUUID->"e56b5a4c-792c-43e7-aed6-\
80ac45269c55"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"writeProof2", "[", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<1a\>\"", ",", "\"\<q\>\""}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<1b1\>\"", ",", "\"\<Krp\>\""}], "}"}]}], 
    "\[IndentingNewLine]", "}"}], ",", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<1b2\>\"", ",", "\"\<1b1\>\"", ",", "KoR", ",", "\"\<p\>\""}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<1c\>\"", ",", 
       RowBox[{"\"\<1b1\>\"", "\[RuleDelayed]", "\"\<1b2\>\""}], ",", "Ci", 
       ",", "\"\<CKrpp\>\""}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<2\>\"", ",", 
       RowBox[{"\"\<1a\>\"", "\[RuleDelayed]", "\"\<1c\>\""}], ",", "Ci", 
       ",", "\"\<CqCKrpp\>\""}], "}"}]}], "\[IndentingNewLine]", "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.550175940805027*^9, 3.5501761172514315`*^9}, {
  3.55017615069132*^9, 3.5501761875059676`*^9}, {3.550195720126286*^9, 
  3.550195734977136*^9}, {3.550195959352969*^9, 3.550195966064353*^9}, {
  3.5501960061146436`*^9, 3.550196029568985*^9}},
 CellLabel->
  "In[754]:=",ExpressionUUID->"77e40b36-5a37-4877-b012-68829824da78"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"1a\"\>", "\<\"q\"\>", "\<\"1a\"\>", "\<\"Supp\"\>"},
     {"\<\"1b1\"\>", "\<\"Krp\"\>", "\<\"1b1\"\>", "\<\"Supp\"\>"},
     {"\<\"1b2\"\>", "\<\"p\"\>", "\<\"1b1\"\>", "\<\"KoR\"\>"},
     {"\<\"1c\"\>", "\<\"CKrpp\"\>", 
      RowBox[{"\<\"1b1\"\>", "\[RuleDelayed]", "\<\"1b2\"\>"}], "\<\"Ci\"\>"},
     {"\<\"2\"\>", "\<\"CqCKrpp\"\>", 
      RowBox[{"\<\"1a\"\>", "\[RuleDelayed]", "\<\"1c\"\>"}], "\<\"Ci\"\>"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.550176187796985*^9, {3.5501957290627975`*^9, 3.550195735973192*^9}, 
   3.550195967004407*^9, {3.5501960143641157`*^9, 3.5501960307430525`*^9}, 
   3.55022181633748*^9, 3.550224329854245*^9, 3.550364526790056*^9, 
   3.550412006364824*^9, 3.5507106233418503`*^9, 3.623890142898086*^9, 
   3.623890762000342*^9, 3.624409987506468*^9, 3.629583258292333*^9, 
   3.629584140031322*^9, 3.645653963983098*^9, 3.645656255138317*^9, 
   3.645749618290909*^9, 3.68763870247549*^9, 3.6876387508161926`*^9, 
   3.841155864334401*^9, 3.841163858772566*^9, 3.841164032028777*^9, 
   3.841164607707527*^9, 3.841166571297451*^9, 3.841166680979593*^9, 
   3.8411668638116693`*^9, 3.841166897635161*^9, 3.841220351571462*^9, 
   3.841230088367589*^9, 3.8412301972220497`*^9, 3.841248974373148*^9, 
   3.841249029958406*^9, 3.841249077123758*^9, 3.841318272606888*^9, 
   3.8413221529292603`*^9, 3.84132240522465*^9, 3.841324759382506*^9, 
   3.841324989050683*^9, 3.8413329256781588`*^9, 3.841350166088504*^9, 
   3.841352240130786*^9, 3.841392983756515*^9, 3.841403444863256*^9, {
   3.841405458295692*^9, 3.841405480108277*^9}, 3.841422368261057*^9, 
   3.911255354201106*^9, 3.911290461897913*^9, 3.912269859357523*^9, 
   3.912546353596648*^9, 3.912589072158732*^9, 3.912600351508198*^9, 
   3.912601706698704*^9, 3.9150508718522987`*^9, 3.915535457790635*^9},
 CellLabel->
  "Out[754]//MatrixForm=",ExpressionUUID->"c9df8d9d-82ea-41da-94b7-\
e88eec1fbd37"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["P6 \[LongDash] page 114", "Subsubsection",
 CellChangeTimes->{{3.550176749705683*^9, 3.550176754112934*^9}, 
   3.911290370419096*^9},ExpressionUUID->"1240922c-7761-40f8-a93b-\
6b1219d70bc4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"writeProof2", "[", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"\"\<1a\>\"", ",", "\"\<KsCsr\>\""}], "}"}], 
    "\[IndentingNewLine]", "}"}], ",", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<1b\>\"", ",", "\"\<1a\>\"", ",", "KoL", ",", "\"\<s\>\""}],
       "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<1c\>\"", ",", "\"\<1a\>\"", ",", "KoR", ",", "\"\<Csr\>\""}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<1d\>\"", ",", 
       RowBox[{"\"\<1c\>\"", "&&", "\"\<1b\>\""}], ",", "Co", ",", 
       "\"\<r\>\""}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<1e\>\"", ",", 
       RowBox[{"\"\<1d\>\"", "&&", "\"\<1b\>\""}], ",", "Ki", ",", 
       "\"\<Krs\>\""}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<1f\>\"", ",", 
       RowBox[{"\"\<1b\>\"", "&&", "\"\<1e\>\""}], ",", "Ki", ",", 
       "\"\<KsKrs\>\""}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<2\>\"", ",", 
       RowBox[{"\"\<1a\>\"", "\[RuleDelayed]", "\"\<1f\>\""}], ",", "Ci", 
       ",", "\"\<CKsCsrKsKrs\>\""}], "}"}]}], "\[IndentingNewLine]", "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.550176757279116*^9, 3.550176790109787*^9}, {
  3.550176846755195*^9, 3.550176900241309*^9}, {3.550196138016188*^9, 
  3.55019614679169*^9}, {3.550196177256433*^9, 3.550196252378729*^9}, {
  3.550196284932591*^9, 3.550196388342506*^9}},
 CellLabel->
  "In[755]:=",ExpressionUUID->"91642047-40d9-48b0-aef5-6c22264a3f46"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"1a\"\>", "\<\"KsCsr\"\>", "\<\"1a\"\>", "\<\"Supp\"\>"},
     {"\<\"1b\"\>", "\<\"s\"\>", "\<\"1a\"\>", "\<\"KoL\"\>"},
     {"\<\"1c\"\>", "\<\"Csr\"\>", "\<\"1a\"\>", "\<\"KoR\"\>"},
     {"\<\"1d\"\>", "\<\"r\"\>", 
      RowBox[{"\<\"1c\"\>", "&&", "\<\"1b\"\>"}], "\<\"Co\"\>"},
     {"\<\"1e\"\>", "\<\"Krs\"\>", 
      RowBox[{"\<\"1d\"\>", "&&", "\<\"1b\"\>"}], "\<\"Ki\"\>"},
     {"\<\"1f\"\>", "\<\"KsKrs\"\>", 
      RowBox[{"\<\"1b\"\>", "&&", "\<\"1e\"\>"}], "\<\"Ki\"\>"},
     {"\<\"2\"\>", "\<\"CKsCsrKsKrs\"\>", 
      RowBox[{"\<\"1a\"\>", "\[RuleDelayed]", "\<\"1f\"\>"}], "\<\"Ci\"\>"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.550196205835067*^9, 3.5501962152556057`*^9}, 
   3.550196253703805*^9, {3.550196313498224*^9, 3.5501963384346514`*^9}, 
   3.550196390220614*^9, 3.550221816387483*^9, 3.5502243298962474`*^9, 
   3.550364526831058*^9, 3.550412006408827*^9, 3.550710623420854*^9, 
   3.6238901526028852`*^9, 3.623890762068478*^9, 3.624409987570809*^9, 
   3.629583258442623*^9, 3.629584140081325*^9, 3.645653964061541*^9, 
   3.645656255216728*^9, 3.645749618347188*^9, 3.687638702540485*^9, 
   3.687638750882479*^9, 3.8411558691727953`*^9, 3.841163858795453*^9, 
   3.841164032051333*^9, 3.841164607734915*^9, 3.841166571318359*^9, 
   3.841166681004314*^9, 3.8411668638385267`*^9, 3.841166897657341*^9, 
   3.841220351604635*^9, 3.841230088403251*^9, 3.8412301972586927`*^9, 
   3.8412489743998394`*^9, 3.841249029983081*^9, 3.841249077151166*^9, 
   3.841318272626657*^9, 3.841322152966785*^9, 3.841322405245708*^9, 
   3.841324759416875*^9, 3.841324989082695*^9, 3.841332925702543*^9, 
   3.8413501661214314`*^9, 3.8413522401649942`*^9, 3.8413929837861137`*^9, 
   3.841403444880589*^9, {3.841405458331161*^9, 3.841405480139757*^9}, 
   3.841422368287731*^9, 3.911255354223456*^9, 3.911290461903307*^9, 
   3.912269862243267*^9, 3.912546353605348*^9, 3.9125890721625853`*^9, 
   3.912600351511834*^9, 3.912601706708*^9, 3.915050871856229*^9, 
   3.915535457798882*^9},
 CellLabel->
  "Out[755]//MatrixForm=",ExpressionUUID->"45ac79c9-16f6-4136-b17a-\
13d46a037619"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["P7 \[LongDash] page 116 \[LongDash]> CCCKpqprr", "Subsubsection",
 CellChangeTimes->{{3.5501977485803065`*^9, 3.550197765114959*^9}, {
  3.550221860629013*^9, 3.550221863205161*^9}, {3.9112903710517063`*^9, 
  3.911290374011348*^9}},ExpressionUUID->"7232f489-7936-4d48-ba33-\
05add2d3aec9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"writeProof2", "[", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<1a\>\"", ",", "\"\<CCKpqpr\>\""}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<1b1\>\"", ",", "\"\<Kpq\>\""}], "}"}]}], 
    "\[IndentingNewLine]", "}"}], ",", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<1b2\>\"", ",", "\"\<1b1\>\"", ",", "KoL", ",", "\"\<p\>\""}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<1c\>\"", ",", 
       RowBox[{"\"\<1b1\>\"", "\[RuleDelayed]", "\"\<1b2\>\""}], ",", "Ci", 
       ",", "\"\<CKpqp\>\""}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<1d\>\"", ",", 
       RowBox[{"\"\<1a\>\"", "&&", "\"\<1c\>\""}], ",", "Co", ",", 
       "\"\<r\>\""}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<2\>\"", ",", 
       RowBox[{"\"\<1a\>\"", "\[RuleDelayed]", "\"\<1d\>\""}], ",", "Ci", 
       ",", "\"\<CCCKpqprr\>\""}], "}"}]}], "\[IndentingNewLine]", "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.550197768291277*^9, 3.550197827363183*^9}, {
  3.5501981645078945`*^9, 3.550198342344676*^9}, {3.550198430441485*^9, 
  3.550198503274768*^9}},
 CellLabel->
  "In[756]:=",ExpressionUUID->"3c077e73-fc16-4867-8b66-2348caf0ade9"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"1a\"\>", "\<\"CCKpqpr\"\>", "\<\"1a\"\>", "\<\"Supp\"\>"},
     {"\<\"1b1\"\>", "\<\"Kpq\"\>", "\<\"1b1\"\>", "\<\"Supp\"\>"},
     {"\<\"1b2\"\>", "\<\"p\"\>", "\<\"1b1\"\>", "\<\"KoL\"\>"},
     {"\<\"1c\"\>", "\<\"CKpqp\"\>", 
      RowBox[{"\<\"1b1\"\>", "\[RuleDelayed]", "\<\"1b2\"\>"}], "\<\"Ci\"\>"},
     {"\<\"1d\"\>", "\<\"r\"\>", 
      RowBox[{"\<\"1a\"\>", "&&", "\<\"1c\"\>"}], "\<\"Co\"\>"},
     {"\<\"2\"\>", "\<\"CCCKpqprr\"\>", 
      RowBox[{"\<\"1a\"\>", "\[RuleDelayed]", "\<\"1d\"\>"}], "\<\"Ci\"\>"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.550198258320275*^9, 3.55019831218166*^9, 3.5501984537098117`*^9, 
   3.5501985041638565`*^9, 3.550221816436486*^9, 3.55022432993725*^9, 
   3.55036452687006*^9, 3.55041200645383*^9, 3.550710623478858*^9, 
   3.623890158650541*^9, 3.6238907621354537`*^9, 3.624409987638772*^9, 
   3.62958325859235*^9, 3.629584140131353*^9, 3.645653964132288*^9, 
   3.645656255301228*^9, 3.645749618412312*^9, 3.68763870260926*^9, 
   3.687638750950614*^9, 3.841155878023657*^9, 3.841163858806394*^9, 
   3.841164032073311*^9, 3.84116460776329*^9, 3.841166571335355*^9, 
   3.841166681029022*^9, 3.841166863864348*^9, 3.841166897679777*^9, 
   3.841220351637259*^9, 3.841230088433083*^9, 3.8412301972960653`*^9, 
   3.84124897442632*^9, 3.841249030007182*^9, 3.8412490771921797`*^9, 
   3.841318272646461*^9, 3.841322153003437*^9, 3.841322405268738*^9, 
   3.841324759440157*^9, 3.84132498911677*^9, 3.841332925716007*^9, 
   3.841350166150536*^9, 3.841352240199896*^9, 3.841392983816348*^9, 
   3.84140344491936*^9, {3.841405458366729*^9, 3.841405480172154*^9}, 
   3.8414223683147593`*^9, 3.911255354229107*^9, 3.911290461912735*^9, 
   3.912269864980363*^9, 3.912546353609071*^9, 3.9125890721710653`*^9, 
   3.912600351518659*^9, 3.9126017067116833`*^9, 3.915050871863584*^9, 
   3.915535457802557*^9},
 CellLabel->
  "Out[756]//MatrixForm=",ExpressionUUID->"c279449b-9fbd-4c24-be34-\
a89645cd03ba"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["P8 \[LongDash] page 116 \[LongDash]> CApqCNpCKrsr", "Subsubsection",
 CellChangeTimes->{{3.550221834045493*^9, 3.550221853812624*^9}, {
  3.911290374830586*^9, 
  3.911290375327421*^9}},ExpressionUUID->"b2b415fc-3688-48a8-96f3-\
f223ce4932e6"],

Cell["\<\
The pattern emerging is that every time I see a C, I am going to nest a level \
in my proof structure. The new level is a lemma that assumes the premise and \
tries independently to prove the consequent of the C.\
\>", "Text",
 CellChangeTimes->{{3.5502220231813107`*^9, 
  3.550222114388528*^9}},ExpressionUUID->"c1fbe267-261e-4cd8-80cd-\
4b7026023554"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"writeProof2", "[", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<1a\>\"", ",", "\"\<Apq\>\""}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<1b1\>\"", ",", "\"\<Np\>\""}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<1b2a\>\"", ",", "\"\<Ksr\>\""}], "}"}]}], 
    "\[IndentingNewLine]", "}"}], ",", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<1b2b\>\"", ",", "\"\<1b2a\>\"", ",", "KoR", ",", "\"\<r\>\""}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<1b3\>\"", ",", 
       RowBox[{"\"\<1b2a\>\"", "\[RuleDelayed]", "\"\<1b2b\>\""}], ",", "Ci", 
       ",", "\"\<CNpCKrsr\>\""}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<1c\>\"", ",", 
       RowBox[{"\"\<1b1\>\"", "\[RuleDelayed]", "\"\<1b3\>\""}], ",", "Ci", 
       ",", "\"\<CnpCKrsr\>\""}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<2\>\"", ",", 
       RowBox[{"\"\<1a\>\"", "\[RuleDelayed]", "\"\<1c\>\""}], ",", "Ci", 
       ",", "\"\<CApqCNpCKrsr\>\""}], "}"}]}], "\[IndentingNewLine]", "}"}]}],
   "]"}]], "Input",
 CellChangeTimes->{{3.5502218703545694`*^9, 3.550221906414632*^9}, {
  3.550221952686279*^9, 3.5502219998149743`*^9}, {3.550222136406787*^9, 
  3.550222358169472*^9}},
 CellLabel->
  "In[757]:=",ExpressionUUID->"e45e8fdc-d47b-47a6-a065-95dcb862416b"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"1a\"\>", "\<\"Apq\"\>", "\<\"1a\"\>", "\<\"Supp\"\>"},
     {"\<\"1b1\"\>", "\<\"Np\"\>", "\<\"1b1\"\>", "\<\"Supp\"\>"},
     {"\<\"1b2a\"\>", "\<\"Ksr\"\>", "\<\"1b2a\"\>", "\<\"Supp\"\>"},
     {"\<\"1b2b\"\>", "\<\"r\"\>", "\<\"1b2a\"\>", "\<\"KoR\"\>"},
     {"\<\"1b3\"\>", "\<\"CKsrr\"\>", 
      RowBox[{"\<\"1b2a\"\>", 
       "\[RuleDelayed]", "\<\"1b2b\"\>"}], "\<\"Ci\"\>"},
     {"\<\"1c\"\>", "\<\"CNpCKsrr\"\>", 
      RowBox[{"\<\"1b1\"\>", "\[RuleDelayed]", "\<\"1b3\"\>"}], "\<\"Ci\"\>"},
     {"\<\"2\"\>", "\<\"CApqCNpCKsrr\"\>", 
      RowBox[{"\<\"1a\"\>", "\[RuleDelayed]", "\<\"1c\"\>"}], "\<\"Ci\"\>"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.550222188830785*^9, 3.550222193824071*^9}, 
   3.550222266602234*^9, 3.550222325683613*^9, 3.5502223592605333`*^9, 
   3.5502243299802523`*^9, 3.5503645269110622`*^9, 3.550412006517833*^9, 
   3.550710623569863*^9, 3.623890171649472*^9, 3.623890762201273*^9, 
   3.62440998770088*^9, 3.629583258743075*^9, 3.629584140180915*^9, 
   3.645653964232097*^9, 3.6456562553850603`*^9, 3.645749618478921*^9, 
   3.687638702671652*^9, 3.687638751015799*^9, 3.841155883774539*^9, 
   3.841163858829095*^9, 3.841164032095302*^9, 3.841164607791444*^9, 
   3.841166571356717*^9, 3.841166681054105*^9, 3.841166863891755*^9, 
   3.84116689770217*^9, 3.8412203516699142`*^9, 3.841230088464716*^9, 
   3.841230197330014*^9, 3.84124897445265*^9, 3.841249030034459*^9, 
   3.841249077210868*^9, 3.841318272666013*^9, 3.8413221530377407`*^9, 
   3.841322405291379*^9, 3.84132475946364*^9, 3.8413249891505117`*^9, 
   3.8413329257451973`*^9, 3.841350166177843*^9, 3.841352240237571*^9, 
   3.841392983854068*^9, 3.841403444965365*^9, {3.841405458402987*^9, 
   3.841405480205025*^9}, 3.84142236834216*^9, 3.911255354240645*^9, 
   3.911290461916576*^9, 3.91226987884487*^9, 3.912546353617796*^9, 
   3.912589072175054*^9, 3.912600351522283*^9, 3.912601706720235*^9, 
   3.91505087186758*^9, 3.9155354578105717`*^9},
 CellLabel->
  "Out[757]//MatrixForm=",ExpressionUUID->"43f09141-74e9-464f-bfbc-\
64ab7bece93c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["P9 \[LongDash] page 116 \[LongDash]> CNsCNpCsCKrCrqq", "Subsubsection",
 CellChangeTimes->{{3.550222576916983*^9, 3.550222592100851*^9}, {
  3.911290376499742*^9, 
  3.911290376825056*^9}},ExpressionUUID->"86e45765-293f-46fa-b8af-\
0f843bbf8255"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"writeProof2", "[", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<1a\>\"", ",", "\"\<Ns\>\""}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<1b1\>\"", ",", "\"\<Np\>\""}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<1b2a\>\"", ",", "\"\<s\>\""}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<1b2b1\>\"", ",", "\"\<KrCrq\>\""}], "}"}]}], 
    "\[IndentingNewLine]", "}"}], ",", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<1b2b2\>\"", ",", "\"\<1b2b1\>\"", ",", "KoL", ",", "\"\<r\>\""}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<1b2b3\>\"", ",", "\"\<1b2b1\>\"", ",", "KoR", ",", "\"\<Crq\>\""}],
       "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<1b2b4\>\"", ",", 
       RowBox[{"\"\<1b2b2\>\"", "&&", "\"\<1b2b3\>\""}], ",", "Co", ",", 
       "\"\<q\>\""}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<1b2c\>\"", ",", 
       RowBox[{"\"\<1b2b1\>\"", "\[RuleDelayed]", "\"\<1b2b4\>\""}], ",", 
       "Ci", ",", "\"\<CKrCrqq \[LongDash] lemma\>\""}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<1b3\>\"", ",", 
       RowBox[{"\"\<1b2a\>\"", "\[RuleDelayed]", "\"\<1b2c\>\""}], ",", "Ci", 
       ",", "\"\<CsCKrCrqq \[LongDash] lemma\>\""}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<1c\>\"", ",", 
       RowBox[{"\"\<1b1\>\"", "\[RuleDelayed]", "\"\<1b3\>\""}], ",", "Ci", 
       ",", "\"\<CNpCsCKrCrqq \[LongDash] lemma\>\""}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<2\>\"", ",", 
       RowBox[{"\"\<1a\>\"", "\[RuleDelayed]", "\"\<1c\>\""}], ",", "Ci"}], 
      "}"}]}], "\[IndentingNewLine]", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.550222596930127*^9, 3.550222734382989*^9}, {
  3.550222785871935*^9, 3.550222809311275*^9}, {3.550222851911712*^9, 
  3.5502229404087734`*^9}, {3.5502229862403946`*^9, 3.550223249332444*^9}, {
  3.9112903788401613`*^9, 3.911290384087661*^9}},
 CellLabel->
  "In[758]:=",ExpressionUUID->"81e5ed9d-83d3-4345-9057-f9ca9cd13688"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"1a\"\>", "\<\"Ns\"\>", "\<\"1a\"\>", "\<\"Supp\"\>"},
     {"\<\"1b1\"\>", "\<\"Np\"\>", "\<\"1b1\"\>", "\<\"Supp\"\>"},
     {"\<\"1b2a\"\>", "\<\"s\"\>", "\<\"1b2a\"\>", "\<\"Supp\"\>"},
     {"\<\"1b2b1\"\>", "\<\"KrCrq\"\>", "\<\"1b2b1\"\>", "\<\"Supp\"\>"},
     {"\<\"1b2b2\"\>", "\<\"r\"\>", "\<\"1b2b1\"\>", "\<\"KoL\"\>"},
     {"\<\"1b2b3\"\>", "\<\"Crq\"\>", "\<\"1b2b1\"\>", "\<\"KoR\"\>"},
     {"\<\"1b2b4\"\>", "\<\"q\"\>", 
      RowBox[{"\<\"1b2b2\"\>", "&&", "\<\"1b2b3\"\>"}], "\<\"Co\"\>"},
     {"\<\"1b2c\"\>", "\<\"CKrCrqq\"\>", 
      RowBox[{"\<\"1b2b1\"\>", 
       "\[RuleDelayed]", "\<\"1b2b4\"\>"}], "\<\"Ci\"\>"},
     {"\<\"1b3\"\>", "\<\"CsCKrCrqq\"\>", 
      RowBox[{"\<\"1b2a\"\>", 
       "\[RuleDelayed]", "\<\"1b2c\"\>"}], "\<\"Ci\"\>"},
     {"\<\"1c\"\>", "\<\"CNpCsCKrCrqq\"\>", 
      RowBox[{"\<\"1b1\"\>", "\[RuleDelayed]", "\<\"1b3\"\>"}], "\<\"Ci\"\>"},
     {"\<\"2\"\>", "\<\"CNsCNpCsCKrCrqq\"\>", 
      RowBox[{"\<\"1a\"\>", "\[RuleDelayed]", "\<\"1c\"\>"}], "\<\"Ci\"\>"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.5502226541013975`*^9, 3.550222863694385*^9, {3.550222909848025*^9, 
   3.550222945109042*^9}, 3.550222987000438*^9, {3.550223018489239*^9, 
   3.5502230367312827`*^9}, 3.550223117876924*^9, 3.550223171594997*^9, {
   3.550223222958935*^9, 3.550223249701464*^9}, 3.5502243300262547`*^9, 
   3.550364526954065*^9, 3.5504120065728364`*^9, 3.550710623618866*^9, 
   3.623890183005496*^9, 3.623890762268875*^9, 3.624409987766821*^9, 
   3.629583258844458*^9, 3.629584140231167*^9, 3.645653964311756*^9, 
   3.645656255468562*^9, 3.6457496185460243`*^9, 3.6876387027415156`*^9, 
   3.68763875107877*^9, 3.841155886782913*^9, 3.841163858845379*^9, 
   3.841164032118232*^9, 3.8411646078200293`*^9, 3.841166571380436*^9, 
   3.841166681080234*^9, 3.841166863919003*^9, 3.841166897725977*^9, 
   3.841220351703343*^9, 3.841230088495516*^9, 3.8412301973650427`*^9, 
   3.841248974479041*^9, 3.84124903006123*^9, 3.841249077238598*^9, 
   3.841318272689752*^9, 3.841322153073207*^9, 3.841322405312792*^9, 
   3.841324759486981*^9, 3.84132498918531*^9, 3.8413329257697563`*^9, 
   3.8413501662056503`*^9, 3.841352240274019*^9, 3.841392983887218*^9, 
   3.841403444994707*^9, {3.8414054584374313`*^9, 3.841405480237688*^9}, 
   3.841422368366362*^9, 3.911255354245487*^9, 3.911290461925441*^9, 
   3.912269883236866*^9, 3.91254635362251*^9, 3.912589072183708*^9, 
   3.912600351531559*^9, 3.912601706724169*^9, 3.915050871874596*^9, 
   3.915535457814136*^9},
 CellLabel->
  "Out[758]//MatrixForm=",ExpressionUUID->"5ac34c7d-5994-409d-bb1d-\
e2282ebd78f5"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["P10 \[LongDash] page 117 \[LongDash]> CpCqCNqCNpCKCrsrs", \
"Subsubsection",
 CellChangeTimes->{{3.550223278445108*^9, 3.550223297053172*^9}, 
   3.550223619148595*^9, 3.550223870788988*^9, {3.9112903853272543`*^9, 
   3.91129038582957*^9}},ExpressionUUID->"02f9fd38-b720-434d-8318-\
aadae177f61b"],

Cell["\<\
At this point, I am using the proof machinery as fancy pencil-and-paper \
layout. It\[CloseCurlyQuote]s not actually doing any checking, structuring, \
or destructuring for me, just straight lookup and substitution. I\
\[CloseCurlyQuote]m doing the proofs; it\[CloseCurlyQuote]s just writing them \
out for me in a pretty format.\
\>", "Text",
 CellChangeTimes->{{3.55022377345342*^9, 3.550223818621004*^9}, {
  3.550223974668929*^9, 3.550223993997035*^9}, {3.623890194274045*^9, 
  3.623890197904215*^9}},ExpressionUUID->"f11a622f-3f11-4fd8-b7e0-\
932c06a40753"],

Cell["\<\
Rhetorically, this is an interesting case. We pose conditionals that \
alternately presume q and Nq, p and Np and derive a true statement that if \
some final conditional, Crs, and its premise, r, then then its consequent, s. \
A listener to a real argument structured this way might hear that some \
contradiction resulted in an independent truth. But, there is no \
contradiction because everything was conditional and the final result, \
CKCrsrs, did not depend on p and q, the alternating premises.\
\>", "Text",
 CellChangeTimes->{{3.550224110820717*^9, 3.550224302510681*^9}, 
   3.84115591613759*^9, {3.841310657828517*^9, 
   3.841310658976643*^9}},ExpressionUUID->"1fa04959-0650-4871-81e5-\
ec27c99953a4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"writeProof2", "[", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<1a\>\"", ",", "\"\<p\>\""}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<1b1\>\"", ",", "\"\<q\>\""}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<1b2a\>\"", ",", "\"\<Nq\>\""}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<1b2b1\>\"", ",", "\"\<Np\>\""}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<1b2b2a\>\"", ",", "\"\<KCrsr\>\""}], "}"}]}], 
    "\[IndentingNewLine]", "}"}], ",", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<1b2b2b\>\"", ",", "\"\<1b2b2a\>\"", ",", "KoR", ",", "\"\<r\>\""}],
       "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<1b2b2c\>\"", ",", "\"\<1b2b2a\>\"", ",", "KoL", ",", 
       "\"\<Crs\>\""}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<1b2b2d\>\"", ",", 
       RowBox[{"\"\<1b2b2b\>\"", "&&", "\"\<1b2b2c\>\""}], ",", "Co", ",", 
       "\"\<s\>\""}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<1b2b3\>\"", ",", 
       RowBox[{"\"\<1b2b2a\>\"", "\[RuleDelayed]", "\"\<1b2b2d\>\""}], ",", 
       "Ci", ",", "\"\<CKCrsrs\>\""}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<1b2c\>\"", ",", 
       RowBox[{"\"\<1b2b1\>\"", "\[RuleDelayed]", "\"\<1b2b3\>\""}], ",", 
       "Ci", ",", "\"\<CNpCKCrsrs\>\""}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<1b3\>\"", ",", 
       RowBox[{"\"\<1b2a\>\"", "\[RuleDelayed]", "\"\<1b2c\>\""}], ",", "Ci", 
       ",", "\"\<CNqCNpCKCrsrs\>\""}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<1c\>\"", ",", 
       RowBox[{"\"\<1b1\>\"", "\[RuleDelayed]", "\"\<1b3\>\""}], ",", "Ci", 
       ",", "\"\<CqCNqCNpCKCrsrs\>\""}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<2\>\"", ",", 
       RowBox[{"\"\<1a\>\"", "\[RuleDelayed]", "\"\<1c\>\""}], ",", "Ci", 
       ",", "\"\<CpCqCNqCNpCKCrsrs\>\""}], "}"}]}], "\[IndentingNewLine]", 
    "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.550223304480597*^9, 3.55022353758393*^9}, {
  3.550223568440695*^9, 3.550223605000786*^9}, {3.5502236437210007`*^9, 
  3.550223769307184*^9}, {3.550223835938995*^9, 3.5502239632602773`*^9}, {
  3.550223997732249*^9, 3.5502240949578094`*^9}},
 CellLabel->
  "In[759]:=",ExpressionUUID->"36706161-3a85-4a3e-9aae-b1908dc81cdc"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"1a\"\>", "\<\"p\"\>", "\<\"1a\"\>", "\<\"Supp\"\>"},
     {"\<\"1b1\"\>", "\<\"q\"\>", "\<\"1b1\"\>", "\<\"Supp\"\>"},
     {"\<\"1b2a\"\>", "\<\"Nq\"\>", "\<\"1b2a\"\>", "\<\"Supp\"\>"},
     {"\<\"1b2b1\"\>", "\<\"Np\"\>", "\<\"1b2b1\"\>", "\<\"Supp\"\>"},
     {"\<\"1b2b2a\"\>", "\<\"KCrsr\"\>", "\<\"1b2b2a\"\>", "\<\"Supp\"\>"},
     {"\<\"1b2b2b\"\>", "\<\"r\"\>", "\<\"1b2b2a\"\>", "\<\"KoR\"\>"},
     {"\<\"1b2b2c\"\>", "\<\"Crs\"\>", "\<\"1b2b2a\"\>", "\<\"KoL\"\>"},
     {"\<\"1b2b2d\"\>", "\<\"s\"\>", 
      RowBox[{"\<\"1b2b2b\"\>", "&&", "\<\"1b2b2c\"\>"}], "\<\"Co\"\>"},
     {"\<\"1b2b3\"\>", "\<\"CKCrsrs\"\>", 
      RowBox[{"\<\"1b2b2a\"\>", 
       "\[RuleDelayed]", "\<\"1b2b2d\"\>"}], "\<\"Ci\"\>"},
     {"\<\"1b2c\"\>", "\<\"CNpCKCrsrs\"\>", 
      RowBox[{"\<\"1b2b1\"\>", 
       "\[RuleDelayed]", "\<\"1b2b3\"\>"}], "\<\"Ci\"\>"},
     {"\<\"1b3\"\>", "\<\"CNqCNpCKCrsrs\"\>", 
      RowBox[{"\<\"1b2a\"\>", 
       "\[RuleDelayed]", "\<\"1b2c\"\>"}], "\<\"Ci\"\>"},
     {"\<\"1c\"\>", "\<\"CqCNqCNpCKCrsrs\"\>", 
      RowBox[{"\<\"1b1\"\>", "\[RuleDelayed]", "\<\"1b3\"\>"}], "\<\"Ci\"\>"},
     {"\<\"2\"\>", "\<\"CpCqCNqCNpCKCrsrs\"\>", 
      RowBox[{"\<\"1a\"\>", "\[RuleDelayed]", "\<\"1c\"\>"}], "\<\"Ci\"\>"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.550223538024955*^9, {3.5502235687737136`*^9, 3.550223593110105*^9}, 
   3.550223675380811*^9, 3.550223757159489*^9, 3.550223887181926*^9, 
   3.5502239640193205`*^9, {3.550224065696136*^9, 3.55022409548684*^9}, 
   3.550224330074258*^9, 3.550364526996067*^9, 3.5504120066308393`*^9, 
   3.55071062367587*^9, 3.623890233286047*^9, 3.623890762342504*^9, 
   3.624409987857609*^9, 3.629583258954789*^9, 3.629584140289646*^9, 
   3.64565396437981*^9, 3.645656255550538*^9, 3.645749618611758*^9, 
   3.687638702804102*^9, 3.687638751149617*^9, 3.841155940055718*^9, 
   3.841163858870222*^9, 3.841164032139125*^9, 3.841164607850833*^9, 
   3.841166571403865*^9, 3.841166681104105*^9, 3.8411668639471607`*^9, 
   3.841166897752476*^9, 3.8412203517385597`*^9, 3.841230088529249*^9, 
   3.841230197398776*^9, 3.841248974506539*^9, 3.841249030089183*^9, 
   3.841249077264965*^9, 3.841318272713299*^9, 3.841322153109129*^9, 
   3.8413224053360233`*^9, 3.84132475951002*^9, 3.841324989223302*^9, 
   3.841332925794477*^9, 3.841350166233751*^9, 3.84135224031131*^9, 
   3.8413929839140463`*^9, 3.841403445034244*^9, {3.84140545847399*^9, 
   3.841405480269265*^9}, 3.841422368390296*^9, 3.911255354256757*^9, 
   3.911290461929438*^9, 3.912269921350544*^9, 3.912546353634384*^9, 
   3.912589072189232*^9, 3.912600351536036*^9, 3.912601706732478*^9, 
   3.9150508718814487`*^9, 3.915535457823053*^9},
 CellLabel->
  "Out[759]//MatrixForm=",ExpressionUUID->"32388e25-6f8f-4848-a5be-\
794ffa5acad1"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Reiteration \[LongDash] page 119ff", "Subsection",
 CellChangeTimes->{{3.5490144546131587`*^9, 3.54901445809212*^9}, {
   3.550224765261149*^9, 3.5502247692363772`*^9}, 
   3.911290386676079*^9},ExpressionUUID->"e732d8ac-6b78-46e2-a18c-\
5330cd16cee2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DefineInferenceRule", "[", 
   RowBox[{"R", ",", 
    RowBox[{"left_", "\[RuleDelayed]", "left"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.549014460698438*^9, 3.549014505729645*^9}, {
  3.550227418598912*^9, 3.550227430558595*^9}, {3.5502279138472376`*^9, 
  3.5502279278630395`*^9}, {3.550228532295611*^9, 3.550228534526738*^9}, {
  3.550412451322274*^9, 3.5504124525983477`*^9}},
 CellLabel->
  "In[760]:=",ExpressionUUID->"8546cfb5-ac3b-427f-a5b2-413497c1b619"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"writeProof2", "[", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<1\>\"", ",", "\"\<CKpqr\>\""}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<2a\>\"", ",", "\"\<p\>\""}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<2c1\>\"", ",", "\"\<q\>\""}], "}"}]}], 
    "\[IndentingNewLine]", "}"}], ",", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<2b\>\"", ",", "\"\<1\>\"", ",", "R", ",", "\"\<CKpqr\>\""}], "}"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<2c2\>\"", ",", "\"\<2a\>\"", ",", "R", ",", "\"\<p\>\""}], 
      "}"}]}], "\[IndentingNewLine]", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.5502274369329596`*^9, 3.5502275659913416`*^9}, {
   3.550228542559198*^9, 3.5502285607672396`*^9}, 3.550412015750361*^9, {
   3.550412313704403*^9, 3.550412392234894*^9}, {3.550412465087062*^9, 
   3.550412529534748*^9}},
 CellLabel->
  "In[761]:=",ExpressionUUID->"c26491f4-41fe-4588-8b3e-bd5483c1b998"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"1\"\>", "\<\"CKpqr\"\>", "\<\"1\"\>", "\<\"Supp\"\>"},
     {"\<\"2a\"\>", "\<\"p\"\>", "\<\"2a\"\>", "\<\"Supp\"\>"},
     {"\<\"2b\"\>", "\<\"CKpqr\"\>", "\<\"1\"\>", "\<\"R\"\>"},
     {"\<\"2c1\"\>", "\<\"q\"\>", "\<\"2c1\"\>", "\<\"Supp\"\>"},
     {"\<\"2c2\"\>", "\<\"p\"\>", "\<\"2a\"\>", "\<\"R\"\>"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.550227552409565*^9, 3.550227566489371*^9}, 
   3.55022799991416*^9, 3.550228545525368*^9, 3.5503645270480704`*^9, {
   3.550412006704844*^9, 3.550412017405456*^9}, 3.550412335746664*^9, 
   3.550412475178639*^9, {3.55041251487591*^9, 3.550412532421913*^9}, 
   3.550710623754874*^9, 3.623890246126149*^9, 3.623890762584285*^9, 
   3.624409987940487*^9, 3.6295832590386457`*^9, 3.629584140364096*^9, 
   3.645653964469273*^9, 3.645656255670691*^9, 3.645749618702125*^9, 
   3.68763870287283*^9, 3.687638751235345*^9, 3.841155950345001*^9, 
   3.841163858904564*^9, 3.841164032169182*^9, 3.841164607913133*^9, 
   3.841166571434897*^9, 3.8411666811390953`*^9, 3.841166864000565*^9, 
   3.8411668977856693`*^9, 3.841220351788784*^9, 3.841230088580324*^9, 
   3.84123019744741*^9, 3.841248974563096*^9, 3.841249030130934*^9, 
   3.841249077307534*^9, 3.8413182727442913`*^9, 3.841322153158049*^9, 
   3.841322405366259*^9, 3.841324759541724*^9, 3.841324989266147*^9, 
   3.84133292583283*^9, 3.841350166268004*^9, 3.841352240358403*^9, 
   3.841392983953869*^9, 3.841403445086848*^9, {3.841405458523817*^9, 
   3.841405480323984*^9}, 3.841422368421789*^9, 3.911255354272615*^9, 
   3.911290461939927*^9, 3.912269930472374*^9, 3.912546353650972*^9, 
   3.912589072200404*^9, 3.912600351544827*^9, 3.912601706746723*^9, 
   3.915050871890435*^9, 3.915535457833283*^9},
 CellLabel->
  "Out[761]//MatrixForm=",ExpressionUUID->"39692c1a-9220-45bf-8acb-\
261d9230ae62"]
}, Open  ]],

Cell["Do a better job of laying out proofs; page 122ff", "Text",
 CellChangeTimes->{{3.550412562525635*^9, 3.5504125713001366`*^9}, {
  3.5504126532758245`*^9, 3.550412669420749*^9}, {3.550412923084258*^9, 
  3.5504129236922927`*^9}},ExpressionUUID->"7fe1c85f-bec5-4829-a137-\
d8e74b56580a"],

Cell[CellGroupData[{

Cell[BoxData[GridBox[{
   {"\"\<1\>\"", "\"\<CKpqr\>\"", "\"\<s\>\""},
   {"\"\<2\>\"", "\[Placeholder]", "\[Placeholder]"}
  }]], "Input",
 CellChangeTimes->{{3.550412944074458*^9, 3.550412999116606*^9}},
 CellLabel->
  "In[762]:=",ExpressionUUID->"c8e5b257-f1c6-4684-b007-e81d30490996"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\<\"1\"\>", ",", "\<\"CKpqr\"\>", ",", "\<\"s\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"2\"\>", ",", "\[Placeholder]", ",", "\[Placeholder]"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.550413034516631*^9, 3.550710623804877*^9, 3.623890262294486*^9, 
   3.623890762651696*^9, 3.624409987967808*^9, 3.629583259063377*^9, 
   3.629584140389577*^9, 3.645653964549304*^9, 3.645656255751223*^9, 
   3.645749618736127*^9, 3.687638702938128*^9, 3.687638751266742*^9, 
   3.841155953354307*^9, 3.841163858920421*^9, 3.841164032184939*^9, 
   3.841164607981898*^9, 3.8411665714527493`*^9, 3.841166681157909*^9, 
   3.841166864028649*^9, 3.841166897804183*^9, 3.841220351812588*^9, 
   3.841230088603039*^9, 3.8412301974707193`*^9, 3.841248974580731*^9, 
   3.841249030146913*^9, 3.841249077325368*^9, 3.841318272767117*^9, 
   3.841322153193842*^9, 3.841322405387355*^9, 3.841324759563249*^9, 
   3.841324989299843*^9, 3.841332925856868*^9, 3.841350166294582*^9, 
   3.841352240394298*^9, 3.841392983980611*^9, 3.8414034451159267`*^9, {
   3.841405458546844*^9, 3.841405480356523*^9}, 3.841422368443098*^9, 
   3.911255354275529*^9, 3.911290461949827*^9, 3.912269933828748*^9, 
   3.91254635365574*^9, 3.912589072209538*^9, 3.912600351554711*^9, 
   3.912601706753647*^9, 3.9150508718955793`*^9, 3.915535457836673*^9},
 CellLabel->
  "Out[762]=",ExpressionUUID->"0325321b-db9f-4a52-ad9a-8d02403f0adf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "//", "FullForm"}]], "Input",
 CellChangeTimes->{{3.550413040295963*^9, 3.550413044604208*^9}},
 CellLabel->
  "In[763]:=",ExpressionUUID->"90d4db87-0cfb-45e2-a22e-08c4de2b435f"],

Cell[BoxData[
 TagBox[
  StyleBox[
   RowBox[{"List", "[", 
    RowBox[{
     RowBox[{"List", "[", 
      RowBox[{"\"\<1\>\"", ",", "\"\<CKpqr\>\"", ",", "\"\<s\>\""}], "]"}], 
     ",", 
     RowBox[{"List", "[", 
      RowBox[{"\"\<2\>\"", ",", "\\[Placeholder]", ",", "\\[Placeholder]"}], 
      "]"}]}], "]"}],
   ShowSpecialCharacters->False,
   ShowStringCharacters->True,
   NumberMarks->True],
  FullForm]], "Output",
 CellChangeTimes->{
  3.550413047036348*^9, 3.550710623882881*^9, 3.623890263840939*^9, 
   3.623890762768415*^9, 3.624409988039061*^9, 3.629583259104268*^9, 
   3.629584140441102*^9, 3.6456539646294117`*^9, 3.645656255834387*^9, 
   3.645749618794775*^9, 3.687638703008412*^9, 3.687638751332417*^9, 
   3.84115595589001*^9, 3.841163858940342*^9, 3.841164032205689*^9, 
   3.841164608005384*^9, 3.841166571474399*^9, 3.841166681182617*^9, 
   3.841166864056053*^9, 3.841166897826434*^9, 3.841220351855649*^9, 
   3.84123008864038*^9, 3.841230197503969*^9, 3.841248974607124*^9, 
   3.841249030172397*^9, 3.841249077351477*^9, 3.841318272788025*^9, 
   3.841322153207095*^9, 3.841322405409668*^9, 3.841324759586585*^9, 
   3.841324989330781*^9, 3.841332925881682*^9, 3.841350166321746*^9, 
   3.84135224043135*^9, 3.841392984007056*^9, 3.841403445153384*^9, {
   3.841405458582352*^9, 3.841405480362233*^9}, 3.841422368471899*^9, 
   3.911255354287665*^9, 3.911290461953981*^9, 3.912269936144795*^9, 
   3.9125463536639767`*^9, 3.912589072212914*^9, 3.912600351561489*^9, 
   3.912601706766392*^9, 3.915050871902426*^9, 3.915535457844182*^9},
 CellLabel->
  "Out[763]//FullForm=",ExpressionUUID->"0a3fa0f0-4665-406a-a583-\
579c772bd471"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["%%"], "Input",
 CellChangeTimes->{{3.550413071063721*^9, 3.550413074492918*^9}},
 CellLabel->
  "In[764]:=",ExpressionUUID->"9fd2b6c3-865d-4208-b483-17a8102fa0e8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\<\"1\"\>", ",", "\<\"CKpqr\"\>", ",", "\<\"s\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"2\"\>", ",", "\[Placeholder]", ",", "\[Placeholder]"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.623890762984969*^9, 3.6244099881060257`*^9, 3.629583259150586*^9, 
   3.629584140489726*^9, 3.645653964696842*^9, 3.64565625591842*^9, 
   3.6457496188625402`*^9, 3.687638703126352*^9, 3.68763875139858*^9, 
   3.841155957572998*^9, 3.841163858962564*^9, 3.841164032229175*^9, 
   3.841164608036578*^9, 3.841166571496224*^9, 3.841166681207113*^9, 
   3.841166864085775*^9, 3.841166897850069*^9, 3.841220351880351*^9, 
   3.841230088675211*^9, 3.841230197537787*^9, 3.841248974633444*^9, 
   3.84124903021017*^9, 3.8412490773776417`*^9, 3.841318272809142*^9, 
   3.841322153241588*^9, 3.841322405442396*^9, 3.841324759609299*^9, 
   3.84132498935843*^9, 3.841332925905657*^9, 3.8413501663493433`*^9, 
   3.841352240464736*^9, 3.841392984034054*^9, 3.841403445191171*^9, {
   3.8414054586157637`*^9, 3.841405480394192*^9}, 3.841422368498901*^9, 
   3.911255354290516*^9, 3.911290461962535*^9, 3.912269937810708*^9, 
   3.9125463536672173`*^9, 3.912589072221233*^9, 3.9126003515719957`*^9, 
   3.9126017067697268`*^9, 3.915050871905933*^9, 3.915535457847226*^9},
 CellLabel->
  "Out[764]=",ExpressionUUID->"6b9b3057-08d7-4d0b-b4fd-db897930f76c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\"\<1\>\"", ",", "\"\<CKpqr\>\"", ",", "\"\<s\>\""}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\"\<2\>\"", ",", "\[Placeholder]", ",", "\[Placeholder]"}], 
    "}"}]}], "}"}]], "Input",
 CellChangeTimes->{3.623890266150045*^9},
 CellLabel->
  "In[765]:=",ExpressionUUID->"9f01e593-1ca1-47af-add3-4613f20604c0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\<\"1\"\>", ",", "\<\"CKpqr\"\>", ",", "\<\"s\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"2\"\>", ",", "\[Placeholder]", ",", "\[Placeholder]"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.62389026622646*^9, 3.623890763151695*^9, 3.6295832591993*^9, 
   3.629584140540259*^9, 3.6456539648253098`*^9, 3.645656256002253*^9, 
   3.645749618929317*^9, 3.687638703342222*^9, 3.687638751463619*^9, 
   3.84115595905462*^9, 3.841163858985361*^9, 3.841164032250928*^9, 
   3.841164608066542*^9, 3.841166571516699*^9, 3.841166681232726*^9, 
   3.841166864115027*^9, 3.84116689787397*^9, 3.841220351910204*^9, 
   3.841230088717737*^9, 3.841230197571797*^9, 3.841248974658771*^9, 
   3.841249030226688*^9, 3.841249077404662*^9, 3.841318272830844*^9, 
   3.841322153278189*^9, 3.841322405463039*^9, 3.841324759631839*^9, 
   3.841324989384272*^9, 3.841332925930117*^9, 3.841350166377352*^9, 
   3.841352240501339*^9, 3.841392984060932*^9, 3.841403445228843*^9, {
   3.841405458648437*^9, 3.841405480415754*^9}, 3.841422368525119*^9, 
   3.911255354292922*^9, 3.911290461966042*^9, 3.912269939280336*^9, 
   3.912546353677281*^9, 3.912589072224826*^9, 3.912600351578596*^9, 
   3.912601706777557*^9, 3.915050871912894*^9, 3.915535457855178*^9},
 CellLabel->
  "Out[765]=",ExpressionUUID->"a206f8a9-3354-4b66-9d24-44de22521bf5"]
}, Open  ]],

Cell["\<\
Here\[CloseCurlyQuote]s an approach to the sequences, but it creates \
difficulties for the justifications.\
\>", "Text",
 CellChangeTimes->{{3.5504801552761064`*^9, 
  3.5504801817876225`*^9}},ExpressionUUID->"ae0eecf5-d869-485e-9361-\
584676f40272"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Grid", "[", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<P1\>\"", ",", "\"\<CKpqr -> CpCqr\>\""}], "}"}], ","}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"Grid", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<1\>\"", ",", "\"\<CKpqr\>\""}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"\"\<2\>\"", ",", 
           RowBox[{"Grid", "[", 
            RowBox[{
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"\"\<a\>\"", ",", "\"\<p\>\""}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"\"\<b\>\"", ",", "\"\<CKpqr\>\""}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"\"\<c\>\"", ",", 
                 RowBox[{"Grid", "[", 
                  RowBox[{
                   RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<1\>\"", ",", "\"\<q\>\""}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<2\>\"", ",", "\"\<p\>\""}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<3\>\"", ",", "\"\<Kpq\>\""}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<4\>\"", ",", "\"\<CKpqr\>\""}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<5\>\"", ",", "\"\<r\>\""}], "}"}]}], 
                    "\[IndentingNewLine]", "}"}], ",", 
                   RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}]}], "}"}], ",",
                "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"\"\<d\>\"", ",", "\"\<Cqr\>\""}], "}"}]}], 
              "\[IndentingNewLine]", "}"}], ",", 
             RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"\"\<3\>\"", ",", "\"\<CpCqr\>\""}], "}"}]}], 
        "\[IndentingNewLine]", "}"}], ",", 
       RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}], "}"}], 
    "\[IndentingNewLine]", "}"}], ",", 
   RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.55041258937117*^9, 3.5504125933013954`*^9}, {
   3.550412699040443*^9, 3.5504127301322217`*^9}, {3.550413098270278*^9, 
   3.5504130987523055`*^9}, {3.550413148264138*^9, 3.550413323144139*^9}, {
   3.550413355924015*^9, 3.5504135700412617`*^9}, {3.55041361356375*^9, 
   3.550413640487291*^9}, {3.550413674378229*^9, 3.550413700877745*^9}, {
   3.550479219671593*^9, 3.550479341332552*^9}, {3.5504793727833505`*^9, 
   3.5504793754785047`*^9}, {3.550479410558511*^9, 3.550479464479595*^9}, {
   3.550479587951658*^9, 3.550479648672131*^9}, {3.550479687928375*^9, 
   3.550479706321428*^9}, {3.5504797562812853`*^9, 3.550479770784115*^9}, {
   3.5504799081129694`*^9, 3.550480097051776*^9}, 3.550480150883855*^9},
 CellLabel->
  "In[766]:=",ExpressionUUID->"3c82dfec-9cbe-47c1-ae9a-c8431ef20835"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[GridBox[{
        {"\<\"1\"\>", "\<\"CKpqr\"\>"},
        {"\<\"2\"\>", 
         TagBox[GridBox[{
            {"\<\"a\"\>", "\<\"p\"\>"},
            {"\<\"b\"\>", "\<\"CKpqr\"\>"},
            {"\<\"c\"\>", 
             TagBox[GridBox[{
                {"\<\"1\"\>", "\<\"q\"\>"},
                {"\<\"2\"\>", "\<\"p\"\>"},
                {"\<\"3\"\>", "\<\"Kpq\"\>"},
                {"\<\"4\"\>", "\<\"CKpqr\"\>"},
                {"\<\"5\"\>", "\<\"r\"\>"}
               },
               AutoDelete->False,
               GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
               
               GridBoxItemSize->{
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
              "Grid"]},
            {"\<\"d\"\>", "\<\"Cqr\"\>"}
           },
           AutoDelete->False,
           GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
           
           GridBoxItemSize->{
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
          "Grid"]},
        {"\<\"3\"\>", "\<\"CpCqr\"\>"}
       },
       AutoDelete->False,
       GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"]}
   },
   AutoDelete->False,
   GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{
  3.550413642015379*^9, 3.5504137026868486`*^9, {3.550479227975068*^9, 
   3.5504792618480053`*^9}, 3.5504792940328465`*^9, {3.550479325131624*^9, 
   3.5504793426396265`*^9}, {3.550479442242323*^9, 3.550479465143633*^9}, 
   3.550479639898628*^9, 3.5504797077345085`*^9, 3.550479771356148*^9, 
   3.550479964036168*^9, {3.550480046350877*^9, 3.550480097478801*^9}, 
   3.550710623973886*^9, 3.623890276572274*^9, 3.6238907632673206`*^9, 
   3.624409988171471*^9, 3.629583259250035*^9, 3.629584140587099*^9, 
   3.64565396490733*^9, 3.645656256085066*^9, 3.645749618996876*^9, 
   3.68763870355876*^9, 3.687638751528839*^9, 3.841155964805635*^9, 
   3.841163859006282*^9, 3.841164032272908*^9, 3.841164608100324*^9, 
   3.841166571538717*^9, 3.8411666812585993`*^9, 3.841166864142449*^9, 
   3.841166897901609*^9, 3.841220351940769*^9, 3.841230088744049*^9, 
   3.841230197605599*^9, 3.841248974684417*^9, 3.841249030252713*^9, 
   3.841249077432013*^9, 3.841318272853674*^9, 3.841322153314754*^9, 
   3.8413224054846478`*^9, 3.841324759655657*^9, 3.841324989410001*^9, 
   3.8413329259545107`*^9, 3.84135016640622*^9, 3.8413522405368156`*^9, 
   3.84139298408809*^9, 3.841403445269932*^9, {3.841405458700379*^9, 
   3.841405480446685*^9}, 3.841422368553117*^9, 3.911255354296629*^9, 
   3.911290461976026*^9, 3.912269943633443*^9, 3.912546353681926*^9, 
   3.9125890722286043`*^9, 3.912600351585187*^9, 3.912601706782036*^9, 
   3.9150508719171553`*^9, 3.915535457858554*^9},
 CellLabel->
  "Out[766]=",ExpressionUUID->"1399de03-88d0-4e87-a1e2-aad4b95ff422"]
}, Open  ]],

Cell["\<\
Suppose we know at the outset how many levels of nesting we need. we can then \
use SpanFromLeft to leave judicious spacing.\
\>", "Text",
 CellChangeTimes->{{3.550480197940547*^9, 
  3.550480234958664*^9}},ExpressionUUID->"f7e409e4-3679-44ff-b14f-\
d27937708855"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sl", "=", "SpanFromLeft"}]], "Input",
 CellChangeTimes->{{3.5504802853375454`*^9, 3.550480289518784*^9}},
 CellLabel->
  "In[767]:=",ExpressionUUID->"100e0aee-ca4a-403a-9132-2bfd743272ad"],

Cell[BoxData["\[SpanFromLeft]"], "Output",
 CellChangeTimes->{
  3.5504803024485245`*^9, 3.55071062403889*^9, 3.623890305414831*^9, 
   3.623890763333752*^9, 3.624409988237689*^9, 3.629583259334743*^9, 
   3.629584140640788*^9, 3.645653964987551*^9, 3.645656256153986*^9, 
   3.645749619063543*^9, 3.687638703674114*^9, 3.687638751594769*^9, 
   3.841155977576082*^9, 3.84116385902827*^9, 3.841164032295326*^9, 
   3.8411646081311693`*^9, 3.841166571561659*^9, 3.841166681282915*^9, 
   3.841166864171927*^9, 3.841166897926711*^9, 3.841220351971051*^9, 
   3.841230088758276*^9, 3.841230197637883*^9, 3.84124897470888*^9, 
   3.84124903027927*^9, 3.84124907745891*^9, 3.84131827287593*^9, 
   3.841322153352244*^9, 3.8413224055050983`*^9, 3.841324759678759*^9, 
   3.841324989435643*^9, 3.841332925980156*^9, 3.8413501664336977`*^9, 
   3.84135224057052*^9, 3.841392984114133*^9, 3.841403445306012*^9, {
   3.841405458724834*^9, 3.841405480478078*^9}, 3.841422368576172*^9, 
   3.911255354307771*^9, 3.9112904619796953`*^9, 3.912269956199071*^9, 
   3.912546353690208*^9, 3.91258907224114*^9, 3.912600351588466*^9, 
   3.9126017067922153`*^9, 3.915050871924347*^9, 3.915535457866582*^9},
 CellLabel->
  "Out[767]=",ExpressionUUID->"2c35e891-4591-43d3-8b35-8ebde65a3462"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{GridBox[{
    {"\"\<1\>\"", "\"\<CKpqr\>\"", "sl", "sl", "\"\<s\>\""},
    {"\"\<2\>\"", "\"\<a\>\"", "\"\<p\>\"", "sl", "\"\<s\>\""},
    {"sl", "\"\<b\>\"", "\"\<CKqpr\>\"", "sl", "\"\<1,R\>\""},
    {"sl", "\"\<c\>\"", "\"\<1\>\"", "\"\<q\>\"", "\"\<s\>\""},
    {"sl", "sl", "\"\<2\>\"", "\"\<p\>\"", "\"\<a,R\>\""},
    {"sl", "sl", "\"\<3\>\"", "\"\<Kpq\>\"", "\"\<2,1,Ki\>\""},
    {"sl", "sl", "\"\<4\>\"", "\"\<CKpqr\>\"", "\"\<b,R\>\""},
    {"sl", "sl", "\"\<5\>\"", "\"\<r\>\"", "\"\<4,3,Co\>\""},
    {"sl", "\"\<d\>\"", "\"\<Cqr\>\"", "sl", "\"\<c,Ci\>\""},
    {"\"\<3\>\"", "\"\<CpCqr\>\"", "sl", "sl", "\"\<2,Ci\>\""}
   }], "//", 
  RowBox[{
   RowBox[{"Grid", "[", 
    RowBox[{"#", ",", 
     RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}], "&"}]}]], "Input",
 CellChangeTimes->{{3.550480251955636*^9, 3.550480471926218*^9}, {
  3.5504805057831545`*^9, 3.550480708572753*^9}, {3.55048094961454*^9, 
  3.550480956507935*^9}},
 CellLabel->
  "In[768]:=",ExpressionUUID->"f2b3b043-018f-4d82-ba5e-4962997f1267"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"1\"\>", "\<\"CKpqr\"\>", "\[SpanFromLeft]", 
     "\[SpanFromLeft]", "\<\"s\"\>"},
    {"\<\"2\"\>", "\<\"a\"\>", "\<\"p\"\>", "\[SpanFromLeft]", "\<\"s\"\>"},
    {"\[SpanFromLeft]", "\<\"b\"\>", "\<\"CKqpr\"\>", 
     "\[SpanFromLeft]", "\<\"1,R\"\>"},
    {"\[SpanFromLeft]", "\<\"c\"\>", "\<\"1\"\>", "\<\"q\"\>", "\<\"s\"\>"},
    {"\[SpanFromLeft]", 
     "\[SpanFromLeft]", "\<\"2\"\>", "\<\"p\"\>", "\<\"a,R\"\>"},
    {"\[SpanFromLeft]", 
     "\[SpanFromLeft]", "\<\"3\"\>", "\<\"Kpq\"\>", "\<\"2,1,Ki\"\>"},
    {"\[SpanFromLeft]", 
     "\[SpanFromLeft]", "\<\"4\"\>", "\<\"CKpqr\"\>", "\<\"b,R\"\>"},
    {"\[SpanFromLeft]", 
     "\[SpanFromLeft]", "\<\"5\"\>", "\<\"r\"\>", "\<\"4,3,Co\"\>"},
    {"\[SpanFromLeft]", "\<\"d\"\>", "\<\"Cqr\"\>", 
     "\[SpanFromLeft]", "\<\"c,Ci\"\>"},
    {"\<\"3\"\>", "\<\"CpCqr\"\>", "\[SpanFromLeft]", 
     "\[SpanFromLeft]", "\<\"2,Ci\"\>"}
   },
   AutoDelete->False,
   GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{
  3.550480709349797*^9, 3.550710624086893*^9, 3.623890313333324*^9, 
   3.623890763401816*^9, 3.624409988301526*^9, 3.62958325946716*^9, 
   3.6295841406897182`*^9, 3.645653965065938*^9, 3.645656256255099*^9, 
   3.645749619129953*^9, 3.687638703742618*^9, 3.687638751659214*^9, 
   3.841155979876374*^9, 3.84116385905062*^9, 3.8411640323291283`*^9, 
   3.8411646081625156`*^9, 3.841166571583103*^9, 3.8411666813082533`*^9, 
   3.84116686420022*^9, 3.841166897953997*^9, 3.841220352002486*^9, 
   3.841230088788009*^9, 3.8412301976693172`*^9, 3.841248974738085*^9, 
   3.8412490303062363`*^9, 3.841249077487673*^9, 3.841318272898181*^9, 
   3.841322153386672*^9, 3.841322405526176*^9, 3.84132475970161*^9, 
   3.8413249894602547`*^9, 3.841332926015442*^9, 3.841350166465469*^9, 
   3.841352240602371*^9, 3.841392984141737*^9, 3.8414034453425913`*^9, {
   3.841405458762089*^9, 3.8414054805104723`*^9}, 3.841422368613293*^9, 
   3.911255354313531*^9, 3.911290461988742*^9, 3.912269959299225*^9, 
   3.912546353693861*^9, 3.912589072244744*^9, 3.91260035159653*^9, 
   3.912601706795602*^9, 3.915050871929079*^9, 3.915535457870091*^9},
 CellLabel->
  "Out[768]=",ExpressionUUID->"1cff8a12-d996-4b4a-a24f-bc9cd9b0e825"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{GridBox[{
    {"\"\<1\>\"", "sl", "sl", "\"\<CKpqr\>\"", "\"\<s\>\""},
    {"\"\<2\>\"", "\"\<a\>\"", "sl", "\"\<p\>\"", "\"\<s\>\""},
    {"\"\<\>\"", "\"\<b\>\"", "sl", "\"\<CKqpr\>\"", "\"\<1,R\>\""},
    {"\"\<\>\"", "\"\<c\>\"", "\"\<1\>\"", "\"\<q\>\"", "\"\<s\>\""},
    {"\"\<\>\"", "\"\<\>\"", "\"\<2\>\"", "\"\<p\>\"", "\"\<a,R\>\""},
    {"\"\<\>\"", "\"\<\>\"", "\"\<3\>\"", "\"\<Kpq\>\"", "\"\<2,1,Ki\>\""},
    {"\"\<\>\"", "\"\<\>\"", "\"\<4\>\"", "\"\<CKpqr\>\"", "\"\<b,R\>\""},
    {"\"\<\>\"", "\"\<\>\"", "\"\<5\>\"", "\"\<r\>\"", "\"\<4,3,Co\>\""},
    {"\"\<\>\"", "\"\<d\>\"", "sl", "\"\<Cqr\>\"", "\"\<c,Ci\>\""},
    {"\"\<3\>\"", "sl", "sl", "\"\<CpCqr\>\"", "\"\<2,Ci\>\""}
   }], "//", 
  RowBox[{
   RowBox[{"Grid", "[", 
    RowBox[{"#", ",", 
     RowBox[{"Frame", "\[Rule]", "All"}], ",", 
     RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}], "&"}]}]], "Input",
 CellChangeTimes->{{3.550480251955636*^9, 3.550480471926218*^9}, {
  3.5504805057831545`*^9, 3.550480708572753*^9}, {3.55048094961454*^9, 
  3.550480956507935*^9}, {3.550481374523844*^9, 3.550481451158227*^9}, {
  3.550481482224004*^9, 3.550481521887272*^9}},
 CellLabel->
  "In[769]:=",ExpressionUUID->"baa34b90-4447-4100-a05f-4386ebe18e1f"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"1\"\>", "\[SpanFromLeft]", 
     "\[SpanFromLeft]", "\<\"CKpqr\"\>", "\<\"s\"\>"},
    {"\<\"2\"\>", "\<\"a\"\>", "\[SpanFromLeft]", "\<\"p\"\>", "\<\"s\"\>"},
    {"\<\"\"\>", "\<\"b\"\>", 
     "\[SpanFromLeft]", "\<\"CKqpr\"\>", "\<\"1,R\"\>"},
    {"\<\"\"\>", "\<\"c\"\>", "\<\"1\"\>", "\<\"q\"\>", "\<\"s\"\>"},
    {"\<\"\"\>", "\<\"\"\>", "\<\"2\"\>", "\<\"p\"\>", "\<\"a,R\"\>"},
    {"\<\"\"\>", "\<\"\"\>", "\<\"3\"\>", "\<\"Kpq\"\>", "\<\"2,1,Ki\"\>"},
    {"\<\"\"\>", "\<\"\"\>", "\<\"4\"\>", "\<\"CKpqr\"\>", "\<\"b,R\"\>"},
    {"\<\"\"\>", "\<\"\"\>", "\<\"5\"\>", "\<\"r\"\>", "\<\"4,3,Co\"\>"},
    {"\<\"\"\>", "\<\"d\"\>", 
     "\[SpanFromLeft]", "\<\"Cqr\"\>", "\<\"c,Ci\"\>"},
    {"\<\"3\"\>", "\[SpanFromLeft]", 
     "\[SpanFromLeft]", "\<\"CpCqr\"\>", "\<\"2,Ci\"\>"}
   },
   AutoDelete->False,
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{
  3.550481320941779*^9, 3.5504814123800087`*^9, {3.550481443263775*^9, 
   3.550481452489303*^9}, {3.5504814832600627`*^9, 3.5504814901844587`*^9}, 
   3.550481523894387*^9, 3.550710624142896*^9, 3.623890330720809*^9, 
   3.623890763567956*^9, 3.624409988371805*^9, 3.62958325958404*^9, 
   3.629584140740848*^9, 3.645653965149742*^9, 3.645656256334381*^9, 
   3.645749619195565*^9, 3.687638703865524*^9, 3.687638751693795*^9, 
   3.8411559835501*^9, 3.841163859072661*^9, 3.841164032344984*^9, 
   3.841164608194239*^9, 3.841166571605101*^9, 3.841166681319697*^9, 
   3.841166864228554*^9, 3.841166897979201*^9, 3.841220352033477*^9, 
   3.841230088814822*^9, 3.841230197701233*^9, 3.841248974765336*^9, 
   3.841249030333026*^9, 3.8412490775126657`*^9, 3.841318272920926*^9, 
   3.841322153421282*^9, 3.841322405547472*^9, 3.84132475972532*^9, 
   3.841324989495825*^9, 3.841332926040823*^9, 3.841350166498548*^9, 
   3.841352240633651*^9, 3.841392984172117*^9, 3.8414034453780947`*^9, {
   3.8414054587966213`*^9, 3.841405480542535*^9}, 3.841422368636567*^9, 
   3.911255354324486*^9, 3.91129046199463*^9, 3.912269967213936*^9, 
   3.912546353707013*^9, 3.912589072253823*^9, 3.91260035160006*^9, 
   3.9126017068033*^9, 3.915050871936592*^9, 3.915535457878285*^9},
 CellLabel->
  "Out[769]=",ExpressionUUID->"721a915c-6493-42bd-9f71-52df67e90850"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{GridBox[{
    {"\"\<1\>\"", "sl", "sl", "\"\<CKpqr\>\"", "\"\<s\>\""},
    {"\"\<2\>\"", "\"\<a\>\"", "sl", "\"\<p\>\"", "\"\<s\>\""},
    {"\"\<2\>\"", "\"\<b\>\"", "sl", "\"\<CKqpr\>\"", "\"\<1,R\>\""},
    {"\"\<2\>\"", "\"\<c\>\"", "\"\<1\>\"", "\"\<q\>\"", "\"\<s\>\""},
    {"\"\<2\>\"", "\"\<c\>\"", "\"\<2\>\"", "\"\<p\>\"", "\"\<a,R\>\""},
    {"\"\<2\>\"", "\"\<c\>\"", "\"\<3\>\"", "\"\<Kpq\>\"", "\"\<2,1,Ki\>\""},
    {"\"\<2\>\"", "\"\<c\>\"", "\"\<4\>\"", "\"\<CKpqr\>\"", "\"\<b,R\>\""},
    {"\"\<2\>\"", "\"\<c\>\"", "\"\<5\>\"", "\"\<r\>\"", "\"\<4,3,Co\>\""},
    {"\"\<2\>\"", "\"\<d\>\"", "sl", "\"\<Cqr\>\"", "\"\<c,Ci\>\""},
    {"\"\<3\>\"", "sl", "sl", "\"\<CpCqr\>\"", "\"\<2,Ci\>\""}
   }], "//", 
  RowBox[{
   RowBox[{"Grid", "[", 
    RowBox[{"#", ",", 
     RowBox[{"Frame", "\[Rule]", "All"}], ",", 
     RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}], "&"}]}]], "Input",
 CellChangeTimes->{{3.550480251955636*^9, 3.550480471926218*^9}, {
  3.5504805057831545`*^9, 3.550480708572753*^9}, {3.55048094961454*^9, 
  3.550480956507935*^9}, {3.550481374523844*^9, 3.550481451158227*^9}, {
  3.550481482224004*^9, 3.550481521887272*^9}, {3.550481556888274*^9, 
  3.550481569717008*^9}},
 CellLabel->
  "In[770]:=",ExpressionUUID->"1a69b8ae-9738-4052-81ae-162cdeba643f"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"1\"\>", "\[SpanFromLeft]", 
     "\[SpanFromLeft]", "\<\"CKpqr\"\>", "\<\"s\"\>"},
    {"\<\"2\"\>", "\<\"a\"\>", "\[SpanFromLeft]", "\<\"p\"\>", "\<\"s\"\>"},
    {"\<\"2\"\>", "\<\"b\"\>", 
     "\[SpanFromLeft]", "\<\"CKqpr\"\>", "\<\"1,R\"\>"},
    {"\<\"2\"\>", "\<\"c\"\>", "\<\"1\"\>", "\<\"q\"\>", "\<\"s\"\>"},
    {"\<\"2\"\>", "\<\"c\"\>", "\<\"2\"\>", "\<\"p\"\>", "\<\"a,R\"\>"},
    {"\<\"2\"\>", "\<\"c\"\>", "\<\"3\"\>", "\<\"Kpq\"\>", "\<\"2,1,Ki\"\>"},
    {"\<\"2\"\>", "\<\"c\"\>", "\<\"4\"\>", "\<\"CKpqr\"\>", "\<\"b,R\"\>"},
    {"\<\"2\"\>", "\<\"c\"\>", "\<\"5\"\>", "\<\"r\"\>", "\<\"4,3,Co\"\>"},
    {"\<\"2\"\>", "\<\"d\"\>", 
     "\[SpanFromLeft]", "\<\"Cqr\"\>", "\<\"c,Ci\"\>"},
    {"\<\"3\"\>", "\[SpanFromLeft]", 
     "\[SpanFromLeft]", "\<\"CpCqr\"\>", "\<\"2,Ci\"\>"}
   },
   AutoDelete->False,
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{
  3.550481570694064*^9, 3.550710624205899*^9, 3.623890461149438*^9, 
   3.623890763735844*^9, 3.624409988434009*^9, 3.62958325970135*^9, 
   3.629584140795218*^9, 3.645653965230208*^9, 3.6456562564169292`*^9, 
   3.6457496193202143`*^9, 3.687638704300482*^9, 3.6876387517461176`*^9, 
   3.841155989079729*^9, 3.841163859096437*^9, 3.841164032365336*^9, 
   3.84116460822495*^9, 3.841166571627245*^9, 3.8411666813442793`*^9, 
   3.841166864256943*^9, 3.841166898004429*^9, 3.8412203520635557`*^9, 
   3.841230088853114*^9, 3.841230197732044*^9, 3.841248974792235*^9, 
   3.841249030360892*^9, 3.841249077538896*^9, 3.841318272942139*^9, 
   3.841322153457954*^9, 3.841322405568738*^9, 3.841324759748147*^9, 
   3.841324989519959*^9, 3.841332926066957*^9, 3.84135016653162*^9, 
   3.841352240664899*^9, 3.841392984201232*^9, 3.841403445414652*^9, {
   3.841405458831058*^9, 3.841405480574866*^9}, 3.841422368664589*^9, 
   3.911255354330187*^9, 3.911290462003426*^9, 3.912269974431142*^9, 
   3.912546353711385*^9, 3.912589072257715*^9, 3.912600351606535*^9, 
   3.91260170680687*^9, 3.915050871940813*^9, 3.9155354578834553`*^9},
 CellLabel->
  "Out[770]=",ExpressionUUID->"cb3523a2-b9bd-46af-8c2c-47fddb0df1a0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{GridBox[{
    {"\"\<1\>\"", "\[SpanFromLeft]", "\[SpanFromLeft]", "\"\<CKpqr\>\"", 
     "\"\<s\>\""},
    {"\"\<2\>\"", "\"\<a\>\"", "\[SpanFromLeft]", "\"\<p\>\"", "\"\<s\>\""},
    {"\"\<2\>\"", "\"\<b\>\"", "\[SpanFromLeft]", "\"\<CKqpr\>\"", 
     "\"\<1,R\>\""},
    {"\"\<2\>\"", "\"\<c\>\"", "\"\<1\>\"", "\"\<q\>\"", "\"\<s\>\""},
    {"\"\<2\>\"", "\"\<c\>\"", "\"\<2\>\"", "\"\<p\>\"", "\"\<a,R\>\""},
    {"\"\<2\>\"", "\"\<c\>\"", "\"\<3\>\"", "\"\<Kpq\>\"", "\"\<2,1,Ki\>\""},
    {"\"\<2\>\"", "\"\<c\>\"", "\"\<4\>\"", "\"\<CKpqr\>\"", "\"\<b,R\>\""},
    {"\"\<2\>\"", "\"\<c\>\"", "\"\<5\>\"", "\"\<r\>\"", "\"\<4,3,Co\>\""},
    {"\"\<2\>\"", "\"\<d\>\"", "\[SpanFromLeft]", "\"\<Cqr\>\"", 
     "\"\<c,Ci\>\""},
    {"\"\<3\>\"", "\[SpanFromLeft]", "\[SpanFromLeft]", "\"\<CpCqr\>\"", 
     "\"\<2,Ci\>\""}
   }], "//", 
  RowBox[{
   RowBox[{"Grid", "[", 
    RowBox[{"#", ",", 
     RowBox[{"Frame", "\[Rule]", "All"}], ",", 
     RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}], "&"}]}]], "Input",
 CellChangeTimes->{{3.550480251955636*^9, 3.550480471926218*^9}, {
  3.5504805057831545`*^9, 3.550480708572753*^9}, {3.55048094961454*^9, 
  3.550480956507935*^9}, {3.550481374523844*^9, 3.550481451158227*^9}, {
  3.550481482224004*^9, 3.550481521887272*^9}, {3.550481556888274*^9, 
  3.550481630401479*^9}},
 CellLabel->
  "In[771]:=",ExpressionUUID->"456c13b0-8c2c-4d73-8391-fe46cd0e4635"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"1\"\>", "\[SpanFromLeft]", 
     "\[SpanFromLeft]", "\<\"CKpqr\"\>", "\<\"s\"\>"},
    {"\<\"2\"\>", "\<\"a\"\>", "\[SpanFromLeft]", "\<\"p\"\>", "\<\"s\"\>"},
    {"\<\"2\"\>", "\<\"b\"\>", 
     "\[SpanFromLeft]", "\<\"CKqpr\"\>", "\<\"1,R\"\>"},
    {"\<\"2\"\>", "\<\"c\"\>", "\<\"1\"\>", "\<\"q\"\>", "\<\"s\"\>"},
    {"\<\"2\"\>", "\<\"c\"\>", "\<\"2\"\>", "\<\"p\"\>", "\<\"a,R\"\>"},
    {"\<\"2\"\>", "\<\"c\"\>", "\<\"3\"\>", "\<\"Kpq\"\>", "\<\"2,1,Ki\"\>"},
    {"\<\"2\"\>", "\<\"c\"\>", "\<\"4\"\>", "\<\"CKpqr\"\>", "\<\"b,R\"\>"},
    {"\<\"2\"\>", "\<\"c\"\>", "\<\"5\"\>", "\<\"r\"\>", "\<\"4,3,Co\"\>"},
    {"\<\"2\"\>", "\<\"d\"\>", 
     "\[SpanFromLeft]", "\<\"Cqr\"\>", "\<\"c,Ci\"\>"},
    {"\<\"3\"\>", "\[SpanFromLeft]", 
     "\[SpanFromLeft]", "\<\"CpCqr\"\>", "\<\"2,Ci\"\>"}
   },
   AutoDelete->False,
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{
  3.550710624371909*^9, 3.623890468217154*^9, 3.623890763951786*^9, 
   3.624409988500812*^9, 3.629583259788965*^9, 3.629584140892578*^9, 
   3.645653965316057*^9, 3.645656256500525*^9, 3.645749619378731*^9, 
   3.687638704350451*^9, 3.687638751816009*^9, 3.841155991204427*^9, 
   3.8411638591186237`*^9, 3.8411640323857613`*^9, 3.841164608255846*^9, 
   3.841166571649044*^9, 3.841166681363586*^9, 3.841166864285864*^9, 
   3.8411668980287523`*^9, 3.841220352094322*^9, 3.841230088887089*^9, 
   3.841230197766375*^9, 3.841248974817655*^9, 3.841249030388421*^9, 
   3.841249077552978*^9, 3.841318272963381*^9, 3.841322153492069*^9, 
   3.841322405590927*^9, 3.841324759774221*^9, 3.841324989543791*^9, 
   3.841332926093361*^9, 3.841350166564905*^9, 3.841352240701028*^9, 
   3.841392984214294*^9, 3.841403445450728*^9, {3.8414054588683357`*^9, 
   3.84140548060572*^9}, 3.841422368691348*^9, 3.911255354341579*^9, 
   3.911290462007345*^9, 3.912269985134699*^9, 3.912546353720103*^9, 
   3.9125890722665462`*^9, 3.912600351610815*^9, 3.912601706814536*^9, 
   3.915050871950143*^9, 3.9155354578917627`*^9},
 CellLabel->
  "Out[771]=",ExpressionUUID->"f2577a04-a5d6-47af-8cba-1e7b95d45d42"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{GridBox[{
    {"\"\<1\>\"", "\[SpanFromLeft]", "\[SpanFromLeft]", "\"\<CKpqr\>\"", 
     "\"\<s\>\""},
    {"\"\<2\>\"", "\"\<a\>\"", "\[SpanFromLeft]", "\"\<p\>\"", "\"\<s\>\""},
    {"\"\<\>\"", "\"\<b\>\"", "\[SpanFromLeft]", "\"\<CKqpr\>\"", 
     "\"\<1,R\>\""},
    {"\"\<\>\"", "\"\<c\>\"", "\"\<1\>\"", "\"\<q\>\"", "\"\<s\>\""},
    {"\"\<\>\"", "\"\<\>\"", "\"\<2\>\"", "\"\<p\>\"", "\"\<a,R\>\""},
    {"\"\<\>\"", "\"\<\>\"", "\"\<3\>\"", "\"\<Kpq\>\"", "\"\<2,1,Ki\>\""},
    {"\"\<\>\"", "\"\<\>\"", "\"\<4\>\"", "\"\<CKpqr\>\"", "\"\<b,R\>\""},
    {"\"\<\>\"", "\"\<\>\"", "\"\<5\>\"", "\"\<r\>\"", "\"\<4,3,Co\>\""},
    {"\"\<\>\"", "\"\<d\>\"", "\[SpanFromLeft]", "\"\<Cqr\>\"", 
     "\"\<c,Ci\>\""},
    {"\"\<3\>\"", "\[SpanFromLeft]", "\[SpanFromLeft]", "\"\<CpCqr\>\"", 
     "\"\<2,Ci\>\""}
   }], "//", 
  RowBox[{
   RowBox[{"Grid", "[", 
    RowBox[{"#", ",", 
     RowBox[{"Frame", "\[Rule]", "All"}], ",", 
     RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}], "&"}]}]], "Input",
 CellChangeTimes->{{3.550480251955636*^9, 3.550480471926218*^9}, {
  3.5504805057831545`*^9, 3.550480708572753*^9}, {3.55048094961454*^9, 
  3.550480956507935*^9}, {3.550481374523844*^9, 3.550481451158227*^9}, {
  3.550481482224004*^9, 3.550481521887272*^9}, {3.5504816526397505`*^9, 
  3.55048168759375*^9}},
 CellLabel->
  "In[772]:=",ExpressionUUID->"e096d739-e2e5-46ba-aa47-1dd6fae6a26b"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"1\"\>", "\[SpanFromLeft]", 
     "\[SpanFromLeft]", "\<\"CKpqr\"\>", "\<\"s\"\>"},
    {"\<\"2\"\>", "\<\"a\"\>", "\[SpanFromLeft]", "\<\"p\"\>", "\<\"s\"\>"},
    {"\<\"\"\>", "\<\"b\"\>", 
     "\[SpanFromLeft]", "\<\"CKqpr\"\>", "\<\"1,R\"\>"},
    {"\<\"\"\>", "\<\"c\"\>", "\<\"1\"\>", "\<\"q\"\>", "\<\"s\"\>"},
    {"\<\"\"\>", "\<\"\"\>", "\<\"2\"\>", "\<\"p\"\>", "\<\"a,R\"\>"},
    {"\<\"\"\>", "\<\"\"\>", "\<\"3\"\>", "\<\"Kpq\"\>", "\<\"2,1,Ki\"\>"},
    {"\<\"\"\>", "\<\"\"\>", "\<\"4\"\>", "\<\"CKpqr\"\>", "\<\"b,R\"\>"},
    {"\<\"\"\>", "\<\"\"\>", "\<\"5\"\>", "\<\"r\"\>", "\<\"4,3,Co\"\>"},
    {"\<\"\"\>", "\<\"d\"\>", 
     "\[SpanFromLeft]", "\<\"Cqr\"\>", "\<\"c,Ci\"\>"},
    {"\<\"3\"\>", "\[SpanFromLeft]", 
     "\[SpanFromLeft]", "\<\"CpCqr\"\>", "\<\"2,Ci\"\>"}
   },
   AutoDelete->False,
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{
  3.5504816888618226`*^9, 3.550710624430913*^9, {3.623890472038787*^9, 
   3.623890490318734*^9}, 3.623890764117673*^9, 3.624409988570921*^9, 
   3.629583259833848*^9, 3.629584140939415*^9, 3.6456539654066772`*^9, 
   3.645656256584427*^9, 3.645749619445162*^9, 3.687638704417659*^9, 
   3.68763875188233*^9, 3.841155992817721*^9, 3.841163859141137*^9, 
   3.84116403240571*^9, 3.841164608284013*^9, 3.841166571670764*^9, 
   3.841166681388604*^9, 3.841166864313884*^9, 3.8411668980532103`*^9, 
   3.84122035212402*^9, 3.841230088922374*^9, 3.841230197799788*^9, 
   3.84124897484334*^9, 3.841249030415224*^9, 3.841249077580924*^9, 
   3.841318272985332*^9, 3.841322153526235*^9, 3.841322405612869*^9, 
   3.841324759796832*^9, 3.841324989567964*^9, 3.841332926117397*^9, 
   3.841350166596879*^9, 3.841352240714077*^9, 3.841392984250037*^9, 
   3.841403445486677*^9, {3.8414054588999453`*^9, 3.841405480638381*^9}, 
   3.841422368717267*^9, 3.911255354347459*^9, 3.911290462017915*^9, 
   3.912269992923573*^9, 3.912546353723905*^9, 3.912589072270138*^9, 
   3.912600351617444*^9, 3.912601706821391*^9, 3.915050871954171*^9, 
   3.915535457895136*^9},
 CellLabel->
  "Out[772]=",ExpressionUUID->"64483dc9-f7b0-477f-8f1b-5f94d5149604"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"sa", "=", "SpanFromAbove"}], ";", 
  RowBox[{"sb", "=", "SpanFromBoth"}], ";"}]], "Input",
 CellChangeTimes->{{3.5504818212983975`*^9, 3.550481856580416*^9}},
 CellLabel->
  "In[773]:=",ExpressionUUID->"abd44feb-180a-4120-8291-eacfd0b4e5a2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{GridBox[{
    {"\"\<P1\>\"", "sl", "sl", "\"\<CpCqr\>\"", "\"\<CKpqr\>\""},
    {"sa", "sb", "sb", "sa", "sa"},
    {"\"\<1\>\"", "sl", "sl", "\"\<CKpqr\>\"", "\"\<s\>\""},
    {"\"\<2\>\"", "\"\<a\>\"", "sl", "\"\<p\>\"", "\"\<s\>\""},
    {"\"\<\>\"", "\"\<b\>\"", "sl", "\"\<CKqpr\>\"", "\"\<1,R\>\""},
    {"\"\<\>\"", "\"\<c\>\"", "\"\<1\>\"", "\"\<q\>\"", "\"\<s\>\""},
    {"\"\<\>\"", "\"\<\>\"", "\"\<2\>\"", "\"\<p\>\"", "\"\<a,R\>\""},
    {"\"\<\>\"", "\"\<\>\"", "\"\<3\>\"", "\"\<Kpq\>\"", "\"\<2,1,Ki\>\""},
    {"\"\<\>\"", "\"\<\>\"", "\"\<4\>\"", "\"\<CKpqr\>\"", "\"\<b,R\>\""},
    {"\"\<\>\"", "\"\<\>\"", "\"\<5\>\"", "\"\<r\>\"", "\"\<4,3,Co\>\""},
    {"\"\<\>\"", "\"\<d\>\"", "sl", "\"\<Cqr\>\"", "\"\<c,Ci\>\""},
    {"\"\<3\>\"", "sl", "sl", "\"\<CpCqr\>\"", "\"\<2,Ci\>\""}
   }], "//", 
  RowBox[{
   RowBox[{"Grid", "[", 
    RowBox[{"#", ",", 
     RowBox[{"Frame", "\[Rule]", "All"}], ",", 
     RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}], "&"}]}]], "Input",
 CellChangeTimes->{{3.550480251955636*^9, 3.550480471926218*^9}, {
  3.5504805057831545`*^9, 3.550480708572753*^9}, {3.55048094961454*^9, 
  3.550480956507935*^9}, {3.550481374523844*^9, 3.550481451158227*^9}, {
  3.550481482224004*^9, 3.550481521887272*^9}, {3.550481744320995*^9, 
  3.550481876512556*^9}},
 CellLabel->
  "In[774]:=",ExpressionUUID->"3cd9a13f-81de-48f3-8bf5-569677b1c352"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"P1\"\>", "\[SpanFromLeft]", 
     "\[SpanFromLeft]", "\<\"CpCqr\"\>", "\<\"CKpqr\"\>"},
    {"\[SpanFromAbove]", "\[SpanFromBoth]", "\[SpanFromBoth]", 
     "\[SpanFromAbove]", "\[SpanFromAbove]"},
    {"\<\"1\"\>", "\[SpanFromLeft]", 
     "\[SpanFromLeft]", "\<\"CKpqr\"\>", "\<\"s\"\>"},
    {"\<\"2\"\>", "\<\"a\"\>", "\[SpanFromLeft]", "\<\"p\"\>", "\<\"s\"\>"},
    {"\<\"\"\>", "\<\"b\"\>", 
     "\[SpanFromLeft]", "\<\"CKqpr\"\>", "\<\"1,R\"\>"},
    {"\<\"\"\>", "\<\"c\"\>", "\<\"1\"\>", "\<\"q\"\>", "\<\"s\"\>"},
    {"\<\"\"\>", "\<\"\"\>", "\<\"2\"\>", "\<\"p\"\>", "\<\"a,R\"\>"},
    {"\<\"\"\>", "\<\"\"\>", "\<\"3\"\>", "\<\"Kpq\"\>", "\<\"2,1,Ki\"\>"},
    {"\<\"\"\>", "\<\"\"\>", "\<\"4\"\>", "\<\"CKpqr\"\>", "\<\"b,R\"\>"},
    {"\<\"\"\>", "\<\"\"\>", "\<\"5\"\>", "\<\"r\"\>", "\<\"4,3,Co\"\>"},
    {"\<\"\"\>", "\<\"d\"\>", 
     "\[SpanFromLeft]", "\<\"Cqr\"\>", "\<\"c,Ci\"\>"},
    {"\<\"3\"\>", "\[SpanFromLeft]", 
     "\[SpanFromLeft]", "\<\"CpCqr\"\>", "\<\"2,Ci\"\>"}
   },
   AutoDelete->False,
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{
  3.550481320941779*^9, 3.5504814123800087`*^9, {3.550481443263775*^9, 
   3.550481452489303*^9}, {3.5504814832600627`*^9, 3.5504814901844587`*^9}, 
   3.550481523894387*^9, 3.550481798391088*^9, {3.550481838594387*^9, 
   3.5504818785606747`*^9}, 3.550710624485916*^9, 3.623890479207174*^9, 
   3.623890519368991*^9, 3.62389076426788*^9, 3.624409988657755*^9, 
   3.629583259946578*^9, 3.629584141014089*^9, 3.6456539655242033`*^9, 
   3.645656256704857*^9, 3.645749619523223*^9, 3.687638704495879*^9, 
   3.687638751972732*^9, 3.84115599719785*^9, 3.841163859171556*^9, 
   3.84116403243486*^9, 3.841164608322867*^9, 3.841166571701507*^9, 
   3.841166681423004*^9, 3.841166864351334*^9, 3.841166898085073*^9, 
   3.84122035217211*^9, 3.841230088973782*^9, 3.841230197844524*^9, 
   3.841248974880966*^9, 3.841249030454764*^9, 3.841249077611596*^9, 
   3.8413182730150423`*^9, 3.841322153563714*^9, 3.841322405643751*^9, 
   3.841324759829183*^9, 3.841324989601056*^9, 3.841332926148729*^9, 
   3.841350166639872*^9, 3.841352240757638*^9, 3.841392984290347*^9, 
   3.841403445538163*^9, {3.841405458948628*^9, 3.841405480693859*^9}, 
   3.841422368754491*^9, 3.9112553543623123`*^9, 3.9112904620286713`*^9, 
   3.912269999096765*^9, 3.912546353734054*^9, 3.91258907228265*^9, 
   3.912600351625594*^9, 3.912601706830756*^9, 3.915050871963366*^9, 
   3.915535457906996*^9},
 CellLabel->
  "Out[774]=",ExpressionUUID->"4fdb2e35-609b-40f2-8554-9a6b5c9a8eb8"]
}, Open  ]],

Cell["There\[CloseCurlyQuote]s the pattern I like best. ", "Text",
 CellChangeTimes->{{3.5504819134206667`*^9, 3.550481950140767*^9}, 
   3.8411560114213457`*^9, 
   3.9122700322605267`*^9},ExpressionUUID->"a843f954-f40b-4793-afc3-\
1bdba07be951"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["ALGEBRA-1 TRAVESTIES", "Title"]], "Chapter",
 CellChangeTimes->{{3.84158892646931*^9, 3.841588945971508*^9}, {
  3.841649285389276*^9, 3.8416492854606433`*^9}, {3.912270054619034*^9, 
  3.912270057291357*^9}},ExpressionUUID->"1cf83c4e-35a0-4ed6-bd9f-\
d4d82cff5000"],

Cell["\<\
This section is reproduced from an earlier notebook, and included here for \
completeness.\
\>", "Text",
 CellChangeTimes->{{3.915535559139883*^9, 
  3.915535576525278*^9}},ExpressionUUID->"7b1a639d-6065-4bd1-b8ba-\
2e35260044b2"],

Cell[TextData[{
 "Let\[CloseCurlyQuote]s generate travesties for expressions in basic \
algebra. Such travesties might serve us well for testing an expression \
parser. A generative grammar for the expressions is one of our PPFs, however. \
We don\[CloseCurlyQuote]t need ",
 StyleBox["any",
  FontSlant->"Italic"],
 " new machinery. This example works just as well as WFF-n-Proof."
}], "Text",
 CellChangeTimes->{{3.912270048388328*^9, 3.912270132087584*^9}, {
   3.912270279854889*^9, 3.912270305040903*^9}, 3.912601519189683*^9, 
   3.912601669083964*^9},ExpressionUUID->"c7afdeca-2126-423e-a96c-\
cf65625aa091"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "F", "]"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"for", " ", "\"\<Field\>\""}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"F", "[", "Expr", "]"}], "=", 
    RowBox[{"(", GridBox[{
       {"FSum"},
       {"FProd"},
       {"FVar"},
       {"FInt"}
      }], ")"}]}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "\"\<Sum\>\"", " ", "collides", " ", "with", " ", "a", " ", "built"}], 
    "-", 
    RowBox[{"in", "."}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"F", "[", "FSum", "]"}], "=", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"Plus", ",", "Expr", ",", "Expr"}], "}"}], "}"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Do", " ", "we", " ", "want", " ", "the", " ", "built"}], "-", 
    RowBox[{"in", " ", 
     RowBox[{"\"\<Plus\>\"", "?"}]}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"F", "[", "FInt", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"{", "RandomInteger", "}"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"F", "[", "FVar", "]"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"{", "a", "}"}], ",", 
      RowBox[{"{", "b", "}"}], ",", 
      RowBox[{"{", "c", "}"}], ",", 
      RowBox[{"{", "d", "}"}], ",", 
      RowBox[{"{", "e", "}"}], ",", 
      RowBox[{"{", "f", "}"}], ",", 
      RowBox[{"{", "g", "}"}], ",", 
      RowBox[{"{", "h", "}"}], ",", 
      RowBox[{"{", "i", "}"}], ",", 
      RowBox[{"{", "j", "}"}], ",", 
      RowBox[{"{", "k", "}"}], ",", 
      RowBox[{"{", "m", "}"}], ",", 
      RowBox[{"{", "n", "}"}], ","}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "x", "}"}], ",", 
     RowBox[{"{", "y", "}"}], ",", 
     RowBox[{"{", "z", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"-", "x"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"-", "y"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"-", "z"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", "/", "x"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", "/", "y"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", "/", "z"}], "}"}]}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{",", 
      RowBox[{"{", "u", "}"}], ",", 
      RowBox[{"{", "v", "}"}], ",", 
      RowBox[{"{", "w", "}"}], ",", 
      RowBox[{"{", "p", "}"}], ",", 
      RowBox[{"{", "q", "}"}], ",", 
      RowBox[{"{", "r", "}"}], ",", 
      RowBox[{"{", "s", "}"}], ",", 
      RowBox[{"{", "t", "}"}]}], "*)"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"F", "[", "FProd", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"Times", ",", "Expr", ",", "Expr"}], "}"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"F", "[", "Start", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"{", "Expr", "}"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.841588953003465*^9, 3.841589098700119*^9}, {
   3.841589140479911*^9, 3.841589271730172*^9}, {3.841594238177086*^9, 
   3.841594248303466*^9}, {3.841610302527225*^9, 3.841610323594833*^9}, {
   3.841610651673971*^9, 3.841610652322965*^9}, {3.84161072494884*^9, 
   3.841610768130988*^9}, {3.841610899684175*^9, 3.841610901772839*^9}, {
   3.841611688359497*^9, 3.841611727469092*^9}, {3.8416118634116497`*^9, 
   3.841611878441326*^9}, {3.841612978719796*^9, 3.841612986106964*^9}, {
   3.841613429100837*^9, 3.841613446325363*^9}, {3.8416135240078783`*^9, 
   3.841613538337714*^9}, {3.841648873841614*^9, 3.841648938402764*^9}, 
   3.841649020707903*^9, 3.841649112427002*^9},
 CellLabel->
  "In[775]:=",ExpressionUUID->"82afbe68-cfd3-4a0a-970f-2121f98c6b7d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "visGrammar", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"visGrammar", "[", "P_", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"d", "=", 
       RowBox[{"DownValues", "[", "P", "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Zip", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"hp", ",", 
          RowBox[{"hp", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}]}], "]"}], "/@", 
        RowBox[{"Unevaluated", "/@", "d"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"hp", ",", 
          RowBox[{"hp", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "]"}], "/@", "d"}], ",", 
       "Rule"}], "]"}]}], "]"}], "//", 
   StyleBox["gridRules",
    Background->RGBColor[1, 1, 0]]}]}]}], "Input",
 CellChangeTimes->{{3.912270224225655*^9, 3.912270248911523*^9}},
 CellLabel->
  "In[782]:=",ExpressionUUID->"baaf8c78-1560-4ba5-8fb3-c7dda29c644a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"visGrammar", "@", "F"}]], "Input",
 CellChangeTimes->{{3.841589276667752*^9, 3.841589281511119*^9}},
 CellLabel->
  "In[784]:=",ExpressionUUID->"8cccf803-e167-464f-b224-8c59cf1d9a2b"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[GridBox[{
        {
         StyleBox[
          StyleBox[
           TagBox[GridBox[{
              {"Expr"}
             },
             AutoDelete->False,
             GridBoxAlignment->{"Columns" -> {{Left}}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
            "Grid"],
           StripOnInput->False,
           FontWeight->Bold],
          StripOnInput->False,
          LineColor->GrayLevel[0],
          FrontFaceColor->GrayLevel[0],
          BackFaceColor->GrayLevel[0],
          GraphicsColor->GrayLevel[0],
          FontWeight->Bold,
          FontColor->GrayLevel[0]], 
         StyleBox[
          TagBox[GridBox[{
             {
              TagBox[GridBox[{
                 {
                  StyleBox[
                   TagBox[GridBox[{
                    {"FSum"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   FontWeight->Bold]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]},
             {
              TagBox[GridBox[{
                 {
                  StyleBox[
                   TagBox[GridBox[{
                    {"FProd"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   FontWeight->Bold]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]},
             {
              TagBox[GridBox[{
                 {
                  StyleBox[
                   TagBox[GridBox[{
                    {"FVar"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   FontWeight->Bold]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]},
             {
              TagBox[GridBox[{
                 {
                  StyleBox[
                   TagBox[GridBox[{
                    {"FInt"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   FontWeight->Bold]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]}
            },
            AutoDelete->False,
            FrameStyle->RGBColor[0, 
              Rational[2, 3], 0],
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxBackground->{"Columns" -> {{
                 RGBColor[0.88, 1, 0.88]}}},
            GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
           "Grid"],
          StripOnInput->False,
          LineColor->RGBColor[0, 0, 1],
          FrontFaceColor->RGBColor[0, 0, 1],
          BackFaceColor->RGBColor[0, 0, 1],
          GraphicsColor->RGBColor[0, 0, 1],
          FontWeight->Bold,
          FontColor->RGBColor[0, 0, 1]]},
        {
         StyleBox[
          StyleBox[
           TagBox[GridBox[{
              {"FInt"}
             },
             AutoDelete->False,
             GridBoxAlignment->{"Columns" -> {{Left}}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
            "Grid"],
           StripOnInput->False,
           FontWeight->Bold],
          StripOnInput->False,
          LineColor->GrayLevel[0],
          FrontFaceColor->GrayLevel[0],
          BackFaceColor->GrayLevel[0],
          GraphicsColor->GrayLevel[0],
          FontWeight->Bold,
          FontColor->GrayLevel[0]], 
         StyleBox[
          TagBox[GridBox[{
             {
              TagBox[GridBox[{
                 {
                  StyleBox[
                   TagBox[GridBox[{
                    {"RandomInteger"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   FontWeight->Bold]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]}
            },
            AutoDelete->False,
            FrameStyle->RGBColor[0, 
              Rational[2, 3], 0],
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxBackground->{"Columns" -> {{
                 RGBColor[0.88, 1, 0.88]}}},
            GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
           "Grid"],
          StripOnInput->False,
          LineColor->RGBColor[0, 0, 1],
          FrontFaceColor->RGBColor[0, 0, 1],
          BackFaceColor->RGBColor[0, 0, 1],
          GraphicsColor->RGBColor[0, 0, 1],
          FontWeight->Bold,
          FontColor->RGBColor[0, 0, 1]]},
        {
         StyleBox[
          StyleBox[
           TagBox[GridBox[{
              {"FProd"}
             },
             AutoDelete->False,
             GridBoxAlignment->{"Columns" -> {{Left}}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
            "Grid"],
           StripOnInput->False,
           FontWeight->Bold],
          StripOnInput->False,
          LineColor->GrayLevel[0],
          FrontFaceColor->GrayLevel[0],
          BackFaceColor->GrayLevel[0],
          GraphicsColor->GrayLevel[0],
          FontWeight->Bold,
          FontColor->GrayLevel[0]], 
         StyleBox[
          TagBox[GridBox[{
             {
              TagBox[GridBox[{
                 {
                  StyleBox[
                   TagBox[GridBox[{
                    {"Times"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   FontWeight->Bold]},
                 {
                  StyleBox[
                   TagBox[GridBox[{
                    {"Expr"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   FontWeight->Bold]},
                 {
                  StyleBox[
                   TagBox[GridBox[{
                    {"Expr"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   FontWeight->Bold]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]}
            },
            AutoDelete->False,
            FrameStyle->RGBColor[0, 
              Rational[2, 3], 0],
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxBackground->{"Columns" -> {{
                 RGBColor[0.88, 1, 0.88]}}},
            GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
           "Grid"],
          StripOnInput->False,
          LineColor->RGBColor[0, 0, 1],
          FrontFaceColor->RGBColor[0, 0, 1],
          BackFaceColor->RGBColor[0, 0, 1],
          GraphicsColor->RGBColor[0, 0, 1],
          FontWeight->Bold,
          FontColor->RGBColor[0, 0, 1]]},
        {
         StyleBox[
          StyleBox[
           TagBox[GridBox[{
              {"FSum"}
             },
             AutoDelete->False,
             GridBoxAlignment->{"Columns" -> {{Left}}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
            "Grid"],
           StripOnInput->False,
           FontWeight->Bold],
          StripOnInput->False,
          LineColor->GrayLevel[0],
          FrontFaceColor->GrayLevel[0],
          BackFaceColor->GrayLevel[0],
          GraphicsColor->GrayLevel[0],
          FontWeight->Bold,
          FontColor->GrayLevel[0]], 
         StyleBox[
          TagBox[GridBox[{
             {
              TagBox[GridBox[{
                 {
                  StyleBox[
                   TagBox[GridBox[{
                    {"Plus"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   FontWeight->Bold]},
                 {
                  StyleBox[
                   TagBox[GridBox[{
                    {"Expr"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   FontWeight->Bold]},
                 {
                  StyleBox[
                   TagBox[GridBox[{
                    {"Expr"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   FontWeight->Bold]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]}
            },
            AutoDelete->False,
            FrameStyle->RGBColor[0, 
              Rational[2, 3], 0],
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxBackground->{"Columns" -> {{
                 RGBColor[0.88, 1, 0.88]}}},
            GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
           "Grid"],
          StripOnInput->False,
          LineColor->RGBColor[0, 0, 1],
          FrontFaceColor->RGBColor[0, 0, 1],
          BackFaceColor->RGBColor[0, 0, 1],
          GraphicsColor->RGBColor[0, 0, 1],
          FontWeight->Bold,
          FontColor->RGBColor[0, 0, 1]]},
        {
         StyleBox[
          StyleBox[
           TagBox[GridBox[{
              {"FVar"}
             },
             AutoDelete->False,
             GridBoxAlignment->{"Columns" -> {{Left}}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
            "Grid"],
           StripOnInput->False,
           FontWeight->Bold],
          StripOnInput->False,
          LineColor->GrayLevel[0],
          FrontFaceColor->GrayLevel[0],
          BackFaceColor->GrayLevel[0],
          GraphicsColor->GrayLevel[0],
          FontWeight->Bold,
          FontColor->GrayLevel[0]], 
         StyleBox[
          TagBox[GridBox[{
             {
              TagBox[GridBox[{
                 {
                  StyleBox[
                   TagBox[GridBox[{
                    {"x"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   FontWeight->Bold]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]},
             {
              TagBox[GridBox[{
                 {
                  StyleBox[
                   TagBox[GridBox[{
                    {"y"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   FontWeight->Bold]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]},
             {
              TagBox[GridBox[{
                 {
                  StyleBox[
                   TagBox[GridBox[{
                    {"z"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   FontWeight->Bold]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]},
             {
              TagBox[GridBox[{
                 {
                  TagBox[GridBox[{
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"Times"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                    StripOnInput->False,
                    
                    LineColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                    
                    FrontFaceColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                    
                    BackFaceColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                    
                    GraphicsColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                    FontWeight->Bold,
                    
                    FontColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`]], 
                    StyleBox[
                    TagBox[GridBox[{
                    {
                    RowBox[{"-", "1"}]}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold], 
                    StyleBox[
                    TagBox[GridBox[{
                    {"x"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold]}
                    },
                    AutoDelete->False,
                    FrameStyle->GrayLevel[0],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[0.88, 1, 0.88]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                   "Grid"]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]},
             {
              TagBox[GridBox[{
                 {
                  TagBox[GridBox[{
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"Times"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                    StripOnInput->False,
                    
                    LineColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                    
                    FrontFaceColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                    
                    BackFaceColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                    
                    GraphicsColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                    FontWeight->Bold,
                    
                    FontColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`]], 
                    StyleBox[
                    TagBox[GridBox[{
                    {
                    RowBox[{"-", "1"}]}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold], 
                    StyleBox[
                    TagBox[GridBox[{
                    {"y"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold]}
                    },
                    AutoDelete->False,
                    FrameStyle->GrayLevel[0],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[0.88, 1, 0.88]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                   "Grid"]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]},
             {
              TagBox[GridBox[{
                 {
                  TagBox[GridBox[{
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"Times"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                    StripOnInput->False,
                    
                    LineColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                    
                    FrontFaceColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                    
                    BackFaceColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                    
                    GraphicsColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                    FontWeight->Bold,
                    
                    FontColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`]], 
                    StyleBox[
                    TagBox[GridBox[{
                    {
                    RowBox[{"-", "1"}]}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold], 
                    StyleBox[
                    TagBox[GridBox[{
                    {"z"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold]}
                    },
                    AutoDelete->False,
                    FrameStyle->GrayLevel[0],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[0.88, 1, 0.88]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                   "Grid"]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]},
             {
              TagBox[GridBox[{
                 {
                  TagBox[GridBox[{
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"Power"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                    StripOnInput->False,
                    
                    LineColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                    
                    FrontFaceColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                    
                    BackFaceColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                    
                    GraphicsColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                    FontWeight->Bold,
                    
                    FontColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`]], 
                    StyleBox[
                    TagBox[GridBox[{
                    {"x"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold], 
                    StyleBox[
                    TagBox[GridBox[{
                    {
                    RowBox[{"-", "1"}]}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold]}
                    },
                    AutoDelete->False,
                    FrameStyle->GrayLevel[0],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[0.88, 1, 0.88]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                   "Grid"]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]},
             {
              TagBox[GridBox[{
                 {
                  TagBox[GridBox[{
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"Power"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                    StripOnInput->False,
                    
                    LineColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                    
                    FrontFaceColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                    
                    BackFaceColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                    
                    GraphicsColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                    FontWeight->Bold,
                    
                    FontColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`]], 
                    StyleBox[
                    TagBox[GridBox[{
                    {"y"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold], 
                    StyleBox[
                    TagBox[GridBox[{
                    {
                    RowBox[{"-", "1"}]}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold]}
                    },
                    AutoDelete->False,
                    FrameStyle->GrayLevel[0],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[0.88, 1, 0.88]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                   "Grid"]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]},
             {
              TagBox[GridBox[{
                 {
                  TagBox[GridBox[{
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"Power"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                    StripOnInput->False,
                    
                    LineColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                    
                    FrontFaceColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                    
                    BackFaceColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                    
                    GraphicsColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                    FontWeight->Bold,
                    
                    FontColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`]], 
                    StyleBox[
                    TagBox[GridBox[{
                    {"z"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold], 
                    StyleBox[
                    TagBox[GridBox[{
                    {
                    RowBox[{"-", "1"}]}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold]}
                    },
                    AutoDelete->False,
                    FrameStyle->GrayLevel[0],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[0.88, 1, 0.88]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                   "Grid"]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]}
            },
            AutoDelete->False,
            FrameStyle->RGBColor[0, 
              Rational[2, 3], 0],
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxBackground->{"Columns" -> {{
                 RGBColor[0.88, 1, 0.88]}}},
            GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
           "Grid"],
          StripOnInput->False,
          LineColor->RGBColor[0, 0, 1],
          FrontFaceColor->RGBColor[0, 0, 1],
          BackFaceColor->RGBColor[0, 0, 1],
          GraphicsColor->RGBColor[0, 0, 1],
          FontWeight->Bold,
          FontColor->RGBColor[0, 0, 1]]},
        {
         StyleBox[
          StyleBox[
           TagBox[GridBox[{
              {"Start"}
             },
             AutoDelete->False,
             GridBoxAlignment->{"Columns" -> {{Left}}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
            "Grid"],
           StripOnInput->False,
           FontWeight->Bold],
          StripOnInput->False,
          LineColor->GrayLevel[0],
          FrontFaceColor->GrayLevel[0],
          BackFaceColor->GrayLevel[0],
          GraphicsColor->GrayLevel[0],
          FontWeight->Bold,
          FontColor->GrayLevel[0]], 
         StyleBox[
          TagBox[GridBox[{
             {
              TagBox[GridBox[{
                 {
                  StyleBox[
                   TagBox[GridBox[{
                    {"Expr"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   FontWeight->Bold]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]}
            },
            AutoDelete->False,
            FrameStyle->RGBColor[0, 
              Rational[2, 3], 0],
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxBackground->{"Columns" -> {{
                 RGBColor[0.88, 1, 0.88]}}},
            GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
           "Grid"],
          StripOnInput->False,
          LineColor->RGBColor[0, 0, 1],
          FrontFaceColor->RGBColor[0, 0, 1],
          BackFaceColor->RGBColor[0, 0, 1],
          GraphicsColor->RGBColor[0, 0, 1],
          FontWeight->Bold,
          FontColor->RGBColor[0, 0, 1]]}
       },
       AutoDelete->False,
       FrameStyle->RGBColor[0, 0, 1],
       GridBoxAlignment->{"Columns" -> {{Left}}},
       GridBoxBackground->{"Columns" -> {
           RGBColor[1, 0.9, 0.8], {
            RGBColor[1, 1, 0.85]}}},
       GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"]}
   },
   AutoDelete->False,
   FrameStyle->RGBColor[0, 
     Rational[2, 3], 0],
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxBackground->{"Columns" -> {{
        RGBColor[0.88, 1, 0.88]}}},
   GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{
  3.841589282150535*^9, 3.841594250955892*^9, 3.841610337137113*^9, 
   3.8416106570783653`*^9, {3.841610761221702*^9, 3.841610770710254*^9}, 
   3.8416108321417017`*^9, 3.841610903948602*^9, 3.841611739779383*^9, 
   3.841611883778592*^9, 3.841613448844514*^9, 3.841613541830069*^9, 
   3.841648941382194*^9, 3.841649023000456*^9, 3.841649119279957*^9, 
   3.84164929501953*^9, 3.911255354375679*^9, 3.911290462043993*^9, 
   3.912270143680207*^9, 3.912270252150092*^9, 3.9125463537689*^9, 
   3.912589072311239*^9, 3.912600351650508*^9, 3.912601706858264*^9, 
   3.915050871987711*^9, 3.915535457934102*^9},
 CellLabel->
  "Out[784]=",ExpressionUUID->"8ca3bbf5-2d66-42c7-8135-77e75d446335"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"FProbabilized", "=", 
    RowBox[{"injectGenerationProbabilities", "[", 
     RowBox[{"F", ",", "\[IndentingNewLine]", 
      RowBox[{"Function", "[", 
       RowBox[{"list", ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"list", "===", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "FSum", "}"}], ",", 
             RowBox[{"{", "FProd", "}"}]}], "}"}]}], ",", 
          RowBox[{"{", 
           RowBox[{".5", ",", ".5"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"equiProbabilities", "@", "list"}]}], "]"}]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], ")"}], "//", "visGrammar"}]], "Input",
 CellChangeTimes->{{3.841589297712808*^9, 3.841589309985021*^9}, {
  3.841589361306075*^9, 3.841589376191196*^9}, {3.841610416933027*^9, 
  3.841610563359454*^9}, {3.841610593958315*^9, 3.841610602809819*^9}, {
  3.841610672436894*^9, 3.841610681883857*^9}},
 CellLabel->
  "In[785]:=",ExpressionUUID->"143ee985-1f63-4f1c-940b-ab0888ca39cd"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[GridBox[{
        {
         StyleBox[
          StyleBox[
           TagBox[GridBox[{
              {"Expr"}
             },
             AutoDelete->False,
             GridBoxAlignment->{"Columns" -> {{Left}}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
            "Grid"],
           StripOnInput->False,
           FontWeight->Bold],
          StripOnInput->False,
          LineColor->GrayLevel[0],
          FrontFaceColor->GrayLevel[0],
          BackFaceColor->GrayLevel[0],
          GraphicsColor->GrayLevel[0],
          FontWeight->Bold,
          FontColor->GrayLevel[0]], 
         StyleBox[
          TagBox[GridBox[{
             {
              TagBox[GridBox[{
                 {
                  TagBox[GridBox[{
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"probability\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"0.25`"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]},
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"alternative\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    TagBox[GridBox[{
                    {
                    StyleBox[
                    TagBox[GridBox[{
                    {"FSum"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 
                    Rational[2, 3], 0],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 0, 1],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[1, 1, 0.85]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                   "Grid"]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]},
             {
              TagBox[GridBox[{
                 {
                  TagBox[GridBox[{
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"probability\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"0.25`"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]},
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"alternative\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    TagBox[GridBox[{
                    {
                    StyleBox[
                    TagBox[GridBox[{
                    {"FProd"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 
                    Rational[2, 3], 0],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 0, 1],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[1, 1, 0.85]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                   "Grid"]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]},
             {
              TagBox[GridBox[{
                 {
                  TagBox[GridBox[{
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"probability\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"0.25`"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]},
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"alternative\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    TagBox[GridBox[{
                    {
                    StyleBox[
                    TagBox[GridBox[{
                    {"FVar"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 
                    Rational[2, 3], 0],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 0, 1],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[1, 1, 0.85]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                   "Grid"]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]},
             {
              TagBox[GridBox[{
                 {
                  TagBox[GridBox[{
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"probability\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"0.25`"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]},
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"alternative\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    TagBox[GridBox[{
                    {
                    StyleBox[
                    TagBox[GridBox[{
                    {"FInt"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 
                    Rational[2, 3], 0],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 0, 1],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[1, 1, 0.85]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                   "Grid"]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]}
            },
            AutoDelete->False,
            FrameStyle->RGBColor[0, 
              Rational[2, 3], 0],
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxBackground->{"Columns" -> {{
                 RGBColor[0.88, 1, 0.88]}}},
            GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
           "Grid"],
          StripOnInput->False,
          LineColor->RGBColor[0, 0, 1],
          FrontFaceColor->RGBColor[0, 0, 1],
          BackFaceColor->RGBColor[0, 0, 1],
          GraphicsColor->RGBColor[0, 0, 1],
          FontWeight->Bold,
          FontColor->RGBColor[0, 0, 1]]},
        {
         StyleBox[
          StyleBox[
           TagBox[GridBox[{
              {"FInt"}
             },
             AutoDelete->False,
             GridBoxAlignment->{"Columns" -> {{Left}}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
            "Grid"],
           StripOnInput->False,
           FontWeight->Bold],
          StripOnInput->False,
          LineColor->GrayLevel[0],
          FrontFaceColor->GrayLevel[0],
          BackFaceColor->GrayLevel[0],
          GraphicsColor->GrayLevel[0],
          FontWeight->Bold,
          FontColor->GrayLevel[0]], 
         StyleBox[
          TagBox[GridBox[{
             {
              TagBox[GridBox[{
                 {
                  TagBox[GridBox[{
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"probability\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"1.`"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]},
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"alternative\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    TagBox[GridBox[{
                    {
                    StyleBox[
                    TagBox[GridBox[{
                    {"RandomInteger"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 
                    Rational[2, 3], 0],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 0, 1],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[1, 1, 0.85]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                   "Grid"]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]}
            },
            AutoDelete->False,
            FrameStyle->RGBColor[0, 
              Rational[2, 3], 0],
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxBackground->{"Columns" -> {{
                 RGBColor[0.88, 1, 0.88]}}},
            GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
           "Grid"],
          StripOnInput->False,
          LineColor->RGBColor[0, 0, 1],
          FrontFaceColor->RGBColor[0, 0, 1],
          BackFaceColor->RGBColor[0, 0, 1],
          GraphicsColor->RGBColor[0, 0, 1],
          FontWeight->Bold,
          FontColor->RGBColor[0, 0, 1]]},
        {
         StyleBox[
          StyleBox[
           TagBox[GridBox[{
              {"FProd"}
             },
             AutoDelete->False,
             GridBoxAlignment->{"Columns" -> {{Left}}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
            "Grid"],
           StripOnInput->False,
           FontWeight->Bold],
          StripOnInput->False,
          LineColor->GrayLevel[0],
          FrontFaceColor->GrayLevel[0],
          BackFaceColor->GrayLevel[0],
          GraphicsColor->GrayLevel[0],
          FontWeight->Bold,
          FontColor->GrayLevel[0]], 
         StyleBox[
          TagBox[GridBox[{
             {
              TagBox[GridBox[{
                 {
                  TagBox[GridBox[{
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"probability\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"1.`"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]},
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"alternative\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    TagBox[GridBox[{
                    {
                    StyleBox[
                    TagBox[GridBox[{
                    {"Times"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold]},
                    {
                    StyleBox[
                    TagBox[GridBox[{
                    {"Expr"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold]},
                    {
                    StyleBox[
                    TagBox[GridBox[{
                    {"Expr"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 
                    Rational[2, 3], 0],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 0, 1],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[1, 1, 0.85]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                   "Grid"]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]}
            },
            AutoDelete->False,
            FrameStyle->RGBColor[0, 
              Rational[2, 3], 0],
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxBackground->{"Columns" -> {{
                 RGBColor[0.88, 1, 0.88]}}},
            GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
           "Grid"],
          StripOnInput->False,
          LineColor->RGBColor[0, 0, 1],
          FrontFaceColor->RGBColor[0, 0, 1],
          BackFaceColor->RGBColor[0, 0, 1],
          GraphicsColor->RGBColor[0, 0, 1],
          FontWeight->Bold,
          FontColor->RGBColor[0, 0, 1]]},
        {
         StyleBox[
          StyleBox[
           TagBox[GridBox[{
              {"FSum"}
             },
             AutoDelete->False,
             GridBoxAlignment->{"Columns" -> {{Left}}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
            "Grid"],
           StripOnInput->False,
           FontWeight->Bold],
          StripOnInput->False,
          LineColor->GrayLevel[0],
          FrontFaceColor->GrayLevel[0],
          BackFaceColor->GrayLevel[0],
          GraphicsColor->GrayLevel[0],
          FontWeight->Bold,
          FontColor->GrayLevel[0]], 
         StyleBox[
          TagBox[GridBox[{
             {
              TagBox[GridBox[{
                 {
                  TagBox[GridBox[{
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"probability\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"1.`"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]},
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"alternative\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    TagBox[GridBox[{
                    {
                    StyleBox[
                    TagBox[GridBox[{
                    {"Plus"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold]},
                    {
                    StyleBox[
                    TagBox[GridBox[{
                    {"Expr"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold]},
                    {
                    StyleBox[
                    TagBox[GridBox[{
                    {"Expr"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 
                    Rational[2, 3], 0],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 0, 1],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[1, 1, 0.85]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                   "Grid"]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]}
            },
            AutoDelete->False,
            FrameStyle->RGBColor[0, 
              Rational[2, 3], 0],
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxBackground->{"Columns" -> {{
                 RGBColor[0.88, 1, 0.88]}}},
            GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
           "Grid"],
          StripOnInput->False,
          LineColor->RGBColor[0, 0, 1],
          FrontFaceColor->RGBColor[0, 0, 1],
          BackFaceColor->RGBColor[0, 0, 1],
          GraphicsColor->RGBColor[0, 0, 1],
          FontWeight->Bold,
          FontColor->RGBColor[0, 0, 1]]},
        {
         StyleBox[
          StyleBox[
           TagBox[GridBox[{
              {"FVar"}
             },
             AutoDelete->False,
             GridBoxAlignment->{"Columns" -> {{Left}}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
            "Grid"],
           StripOnInput->False,
           FontWeight->Bold],
          StripOnInput->False,
          LineColor->GrayLevel[0],
          FrontFaceColor->GrayLevel[0],
          BackFaceColor->GrayLevel[0],
          GraphicsColor->GrayLevel[0],
          FontWeight->Bold,
          FontColor->GrayLevel[0]], 
         StyleBox[
          TagBox[GridBox[{
             {
              TagBox[GridBox[{
                 {
                  TagBox[GridBox[{
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"probability\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"0.1111111111111111`"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]},
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"alternative\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    TagBox[GridBox[{
                    {
                    StyleBox[
                    TagBox[GridBox[{
                    {"x"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 
                    Rational[2, 3], 0],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 0, 1],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[1, 1, 0.85]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                   "Grid"]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]},
             {
              TagBox[GridBox[{
                 {
                  TagBox[GridBox[{
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"probability\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"0.1111111111111111`"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]},
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"alternative\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    TagBox[GridBox[{
                    {
                    StyleBox[
                    TagBox[GridBox[{
                    {"y"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 
                    Rational[2, 3], 0],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 0, 1],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[1, 1, 0.85]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                   "Grid"]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]},
             {
              TagBox[GridBox[{
                 {
                  TagBox[GridBox[{
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"probability\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"0.1111111111111111`"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]},
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"alternative\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    TagBox[GridBox[{
                    {
                    StyleBox[
                    TagBox[GridBox[{
                    {"z"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 
                    Rational[2, 3], 0],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 0, 1],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[1, 1, 0.85]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                   "Grid"]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]},
             {
              TagBox[GridBox[{
                 {
                  TagBox[GridBox[{
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"probability\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"0.1111111111111111`"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]},
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"alternative\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    TagBox[GridBox[{
                    {
                    TagBox[GridBox[{
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"Times"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                    StripOnInput->False,
                    
                    LineColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                    
                    FrontFaceColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                    
                    BackFaceColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                    
                    GraphicsColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                    FontWeight->Bold,
                    
                    FontColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`]], 
                    StyleBox[
                    TagBox[GridBox[{
                    {
                    RowBox[{"-", "1"}]}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold], 
                    StyleBox[
                    TagBox[GridBox[{
                    {"x"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold]}
                    },
                    AutoDelete->False,
                    FrameStyle->GrayLevel[0],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[0.88, 1, 0.88]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 
                    Rational[2, 3], 0],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 0, 1],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[1, 1, 0.85]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                   "Grid"]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]},
             {
              TagBox[GridBox[{
                 {
                  TagBox[GridBox[{
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"probability\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"0.1111111111111111`"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]},
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"alternative\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    TagBox[GridBox[{
                    {
                    TagBox[GridBox[{
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"Times"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                    StripOnInput->False,
                    
                    LineColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                    
                    FrontFaceColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                    
                    BackFaceColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                    
                    GraphicsColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                    FontWeight->Bold,
                    
                    FontColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`]], 
                    StyleBox[
                    TagBox[GridBox[{
                    {
                    RowBox[{"-", "1"}]}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold], 
                    StyleBox[
                    TagBox[GridBox[{
                    {"y"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold]}
                    },
                    AutoDelete->False,
                    FrameStyle->GrayLevel[0],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[0.88, 1, 0.88]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 
                    Rational[2, 3], 0],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 0, 1],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[1, 1, 0.85]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                   "Grid"]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]},
             {
              TagBox[GridBox[{
                 {
                  TagBox[GridBox[{
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"probability\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"0.1111111111111111`"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]},
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"alternative\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    TagBox[GridBox[{
                    {
                    TagBox[GridBox[{
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"Times"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                    StripOnInput->False,
                    
                    LineColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                    
                    FrontFaceColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                    
                    BackFaceColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                    
                    GraphicsColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                    FontWeight->Bold,
                    
                    FontColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`]], 
                    StyleBox[
                    TagBox[GridBox[{
                    {
                    RowBox[{"-", "1"}]}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold], 
                    StyleBox[
                    TagBox[GridBox[{
                    {"z"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold]}
                    },
                    AutoDelete->False,
                    FrameStyle->GrayLevel[0],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[0.88, 1, 0.88]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 
                    Rational[2, 3], 0],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 0, 1],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[1, 1, 0.85]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                   "Grid"]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]},
             {
              TagBox[GridBox[{
                 {
                  TagBox[GridBox[{
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"probability\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"0.1111111111111111`"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]},
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"alternative\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    TagBox[GridBox[{
                    {
                    TagBox[GridBox[{
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"Power"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                    StripOnInput->False,
                    
                    LineColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                    
                    FrontFaceColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                    
                    BackFaceColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                    
                    GraphicsColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                    FontWeight->Bold,
                    
                    FontColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`]], 
                    StyleBox[
                    TagBox[GridBox[{
                    {"x"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold], 
                    StyleBox[
                    TagBox[GridBox[{
                    {
                    RowBox[{"-", "1"}]}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold]}
                    },
                    AutoDelete->False,
                    FrameStyle->GrayLevel[0],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[0.88, 1, 0.88]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 
                    Rational[2, 3], 0],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 0, 1],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[1, 1, 0.85]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                   "Grid"]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]},
             {
              TagBox[GridBox[{
                 {
                  TagBox[GridBox[{
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"probability\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"0.1111111111111111`"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]},
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"alternative\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    TagBox[GridBox[{
                    {
                    TagBox[GridBox[{
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"Power"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                    StripOnInput->False,
                    
                    LineColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                    
                    FrontFaceColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                    
                    BackFaceColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                    
                    GraphicsColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                    FontWeight->Bold,
                    
                    FontColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`]], 
                    StyleBox[
                    TagBox[GridBox[{
                    {"y"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold], 
                    StyleBox[
                    TagBox[GridBox[{
                    {
                    RowBox[{"-", "1"}]}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold]}
                    },
                    AutoDelete->False,
                    FrameStyle->GrayLevel[0],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[0.88, 1, 0.88]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 
                    Rational[2, 3], 0],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 0, 1],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[1, 1, 0.85]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                   "Grid"]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]},
             {
              TagBox[GridBox[{
                 {
                  TagBox[GridBox[{
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"probability\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"0.1111111111111111`"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]},
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"alternative\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    TagBox[GridBox[{
                    {
                    TagBox[GridBox[{
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"Power"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                    StripOnInput->False,
                    
                    LineColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                    
                    FrontFaceColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                    
                    BackFaceColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                    
                    GraphicsColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`],
                    FontWeight->Bold,
                    
                    FontColor->RGBColor[
                    0.33333333333333337`, 0, 0.33333333333333337`]], 
                    StyleBox[
                    TagBox[GridBox[{
                    {"z"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold], 
                    StyleBox[
                    TagBox[GridBox[{
                    {
                    RowBox[{"-", "1"}]}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold]}
                    },
                    AutoDelete->False,
                    FrameStyle->GrayLevel[0],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[0.88, 1, 0.88]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 
                    Rational[2, 3], 0],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 0, 1],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[1, 1, 0.85]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                   "Grid"]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]}
            },
            AutoDelete->False,
            FrameStyle->RGBColor[0, 
              Rational[2, 3], 0],
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxBackground->{"Columns" -> {{
                 RGBColor[0.88, 1, 0.88]}}},
            GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
           "Grid"],
          StripOnInput->False,
          LineColor->RGBColor[0, 0, 1],
          FrontFaceColor->RGBColor[0, 0, 1],
          BackFaceColor->RGBColor[0, 0, 1],
          GraphicsColor->RGBColor[0, 0, 1],
          FontWeight->Bold,
          FontColor->RGBColor[0, 0, 1]]},
        {
         StyleBox[
          StyleBox[
           TagBox[GridBox[{
              {"Start"}
             },
             AutoDelete->False,
             GridBoxAlignment->{"Columns" -> {{Left}}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
            "Grid"],
           StripOnInput->False,
           FontWeight->Bold],
          StripOnInput->False,
          LineColor->GrayLevel[0],
          FrontFaceColor->GrayLevel[0],
          BackFaceColor->GrayLevel[0],
          GraphicsColor->GrayLevel[0],
          FontWeight->Bold,
          FontColor->GrayLevel[0]], 
         StyleBox[
          TagBox[GridBox[{
             {
              TagBox[GridBox[{
                 {
                  TagBox[GridBox[{
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"probability\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"1.`"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]},
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"alternative\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    TagBox[GridBox[{
                    {
                    StyleBox[
                    TagBox[GridBox[{
                    {"Expr"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 
                    Rational[2, 3], 0],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 0, 1],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[1, 1, 0.85]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                   "Grid"]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]}
            },
            AutoDelete->False,
            FrameStyle->RGBColor[0, 
              Rational[2, 3], 0],
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxBackground->{"Columns" -> {{
                 RGBColor[0.88, 1, 0.88]}}},
            GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
           "Grid"],
          StripOnInput->False,
          LineColor->RGBColor[0, 0, 1],
          FrontFaceColor->RGBColor[0, 0, 1],
          BackFaceColor->RGBColor[0, 0, 1],
          GraphicsColor->RGBColor[0, 0, 1],
          FontWeight->Bold,
          FontColor->RGBColor[0, 0, 1]]}
       },
       AutoDelete->False,
       FrameStyle->RGBColor[0, 0, 1],
       GridBoxAlignment->{"Columns" -> {{Left}}},
       GridBoxBackground->{"Columns" -> {
           RGBColor[1, 0.9, 0.8], {
            RGBColor[1, 1, 0.85]}}},
       GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"]}
   },
   AutoDelete->False,
   FrameStyle->RGBColor[0, 
     Rational[2, 3], 0],
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxBackground->{"Columns" -> {{
        RGBColor[0.88, 1, 0.88]}}},
   GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{
  3.841589377243457*^9, 3.84159425312426*^9, 3.841610339855221*^9, {
   3.841610515522459*^9, 3.8416105339115562`*^9}, 3.841610563973853*^9, 
   3.8416106036130123`*^9, 3.841610682633684*^9, 3.841610772888218*^9, 
   3.841610834412057*^9, 3.841610905543607*^9, 3.841611742252201*^9, 
   3.84161188674209*^9, 3.841613459398864*^9, 3.841613543552095*^9, 
   3.8416489520874557`*^9, 3.841649025052789*^9, 3.841649119367338*^9, 
   3.841649295083746*^9, 3.911255354387924*^9, 3.911290462047607*^9, 
   3.912270264130992*^9, 3.9125463538104467`*^9, 3.912589072342759*^9, 
   3.912600351681735*^9, 3.91260170688864*^9, 3.915050872020705*^9, 
   3.915535457966116*^9},
 CellLabel->
  "Out[785]=",ExpressionUUID->"1c868cf1-bc19-4028-abf7-0afdcf278e2f"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "$exprTable", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"parserPatterns", "[", 
   RowBox[{"F", ",", "$exprTable"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.841610968890296*^9, 3.841610996555987*^9}},
 CellLabel->
  "In[786]:=",ExpressionUUID->"e7e77504-70bf-4b1d-9fbd-685aa440462a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"SeedRandom", "[", "42", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"gengen", "=", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"generateSentence", "[", 
          RowBox[{"FProbabilized", ",", "FVar", ",", 
           RowBox[{"terminalsFromGrammar", "@", "F"}], ",", "10"}], "]"}], "//",
          "InputForm"}], ")"}], ")"}], "&"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"DynamicModule", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"foo", "=", 
       RowBox[{"gengen", "[", "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Manipulate", "[", 
      RowBox[{"foo", ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<GEN\>\"", ",", 
         RowBox[{"foo", "=", 
          RowBox[{"gengen", "[", "]"}]}]}], "]"}]}], "]"}]}], "]"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.84158939501011*^9, 3.8415894024582977`*^9}, {
  3.841594148962861*^9, 3.841594201482233*^9}, {3.841611020731133*^9, 
  3.841611156617223*^9}, {3.841611192979441*^9, 3.8416112669822*^9}, {
  3.84161179155472*^9, 3.841611837320256*^9}, {3.841611904837119*^9, 
  3.841611911905628*^9}, {3.911292214616894*^9, 3.91129228633438*^9}, {
  3.911292382564924*^9, 3.911292394126382*^9}},
 CellLabel->
  "In[788]:=",ExpressionUUID->"a67a97fb-6326-49f5-977e-7cc57bfa74e0"],

Cell[BoxData[
 DynamicModuleBox[{$CellContext`foo$$ = 
  InputForm[{
   Times, Times, Times, $CellContext`y, $CellContext`z, 
    RandomInteger, $CellContext`x^(-1)}]}, 
  TagBox[
   StyleBox[
    DynamicModuleBox[{Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
     Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
     1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{
       Hold[
        Button["GEN", $CellContext`foo$$ = (InputForm[
           $CellContext`generateSentence[$CellContext`FProbabilized, \
$CellContext`FVar, 
            $CellContext`terminalsFromGrammar[$CellContext`F], 10]]& )[]]], 
       Manipulate`Dump`ThisIsNotAControl, ControlType -> None}}, 
     Typeset`size$$ = {598., {4.368, 13.962}}, Typeset`update$$ = 0, 
     Typeset`initDone$$, Typeset`skipInitDone$$ = True}, 
     DynamicBox[Manipulate`ManipulateBoxes[
      1, StandardForm, "Variables" :> {}, "ControllerVariables" :> {}, 
       "OtherVariables" :> {
        Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
         Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
         Typeset`specs$$, Typeset`size$$, Typeset`update$$, 
         Typeset`initDone$$, Typeset`skipInitDone$$}, 
       "Body" :> $CellContext`foo$$, "Specifications" :> {
         Button["GEN", $CellContext`foo$$ = (InputForm[
            $CellContext`generateSentence[$CellContext`FProbabilized, \
$CellContext`FVar, 
             $CellContext`terminalsFromGrammar[$CellContext`F], 10]]& )[]]}, 
       "Options" :> {}, "DefaultOptions" :> {}],
      ImageSizeCache->{664., {78., 86.}},
      SingleEvaluation->True],
     Deinitialization:>None,
     DynamicModuleValues:>{},
     SynchronousInitialization->True,
     UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
     UnsavedVariables:>{Typeset`initDone$$},
     UntrackedVariables:>{Typeset`size$$}], "Manipulate",
    Deployed->True,
    StripOnInput->False],
   Manipulate`InterpretManipulate[1]],
  DynamicModuleValues:>{}]], "Output",
 CellChangeTimes->{{3.911292264645137*^9, 3.911292286879225*^9}, 
   3.912270314485525*^9, 3.9125463538275337`*^9, 3.912589072362842*^9, 
   3.912600351696262*^9, 3.912601706901233*^9, 3.915050872033784*^9, 
   3.915535457979843*^9},
 CellLabel->
  "Out[789]=",ExpressionUUID->"5edf7bde-fb8b-48f8-bf77-701cd5e0606c"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "$fexpr", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$fexpr", "[", 
   RowBox[{"dummy_", ",", 
    RowBox[{"depth_", ":", "20"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"sen", "=", 
      RowBox[{"generateSentence", "[", "\[IndentingNewLine]", 
       RowBox[{"FProbabilized", ",", "FVar", ",", 
        RowBox[{"terminalsFromGrammar", "@", "F"}], ",", "depth"}], "]"}]}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"parse", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"$exprTable", "@", "sen"}], ")"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"interp", "=", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"FInt", "[", "RandomInteger", "]"}], "\[RuleDelayed]", 
             RowBox[{"RandomInteger", "[", "10", "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"FVar", "\[Rule]", "Identity"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"FSum", "|", "FProd"}], ")"}], "[", 
              RowBox[{"f_", ",", "args__"}], "]"}], "\[RuleDelayed]", 
             RowBox[{"Apply", "[", 
              RowBox[{"f", ",", 
               RowBox[{"{", "args", "}"}]}], "]"}]}]}], "}"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"TreeForm", "[", 
           RowBox[{"parse", ",", 
            RowBox[{"VertexLabeling", "\[Rule]", "Automatic"}]}], "]"}], ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"parse", "//.", "interp"}], "//", "FullSimplify"}], 
           ")"}]}], "}"}]}], "]"}]}], "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8416495566650953`*^9, 3.841649609862783*^9}, {
  3.841649645100088*^9, 3.8416496475721607`*^9}, {3.841649690910379*^9, 
  3.841649715686039*^9}, {3.84167658476176*^9, 3.841676597245163*^9}, {
  3.84167679519763*^9, 3.841676849917198*^9}, {3.841677007447156*^9, 
  3.841677055317708*^9}},
 CellLabel->
  "In[790]:=",ExpressionUUID->"763d4777-830e-4997-ac56-ab4dde17d4a1"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$fcontender", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Animate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"t", ",", "e"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"t", ",", "e"}], "}"}], "=", 
       RowBox[{"$fexpr", "[", "dummy", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"le", "=", 
          RowBox[{"LeafCount", "[", "e", "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"le", ">", 
            RowBox[{"LeafCount", "@", "$fcontender"}]}], ",", 
           RowBox[{"$fcontender", "=", "e"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Grid", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"e", ",", "SpanFromLeft"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"le", ",", "t"}], "}"}]}], "}"}], ",", 
           RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}]}]}], "]"}]}]}], "]"}],
    ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"dummy", ",", "1", ",", "25", ",", "1"}], "}"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.841649627755375*^9, 3.841649665787197*^9}, {
   3.841649720061504*^9, 3.841649775873583*^9}, {3.841649823403294*^9, 
   3.84164991173984*^9}, 3.8416764826378727`*^9, {3.841676515492391*^9, 
   3.84167654967482*^9}, {3.841676603830494*^9, 3.841676634882786*^9}, {
   3.841676869161889*^9, 3.841676944303242*^9}, {3.841677068645981*^9, 
   3.8416770773825912`*^9}},
 CellLabel->
  "In[792]:=",ExpressionUUID->"b710322f-65df-42c5-bbdf-5917777e52e6"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`dummy$$ = 6, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`dummy$$], 1, 25, 1, ControlType -> Animator}}, 
    Typeset`size$$ = {304., {105.7010498046875, 114.2989501953125}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = True}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`dummy$$ = 1}, 
      "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`t$, $CellContext`e$}, {$CellContext`t$, \
$CellContext`e$} = $CellContext`$fexpr[$CellContext`dummy$$]; 
        With[{$CellContext`le$ = LeafCount[$CellContext`e$]}, 
          If[$CellContext`le$ > 
            LeafCount[$CellContext`$fcontender], $CellContext`$fcontender = \
$CellContext`e$]; 
          Grid[{{$CellContext`e$, 
              SpanFromLeft}, {$CellContext`le$, $CellContext`t$}}, Frame -> 
            All]]], "Specifications" :> {{$CellContext`dummy$$, 1, 25, 1, 
         AppearanceElements -> {
          "ProgressSlider", "PlayPauseButton", "FasterSlowerButtons", 
           "DirectionButton"}}}, 
      "Options" :> {
       ControlType -> Animator, AppearanceElements -> None, DefaultBaseStyle -> 
        "Animate", DefaultLabelStyle -> "AnimateLabel", SynchronousUpdating -> 
        True, ShrinkingDelay -> 10.}, "DefaultOptions" :> {}],
     ImageSizeCache->{422., {225., 233.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Animate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.841676895906672*^9, 3.841676945214694*^9}, {
   3.841677069509021*^9, 3.841677078342742*^9}, 3.9112553544778767`*^9, 
   3.911290462090029*^9, 3.912270332918221*^9, 3.912546353865942*^9, 
   3.91258907239635*^9, 3.912600351740932*^9, 3.912601706935971*^9, 
   3.9150508720604153`*^9, 3.915535458008246*^9},
 CellLabel->
  "Out[793]=",ExpressionUUID->"cfde2fbf-94b8-470a-af46-dd683f4641f1"]
}, Open  ]],

Cell["Biggest one found so far:", "Text",
 CellChangeTimes->{{3.911292311072605*^9, 
  3.911292316553551*^9}},ExpressionUUID->"c24aee65-aa09-4dfb-a78e-\
a25e89eab448"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dynamic", "[", 
  RowBox[{"$fcontender", "//", "FullSimplify"}], "]"}]], "Input",
 CellChangeTimes->{{3.841676962146185*^9, 3.841676988293538*^9}, {
  3.9125890934095173`*^9, 3.912589097539546*^9}},
 CellLabel->
  "In[794]:=",ExpressionUUID->"8f3a2375-99a9-4809-b005-8de4b66526d1"],

Cell[BoxData[
 DynamicBox[ToBoxes[
   FullSimplify[$CellContext`$fcontender], StandardForm],
  ImageSizeCache->{628., {19., 26.}}]], "Output",
 CellChangeTimes->{{3.841676972884017*^9, 3.841676989603538*^9}, 
   3.91125535450912*^9, 3.911290462133687*^9, 3.912270341421717*^9, 
   3.912546353921135*^9, 3.912589072421498*^9, 3.912600351776484*^9, 
   3.912601706967447*^9, 3.9150508720770063`*^9, 3.9155354580281677`*^9},
 CellLabel->
  "Out[794]=",ExpressionUUID->"d36d1ebb-9c83-41c3-ba25-3166e8a7bf0c"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["BENPIERCE TYPES", "Title",
 CellChangeTimes->{{3.841316897854531*^9, 3.841316907672625*^9}, 
   3.91553548468435*^9},ExpressionUUID->"ddacce19-fbd6-4069-97b5-\
9322a4d7cb10"],

Cell[TextData[{
 "Encode types from Benjamin C. Pierce\[CloseCurlyQuote]s book, ",
 StyleBox["TPL",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 " or \[OpenCurlyDoubleQuote]Types and Programming Languages.\
\[CloseCurlyDoubleQuote]"
}], "Text",
 CellChangeTimes->{{3.841316916564916*^9, 3.841316920659149*^9}, {
   3.84131732214131*^9, 3.841317355927084*^9}, {3.84131753977252*^9, 
   3.841317592084487*^9}, {3.841405537123185*^9, 3.8414055623041368`*^9}, 
   3.841405843408556*^9, {3.841407562929226*^9, 
   3.8414075646522617`*^9}},ExpressionUUID->"bf26fa1c-55a1-4749-a5f8-\
4a4d236f6fbd"],

Cell["\<\
Call the grammar \[OpenCurlyDoubleQuote]BPT,\[CloseCurlyDoubleQuote] for \
\[OpenCurlyDoubleQuote]Ben Pierce Terms,\[CloseCurlyDoubleQuote] from Section \
3.1 of his book. It has ONE non-terminal symbol. He calls it \
\[OpenCurlyDoubleQuote]t.\[CloseCurlyDoubleQuote] That\[CloseCurlyQuote]s too \
small for us. We\[CloseCurlyQuote]ll call it \[OpenCurlyDoubleQuote]Term.\
\[CloseCurlyDoubleQuote] \
\>", "Text",
 CellChangeTimes->{{3.841317618296572*^9, 3.841317646746964*^9}, {
   3.841317696456557*^9, 3.841317724793794*^9}, {3.841317972302861*^9, 
   3.841317984922075*^9}, {3.8413188645994587`*^9, 3.841318891085887*^9}, {
   3.841397019210371*^9, 3.8413970216846046`*^9}, 
   3.841406672651697*^9},ExpressionUUID->"3c195400-a6e2-41f9-9af8-\
62bb8ad853b8"],

Cell[CellGroupData[{

Cell["UNTYPED UTTERANCES", "Section",
 CellChangeTimes->{{3.841407362305547*^9, 
  3.841407368642789*^9}},ExpressionUUID->"33d5a204-314b-4864-b459-\
da23156e9b34"],

Cell["Consistent with Sections 3.2 and 4.1 of TPL.", "Text",
 CellChangeTimes->{{3.841407553510625*^9, 3.8414075774833403`*^9}, {
  3.841407743380055*^9, 3.8414077435735397`*^9}, {3.841427397712925*^9, 
  3.841427404136425*^9}},ExpressionUUID->"941aea95-1173-4764-9e13-\
40097f32d1f2"],

Cell[TextData[{
 "BP\[CloseCurlyQuote]s Ternary ",
 StyleBox["if foo then bar else baz", "Code"],
 " is not in Polish prefix form. Prefix form would be ",
 StyleBox["if foo bar baz", "Code"],
 ", much easier to parse with our nearly-trivial tools. Go there, because the \
point of this exercise is not to spend time on parsing, but to spend time on \
types."
}], "Text",
 CellChangeTimes->{{3.841397023701436*^9, 3.841397056892645*^9}, {
  3.841397134534784*^9, 3.841397308171818*^9}, {3.841406680062207*^9, 
  3.841406702484179*^9}},ExpressionUUID->"c3a6d848-13d4-4706-bb25-\
eddb9456f818"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "BPT", ",", "Term", ",", "Ternary", ",", "Unary", ",", "BPTtokens"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BPT", "[", "Term", "]"}], "=", 
   RowBox[{"(", GridBox[{
      {"Const"},
      {"Ternary"},
      {"Unary"}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BPT", "[", "Const", "]"}], "=", 
    RowBox[{"(", GridBox[{
       {"\"\<true\>\""},
       {"\"\<false\>\""},
       {"\"\<0\>\""}
      }], ")"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"groundTerm", " ", "for", " ", "travesties"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "incovenient", " ", "to", " ", "parse", " ", "with", " ", "present", " ", 
    "tools"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"BPT", "[", "Ternary", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
       "\"\<if\>\"", ",", "Term", ",", "\"\<then\>\"", ",", "Term", ",", 
        "\"\<else\>\"", ",", "Term"}], "}"}], "}"}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BPT", "[", "Ternary", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"\"\<if\>\"", ",", " ", "Term", ",", " ", "Term", ",", "Term"}], 
     "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BPT", "[", "Unary", "]"}], "=", 
   RowBox[{"(", GridBox[{
      {"\"\<succ\>\"", "Term"},
      {"\"\<pred\>\"", "Term"},
      {"\"\<iszero\>\"", "Term"}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BPT", "[", "Start", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"{", "Term", "}"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.841317604927966*^9, 3.841317614216979*^9}, {
  3.8413176509631357`*^9, 3.841317653304769*^9}, {3.841317729768515*^9, 
  3.841317910043915*^9}, {3.841318092270409*^9, 3.841318132147271*^9}, {
  3.841318536196734*^9, 3.841318582200479*^9}, {3.841318907534176*^9, 
  3.841319065316422*^9}, {3.84132773334143*^9, 3.841327783544856*^9}, {
  3.841331462586055*^9, 3.841331469338426*^9}, {3.841397317344038*^9, 
  3.841397369416971*^9}, {3.841398390447437*^9, 3.841398394269914*^9}},
 CellLabel->
  "In[795]:=",ExpressionUUID->"dc6189f6-8e02-4ba3-8945-1bb4c56a8207"],

Cell["from Section 4.1:", "Text",
 CellChangeTimes->{{3.841427511139881*^9, 
  3.841427523583183*^9}},ExpressionUUID->"8fc9ef42-ab8b-4a6f-a7e2-\
34ec2d28bd8b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "isnumerical", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"isnumerical", "[", 
    RowBox[{"Const", "[", "\"\<0\>\"", "]"}], "]"}], ":=", "True"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"isnumerical", "[", 
    RowBox[{"Unary", "[", 
     RowBox[{"\"\<succ\>\"", ",", "t1_"}], "]"}], "]"}], ":=", 
   RowBox[{"isnumerical", "@", "t1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"isnumerical", "[", "_", "]"}], ":=", "False"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "isval", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"isval", "[", 
    RowBox[{"Const", "[", "\"\<true\>\"", "]"}], "]"}], ":=", "True"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"isval", "[", 
    RowBox[{"Const", "[", "\"\<false\>\"", "]"}], "]"}], ":=", "True"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"isval", "[", 
     RowBox[{"t_", "?", "isnumerical"}], "]"}], ":=", "True"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"isval", "[", 
  RowBox[{"Const", "[", "\"\<0\>\"", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.841427530862936*^9, 3.841427693782651*^9}, {
  3.841427762360045*^9, 3.841427903095656*^9}, {3.84142818740107*^9, 
  3.841428221031217*^9}},
 CellLabel->
  "In[801]:=",ExpressionUUID->"96deaf1f-2131-4d32-beee-ea4641fe5439"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.841428216665765*^9, 3.841428222026675*^9}, 
   3.911255354557407*^9, 3.9112904621691303`*^9, 3.912270603826025*^9, 
   3.9125463539424543`*^9, 3.912589072427124*^9, 3.912600351805922*^9, 
   3.912601706994259*^9, 3.915050872086325*^9, 3.9155354580419073`*^9},
 CellLabel->
  "Out[809]=",ExpressionUUID->"40ddd2c2-b99f-4f0c-95db-3f3a2cd9283b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "visGrammar", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"visGrammar", "[", "g_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"d", "=", 
        RowBox[{"DownValues", "[", "g", "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Zip", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{"hp", ",", 
           RowBox[{"hp", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}]}], "]"}], "/@", 
         RowBox[{"Unevaluated", "/@", "d"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{"hp", ",", 
           RowBox[{"hp", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "]"}], "/@", "d"}], ",",
         "Rule"}], "]"}]}], "]"}], "//", "gridRules"}]}], ";"}], "\n", 
 RowBox[{"visGrammar", "[", "BPT", "]"}]}], "Input",
 CellChangeTimes->{{3.8413186309311037`*^9, 3.8413186901554623`*^9}, 
   3.841331488656875*^9},
 CellLabel->
  "In[810]:=",ExpressionUUID->"90afcd9a-6840-4bc1-a9ce-48da59c74132"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[GridBox[{
        {
         StyleBox[
          StyleBox[
           TagBox[GridBox[{
              {"Const"}
             },
             AutoDelete->False,
             GridBoxAlignment->{"Columns" -> {{Left}}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
            "Grid"],
           StripOnInput->False,
           FontWeight->Bold],
          StripOnInput->False,
          LineColor->GrayLevel[0],
          FrontFaceColor->GrayLevel[0],
          BackFaceColor->GrayLevel[0],
          GraphicsColor->GrayLevel[0],
          FontWeight->Bold,
          FontColor->GrayLevel[0]], 
         StyleBox[
          TagBox[GridBox[{
             {
              TagBox[GridBox[{
                 {
                  StyleBox[
                   TagBox[GridBox[{
                    {"\<\"true\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                   FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                   BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                   GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                   FontWeight->Bold,
                   FontColor->RGBColor[
                    Rational[2, 3], 0, 0]]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]},
             {
              TagBox[GridBox[{
                 {
                  StyleBox[
                   TagBox[GridBox[{
                    {"\<\"false\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                   FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                   BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                   GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                   FontWeight->Bold,
                   FontColor->RGBColor[
                    Rational[2, 3], 0, 0]]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]},
             {
              TagBox[GridBox[{
                 {
                  StyleBox[
                   TagBox[GridBox[{
                    {"\<\"0\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                   FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                   BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                   GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                   FontWeight->Bold,
                   FontColor->RGBColor[
                    Rational[2, 3], 0, 0]]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]}
            },
            AutoDelete->False,
            FrameStyle->RGBColor[0, 
              Rational[2, 3], 0],
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxBackground->{"Columns" -> {{
                 RGBColor[0.88, 1, 0.88]}}},
            GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
           "Grid"],
          StripOnInput->False,
          LineColor->RGBColor[0, 0, 1],
          FrontFaceColor->RGBColor[0, 0, 1],
          BackFaceColor->RGBColor[0, 0, 1],
          GraphicsColor->RGBColor[0, 0, 1],
          FontWeight->Bold,
          FontColor->RGBColor[0, 0, 1]]},
        {
         StyleBox[
          StyleBox[
           TagBox[GridBox[{
              {"Start"}
             },
             AutoDelete->False,
             GridBoxAlignment->{"Columns" -> {{Left}}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
            "Grid"],
           StripOnInput->False,
           FontWeight->Bold],
          StripOnInput->False,
          LineColor->GrayLevel[0],
          FrontFaceColor->GrayLevel[0],
          BackFaceColor->GrayLevel[0],
          GraphicsColor->GrayLevel[0],
          FontWeight->Bold,
          FontColor->GrayLevel[0]], 
         StyleBox[
          TagBox[GridBox[{
             {
              TagBox[GridBox[{
                 {
                  StyleBox[
                   TagBox[GridBox[{
                    {"Term"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   FontWeight->Bold]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]}
            },
            AutoDelete->False,
            FrameStyle->RGBColor[0, 
              Rational[2, 3], 0],
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxBackground->{"Columns" -> {{
                 RGBColor[0.88, 1, 0.88]}}},
            GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
           "Grid"],
          StripOnInput->False,
          LineColor->RGBColor[0, 0, 1],
          FrontFaceColor->RGBColor[0, 0, 1],
          BackFaceColor->RGBColor[0, 0, 1],
          GraphicsColor->RGBColor[0, 0, 1],
          FontWeight->Bold,
          FontColor->RGBColor[0, 0, 1]]},
        {
         StyleBox[
          StyleBox[
           TagBox[GridBox[{
              {"Term"}
             },
             AutoDelete->False,
             GridBoxAlignment->{"Columns" -> {{Left}}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
            "Grid"],
           StripOnInput->False,
           FontWeight->Bold],
          StripOnInput->False,
          LineColor->GrayLevel[0],
          FrontFaceColor->GrayLevel[0],
          BackFaceColor->GrayLevel[0],
          GraphicsColor->GrayLevel[0],
          FontWeight->Bold,
          FontColor->GrayLevel[0]], 
         StyleBox[
          TagBox[GridBox[{
             {
              TagBox[GridBox[{
                 {
                  StyleBox[
                   TagBox[GridBox[{
                    {"Const"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   FontWeight->Bold]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]},
             {
              TagBox[GridBox[{
                 {
                  StyleBox[
                   TagBox[GridBox[{
                    {"Ternary"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   FontWeight->Bold]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]},
             {
              TagBox[GridBox[{
                 {
                  StyleBox[
                   TagBox[GridBox[{
                    {"Unary"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   FontWeight->Bold]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]}
            },
            AutoDelete->False,
            FrameStyle->RGBColor[0, 
              Rational[2, 3], 0],
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxBackground->{"Columns" -> {{
                 RGBColor[0.88, 1, 0.88]}}},
            GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
           "Grid"],
          StripOnInput->False,
          LineColor->RGBColor[0, 0, 1],
          FrontFaceColor->RGBColor[0, 0, 1],
          BackFaceColor->RGBColor[0, 0, 1],
          GraphicsColor->RGBColor[0, 0, 1],
          FontWeight->Bold,
          FontColor->RGBColor[0, 0, 1]]},
        {
         StyleBox[
          StyleBox[
           TagBox[GridBox[{
              {"Ternary"}
             },
             AutoDelete->False,
             GridBoxAlignment->{"Columns" -> {{Left}}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
            "Grid"],
           StripOnInput->False,
           FontWeight->Bold],
          StripOnInput->False,
          LineColor->GrayLevel[0],
          FrontFaceColor->GrayLevel[0],
          BackFaceColor->GrayLevel[0],
          GraphicsColor->GrayLevel[0],
          FontWeight->Bold,
          FontColor->GrayLevel[0]], 
         StyleBox[
          TagBox[GridBox[{
             {
              TagBox[GridBox[{
                 {
                  StyleBox[
                   TagBox[GridBox[{
                    {"\<\"if\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                   FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                   BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                   GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                   FontWeight->Bold,
                   FontColor->RGBColor[
                    Rational[2, 3], 0, 0]]},
                 {
                  StyleBox[
                   TagBox[GridBox[{
                    {"Term"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   FontWeight->Bold]},
                 {
                  StyleBox[
                   TagBox[GridBox[{
                    {"Term"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   FontWeight->Bold]},
                 {
                  StyleBox[
                   TagBox[GridBox[{
                    {"Term"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   FontWeight->Bold]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]}
            },
            AutoDelete->False,
            FrameStyle->RGBColor[0, 
              Rational[2, 3], 0],
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxBackground->{"Columns" -> {{
                 RGBColor[0.88, 1, 0.88]}}},
            GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
           "Grid"],
          StripOnInput->False,
          LineColor->RGBColor[0, 0, 1],
          FrontFaceColor->RGBColor[0, 0, 1],
          BackFaceColor->RGBColor[0, 0, 1],
          GraphicsColor->RGBColor[0, 0, 1],
          FontWeight->Bold,
          FontColor->RGBColor[0, 0, 1]]},
        {
         StyleBox[
          StyleBox[
           TagBox[GridBox[{
              {"Unary"}
             },
             AutoDelete->False,
             GridBoxAlignment->{"Columns" -> {{Left}}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
            "Grid"],
           StripOnInput->False,
           FontWeight->Bold],
          StripOnInput->False,
          LineColor->GrayLevel[0],
          FrontFaceColor->GrayLevel[0],
          BackFaceColor->GrayLevel[0],
          GraphicsColor->GrayLevel[0],
          FontWeight->Bold,
          FontColor->GrayLevel[0]], 
         StyleBox[
          TagBox[GridBox[{
             {
              TagBox[GridBox[{
                 {
                  StyleBox[
                   TagBox[GridBox[{
                    {"\<\"succ\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                   FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                   BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                   GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                   FontWeight->Bold,
                   FontColor->RGBColor[
                    Rational[2, 3], 0, 0]]},
                 {
                  StyleBox[
                   TagBox[GridBox[{
                    {"Term"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   FontWeight->Bold]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]},
             {
              TagBox[GridBox[{
                 {
                  StyleBox[
                   TagBox[GridBox[{
                    {"\<\"pred\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                   FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                   BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                   GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                   FontWeight->Bold,
                   FontColor->RGBColor[
                    Rational[2, 3], 0, 0]]},
                 {
                  StyleBox[
                   TagBox[GridBox[{
                    {"Term"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   FontWeight->Bold]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]},
             {
              TagBox[GridBox[{
                 {
                  StyleBox[
                   TagBox[GridBox[{
                    {"\<\"iszero\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                   FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                   BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                   GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                   FontWeight->Bold,
                   FontColor->RGBColor[
                    Rational[2, 3], 0, 0]]},
                 {
                  StyleBox[
                   TagBox[GridBox[{
                    {"Term"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                   StripOnInput->False,
                   FontWeight->Bold]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]}
            },
            AutoDelete->False,
            FrameStyle->RGBColor[0, 
              Rational[2, 3], 0],
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxBackground->{"Columns" -> {{
                 RGBColor[0.88, 1, 0.88]}}},
            GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
           "Grid"],
          StripOnInput->False,
          LineColor->RGBColor[0, 0, 1],
          FrontFaceColor->RGBColor[0, 0, 1],
          BackFaceColor->RGBColor[0, 0, 1],
          GraphicsColor->RGBColor[0, 0, 1],
          FontWeight->Bold,
          FontColor->RGBColor[0, 0, 1]]}
       },
       AutoDelete->False,
       FrameStyle->RGBColor[0, 0, 1],
       GridBoxAlignment->{"Columns" -> {{Left}}},
       GridBoxBackground->{"Columns" -> {
           RGBColor[1, 0.9, 0.8], {
            RGBColor[1, 1, 0.85]}}},
       GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"]}
   },
   AutoDelete->False,
   FrameStyle->RGBColor[0, 
     Rational[2, 3], 0],
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxBackground->{"Columns" -> {{
        RGBColor[0.88, 1, 0.88]}}},
   GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{
  3.841318699040599*^9, 3.841319069372772*^9, 3.841322405701173*^9, 
   3.84132475987751*^9, 3.841324989655118*^9, {3.8413314752130613`*^9, 
   3.841331489891167*^9}, 3.841332418586688*^9, 3.841332926196328*^9, 
   3.841350166712501*^9, 3.841352240820216*^9, 3.841392984344956*^9, 
   3.841397378428589*^9, 3.841403445600097*^9, 3.841406715704772*^9, 
   3.841422368801758*^9, 3.911255354573654*^9, 3.911290462178913*^9, 
   3.912270612843219*^9, 3.912546353958499*^9, 3.912589072439663*^9, 
   3.91260035184356*^9, 3.912601707011574*^9, 3.9150508720970078`*^9, 
   3.9155354580553417`*^9},
 CellLabel->
  "Out[812]=",ExpressionUUID->"b7357967-ead3-4b27-834a-8c3fed39a2d5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"allSymbols", "@", "BPT"}], "//", "gridExpression"}]], "Input",
 CellChangeTimes->{{3.8413341690786943`*^9, 3.8413341800518084`*^9}},
 CellLabel->
  "In[813]:=",ExpressionUUID->"dd555f39-c8ce-4d8d-b714-560b0ba872e4"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"\"\>", 
     TagBox[GridBox[{
        {
         StyleBox["\<\"0\"\>",
          StripOnInput->False,
          FontWeight->Bold]}
       },
       AutoDelete->False,
       GridBoxAlignment->{"Columns" -> {{Left}}},
       GridBoxBackground->{"Columns" -> {{
            RGBColor[1, 1, 0.85]}}},
       GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"]},
    {"\<\"\"\>", 
     TagBox[GridBox[{
        {
         StyleBox["\<\"false\"\>",
          StripOnInput->False,
          FontWeight->Bold]}
       },
       AutoDelete->False,
       GridBoxAlignment->{"Columns" -> {{Left}}},
       GridBoxBackground->{"Columns" -> {{
            RGBColor[1, 1, 0.85]}}},
       GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"]},
    {"\<\"\"\>", 
     TagBox[GridBox[{
        {
         StyleBox["\<\"if\"\>",
          StripOnInput->False,
          FontWeight->Bold]}
       },
       AutoDelete->False,
       GridBoxAlignment->{"Columns" -> {{Left}}},
       GridBoxBackground->{"Columns" -> {{
            RGBColor[1, 1, 0.85]}}},
       GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"]},
    {"\<\"\"\>", 
     TagBox[GridBox[{
        {
         StyleBox["\<\"iszero\"\>",
          StripOnInput->False,
          FontWeight->Bold]}
       },
       AutoDelete->False,
       GridBoxAlignment->{"Columns" -> {{Left}}},
       GridBoxBackground->{"Columns" -> {{
            RGBColor[1, 1, 0.85]}}},
       GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"]},
    {"\<\"\"\>", 
     TagBox[GridBox[{
        {
         StyleBox["\<\"pred\"\>",
          StripOnInput->False,
          FontWeight->Bold]}
       },
       AutoDelete->False,
       GridBoxAlignment->{"Columns" -> {{Left}}},
       GridBoxBackground->{"Columns" -> {{
            RGBColor[1, 1, 0.85]}}},
       GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"]},
    {
     TagBox[GridBox[{
        {
         StyleBox["List",
          StripOnInput->False,
          FontWeight->Bold]}
       },
       AutoDelete->False,
       GridBoxAlignment->{"Columns" -> {{Left}}},
       GridBoxBackground->{"Columns" -> {{
            RGBColor[0.94, 0.88, 0.94]}}},
       GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"], 
     TagBox[GridBox[{
        {
         StyleBox["\<\"succ\"\>",
          StripOnInput->False,
          FontWeight->Bold]}
       },
       AutoDelete->False,
       GridBoxAlignment->{"Columns" -> {{Left}}},
       GridBoxBackground->{"Columns" -> {{
            RGBColor[1, 1, 0.85]}}},
       GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"]},
    {"\<\"\"\>", 
     TagBox[GridBox[{
        {
         StyleBox["\<\"true\"\>",
          StripOnInput->False,
          FontWeight->Bold]}
       },
       AutoDelete->False,
       GridBoxAlignment->{"Columns" -> {{Left}}},
       GridBoxBackground->{"Columns" -> {{
            RGBColor[1, 1, 0.85]}}},
       GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"]},
    {"\<\"\"\>", 
     TagBox[GridBox[{
        {
         StyleBox["Const",
          StripOnInput->False,
          FontWeight->Bold]}
       },
       AutoDelete->False,
       GridBoxAlignment->{"Columns" -> {{Left}}},
       GridBoxBackground->{"Columns" -> {{
            RGBColor[0.94, 0.88, 0.94]}}},
       GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"]},
    {"\<\"\"\>", 
     TagBox[GridBox[{
        {
         StyleBox["Term",
          StripOnInput->False,
          FontWeight->Bold]}
       },
       AutoDelete->False,
       GridBoxAlignment->{"Columns" -> {{Left}}},
       GridBoxBackground->{"Columns" -> {{
            RGBColor[0.94, 0.88, 0.94]}}},
       GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"]},
    {"\<\"\"\>", 
     TagBox[GridBox[{
        {
         StyleBox["Ternary",
          StripOnInput->False,
          FontWeight->Bold]}
       },
       AutoDelete->False,
       GridBoxAlignment->{"Columns" -> {{Left}}},
       GridBoxBackground->{"Columns" -> {{
            RGBColor[0.94, 0.88, 0.94]}}},
       GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"]},
    {"\<\"\"\>", 
     TagBox[GridBox[{
        {
         StyleBox["Unary",
          StripOnInput->False,
          FontWeight->Bold]}
       },
       AutoDelete->False,
       GridBoxAlignment->{"Columns" -> {{Left}}},
       GridBoxBackground->{"Columns" -> {{
            RGBColor[0.94, 0.88, 0.94]}}},
       GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"]}
   },
   AutoDelete->False,
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxBackground->{"Columns" -> {
       RGBColor[1, 0.9, 0.8], {
        RGBColor[0.88, 1, 0.88]}}},
   GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> False},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{{3.84133417297325*^9, 3.841334180727313*^9}, 
   3.841350166747159*^9, 3.84135224086354*^9, 3.841392984376266*^9, 
   3.841397384220602*^9, 3.841403445631853*^9, 3.841406720024881*^9, 
   3.841422368823221*^9, 3.911255354579624*^9, 3.911290462183544*^9, 
   3.912270620179661*^9, 3.912546353989676*^9, 3.912589072444872*^9, 
   3.912600351852566*^9, 3.9126017070202503`*^9, 3.915050872104754*^9, 
   3.915535458065545*^9},
 CellLabel->
  "Out[813]=",ExpressionUUID->"5e6d3a5c-4edc-429a-8992-cadd8e6bcb88"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "$bptTable", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"parserPatterns", "[", 
   RowBox[{"BPT", ",", "$bptTable"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DownValues", "@", "$bptTable"}], "//", "TableForm"}]}], "Input",
 CellChangeTimes->{{3.841319313500142*^9, 3.841319390627939*^9}, {
  3.841393018160912*^9, 3.841393029037169*^9}},
 CellLabel->
  "In[814]:=",ExpressionUUID->"3cfcd030-2e14-42ee-a9e3-6c48448dcc5c"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       RowBox[{"HoldPattern", "[", 
        RowBox[{"$bptTable", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"tok$36505", ":", 
             
             RowBox[{"\<\"true\"\>", "|", "\<\"false\"\>", 
              "|", "\<\"0\"\>"}]}], ",", "toks$36505___"}], "}"}], ",", 
          RowBox[{"tree$36505_", ":", "Null"}]}], "]"}], "]"}], 
       "\[RuleDelayed]", 
       RowBox[{"genParserBody", "[", 
        RowBox[{"0", ",", "tok$36505", ",", 
         RowBox[{"{", "toks$36505", "}"}], ",", "Const", ",", 
         RowBox[{"{", "}"}], ",", "$bptTable"}], "]"}]}]},
     {
      RowBox[{
       RowBox[{"HoldPattern", "[", 
        RowBox[{"$bptTable", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", 
          RowBox[{"tree_", ":", "Null"}]}], "]"}], "]"}], "\[RuleDelayed]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", "tree"}], "}"}]}]},
     {
      RowBox[{
       RowBox[{"HoldPattern", "[", 
        RowBox[{"$bptTable", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"tok$36509", ":", 
             RowBox[{"Alternatives", "[", "\<\"if\"\>", "]"}]}], ",", 
            "toks$36509___"}], "}"}], ",", 
          RowBox[{"tree$36509_", ":", "Null"}]}], "]"}], "]"}], 
       "\[RuleDelayed]", 
       RowBox[{"genParserBody", "[", 
        RowBox[{"3", ",", "tok$36509", ",", 
         RowBox[{"{", "toks$36509", "}"}], ",", "Ternary", ",", 
         RowBox[{"{", "}"}], ",", "$bptTable"}], "]"}]}]},
     {
      RowBox[{
       RowBox[{"HoldPattern", "[", 
        RowBox[{"$bptTable", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"tok$36511", ":", 
             
             RowBox[{"\<\"succ\"\>", "|", "\<\"pred\"\>", 
              "|", "\<\"iszero\"\>"}]}], ",", "toks$36511___"}], "}"}], ",", 
          RowBox[{"tree$36511_", ":", "Null"}]}], "]"}], "]"}], 
       "\[RuleDelayed]", 
       RowBox[{"genParserBody", "[", 
        RowBox[{"1", ",", "tok$36511", ",", 
         RowBox[{"{", "toks$36511", "}"}], ",", "Unary", ",", 
         RowBox[{"{", "}"}], ",", "$bptTable"}], "]"}]}]},
     {
      RowBox[{
       RowBox[{"HoldPattern", "[", 
        RowBox[{"$bptTable", "[", "xs$___", "]"}], "]"}], "\[RuleDelayed]", 
       RowBox[{"Throw", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"ToString", "[", "$bptTable", "]"}], 
           "<>", "\<\": CATASTROPHE: \"\>"}], ",", "xs$"}], "}"}], "]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.841319392219849*^9, 3.841322405812202*^9, 
  3.841324759980994*^9, 3.841324989771405*^9, 3.8413315077116013`*^9, 
  3.841332418696535*^9, 3.841332926313333*^9, 3.841350166881309*^9, 
  3.841352241067503*^9, 3.841392984512225*^9, 3.841393030044514*^9, 
  3.841397399369348*^9, 3.841403445789775*^9, 3.841406736813021*^9, 
  3.841422368856282*^9, 3.911255354591229*^9, 3.911290462194181*^9, 
  3.912270623101738*^9, 3.912546353993962*^9, 3.912589072459655*^9, 
  3.912600351856854*^9, 3.912601707023941*^9, 3.915050872108548*^9, 
  3.915535458069909*^9},
 CellLabel->
  "Out[816]//TableForm=",ExpressionUUID->"041ac9a9-109a-4099-b355-\
d25326a5afe6"]
}, Open  ]],

Cell["\<\
Generate some travesties from this grammar, BPT. Equiprobabilities doesn\
\[CloseCurlyQuote]t generate enough variety, so we\[CloseCurlyQuote]ll build \
a probability-assignment function up by hand.\
\>", "Text",
 CellChangeTimes->{{3.841319640206336*^9, 3.841319652897156*^9}, {
  3.841331528515269*^9, 
  3.84133156014602*^9}},ExpressionUUID->"2a3e85b4-0b9f-44e8-9b5b-\
258eaf2c6356"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"??", "equiProbabilities"}]], "Input",
 CellChangeTimes->{{3.841325626474613*^9, 3.8413256281742973`*^9}},
 CellLabel->
  "In[817]:=",ExpressionUUID->"09b751e4-5db4-4109-84ae-a4d809163d5d"],

Cell[BoxData[
 InterpretationBox[
  StyleBox[
   FrameBox[
    DynamicModuleBox[{System`InformationDump`open$$ = True, 
     System`InformationDump`mouseOver$$ = False}, 
     PaneSelectorBox[{True->
      TagBox[GridBox[{
         {
          ItemBox[
           PaneBox[
            StyleBox[
             TagBox[
              TooltipBox[
               StyleBox["\<\" Symbol\"\>", "InformationRowLabel",
                StripOnInput->False],
               "\"Symbol\"",
               TooltipStyle->"TextStyling"],
              Annotation[#, "Symbol", "Tooltip"]& ], "InformationTitleText",
             StripOnInput->False,
             BaseStyle -> None],
            FrameMargins->{{4, 0}, {-1, 1}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           PaneBox[
            
            StyleBox["\<\"Global`equiProbabilities\"\>", 
             "InformationUsageText",
             StripOnInput->False,
             LineSpacing->{1.5, 1.5, 3.}],
            FrameMargins->{{10, 10}, {8, 10}}],
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False]},
         {
          PaneBox[
           TagBox[GridBox[{
              {
               StyleBox[
                TagBox[
                 TooltipBox[
                  StyleBox["\<\" Definitions\"\>", "InformationRowLabel",
                   StripOnInput->False],
                  "\"Definitions\"",
                  TooltipStyle->"TextStyling"],
                 Annotation[#, "Definitions", "Tooltip"]& ], "DialogStyle",
                StripOnInput->False]},
              {
               TemplateBox[{"\"\[ThinSpace]\"", 
                 GridBox[{{
                    RowBox[{
                    RowBox[{"equiProbabilities", "[", "list_List", "]"}], 
                    ":=", 
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"l", "=", 
                    RowBox[{"Length", "[", "list", "]"}]}], "}"}], ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"N", "[", 
                    FractionBox["1", "l"], "]"}], ",", 
                    RowBox[{"{", "l", "}"}]}], "]"}]}], "]"}]}]}, {" "}}, 
                  GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                  DefaultBaseStyle -> "Column", 
                  GridBoxItemSize -> {
                   "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}]},
                "RowDefault"]}
             },
             DefaultBaseStyle->"Column",
             GridBoxAlignment->{"Columns" -> {{Left}}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
            "Column"],
           FrameMargins->{{6, 0}, {3, 6}}], "\<\"\"\>"},
         {
          PaneBox[GridBox[{
             {
              
              DynamicModuleBox[{System`InformationDump`open$$ = {
               False, False, False, False, False, False}}, 
               StyleBox[GridBox[{
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Full Name\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"FullName\"",
                    TooltipStyle->"TextStyling"],
                    
                    Annotation[#, "FullName", 
                    "Tooltip"]& ], "\<\"Global`equiProbabilities\"\>"}
                 },
                 AutoDelete->False,
                 GridBoxAlignment->{"Columns" -> {Right, Left}},
                 GridBoxDividers->None,
                 GridBoxItemSize->{"Columns" -> {Automatic, Automatic}},
                 GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.5599999999999999]}, 
                    Offset[0.27999999999999997`]}, "Rows" -> {
                    Offset[0.2], {
                    Offset[0.8]}, 
                    Offset[0.2]}}], "DialogStyle",
                StripOnInput->False],
               DynamicModuleValues:>{}]}
            },
            DefaultBaseStyle->"Column",
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxDividers->{"Columns" -> {{False}}, "Rows" -> {{False}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.5599999999999999]}, 
                Offset[0.27999999999999997`]}, "Rows" -> {
                Offset[0.2], {
                 Offset[3.6]}, 
                Offset[0.2]}}],
           FrameMargins->{{6, 6}, {6, 3}}], ""},
         {
          ItemBox[
           TagBox[
            ButtonBox[
             PaneSelectorBox[{False->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "UpPointerOpener"],
               ImageSizeCache->{15., {2., 13.}}], True->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "UpPointerOpenerHot"],
               ImageSizeCache->{15., {2., 13.}}]}, Dynamic[
              System`InformationDump`mouseOver$$]],
             Alignment->Left,
             Appearance->{"Default" -> None},
             
             ButtonFunction:>FEPrivate`Set[
              System`InformationDump`open$$, False],
             Evaluator->Automatic,
             FrameMargins->{{9, 0}, {0, 0}},
             ImageMargins->0,
             ImageSize->Full,
             Method->"Preemptive"],
            
            EventHandlerTag[{
             "MouseEntered" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, True], 
              "MouseExited" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, False], 
              Method -> "Preemptive", PassEventsDown -> Automatic, 
              PassEventsUp -> True}]],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], "\[SpanFromLeft]"}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          GrayLevel[0.8], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {Left, Right}, "Rows" -> {{Center}}},
        GridBoxDividers->{
         "Columns" -> {{None}}, "Rows" -> {False, {True}, False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], False->
      TagBox[GridBox[{
         {
          ItemBox[
           PaneBox[
            StyleBox[
             TagBox[
              TooltipBox[
               StyleBox["\<\" Symbol\"\>", "InformationRowLabel",
                StripOnInput->False],
               "\"Symbol\"",
               TooltipStyle->"TextStyling"],
              Annotation[#, "Symbol", "Tooltip"]& ], "InformationTitleText",
             StripOnInput->False],
            FrameMargins->{{4, 0}, {-1, 1}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           PaneBox[
            
            StyleBox["\<\"Global`equiProbabilities\"\>", 
             "InformationUsageText",
             StripOnInput->False,
             LineSpacing->{1.5, 1.5, 3.}],
            FrameMargins->{{10, 10}, {8, 10}}],
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           TagBox[
            ButtonBox[
             PaneSelectorBox[{False->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpener"]], True->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpenerHot"]]}, Dynamic[
              System`InformationDump`mouseOver$$]],
             Alignment->Left,
             Appearance->{"Default" -> None},
             
             ButtonFunction:>FEPrivate`Set[
              System`InformationDump`open$$, True],
             Evaluator->Automatic,
             FrameMargins->{{9, 0}, {0, 0}},
             ImageMargins->0,
             ImageSize->Full,
             Method->"Preemptive"],
            
            EventHandlerTag[{
             "MouseEntered" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, True], 
              "MouseExited" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, False], 
              Method -> "Preemptive", PassEventsDown -> Automatic, 
              PassEventsUp -> True}]],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], "\[SpanFromLeft]"}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          GrayLevel[0.8], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {Left, Right}, "Rows" -> {{Center}}},
        GridBoxDividers->{
         "Columns" -> {{None}}, "Rows" -> {False, {True}, False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"]}, Dynamic[System`InformationDump`open$$],
      BaselinePosition->Baseline,
      FrameMargins->0,
      ImageSize->Automatic],
     DynamicModuleValues:>{}],
    BaseStyle->"InformationGridFrame",
    StripOnInput->False], "InformationGridPlain",
   StripOnInput->False],
  InformationData[<|
   "ObjectType" -> "Symbol", "Usage" -> "Global`equiProbabilities", 
    "Documentation" -> None, "OwnValues" -> None, "UpValues" -> None, 
    "DownValues" -> 
    Information`InformationValueForm[
     DownValues, $CellContext`equiProbabilities, \
{$CellContext`equiProbabilities[
         Pattern[$CellContext`list, 
          Blank[List]]] :> With[{$CellContext`l = Length[$CellContext`list]}, 
         Table[
          N[1/$CellContext`l], {$CellContext`l}]]}], "SubValues" -> None, 
    "DefaultValues" -> None, "NValues" -> None, "FormatValues" -> None, 
    "Options" -> None, "Attributes" -> {}, "FullName" -> 
    "Global`equiProbabilities"|>, True]]], "Output",
 CellChangeTimes->{3.841325629354886*^9, 3.841332418785606*^9, 
  3.841332926390992*^9, 3.841350166956255*^9, 3.841352241151583*^9, 
  3.841397405721472*^9, 3.841403445870337*^9, 3.841406742244055*^9, 
  3.8414223689352083`*^9, 3.911255354638742*^9, 3.911290462234688*^9, 
  3.912270631165077*^9, 3.912546354041857*^9, 3.912589072507917*^9, 
  3.912600351986055*^9, 3.912601707067482*^9, 3.915050872154915*^9, 
  3.915535458117906*^9},
 CellLabel->
  "Out[817]=",ExpressionUUID->"8bd3702f-4196-44dc-b45f-8278b5a50972"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "BPTprobabilities", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BPTprobabilities", "[", "list_List", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"list", "===", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "Const", "}"}], ",", 
        RowBox[{"{", "Ternary", "}"}], ",", 
        RowBox[{"{", "Unary", "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{".25", ",", ".50", ",", ".25"}], "}"}], ",", " ", 
     RowBox[{"equiProbabilities", "@", "list"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.841325735432481*^9, 3.841325743054226*^9}, {
   3.8413257741479816`*^9, 3.841325952086979*^9}, {3.8413261334753304`*^9, 
   3.841326151814831*^9}, {3.841326334810567*^9, 3.841326397399035*^9}, 
   3.8413320530107317`*^9, {3.841332117282496*^9, 3.841332204445919*^9}},
 CellLabel->
  "In[818]:=",ExpressionUUID->"bc07953d-bf07-4cbb-8eb0-ebd03d0e503f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"BPTprobabilized", "=", 
    RowBox[{"injectGenerationProbabilities", "[", 
     RowBox[{"BPT", ",", "BPTprobabilities"}], "]"}]}], ")"}], "//", 
  "visGrammar"}]], "Input",
 CellChangeTimes->{{3.8413256933653803`*^9, 3.841325727435782*^9}, {
  3.841325963375655*^9, 3.841325997706279*^9}, {3.841326098019111*^9, 
  3.841326104591811*^9}},
 CellLabel->
  "In[820]:=",ExpressionUUID->"e4528f40-5bf2-446f-80d4-f2ae610ee34e"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[GridBox[{
        {
         StyleBox[
          StyleBox[
           TagBox[GridBox[{
              {"Const"}
             },
             AutoDelete->False,
             GridBoxAlignment->{"Columns" -> {{Left}}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
            "Grid"],
           StripOnInput->False,
           FontWeight->Bold],
          StripOnInput->False,
          LineColor->GrayLevel[0],
          FrontFaceColor->GrayLevel[0],
          BackFaceColor->GrayLevel[0],
          GraphicsColor->GrayLevel[0],
          FontWeight->Bold,
          FontColor->GrayLevel[0]], 
         StyleBox[
          TagBox[GridBox[{
             {
              TagBox[GridBox[{
                 {
                  TagBox[GridBox[{
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"probability\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"0.3333333333333333`"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]},
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"alternative\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    TagBox[GridBox[{
                    {
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"true\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 
                    Rational[2, 3], 0],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 0, 1],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[1, 1, 0.85]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                   "Grid"]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]},
             {
              TagBox[GridBox[{
                 {
                  TagBox[GridBox[{
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"probability\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"0.3333333333333333`"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]},
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"alternative\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    TagBox[GridBox[{
                    {
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"false\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 
                    Rational[2, 3], 0],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 0, 1],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[1, 1, 0.85]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                   "Grid"]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]},
             {
              TagBox[GridBox[{
                 {
                  TagBox[GridBox[{
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"probability\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"0.3333333333333333`"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]},
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"alternative\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    TagBox[GridBox[{
                    {
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"0\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 
                    Rational[2, 3], 0],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 0, 1],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[1, 1, 0.85]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                   "Grid"]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]}
            },
            AutoDelete->False,
            FrameStyle->RGBColor[0, 
              Rational[2, 3], 0],
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxBackground->{"Columns" -> {{
                 RGBColor[0.88, 1, 0.88]}}},
            GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
           "Grid"],
          StripOnInput->False,
          LineColor->RGBColor[0, 0, 1],
          FrontFaceColor->RGBColor[0, 0, 1],
          BackFaceColor->RGBColor[0, 0, 1],
          GraphicsColor->RGBColor[0, 0, 1],
          FontWeight->Bold,
          FontColor->RGBColor[0, 0, 1]]},
        {
         StyleBox[
          StyleBox[
           TagBox[GridBox[{
              {"Start"}
             },
             AutoDelete->False,
             GridBoxAlignment->{"Columns" -> {{Left}}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
            "Grid"],
           StripOnInput->False,
           FontWeight->Bold],
          StripOnInput->False,
          LineColor->GrayLevel[0],
          FrontFaceColor->GrayLevel[0],
          BackFaceColor->GrayLevel[0],
          GraphicsColor->GrayLevel[0],
          FontWeight->Bold,
          FontColor->GrayLevel[0]], 
         StyleBox[
          TagBox[GridBox[{
             {
              TagBox[GridBox[{
                 {
                  TagBox[GridBox[{
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"probability\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"1.`"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]},
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"alternative\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    TagBox[GridBox[{
                    {
                    StyleBox[
                    TagBox[GridBox[{
                    {"Term"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 
                    Rational[2, 3], 0],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 0, 1],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[1, 1, 0.85]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                   "Grid"]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]}
            },
            AutoDelete->False,
            FrameStyle->RGBColor[0, 
              Rational[2, 3], 0],
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxBackground->{"Columns" -> {{
                 RGBColor[0.88, 1, 0.88]}}},
            GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
           "Grid"],
          StripOnInput->False,
          LineColor->RGBColor[0, 0, 1],
          FrontFaceColor->RGBColor[0, 0, 1],
          BackFaceColor->RGBColor[0, 0, 1],
          GraphicsColor->RGBColor[0, 0, 1],
          FontWeight->Bold,
          FontColor->RGBColor[0, 0, 1]]},
        {
         StyleBox[
          StyleBox[
           TagBox[GridBox[{
              {"Term"}
             },
             AutoDelete->False,
             GridBoxAlignment->{"Columns" -> {{Left}}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
            "Grid"],
           StripOnInput->False,
           FontWeight->Bold],
          StripOnInput->False,
          LineColor->GrayLevel[0],
          FrontFaceColor->GrayLevel[0],
          BackFaceColor->GrayLevel[0],
          GraphicsColor->GrayLevel[0],
          FontWeight->Bold,
          FontColor->GrayLevel[0]], 
         StyleBox[
          TagBox[GridBox[{
             {
              TagBox[GridBox[{
                 {
                  TagBox[GridBox[{
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"probability\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"0.25`"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]},
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"alternative\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    TagBox[GridBox[{
                    {
                    StyleBox[
                    TagBox[GridBox[{
                    {"Const"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 
                    Rational[2, 3], 0],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 0, 1],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[1, 1, 0.85]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                   "Grid"]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]},
             {
              TagBox[GridBox[{
                 {
                  TagBox[GridBox[{
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"probability\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"0.5`"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]},
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"alternative\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    TagBox[GridBox[{
                    {
                    StyleBox[
                    TagBox[GridBox[{
                    {"Ternary"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 
                    Rational[2, 3], 0],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 0, 1],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[1, 1, 0.85]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                   "Grid"]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]},
             {
              TagBox[GridBox[{
                 {
                  TagBox[GridBox[{
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"probability\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"0.25`"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]},
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"alternative\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    TagBox[GridBox[{
                    {
                    StyleBox[
                    TagBox[GridBox[{
                    {"Unary"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 
                    Rational[2, 3], 0],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 0, 1],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[1, 1, 0.85]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                   "Grid"]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]}
            },
            AutoDelete->False,
            FrameStyle->RGBColor[0, 
              Rational[2, 3], 0],
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxBackground->{"Columns" -> {{
                 RGBColor[0.88, 1, 0.88]}}},
            GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
           "Grid"],
          StripOnInput->False,
          LineColor->RGBColor[0, 0, 1],
          FrontFaceColor->RGBColor[0, 0, 1],
          BackFaceColor->RGBColor[0, 0, 1],
          GraphicsColor->RGBColor[0, 0, 1],
          FontWeight->Bold,
          FontColor->RGBColor[0, 0, 1]]},
        {
         StyleBox[
          StyleBox[
           TagBox[GridBox[{
              {"Ternary"}
             },
             AutoDelete->False,
             GridBoxAlignment->{"Columns" -> {{Left}}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
            "Grid"],
           StripOnInput->False,
           FontWeight->Bold],
          StripOnInput->False,
          LineColor->GrayLevel[0],
          FrontFaceColor->GrayLevel[0],
          BackFaceColor->GrayLevel[0],
          GraphicsColor->GrayLevel[0],
          FontWeight->Bold,
          FontColor->GrayLevel[0]], 
         StyleBox[
          TagBox[GridBox[{
             {
              TagBox[GridBox[{
                 {
                  TagBox[GridBox[{
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"probability\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"1.`"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]},
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"alternative\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    TagBox[GridBox[{
                    {
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"if\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]]},
                    {
                    StyleBox[
                    TagBox[GridBox[{
                    {"Term"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold]},
                    {
                    StyleBox[
                    TagBox[GridBox[{
                    {"Term"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold]},
                    {
                    StyleBox[
                    TagBox[GridBox[{
                    {"Term"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 
                    Rational[2, 3], 0],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 0, 1],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[1, 1, 0.85]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                   "Grid"]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]}
            },
            AutoDelete->False,
            FrameStyle->RGBColor[0, 
              Rational[2, 3], 0],
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxBackground->{"Columns" -> {{
                 RGBColor[0.88, 1, 0.88]}}},
            GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
           "Grid"],
          StripOnInput->False,
          LineColor->RGBColor[0, 0, 1],
          FrontFaceColor->RGBColor[0, 0, 1],
          BackFaceColor->RGBColor[0, 0, 1],
          GraphicsColor->RGBColor[0, 0, 1],
          FontWeight->Bold,
          FontColor->RGBColor[0, 0, 1]]},
        {
         StyleBox[
          StyleBox[
           TagBox[GridBox[{
              {"Unary"}
             },
             AutoDelete->False,
             GridBoxAlignment->{"Columns" -> {{Left}}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
            "Grid"],
           StripOnInput->False,
           FontWeight->Bold],
          StripOnInput->False,
          LineColor->GrayLevel[0],
          FrontFaceColor->GrayLevel[0],
          BackFaceColor->GrayLevel[0],
          GraphicsColor->GrayLevel[0],
          FontWeight->Bold,
          FontColor->GrayLevel[0]], 
         StyleBox[
          TagBox[GridBox[{
             {
              TagBox[GridBox[{
                 {
                  TagBox[GridBox[{
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"probability\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"0.3333333333333333`"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]},
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"alternative\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    TagBox[GridBox[{
                    {
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"succ\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]]},
                    {
                    StyleBox[
                    TagBox[GridBox[{
                    {"Term"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 
                    Rational[2, 3], 0],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 0, 1],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[1, 1, 0.85]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                   "Grid"]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]},
             {
              TagBox[GridBox[{
                 {
                  TagBox[GridBox[{
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"probability\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"0.3333333333333333`"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]},
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"alternative\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    TagBox[GridBox[{
                    {
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"pred\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]]},
                    {
                    StyleBox[
                    TagBox[GridBox[{
                    {"Term"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 
                    Rational[2, 3], 0],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 0, 1],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[1, 1, 0.85]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                   "Grid"]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]},
             {
              TagBox[GridBox[{
                 {
                  TagBox[GridBox[{
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"probability\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"0.3333333333333333`"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]},
                    {
                    StyleBox[
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"alternative\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]],
                    StripOnInput->False,
                    LineColor->GrayLevel[0],
                    FrontFaceColor->GrayLevel[0],
                    BackFaceColor->GrayLevel[0],
                    GraphicsColor->GrayLevel[0],
                    FontWeight->Bold,
                    FontColor->GrayLevel[0]], 
                    StyleBox[
                    TagBox[GridBox[{
                    {
                    StyleBox[
                    TagBox[GridBox[{
                    {"\<\"iszero\"\>"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FrontFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    BackFaceColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    GraphicsColor->RGBColor[
                    Rational[2, 3], 0, 0],
                    FontWeight->Bold,
                    FontColor->RGBColor[
                    Rational[2, 3], 0, 0]]},
                    {
                    StyleBox[
                    TagBox[GridBox[{
                    {"Term"}
                    },
                    AutoDelete->False,
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    FontWeight->Bold]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 
                    Rational[2, 3], 0],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                    "Grid"],
                    StripOnInput->False,
                    LineColor->RGBColor[0, 0, 1],
                    FrontFaceColor->RGBColor[0, 0, 1],
                    BackFaceColor->RGBColor[0, 0, 1],
                    GraphicsColor->RGBColor[0, 0, 1],
                    FontWeight->Bold,
                    FontColor->RGBColor[0, 0, 1]]}
                    },
                    AutoDelete->False,
                    FrameStyle->RGBColor[0, 0, 1],
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    GridBoxBackground->{"Columns" -> {
                    RGBColor[1, 0.9, 0.8], {
                    RGBColor[1, 1, 0.85]}}},
                    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                   "Grid"]}
                },
                AutoDelete->False,
                FrameStyle->RGBColor[0, 
                  Rational[2, 3], 0],
                GridBoxAlignment->{"Columns" -> {{Left}}},
                GridBoxBackground->{"Columns" -> {{
                    RGBColor[0.88, 1, 0.88]}}},
                GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Grid"]}
            },
            AutoDelete->False,
            FrameStyle->RGBColor[0, 
              Rational[2, 3], 0],
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxBackground->{"Columns" -> {{
                 RGBColor[0.88, 1, 0.88]}}},
            GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
           "Grid"],
          StripOnInput->False,
          LineColor->RGBColor[0, 0, 1],
          FrontFaceColor->RGBColor[0, 0, 1],
          BackFaceColor->RGBColor[0, 0, 1],
          GraphicsColor->RGBColor[0, 0, 1],
          FontWeight->Bold,
          FontColor->RGBColor[0, 0, 1]]}
       },
       AutoDelete->False,
       FrameStyle->RGBColor[0, 0, 1],
       GridBoxAlignment->{"Columns" -> {{Left}}},
       GridBoxBackground->{"Columns" -> {
           RGBColor[1, 0.9, 0.8], {
            RGBColor[1, 1, 0.85]}}},
       GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"]}
   },
   AutoDelete->False,
   FrameStyle->RGBColor[0, 
     Rational[2, 3], 0],
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxBackground->{"Columns" -> {{
        RGBColor[0.88, 1, 0.88]}}},
   GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{{3.841326106034157*^9, 3.84132615392833*^9}, 
   3.841326266884774*^9, 3.841326359826288*^9, 3.841326423098493*^9, 
   3.841332000366719*^9, 3.841332208933678*^9, 3.841332418878373*^9, 
   3.841332926481618*^9, 3.841350167061556*^9, 3.841352241254369*^9, 
   3.841397416041798*^9, 3.84140344600574*^9, 3.841406755005831*^9, 
   3.841422368999436*^9, 3.911255354661*^9, 3.911290462256417*^9, 
   3.912270636322934*^9, 3.912546354072104*^9, 3.912589072532082*^9, 
   3.91260035201045*^9, 3.912601707089351*^9, 3.915050872178438*^9, 
   3.9155354581484756`*^9},
 CellLabel->
  "Out[820]=",ExpressionUUID->"dfe78b0b-8082-4216-b5f6-e375a9841758"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "spaceRules", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"spaceRules", "=", 
   RowBox[{"{", 
    RowBox[{"x_String", "\[RuleDelayed]", 
     RowBox[{"x", "<>", "\"\< \>\""}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.841323152093812*^9, {3.841323235687709*^9, 3.841323240076071*^9}, {
   3.841323501911362*^9, 3.84132351769423*^9}},
 CellLabel->
  "In[821]:=",ExpressionUUID->"c227a189-9e9e-43e0-88e2-1f6f0e50af7d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"SeedRandom", "[", "26", "]"}], ";"}], "\n", 
 RowBox[{"expressionStringFromSentence", "[", 
  RowBox[{
   RowBox[{"generateSentence", "[", 
    RowBox[{"BPTprobabilized", ",", "Const", ",", 
     RowBox[{"terminalsFromGrammar", "@", "BPT"}], ",", "10"}], "]"}], ",", 
   "spaceRules"}], "]"}]}], "Input",
 CellChangeTimes->{{3.841323141763595*^9, 3.84132319399882*^9}, {
   3.841323488360787*^9, 3.84132351127387*^9}, {3.8413322627916*^9, 
   3.8413322939035187`*^9}, {3.841332334334746*^9, 3.841332379400677*^9}, 
   3.841333927035123*^9, {3.841333972854643*^9, 3.8413339942644253`*^9}},
 CellLabel->
  "In[823]:=",ExpressionUUID->"8bbe5212-e7cd-4dde-93cc-b2f8537c2527"],

Cell[BoxData["\<\"pred iszero if 0 0 0 \"\>"], "Output",
 CellChangeTimes->{{3.841323194763764*^9, 3.841323203626982*^9}, {
   3.841323243172601*^9, 3.841323271008219*^9}, {3.84132349120043*^9, 
   3.841323530835802*^9}, 3.841324760104061*^9, 3.841324989978862*^9, {
   3.8413261822264013`*^9, 3.841326233607498*^9}, 3.841326436013929*^9, {
   3.841332256603612*^9, 3.841332294642045*^9}, {3.841332338202368*^9, 
   3.841332427838818*^9}, 3.841332926522331*^9, 3.8413336342511578`*^9, 
   3.8413339278122807`*^9, {3.8413339746835823`*^9, 3.841333988002864*^9}, 
   3.8413387674499*^9, 3.841350167101782*^9, 3.841350492726111*^9, 
   3.841350590044621*^9, 3.841350777773675*^9, 3.84135083489119*^9, 
   3.841350881421067*^9, 3.841351117465726*^9, {3.841351371157617*^9, 
   3.84135139793942*^9}, 3.841351556476316*^9, 3.841351812087714*^9, 
   3.841351935513695*^9, 3.8413519781915817`*^9, 3.841352241317073*^9, 
   3.841397422896953*^9, 3.841403446050791*^9, 3.84140676386182*^9, 
   3.841422369036771*^9, 3.911255354675161*^9, 3.911290462267411*^9, 
   3.912270640741959*^9, 3.912546354093569*^9, 3.912589072551327*^9, 
   3.912600352021256*^9, 3.912601707098938*^9, 3.915050872188279*^9, 
   3.915535458161621*^9},
 CellLabel->
  "Out[824]=",ExpressionUUID->"8f6a4ed9-0ab5-4eca-9fcd-ae6f7b81d218"]
}, Open  ]],

Cell[TextData[{
 "The parser, itself, is a composition of ",
 StyleBox["partTree", "Input"],
 " (\[OpenCurlyQuote]cadr\[CloseCurlyQuote]), the parser table above, and a \
tokenizer function, which will just be ",
 StyleBox["StringSplit", "Input"],
 " for this application:"
}], "Text",
 CellChangeTimes->{{3.841319493436736*^9, 3.841319533615781*^9}, {
  3.841323639488565*^9, 
  3.841323652230207*^9}},ExpressionUUID->"b672a40d-ba4c-432b-8dcb-\
a02026005d18"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"SeedRandom", "[", "26", "]"}], ";"}], "\n", 
 RowBox[{"DynamicModule", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"foo", "=", 
     RowBox[{"generateSentence", "[", 
      RowBox[{"BPTprobabilized", ",", "Const", ",", 
       RowBox[{"terminalsFromGrammar", "@", "BPT"}], ",", "20"}], "]"}]}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Manipulate", "[", 
    RowBox[{"foo", ",", "\[IndentingNewLine]", 
     RowBox[{"Button", "[", 
      RowBox[{"\"\<GEN\>\"", ",", 
       RowBox[{"foo", "=", 
        RowBox[{"generateSentence", "[", 
         RowBox[{"BPTprobabilized", ",", "Const", ",", 
          RowBox[{"terminalsFromGrammar", "@", "BPT"}], ",", "20"}], 
         "]"}]}]}], "]"}]}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.841332589264677*^9, 3.841332600369412*^9}, 
   3.841352445020228*^9, {3.911292542181117*^9, 3.911292547896649*^9}},
 CellLabel->
  "In[825]:=",ExpressionUUID->"a03bb016-2adf-47af-9cf5-009519e182e6"],

Cell[BoxData[
 DynamicModuleBox[{$CellContext`foo$$ = {
  "pred", "iszero", "if", "iszero", "pred", "if", "false", "false", "true", 
   "iszero", "if", "if", "false", "false", "false", "false", "0", "if", "if", 
   "0", "if", "0", "0", "0", "0", "iszero", "if", "true", "0", "false", "if", 
   "succ", "0", "if", "0", "0", "false", "if", "true", "0", "false"}}, 
  TagBox[
   StyleBox[
    DynamicModuleBox[{Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
     Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
     1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{
       Hold[
        Button[
        "GEN", $CellContext`foo$$ = \
$CellContext`generateSentence[$CellContext`BPTprobabilized, \
$CellContext`Const, 
           $CellContext`terminalsFromGrammar[$CellContext`BPT], 20]]], 
       Manipulate`Dump`ThisIsNotAControl, ControlType -> None}}, 
     Typeset`size$$ = {1149.5, {36.323402404785156`, 19.18787384033203}}, 
     Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = True}, 
     DynamicBox[Manipulate`ManipulateBoxes[
      1, StandardForm, "Variables" :> {}, "ControllerVariables" :> {}, 
       "OtherVariables" :> {
        Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
         Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
         Typeset`specs$$, Typeset`size$$, Typeset`update$$, 
         Typeset`initDone$$, Typeset`skipInitDone$$}, 
       "Body" :> $CellContext`foo$$, "Specifications" :> {
         Button[
         "GEN", $CellContext`foo$$ = \
$CellContext`generateSentence[$CellContext`BPTprobabilized, \
$CellContext`Const, 
            $CellContext`terminalsFromGrammar[$CellContext`BPT], 20]]}, 
       "Options" :> {}, "DefaultOptions" :> {}],
      ImageSizeCache->{1512., {93., 102.}},
      SingleEvaluation->True],
     Deinitialization:>None,
     DynamicModuleValues:>{},
     SynchronousInitialization->True,
     UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
     UnsavedVariables:>{Typeset`initDone$$},
     UntrackedVariables:>{Typeset`size$$}], "Manipulate",
    Deployed->True,
    StripOnInput->False],
   Manipulate`InterpretManipulate[1]],
  DynamicModuleValues:>{}]], "Output",
 CellChangeTimes->{{3.841332720340673*^9, 3.841332753165341*^9}, 
   3.8413328278468313`*^9, 3.841332926694319*^9, 3.841333660257801*^9, 
   3.841350167234458*^9, 3.841352241456983*^9, 3.841352407820167*^9, 
   3.841352446260128*^9, 3.841352483265638*^9, 3.841390063942333*^9, 
   3.841397443038273*^9, 3.841403446190119*^9, 3.841406794986539*^9, 
   3.841422369066181*^9, 3.911255354689371*^9, 3.911290462277477*^9, 
   3.9112925487636433`*^9, 3.912270659369991*^9, 3.9125463541048584`*^9, 
   3.91258907257088*^9, 3.912600352032992*^9, 3.912601707112914*^9, 
   3.915050872195537*^9, 3.915535458172716*^9},
 CellLabel->
  "Out[826]=",ExpressionUUID->"0301f499-9d18-4a63-ad5e-b3f3aaa9b819"]
}, Open  ]],

Cell["\<\
In the display below, hover over a vertex to see its content.\
\>", "Text",
 CellChangeTimes->{{3.841407167752446*^9, 
  3.841407180426322*^9}},ExpressionUUID->"ed61996f-f8ce-46da-9d8a-\
22c916260f2c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"SeedRandom", "[", "26", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"gengen", "=", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"sen", "=", 
            RowBox[{"generateSentence", "[", 
             RowBox[{"BPTprobabilized", ",", "Const", ",", 
              RowBox[{"terminalsFromGrammar", "@", "BPT"}], ",", "20"}], 
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"tpt", "=", 
              RowBox[{"Timing", "@", 
               RowBox[{"$bptTable", "@", "sen"}]}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Column", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"sen", ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"ToString", "[", 
                  RowBox[{"Length", "@", "sen"}], "]"}], "<>", 
                 "\"\< Leaves\>\""}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"ToString", "@", 
                  RowBox[{"tpt", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "*", "Seconds"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"TreeForm", "[", 
                 RowBox[{
                  RowBox[{"tpt", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], 
                  RowBox[{"(*", 
                   RowBox[{",", 
                    RowBox[{"VertexLabeling", "\[Rule]", "Automatic"}]}], 
                   "*)"}], ",", 
                  RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}], "}"}],
               ",", "\[IndentingNewLine]", 
              RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}]}], "]"}]}], 
         "]"}]}], "]"}], "&"}]}], "}"}], ",", "\n", 
   RowBox[{"DynamicModule", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"foo", "=", 
       RowBox[{"gengen", "[", "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Manipulate", "[", 
      RowBox[{
       RowBox[{"{", "foo", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<GEN\>\"", ",", 
         RowBox[{"foo", "=", 
          RowBox[{"gengen", "[", "]"}]}]}], "]"}]}], "]"}]}], "]"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.841332788628635*^9, 3.841332792478114*^9}, 
   3.841394140181737*^9, {3.841397569878972*^9, 3.841397634096642*^9}, {
   3.841406846043442*^9, 3.841406868723995*^9}, {3.8414069901776943`*^9, 
   3.84140700081597*^9}, {3.841407036201086*^9, 3.84140706992179*^9}, {
   3.841407100801927*^9, 3.8414071018060093`*^9}, 3.841407193053583*^9, {
   3.911292559834152*^9, 3.911292605598213*^9}},
 CellLabel->
  "In[827]:=",ExpressionUUID->"6cb28901-02d2-40cf-a9af-e67a2548df2f"],

Cell[BoxData[
 DynamicModuleBox[{$CellContext`foo$$ = 
  Column[{{"pred", "iszero", "if", "iszero", "pred", "if", "false", "false", 
     "true", "iszero", "if", "if", "false", "false", "false", "false", "0", 
     "if", "if", "0", "if", "0", "0", "0", "0", "iszero", "if", "true", "0", 
     "false", "if", "succ", "0", "if", "0", "0", "false", "if", "true", "0", 
     "false"}, "41 Leaves", "0.000218" $CellContext`Seconds, 
    TreeForm[
     $CellContext`Unary["pred", 
      $CellContext`Unary["iszero", 
       $CellContext`Ternary["if", 
        $CellContext`Unary["iszero", 
         $CellContext`Unary["pred", 
          $CellContext`Ternary["if", 
           $CellContext`Const["false"], 
           $CellContext`Const["false"], 
           $CellContext`Const["true"]]]], 
        $CellContext`Unary["iszero", 
         $CellContext`Ternary["if", 
          $CellContext`Ternary["if", 
           $CellContext`Const["false"], 
           $CellContext`Const["false"], 
           $CellContext`Const["false"]], 
          $CellContext`Const["false"], 
          $CellContext`Const["0"]]], 
        $CellContext`Ternary["if", 
         $CellContext`Ternary["if", 
          $CellContext`Const["0"], 
          $CellContext`Ternary["if", 
           $CellContext`Const["0"], 
           $CellContext`Const["0"], 
           $CellContext`Const["0"]], 
          $CellContext`Const["0"]], 
         $CellContext`Unary["iszero", 
          $CellContext`Ternary["if", 
           $CellContext`Const["true"], 
           $CellContext`Const["0"], 
           $CellContext`Const["false"]]], 
         $CellContext`Ternary["if", 
          $CellContext`Unary["succ", 
           $CellContext`Const["0"]], 
          $CellContext`Ternary["if", 
           $CellContext`Const["0"], 
           $CellContext`Const["0"], 
           $CellContext`Const["false"]], 
          $CellContext`Ternary["if", 
           $CellContext`Const["true"], 
           $CellContext`Const["0"], 
           $CellContext`Const["false"]]]]]]], ImageSize -> Large]}, Frame -> 
   All]}, 
  TagBox[
   StyleBox[
    DynamicModuleBox[{Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
     Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
     1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{
       Hold[
        Button["GEN", $CellContext`foo$$ = (Module[{}, 
           
           With[{$CellContext`sen = \
$CellContext`generateSentence[$CellContext`BPTprobabilized, \
$CellContext`Const, 
               $CellContext`terminalsFromGrammar[$CellContext`BPT], 20]}, 
            With[{$CellContext`tpt = Timing[
                $CellContext`$bptTable[$CellContext`sen]]}, 
             Column[{$CellContext`sen, ToString[
                 Length[$CellContext`sen]] <> " Leaves", ToString[
                 Part[$CellContext`tpt, 1]] $CellContext`Seconds, 
               TreeForm[
                Part[$CellContext`tpt, 2, 2], ImageSize -> Large]}, Frame -> 
              All]]]]& )[]]], Manipulate`Dump`ThisIsNotAControl, ControlType -> 
       None}}, Typeset`size$$ = {
     1548., {222.2010498046875, 230.7989501953125}}, Typeset`update$$ = 0, 
     Typeset`initDone$$, Typeset`skipInitDone$$ = True}, 
     DynamicBox[Manipulate`ManipulateBoxes[
      1, StandardForm, "Variables" :> {}, "ControllerVariables" :> {}, 
       "OtherVariables" :> {
        Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
         Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
         Typeset`specs$$, Typeset`size$$, Typeset`update$$, 
         Typeset`initDone$$, Typeset`skipInitDone$$}, 
       "Body" :> {$CellContext`foo$$}, "Specifications" :> {
         Button["GEN", $CellContext`foo$$ = (Module[{}, 
            
            With[{$CellContext`sen = \
$CellContext`generateSentence[$CellContext`BPTprobabilized, \
$CellContext`Const, 
                $CellContext`terminalsFromGrammar[$CellContext`BPT], 20]}, 
             With[{$CellContext`tpt = Timing[
                 $CellContext`$bptTable[$CellContext`sen]]}, 
              Column[{$CellContext`sen, ToString[
                  Length[$CellContext`sen]] <> " Leaves", ToString[
                  Part[$CellContext`tpt, 1]] $CellContext`Seconds, 
                TreeForm[
                 Part[$CellContext`tpt, 2, 2], ImageSize -> Large]}, Frame -> 
               All]]]]& )[]]}, "Options" :> {}, "DefaultOptions" :> {}],
      ImageSizeCache->{1546., {292., 300.}},
      SingleEvaluation->True],
     Deinitialization:>None,
     DynamicModuleValues:>{},
     SynchronousInitialization->True,
     UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
     UnsavedVariables:>{Typeset`initDone$$},
     UntrackedVariables:>{Typeset`size$$}], "Manipulate",
    Deployed->True,
    StripOnInput->False],
   Manipulate`InterpretManipulate[1]],
  DynamicModuleValues:>{}]], "Output",
 CellChangeTimes->{{3.841324201649147*^9, 3.841324217405355*^9}, 
   3.841324304255974*^9, 3.841324454609769*^9, 3.841324760203178*^9, 
   3.841324990163683*^9, {3.841326254812622*^9, 3.841326278928687*^9}, {
   3.841326310754222*^9, 3.841326321744741*^9}, 3.8413264680081863`*^9, 
   3.84133255721094*^9, {3.841332602736132*^9, 3.841332627981198*^9}, {
   3.8413327796907473`*^9, 3.841332795192563*^9}, 3.841350167373721*^9, 
   3.841352241620755*^9, 3.84139414107779*^9, 3.841397542890836*^9, 
   3.841397577280654*^9, {3.841397607434627*^9, 3.841397634624881*^9}, 
   3.841403446403968*^9, 3.841406829759796*^9, 3.841406869675992*^9, 
   3.8414070018495483`*^9, {3.841407045323389*^9, 3.8414070708152723`*^9}, 
   3.841407103185657*^9, 3.841407194040215*^9, 3.841408435971889*^9, 
   3.841422369109788*^9, 3.911255354743098*^9, 3.911290462300324*^9, 
   3.911292606769868*^9, 3.9122706691567*^9, 3.912546354130198*^9, 
   3.9125890726241198`*^9, 3.912600352060852*^9, 3.9126017071738167`*^9, 
   3.915050872219655*^9, 3.915535458198608*^9},
 CellLabel->
  "Out[828]=",ExpressionUUID->"103e9deb-8d3b-4d70-b890-436d69a98977"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["SMALL-STEP OPERATIONAL SEMANTICS", "Section",
 CellChangeTimes->{{3.841408141104127*^9, 
  3.841408150963554*^9}},ExpressionUUID->"0115f12c-e900-4c3a-9766-\
ac1e10bb7017"],

Cell["Gin up a sample.", "Text",
 CellChangeTimes->{{3.841420118792238*^9, 
  3.841420123011155*^9}},ExpressionUUID->"7f804028-0e97-4e42-9566-\
0f50b1be8ee5"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"SeedRandom", "[", "26", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "$test", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{"$test", "=", 
    RowBox[{
     RowBox[{"$bptTable", "[", 
      RowBox[{"generateSentence", "[", 
       RowBox[{"BPTprobabilized", ",", "Const", ",", 
        RowBox[{"terminalsFromGrammar", "@", "BPT"}], ",", "20"}], "]"}], 
      "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "//", "InputForm"}]}], "Input",
 CellChangeTimes->{{3.8414084460871973`*^9, 3.8414085252498674`*^9}, {
  3.841408605562854*^9, 3.841408607278481*^9}, {3.84140877793517*^9, 
  3.841408807448102*^9}},
 CellLabel->
  "In[829]:=",ExpressionUUID->"fa28991c-af7e-4b13-9ade-4f580e0a78c7"],

Cell["\<\
Unary[\"pred\", Unary[\"iszero\", Ternary[\"if\", Unary[\"iszero\", 
    Unary[\"pred\", Ternary[\"if\", Const[\"false\"], Const[\"false\"], \
Const[\"true\"]]]], 
   Unary[\"iszero\", Ternary[\"if\", Ternary[\"if\", Const[\"false\"], Const[\
\"false\"], 
      Const[\"false\"]], Const[\"false\"], Const[\"0\"]]], 
   Ternary[\"if\", Ternary[\"if\", Const[\"0\"], Ternary[\"if\", \
Const[\"0\"], Const[\"0\"], 
      Const[\"0\"]], Const[\"0\"]], Unary[\"iszero\", Ternary[\"if\", \
Const[\"true\"], 
      Const[\"0\"], Const[\"false\"]]], Ternary[\"if\", Unary[\"succ\", \
Const[\"0\"]], 
     Ternary[\"if\", Const[\"0\"], Const[\"0\"], Const[\"false\"]], 
     Ternary[\"if\", Const[\"true\"], Const[\"0\"], Const[\"false\"]]]]]]]\
\>", "Output",
 CellChangeTimes->{{3.841408492708499*^9, 3.841408526196546*^9}, 
   3.841408608358145*^9, 3.841408808382435*^9, 3.841422369150136*^9, 
   3.911255354790227*^9, 3.9112904623171873`*^9, 3.912270689030083*^9, 
   3.912546354200151*^9, 3.912589072691223*^9, 3.912600352139239*^9, 
   3.912601707240018*^9, 3.915050872287324*^9, 3.9155354582629757`*^9},
 CellLabel->
  "Out[831]//InputForm=",ExpressionUUID->"7f04a3e4-9d31-4554-b364-\
c4c27d832962"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Boolean Evaluation Rules", "Subsection",
 CellChangeTimes->{{3.841420137159439*^9, 
  3.841420142442965*^9}},ExpressionUUID->"d28fa07d-9cb8-4542-b945-\
2b9264208629"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{"Ternary", ",", "evBoolRules35"}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"model", " ", "E"}], "-", 
    RowBox[{
    "If", " ", "with", " ", "a", " ", "function", " ", "representing", " ", 
     "the", " ", "premise", " ", "transition", " ", "that", " ", "is", " ", 
     "above", " ", "the", " ", 
     RowBox[{"line", ".", " ", "The"}], " ", "function", " ", "returns", " ", 
     "the", " ", "transition", " ", 
     RowBox[{"rules", "."}]}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"evBoolRules35", "[", 
     RowBox[{"c1_", ",", "c1p_"}], "]"}], ":=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Ternary", "[", 
        RowBox[{"\"\<if\>\"", ",", 
         RowBox[{"Const", "[", "\"\<true\>\"", "]"}], ",", "t1_", ",", 
         "t2_"}], "]"}], "\[RuleDelayed]", "t1"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Ternary", "[", 
        RowBox[{"\"\<if\>\"", ",", 
         RowBox[{"Const", "[", "\"\<false\>\"", "]"}], ",", "t1_", ",", 
         "t2_"}], "]"}], "\[RuleDelayed]", "t2"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Ternary", "[", 
        RowBox[{"\"\<if\>\"", ",", "c1", ",", "t1_", ",", "t2_"}], "]"}], 
       "\[RuleDelayed]", 
       RowBox[{"Ternary", "[", 
        RowBox[{"\"\<if\>\"", ",", "c1p", ",", "t1", ",", "t2"}], "]"}]}]}], 
     "}"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Ternary", "[", 
      RowBox[{"\"\<if\>\"", ",", 
       RowBox[{"Const", "[", "\"\<true\>\"", "]"}], ",", "t1_", ",", "t2_"}], 
      "]"}], ":=", "t1"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Ternary", "[", 
      RowBox[{"\"\<if\>\"", ",", 
       RowBox[{"Const", "[", "\"\<false\>\"", "]"}], ",", "t1_", ",", "t2_"}],
       "]"}], ":=", "t2"}], ";"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "dpyRules", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dpyRules", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Const", "[", "\"\<0\>\"", "]"}], "\[Rule]", "\"\<0\>\""}], ",", 
     RowBox[{
      RowBox[{"Const", "[", "\"\<true\>\"", "]"}], "\[Rule]", "\"\<#t\>\""}], 
     ",", 
     RowBox[{
      RowBox[{"Const", "[", "\"\<false\>\"", "]"}], "\[Rule]", 
      "\"\<#f\>\""}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8414085403812113`*^9, 3.841408715042179*^9}, {
   3.841409058624693*^9, 3.841409067539864*^9}, {3.841409108782733*^9, 
   3.841409114281372*^9}, {3.841409145954756*^9, 3.841409146278864*^9}, {
   3.841409300261097*^9, 3.841409336243005*^9}, {3.8414093715262823`*^9, 
   3.841409481022196*^9}, {3.841409578920125*^9, 3.841409703700626*^9}, 
   3.841409743326271*^9, {3.841411396399353*^9, 3.841411430244139*^9}, {
   3.841411530731484*^9, 3.841411599648665*^9}, {3.841411719460194*^9, 
   3.841411740797064*^9}, {3.841415132897059*^9, 3.841415139486025*^9}, {
   3.841415198842146*^9, 3.841415242230685*^9}},
 CellLabel->
  "In[832]:=",ExpressionUUID->"9358cfee-bc28-4191-a296-e8cad9102b39"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"$test", "//.", 
   RowBox[{"evBoolRules35", "[", 
    RowBox[{"Null", ",", "Null"}], "]"}]}], "/.", "dpyRules"}]], "Input",
 CellChangeTimes->{{3.841408719357289*^9, 3.841408737117291*^9}, {
  3.84140888962116*^9, 3.841408891977935*^9}, {3.841411446125459*^9, 
  3.841411452720787*^9}},
 CellLabel->
  "In[836]:=",ExpressionUUID->"ee72d0ba-a569-42d1-a9b4-0648b35a9d54"],

Cell[BoxData[
 RowBox[{"Unary", "[", 
  RowBox[{"\<\"pred\"\>", ",", 
   RowBox[{"Unary", "[", 
    RowBox[{"\<\"iszero\"\>", ",", 
     RowBox[{"Ternary", "[", 
      RowBox[{"\<\"if\"\>", ",", 
       RowBox[{"Unary", "[", 
        RowBox[{"\<\"iszero\"\>", ",", 
         RowBox[{"Unary", "[", 
          RowBox[{"\<\"pred\"\>", ",", "\<\"#t\"\>"}], "]"}]}], "]"}], ",", 
       RowBox[{"Unary", "[", 
        RowBox[{"\<\"iszero\"\>", ",", "\<\"0\"\>"}], "]"}], ",", 
       RowBox[{"Ternary", "[", 
        RowBox[{"\<\"if\"\>", ",", 
         RowBox[{"Ternary", "[", 
          RowBox[{"\<\"if\"\>", ",", "\<\"0\"\>", ",", 
           RowBox[{"Ternary", "[", 
            
            RowBox[{"\<\"if\"\>", ",", "\<\"0\"\>", ",", "\<\"0\"\>", 
             ",", "\<\"0\"\>"}], "]"}], ",", "\<\"0\"\>"}], "]"}], ",", 
         RowBox[{"Unary", "[", 
          RowBox[{"\<\"iszero\"\>", ",", "\<\"0\"\>"}], "]"}], ",", 
         RowBox[{"Ternary", "[", 
          RowBox[{"\<\"if\"\>", ",", 
           RowBox[{"Unary", "[", 
            RowBox[{"\<\"succ\"\>", ",", "\<\"0\"\>"}], "]"}], ",", 
           RowBox[{"Ternary", "[", 
            
            RowBox[{"\<\"if\"\>", ",", "\<\"0\"\>", ",", "\<\"0\"\>", 
             ",", "\<\"#f\"\>"}], "]"}], ",", "\<\"0\"\>"}], "]"}]}], "]"}]}],
       "]"}]}], "]"}]}], "]"}]], "Output",
 CellChangeTimes->{3.841422369189986*^9, 3.91125535484721*^9, 
  3.911290462336309*^9, 3.912270694911593*^9, 3.912546354211903*^9, 
  3.91258907270879*^9, 3.912600352174136*^9, 3.912601707249778*^9, 
  3.915050872297125*^9, 3.915535458275489*^9},
 CellLabel->
  "Out[836]=",ExpressionUUID->"7725bbfa-01e7-4b6c-ac06-cfbe6b86746b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Unary", "[", 
  RowBox[{"\"\<pred\>\"", ",", 
   RowBox[{"Unary", "[", 
    RowBox[{"\"\<iszero\>\"", ",", 
     RowBox[{"Ternary", "[", 
      RowBox[{"\"\<if\>\"", ",", 
       RowBox[{"Unary", "[", 
        RowBox[{"\"\<iszero\>\"", ",", 
         RowBox[{"Unary", "[", 
          RowBox[{"\"\<pred\>\"", ",", "\"\<#t\>\""}], "]"}]}], "]"}], ",", 
       RowBox[{"Unary", "[", 
        RowBox[{"\"\<iszero\>\"", ",", "\"\<0\>\""}], "]"}], ",", 
       RowBox[{"Ternary", "[", 
        RowBox[{"\"\<if\>\"", ",", 
         RowBox[{"Ternary", "[", 
          RowBox[{"\"\<if\>\"", ",", "\"\<0\>\"", ",", 
           RowBox[{"Ternary", "[", 
            RowBox[{
            "\"\<if\>\"", ",", "\"\<0\>\"", ",", "\"\<0\>\"", ",", 
             "\"\<0\>\""}], "]"}], ",", "\"\<0\>\""}], "]"}], ",", 
         RowBox[{"Unary", "[", 
          RowBox[{"\"\<iszero\>\"", ",", "\"\<0\>\""}], "]"}], ",", 
         RowBox[{"Ternary", "[", 
          RowBox[{"\"\<if\>\"", ",", 
           RowBox[{"Unary", "[", 
            RowBox[{"\"\<succ\>\"", ",", "\"\<0\>\""}], "]"}], ",", 
           RowBox[{"Ternary", "[", 
            RowBox[{
            "\"\<if\>\"", ",", "\"\<0\>\"", ",", "\"\<0\>\"", ",", 
             "\"\<#f\>\""}], "]"}], ",", "\"\<0\>\""}], "]"}]}], "]"}]}], 
      "]"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.841420108761094*^9, 3.841420108764604*^9}},
 CellLabel->
  "In[837]:=",ExpressionUUID->"cd6226df-5be2-40d7-bf3b-da44978ba5d6"],

Cell[BoxData[
 RowBox[{"Unary", "[", 
  RowBox[{"\<\"pred\"\>", ",", 
   RowBox[{"Unary", "[", 
    RowBox[{"\<\"iszero\"\>", ",", 
     RowBox[{"Ternary", "[", 
      RowBox[{"\<\"if\"\>", ",", 
       RowBox[{"Unary", "[", 
        RowBox[{"\<\"iszero\"\>", ",", 
         RowBox[{"Unary", "[", 
          RowBox[{"\<\"pred\"\>", ",", "\<\"#t\"\>"}], "]"}]}], "]"}], ",", 
       RowBox[{"Unary", "[", 
        RowBox[{"\<\"iszero\"\>", ",", "\<\"0\"\>"}], "]"}], ",", 
       RowBox[{"Ternary", "[", 
        RowBox[{"\<\"if\"\>", ",", 
         RowBox[{"Ternary", "[", 
          RowBox[{"\<\"if\"\>", ",", "\<\"0\"\>", ",", 
           RowBox[{"Ternary", "[", 
            
            RowBox[{"\<\"if\"\>", ",", "\<\"0\"\>", ",", "\<\"0\"\>", 
             ",", "\<\"0\"\>"}], "]"}], ",", "\<\"0\"\>"}], "]"}], ",", 
         RowBox[{"Unary", "[", 
          RowBox[{"\<\"iszero\"\>", ",", "\<\"0\"\>"}], "]"}], ",", 
         RowBox[{"Ternary", "[", 
          RowBox[{"\<\"if\"\>", ",", 
           RowBox[{"Unary", "[", 
            RowBox[{"\<\"succ\"\>", ",", "\<\"0\"\>"}], "]"}], ",", 
           RowBox[{"Ternary", "[", 
            
            RowBox[{"\<\"if\"\>", ",", "\<\"0\"\>", ",", "\<\"0\"\>", 
             ",", "\<\"#f\"\>"}], "]"}], ",", "\<\"0\"\>"}], "]"}]}], "]"}]}],
       "]"}]}], "]"}]}], "]"}]], "Output",
 CellChangeTimes->{3.8414223692146187`*^9, 3.911255354856683*^9, 
  3.911290462345755*^9, 3.91227069676645*^9, 3.912546354215633*^9, 
  3.912589072712529*^9, 3.912600352205896*^9, 3.9126017072584457`*^9, 
  3.915050872304275*^9, 3.9155354582793303`*^9},
 CellLabel->
  "Out[837]=",ExpressionUUID->"582f74c0-bada-451b-9e62-6a9fe3308943"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Ternary", "[", 
   RowBox[{"\"\<if\>\"", ",", "c1", ",", "t1", ",", "t2"}], "]"}], "//.", 
  RowBox[{"evBoolRules35", "[", 
   RowBox[{"c1", ",", "c1p"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.84141147871744*^9, 3.841411521321513*^9}, {
  3.841411627171921*^9, 3.841411709346795*^9}},
 CellLabel->
  "In[838]:=",ExpressionUUID->"42122803-f284-4e20-b998-8171ea6406a6"],

Cell[BoxData[
 RowBox[{"Ternary", "[", 
  RowBox[{"\<\"if\"\>", ",", "c1p", ",", "t1", ",", "t2"}], "]"}]], "Output",
 CellChangeTimes->{{3.841411654112646*^9, 3.841411710327392*^9}, 
   3.8414223692556543`*^9, 3.911255354904149*^9, 3.91129046234951*^9, 
   3.912270699492748*^9, 3.912546354223491*^9, 3.912589072724015*^9, 
   3.91260035221*^9, 3.912601707261898*^9, 3.915050872307893*^9, 
   3.915535458289195*^9},
 CellLabel->
  "Out[838]=",ExpressionUUID->"6d2196aa-3d7d-4c7f-b201-652ddcc56358"]
}, Open  ]],

Cell["\<\
The function for boolRules can be called with complicated arguments:\.18\
\>", "Text",
 CellChangeTimes->{{3.841415710536132*^9, 
  3.841415744672244*^9}},ExpressionUUID->"26a2b549-2046-4e03-bdd5-\
54af2c0bcd89"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Ternary", "[", 
   RowBox[{"\"\<if\>\"", ",", 
    RowBox[{"Ternary", "[", 
     RowBox[{"\"\<if\>\"", ",", 
      RowBox[{"Const", "[", "\"\<true\>\"", "]"}], ",", 
      RowBox[{"Const", "[", "\"\<false\>\"", "]"}], ",", 
      RowBox[{"Const", "[", "\"\<true\>\"", "]"}]}], "]"}], ",", "t1", ",", 
    "t2"}], "]"}], "//.", 
  RowBox[{"evBoolRules35", "[", 
   RowBox[{
    RowBox[{"Ternary", "[", 
     RowBox[{"\"\<if\>\"", ",", 
      RowBox[{"Const", "[", "\"\<true\>\"", "]"}], ",", 
      RowBox[{"Const", "[", "\"\<false\>\"", "]"}], ",", 
      RowBox[{"Const", "[", "\"\<true\>\"", "]"}]}], "]"}], ",", "c1p"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.841415592185878*^9, 3.841415698883223*^9}},
 CellLabel->
  "In[839]:=",ExpressionUUID->"10f79d79-c0b8-4bb2-844e-70fe3f05bd91"],

Cell[BoxData[
 RowBox[{"Ternary", "[", 
  RowBox[{"\<\"if\"\>", ",", "c1p", ",", "t1", ",", "t2"}], "]"}]], "Output",
 CellChangeTimes->{3.841415699640124*^9, 3.8414223692766438`*^9, 
  3.911255354908472*^9, 3.911290462358408*^9, 3.912270701990213*^9, 
  3.912546354226925*^9, 3.912589072727566*^9, 3.912600352216441*^9, 
  3.91260170726971*^9, 3.915050872316314*^9, 3.915535458293038*^9},
 CellLabel->
  "Out[839]=",ExpressionUUID->"3d755b1d-74ce-4275-8979-b5840c1cdb2b"]
}, Open  ]],

Cell["\<\
The following is the derivation tree of Section 3.5.3 in an manually \
prettified input form. But the output is clear.\
\>", "Text",
 CellChangeTimes->{{3.841418777483783*^9, 3.841418789462562*^9}, {
  3.841418856864352*^9, 3.841418880998604*^9}, {3.84141962434431*^9, 
  3.8414196308004007`*^9}},ExpressionUUID->"42540005-4625-4691-9fb6-\
2a7e61fc009a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "s", ",", "t", ",", "u", ",", "if", ",", "$t", ",", "$f", ",", "rlz"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$t", "=", 
     RowBox[{"Const", "[", "\"\<true\>\"", "]"}]}], ";", 
    RowBox[{"$f", "=", 
     RowBox[{"Const", "[", "\"\<false\>\"", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"if", "[", 
      RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], ":=", 
     RowBox[{"Ternary", "[", 
      RowBox[{"\"\<if\>\"", ",", "a", ",", "b", ",", "c"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"s", "=", 
     RowBox[{"if", "[", 
      RowBox[{"$t", ",", "$f", ",", "$f"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"t", "=", 
     RowBox[{"if", "[", 
      RowBox[{"s", ",", "$t", ",", "$t"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"u", "=", 
     RowBox[{"if", "[", 
      RowBox[{"$f", ",", "$t", ",", "$t"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"rlz", "=", 
     RowBox[{"evBoolRules35", "[", 
      RowBox[{"t", ",", "u"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"<|", 
     RowBox[{
      RowBox[{"\"\<s\[Rule]false\>\"", "\[Rule]", 
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"s", "/.", "rlz"}], ")"}], "===", "$f"}], ")"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<t\[Rule]u\>\"", "\[Rule]", "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"t", "/.", "rlz"}], ")"}], "===", "u"}], ")"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
      "\"\<(if t...)\[Rule](if u...)\>\"", "\[Rule]", "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"if", "[", 
            RowBox[{"t", ",", "$f", ",", "$f"}], "]"}], "/.", "rlz"}], ")"}], 
         "===", 
         RowBox[{"if", "[", 
          RowBox[{"u", ",", "$f", ",", "$f"}], "]"}]}], ")"}]}]}], 
     "\[IndentingNewLine]", "|>"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.841415899566004*^9, 3.841416313953562*^9}, {
   3.841416577773488*^9, 3.841416636752809*^9}, {3.841416718788371*^9, 
   3.841416765523465*^9}, {3.841416809288396*^9, 3.841416870847227*^9}, {
   3.84141692406328*^9, 3.841416932225438*^9}, {3.841416963316843*^9, 
   3.841416969820433*^9}, {3.841417089804457*^9, 3.841417168690274*^9}, {
   3.841417348136608*^9, 3.84141736168583*^9}, {3.841417457282851*^9, 
   3.841417507961345*^9}, {3.841418164779031*^9, 3.841418177769838*^9}, 
   3.841418275072463*^9, {3.841418305764787*^9, 3.841418334464747*^9}, {
   3.84141837001707*^9, 3.841418372419747*^9}, 3.841418403643063*^9, {
   3.841418444477841*^9, 3.841418727472906*^9}, {3.841418892495556*^9, 
   3.841418897787074*^9}, {3.8414189296479187`*^9, 3.841419484487199*^9}, {
   3.8414195235944157`*^9, 3.841419615455886*^9}},
 CellLabel->
  "In[840]:=",ExpressionUUID->"18392566-355d-4ff2-ad29-e6b6040c519e"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"s\[Rule]false\"\>", "\[Rule]", "True"}], ",", 
   RowBox[{"\<\"t\[Rule]u\"\>", "\[Rule]", "True"}], ",", 
   RowBox[{"\<\"(if t...)\[Rule](if u...)\"\>", "\[Rule]", "True"}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{
  3.841416651357273*^9, {3.841416720693046*^9, 3.841416729473664*^9}, 
   3.841416766317301*^9, 3.8414168103933153`*^9, {3.841416847383617*^9, 
   3.841416873886519*^9}, 3.8414169358298798`*^9, 3.8414169746469917`*^9, {
   3.841417115351059*^9, 3.841417170010415*^9}, 3.841417363339197*^9, {
   3.841417494627473*^9, 3.841417515148079*^9}, 3.841418179783081*^9, 
   3.841418275593121*^9, {3.841418312887025*^9, 3.84141833538789*^9}, 
   3.841418413375752*^9, {3.841418449347286*^9, 3.84141851967587*^9}, {
   3.841418553921363*^9, 3.841418565297701*^9}, 3.8414186822084837`*^9, 
   3.841418728474854*^9, {3.841419078155775*^9, 3.841419102288549*^9}, 
   3.841419137937202*^9, {3.841419238605617*^9, 3.841419262641115*^9}, {
   3.84141932105971*^9, 3.841419375561212*^9}, 3.841419412624703*^9, {
   3.841419450864909*^9, 3.841419485218279*^9}, 3.8414195392446*^9, 
   3.841419595237069*^9, 3.841422369302285*^9, 3.911255354934*^9, 
   3.911290462362794*^9, 3.912270704523157*^9, 3.912546354238847*^9, 
   3.9125890727387333`*^9, 3.912600352220109*^9, 3.912601707273397*^9, 
   3.915050872320709*^9, 3.915535458306035*^9},
 CellLabel->
  "Out[840]=",ExpressionUUID->"c525208d-7e7a-448e-a185-e1355ce64808"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Numerical Evaluation Rules", "Subsection",
 CellChangeTimes->{{3.841420243734851*^9, 
  3.841420256228692*^9}},ExpressionUUID->"36777c42-1123-4b09-ba78-\
4bc013558988"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "NB", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NB", "[", "Nv", "]"}], "=", 
   RowBox[{"(", GridBox[{
      {"Zero"},
      {"Succ"}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NB", "[", "Zero", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"{", "\"\<0\>\"", "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NB", "[", "Succ", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"\"\<succ\>\"", ",", "Nv"}], "}"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NB", "[", "Start", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"{", "Nv", "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"visGrammar", "[", "NB", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NBprobabilized", "=", 
   RowBox[{"injectGenerationProbabilities", "[", 
    RowBox[{"NB", ",", "equiProbabilities"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NBprobabilized", "//", "visGrammar"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"generateSentence", "[", 
  RowBox[{"NBprobabilized", ",", "Zero", ",", 
   RowBox[{"terminalsFromGrammar", "@", "NB"}], ",", "20"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "$nbTable", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"parserPatterns", "[", 
   RowBox[{"NB", ",", "$nbTable"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DownValues", "@", "$nbTable"}], "//", "TableForm"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.841423403936392*^9, 3.841423605140957*^9}, {
   3.8414236484436197`*^9, 3.841423701254377*^9}, {3.841423749006462*^9, 
   3.841423802373123*^9}, {3.841423881153284*^9, 3.8414239675886517`*^9}, {
   3.841424043216476*^9, 3.841424123272124*^9}, {3.841424164539307*^9, 
   3.841424204085376*^9}, {3.841424237259017*^9, 3.841424283993034*^9}, 
   3.841424356239319*^9, {3.841424388501164*^9, 3.84142447837894*^9}},
 CellLabel->
  "In[841]:=",ExpressionUUID->"ccdad6e6-6216-4088-b7f1-d2ee3914ee5a"],

Cell[BoxData[
 RowBox[{"{", "\<\"0\"\>", "}"}]], "Output",
 CellChangeTimes->{
  3.841424124431693*^9, 3.841424204895812*^9, 3.841424285329496*^9, {
   3.841424423569833*^9, 3.841424482056685*^9}, 3.91125535493842*^9, 
   3.911290462371563*^9, 3.912270710839418*^9, 3.912546354242664*^9, 
   3.912589072742478*^9, 3.9126003522268677`*^9, 3.912601707280923*^9, 
   3.915050872327545*^9, 3.915535458310748*^9},
 CellLabel->
  "Out[849]=",ExpressionUUID->"80c7b775-4e70-4ceb-a7d4-16c3aa1c1161"]
}, Open  ]],

Cell["Some travesties on NB", "Text",
 CellChangeTimes->{{3.8414245924998083`*^9, 
  3.8414246045443783`*^9}},ExpressionUUID->"14d8642a-f3ee-4b0d-9523-\
a3af33f0ba2f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"SeedRandom", "[", "26", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"gengen", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"$nbTable", "@", 
         RowBox[{"generateSentence", "[", 
          RowBox[{"NBprobabilized", ",", "Zero", ",", 
           RowBox[{"terminalsFromGrammar", "@", "NB"}], ",", "40"}], "]"}]}], 
        ")"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], "&"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"DynamicModule", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"foo", "=", 
       RowBox[{"gengen", "[", "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Manipulate", "[", 
      RowBox[{"foo", ",", "\[IndentingNewLine]", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<GEN\>\"", ",", 
         RowBox[{"foo", "=", 
          RowBox[{"gengen", "[", "]"}]}]}], "]"}]}], "]"}]}], "]"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.841424472334544*^9, 3.841424565869433*^9}, {
  3.841424608565767*^9, 3.841424692378972*^9}, {3.911292658911337*^9, 
  3.911292678561244*^9}, {3.911297306866754*^9, 3.91129736879313*^9}},
 CellLabel->
  "In[853]:=",ExpressionUUID->"0c615124-212a-4f4a-8c73-4b830afe4564"],

Cell[BoxData[
 DynamicModuleBox[{$CellContext`foo$$ = $CellContext`Succ["succ", 
   $CellContext`Succ["succ", 
    $CellContext`Zero["0"]]]}, 
  TagBox[
   StyleBox[
    DynamicModuleBox[{Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
     Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
     1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{
       Hold[
        Button["GEN", $CellContext`foo$$ = (Part[
           $CellContext`$nbTable[
            $CellContext`generateSentence[$CellContext`NBprobabilized, \
$CellContext`Zero, 
             $CellContext`terminalsFromGrammar[$CellContext`NB], 40]], 
           2]& )[]]], Manipulate`Dump`ThisIsNotAControl, ControlType -> 
       None}}, Typeset`size$$ = {357., {4.1535, 13.0455}}, Typeset`update$$ = 
     0, Typeset`initDone$$, Typeset`skipInitDone$$ = True}, 
     DynamicBox[Manipulate`ManipulateBoxes[
      1, StandardForm, "Variables" :> {}, "ControllerVariables" :> {}, 
       "OtherVariables" :> {
        Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
         Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
         Typeset`specs$$, Typeset`size$$, Typeset`update$$, 
         Typeset`initDone$$, Typeset`skipInitDone$$}, 
       "Body" :> $CellContext`foo$$, "Specifications" :> {
         Button["GEN", $CellContext`foo$$ = (Part[
            $CellContext`$nbTable[
             $CellContext`generateSentence[$CellContext`NBprobabilized, \
$CellContext`Zero, 
              $CellContext`terminalsFromGrammar[$CellContext`NB], 40]], 
            2]& )[]]}, "Options" :> {}, "DefaultOptions" :> {}],
      ImageSizeCache->{423., {78., 86.}},
      SingleEvaluation->True],
     Deinitialization:>None,
     DynamicModuleValues:>{},
     SynchronousInitialization->True,
     UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
     UnsavedVariables:>{Typeset`initDone$$},
     UntrackedVariables:>{Typeset`size$$}], "Manipulate",
    Deployed->True,
    StripOnInput->False],
   Manipulate`InterpretManipulate[1]],
  DynamicModuleValues:>{}]], "Output",
 CellChangeTimes->{
  3.841424124431693*^9, 3.841424204895812*^9, 3.841424285329496*^9, {
   3.841424423569833*^9, 3.841424467903322*^9}, {3.841424541861433*^9, 
   3.841424567817387*^9}, {3.841424614164097*^9, 3.841424653781457*^9}, 
   3.841424692924434*^9, 3.911255354967266*^9, 3.911290462381731*^9, {
   3.9112926605594063`*^9, 3.911292678940129*^9}, 3.91129736914207*^9, 
   3.91227071474928*^9, 3.912546354280624*^9, 3.912589072759044*^9, 
   3.91260035223295*^9, 3.912601707291102*^9, 3.9150508723375196`*^9, 
   3.915535458324266*^9},
 CellLabel->
  "Out[854]=",ExpressionUUID->"0d0120da-939e-47f5-8adf-d78a52ed2bc7"]
}, Open  ]],

Cell[TextData[{
 "Cross the syntactic domain of ",
 StyleBox["BPT[Term]", "Input"],
 " into the syntactic domain of ",
 StyleBox["NB[Nv]", "Input"],
 "."
}], "Text",
 CellChangeTimes->{{3.841425091942088*^9, 3.841425131990298*^9}, {
  3.841426067741545*^9, 3.841426069598486*^9}, {3.8414268180493793`*^9, 
  3.84142682024648*^9}, {3.91227072442908*^9, 
  3.9122707251126747`*^9}},ExpressionUUID->"7bcc4159-fff9-43e2-a3da-\
17e6c0acfa6d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "evNumRules35", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"evNumRules35", "[", 
    RowBox[{"t1_", ",", "t1p_"}], "]"}], ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
       RowBox[{"Const", "[", "\"\<0\>\"", "]"}], "\[Rule]", 
       RowBox[{"Zero", "[", "\"\<0\>\"", "]"}]}], ","}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Unary", "[", 
       RowBox[{"\"\<pred\>\"", ",", 
        RowBox[{"Const", "[", "\"\<0\>\"", "]"}]}], "]"}], "\[RuleDelayed]", 
      RowBox[{"Const", "[", "\"\<0\>\"", "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Unary", "[", 
       RowBox[{"\"\<pred\>\"", ",", 
        RowBox[{"Unary", "[", 
         RowBox[{"\"\<succ\>\"", ",", "nv_"}], "]"}]}], "]"}], 
      "\[RuleDelayed]", "nv"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Unary", "[", 
       RowBox[{"\"\<iszero\>\"", ",", 
        RowBox[{"Unary", "[", 
         RowBox[{"\"\<succ\>\"", ",", 
          RowBox[{"Const", "[", "\"\<succ\>\"", "]"}]}], "]"}]}], "]"}], 
      "\[RuleDelayed]", 
      RowBox[{"Const", "[", "\"\<false\>\"", "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Unary", "[", 
       RowBox[{"\"\<succ\>\"", ",", "t1"}], "]"}], "\[RuleDelayed]", 
      RowBox[{"Unary", "[", 
       RowBox[{"\"\<succ\>\"", ",", "t1p"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Unary", "[", 
       RowBox[{"\"\<pred\>\"", ",", "t1"}], "]"}], "\[RuleDelayed]", 
      RowBox[{"Unary", "[", 
       RowBox[{"\"\<pred\>\"", ",", "t1p"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Unary", "[", 
       RowBox[{"\"\<iszero\>\"", ",", "t1"}], "]"}], "\[RuleDelayed]", 
      RowBox[{"Unary", "[", 
       RowBox[{"\"\<iszero\>\"", ",", "t1p"}], "]"}]}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.841423403936392*^9, 3.841423605140957*^9}, {
   3.8414236484436197`*^9, 3.841423701254377*^9}, {3.841423749006462*^9, 
   3.841423802373123*^9}, {3.841423881153284*^9, 3.8414239675886517`*^9}, {
   3.841424043216476*^9, 3.841424072023015*^9}, {3.841425062675836*^9, 
   3.8414250649652*^9}, {3.8414251813721733`*^9, 3.841425410021062*^9}, {
   3.841425909563584*^9, 3.841425931612183*^9}, 3.841426004203088*^9, {
   3.8414260826945677`*^9, 3.841426085369581*^9}},
 CellLabel->
  "In[855]:=",ExpressionUUID->"fed6421b-0e9f-49fd-af2d-d9216b30c6c8"],

Cell["Above exercise 3.5.14:", "Text",
 CellChangeTimes->{{3.841425446560707*^9, 
  3.841425457511033*^9}},ExpressionUUID->"1dddc054-2e5c-445e-801c-\
53cef788aae4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"rlz", "=", 
      RowBox[{"evNumRules35", "[", 
       RowBox[{"Null", ",", "Null"}], "]"}]}], ",", "p", ",", "s", ",", "z", 
     ",", "znv"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"p", "[", "nv_", "]"}], ":=", 
     RowBox[{"Unary", "[", 
      RowBox[{"\"\<pred\>\"", ",", "nv"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"z", "=", 
     RowBox[{"Const", "[", "\"\<0\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"znv", "=", 
     RowBox[{"Zero", "[", "\"\<0\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"s", "[", "nv_", "]"}], ":=", 
     RowBox[{"Unary", "[", 
      RowBox[{"\"\<succ\>\"", ",", "nv"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"<|", 
     RowBox[{
      RowBox[{"\"\<p 0 \[Rule] 0\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"p", "[", "z", "]"}], "/.", "rlz"}], ")"}], "==", "znv"}]}],
       ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<s p 0 \[Rule] s 0\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"s", "[", 
           RowBox[{"p", "[", "z", "]"}], "]"}], "/.", "rlz"}], ")"}], "==", 
        RowBox[{"s", "[", "z", "]"}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<p s p 0 \[Rule] p s 0\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"p", "@", 
           RowBox[{"s", "@", 
            RowBox[{"p", "@", "z"}]}]}], "//.", "rlz"}], ")"}], "==", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"p", "@", 
           RowBox[{"s", "@", "z"}]}], "/.", "rlz"}], ")"}]}]}]}], "|>"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.841425512224908*^9, 3.841425575625018*^9}, {
  3.84142561227635*^9, 3.841425900287206*^9}, {3.841425947964772*^9, 
  3.841425953234824*^9}, {3.841425986910754*^9, 3.841426031833725*^9}, {
  3.8414261036343307`*^9, 3.841426106860129*^9}, {3.841426599976919*^9, 
  3.841426679539803*^9}, {3.841426749791566*^9, 3.841426810145813*^9}},
 CellLabel->
  "In[857]:=",ExpressionUUID->"f325b6c6-1e88-4da8-91b8-00349cc21025"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"p 0 \[Rule] 0\"\>", "\[Rule]", 
    RowBox[{
     RowBox[{"Const", "[", "\<\"0\"\>", "]"}], "\[Equal]", 
     RowBox[{"Zero", "[", "\<\"0\"\>", "]"}]}]}], ",", 
   RowBox[{"\<\"s p 0 \[Rule] s 0\"\>", "\[Rule]", "True"}], ",", 
   RowBox[{"\<\"p s p 0 \[Rule] p s 0\"\>", "\[Rule]", "True"}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{
  3.841425793925335*^9, {3.841425883957973*^9, 3.8414259015677547`*^9}, {
   3.841425935572798*^9, 3.841425954068608*^9}, {3.841426021523811*^9, 
   3.841426035766649*^9}, {3.841426089578146*^9, 3.841426107729642*^9}, {
   3.841426653884802*^9, 3.84142668097222*^9}, {3.841426760113585*^9, 
   3.841426811077015*^9}, 3.911255355038408*^9, 3.911290462407908*^9, 
   3.9122707358832183`*^9, 3.912546354303951*^9, 3.912589072785371*^9, 
   3.91260035225383*^9, 3.91260170731277*^9, 3.915050872360862*^9, 
   3.915535458383378*^9},
 CellLabel->
  "Out[857]=",ExpressionUUID->"9e212e69-c4f7-4040-b114-7b6ed4e55f5b"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->None,
WindowSize->{1707, 1387},
WindowMargins->{{Automatic, 1706}, {Automatic, 0}},
ShowSelection->True,
TaggingRules->{
 "WelcomeScreenSettings" -> {"FEStarting" -> False}, "TryRealOnly" -> False},
Magnification:>1.25 Inherited,
FrontEndVersion->"14.0 for Mac OS X ARM (64-bit) (December 12, 2023)",
StyleDefinitions->FrontEnd`FileName[{"Report"}, "StandardReport.nb", 
  CharacterEncoding -> "UTF-8"],
ExpressionUUID->"6ba73e48-2d42-41d2-9bbc-470980523998"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 766, 11, 121, "Title",ExpressionUUID->"e69ed4d1-2852-407b-a4d7-ebd11ce6da7a"],
Cell[1348, 35, 399, 9, 83, "Subtitle",ExpressionUUID->"0a45aa99-9a6b-4a8b-87c8-96d50b07cda3"],
Cell[CellGroupData[{
Cell[1772, 48, 204, 4, 87, "Section",ExpressionUUID->"6f10638c-7ff3-4b8f-aaee-89dcd0cbfa99"],
Cell[1979, 54, 1880, 28, 72, "Text",ExpressionUUID->"95b44c1c-d39c-446b-b779-f6947d601484"],
Cell[3862, 84, 2308, 34, 101, "Text",ExpressionUUID->"5f5053e5-85aa-410e-9a35-d72179a5c16a"],
Cell[6173, 120, 1776, 28, 43, "Text",ExpressionUUID->"aae408a9-9825-40a0-bc06-4ddc96b653ca"],
Cell[7952, 150, 433, 8, 72, "Text",ExpressionUUID->"61aa7330-2248-47d2-a75d-8dcae707794c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8422, 163, 258, 4, 87, "Section",ExpressionUUID->"279e152e-5e98-4885-a949-18c1769e39ee"],
Cell[8683, 169, 243, 5, 51, "Input",ExpressionUUID->"2ce88265-27c5-476d-923b-403c937d1655",
 InitializationCell->True],
Cell[8929, 176, 896, 18, 72, "Text",ExpressionUUID->"83682672-1063-4628-a7ab-7413e1b6a2f0"],
Cell[9828, 196, 526, 10, 104, "Input",ExpressionUUID->"1e220022-7398-4bcd-8560-359d94633541",
 Evaluatable->False]
}, Open  ]],
Cell[CellGroupData[{
Cell[10391, 211, 152, 3, 87, "Section",ExpressionUUID->"4530a9be-c022-45df-a993-ab3ea35d6ade"],
Cell[10546, 216, 782, 19, 253, "Code",ExpressionUUID->"45f745d7-f7ee-4d5c-8be4-d2dbb12f22d4"],
Cell[CellGroupData[{
Cell[11353, 239, 606, 15, 156, "Code",ExpressionUUID->"5c0a8dd4-a050-478e-b000-dbda650924c7"],
Cell[11962, 256, 658, 10, 58, "Output",ExpressionUUID->"30ab2d98-1c88-4f40-b836-7f3b382da018"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12657, 271, 374, 9, 84, "Code",ExpressionUUID->"5d716ec3-b1b8-4560-8776-37a7e6a95d12"],
Cell[13034, 282, 687, 10, 58, "Output",ExpressionUUID->"24308a22-ec99-4bd0-b78e-2115f7817e80"],
Cell[13724, 294, 684, 10, 58, "Output",ExpressionUUID->"5d99f790-9eba-4888-a19f-3adcdfd67156"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14445, 309, 156, 3, 59, "Code",ExpressionUUID->"70a373d6-58e0-41f4-9667-8bbf83c68a76"],
Cell[14604, 314, 664, 10, 58, "Output",ExpressionUUID->"c98209a2-c21c-4b5a-bee3-dda5e9fcd30c"]
}, Open  ]],
Cell[15283, 327, 349, 5, 100, "Text",ExpressionUUID->"ccdb8890-3d8a-4d10-a70f-0dc2621870ff"],
Cell[15635, 334, 740, 10, 187, "Text",ExpressionUUID->"e4e596fc-7bb7-406e-82cb-60b06068e78a"],
Cell[16378, 346, 737, 19, 132, "Code",ExpressionUUID->"c182ccde-9376-4f20-80fa-dc5a5637a2fc"],
Cell[17118, 367, 297, 4, 72, "Text",ExpressionUUID->"febc8aec-bd65-415a-9892-805a157bdc94"],
Cell[17418, 373, 644, 18, 108, "Code",ExpressionUUID->"de1b7fa3-acc0-4c62-a391-3d64ba46525c"],
Cell[18065, 393, 218, 3, 72, "Text",ExpressionUUID->"ea361154-181f-4a12-bedd-239727b6fc22"],
Cell[18286, 398, 328, 9, 70, "Code",ExpressionUUID->"392e5c30-0fcf-4a34-bb33-71158e62ad02"],
Cell[CellGroupData[{
Cell[18639, 411, 133, 3, 59, "Code",ExpressionUUID->"5b316a92-1275-4a01-a54b-f107c87eb273"],
Cell[18775, 416, 668, 10, 58, "Output",ExpressionUUID->"004e7537-cc60-4b1e-834e-683b1cda8a0d"]
}, Open  ]],
Cell[19458, 429, 140, 3, 70, "Code",ExpressionUUID->"32904070-37d7-4c7e-951d-3a300a56822a"]
}, Closed]],
Cell[CellGroupData[{
Cell[19635, 437, 155, 3, 68, "Section",ExpressionUUID->"50f6b680-f159-4cfc-b5a6-1b411b2581d4"],
Cell[CellGroupData[{
Cell[19815, 444, 96, 0, 42, "Subsection",ExpressionUUID->"3e003909-6dc1-4231-bb8d-e32278bf5875"],
Cell[19914, 446, 116, 0, 43, "Text",ExpressionUUID->"e0d0e1ea-ece9-4ee5-bb09-c23d9ed2f8b4"],
Cell[20033, 448, 173, 4, 100, "Text",ExpressionUUID->"9cbec83e-0f13-4051-9fd3-6380779dedc3"],
Cell[20209, 454, 710, 16, 388, "Text",ExpressionUUID->"09e028ad-842a-4d3d-bf41-ac651a49d51f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20956, 475, 93, 0, 42, "Subsection",ExpressionUUID->"7e917cd6-ed45-4b15-9ad1-6ac57c27b04b"],
Cell[CellGroupData[{
Cell[21074, 479, 9403, 249, 1679, "Code",ExpressionUUID->"bbf0a4e9-f04a-4cf8-9255-65f68f7c4b51"],
Cell[30480, 730, 659, 10, 58, "Output",ExpressionUUID->"9e656021-a4ca-41c5-b409-c6db8ff83b2e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31176, 745, 286, 7, 84, "Code",ExpressionUUID->"9c5b7e61-7f6e-4168-98ab-efe6d40abe70"],
Cell[31465, 754, 667, 10, 58, "Output",ExpressionUUID->"e1d1f272-7df6-48b0-9dff-91d9c468da67"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[32181, 770, 116, 0, 42, "Subsection",ExpressionUUID->"a009f09d-020b-4026-b747-def03fad83e9"],
Cell[CellGroupData[{
Cell[32322, 774, 98, 0, 40, "Subsubsection",ExpressionUUID->"dace2c55-db13-4322-b6f5-ddeb87e09e9e"],
Cell[32423, 776, 184, 3, 43, "Text",ExpressionUUID->"1b3a83a6-8624-469e-89ab-9b41c9ee02ce"],
Cell[32610, 781, 14888, 476, 1389, "Code",ExpressionUUID->"9ac91e56-726a-499e-bd0e-5d168452161f"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[47547, 1263, 110, 0, 42, "Subsection",ExpressionUUID->"3d3054f8-3af6-4e80-a38d-ec9db800363b"],
Cell[47660, 1265, 756, 20, 156, "Code",ExpressionUUID->"ae303bdb-2661-4de4-bfcd-24562b7fc12e"],
Cell[48419, 1287, 1830, 48, 301, "Code",ExpressionUUID->"35a64258-27db-44af-b820-1ae215a037e5"],
Cell[50252, 1337, 1150, 23, 350, "Code",ExpressionUUID->"7587407d-b49d-472f-be4e-dde66545014c"],
Cell[51405, 1362, 663, 17, 156, "Code",ExpressionUUID->"07cf428c-b860-4321-adce-c1128842c2fb"],
Cell[52071, 1381, 666, 17, 156, "Code",ExpressionUUID->"fc388fc0-a00c-440a-99b1-5067aef624e9"],
Cell[52740, 1400, 667, 17, 167, "Code",ExpressionUUID->"8eadd198-9e72-4167-be55-6c0e5e59e197"],
Cell[53410, 1419, 512, 13, 167, "Code",ExpressionUUID->"ed06b9e4-5c49-407f-bb78-22dd08d5541e"],
Cell[CellGroupData[{
Cell[53947, 1436, 102, 0, 31, "Subsubsection",ExpressionUUID->"5befc0ce-e774-46a6-99c9-a467644aa361"],
Cell[54052, 1438, 121, 0, 37, "Text",ExpressionUUID->"c9a01d63-2d96-40c1-b37b-92cd0466e79e"],
Cell[54176, 1440, 1014, 27, 132, "Code",ExpressionUUID->"9ee7a5d6-c383-4334-b6c0-8cbc16b2b85d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[55227, 1472, 99, 0, 40, "Subsubsection",ExpressionUUID->"9c0fd9c5-a913-4966-baac-1f0044cb2c11"],
Cell[55329, 1474, 145, 2, 43, "Text",ExpressionUUID->"263d1904-7ac0-4b51-9c3b-ea18fa23d38a"],
Cell[55477, 1478, 1400, 40, 229, "Code",ExpressionUUID->"a2d2c523-83ec-441c-8928-e17cba49756e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[56914, 1523, 88, 0, 40, "Subsubsection",ExpressionUUID->"d1fdf8ac-d64a-4841-ba11-bacbfacd8acb"],
Cell[57005, 1525, 102, 0, 43, "Text",ExpressionUUID->"739e8507-efcc-4463-a864-decd2450d96a"],
Cell[57110, 1527, 1836, 50, 180, "Code",ExpressionUUID->"b672afe7-5d90-4bf2-b6e3-c357bd245b96"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58983, 1582, 100, 0, 40, "Subsubsection",ExpressionUUID->"c7e594a6-5748-4205-a233-b88c5174282e"],
Cell[59086, 1584, 2296, 65, 301, "Code",ExpressionUUID->"e7cf3aab-01a3-4c0c-9e0c-502203a41e0b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[61419, 1654, 98, 0, 40, "Subsubsection",ExpressionUUID->"24057c45-9180-4c4e-a65e-4f2bf963d51d"],
Cell[61520, 1656, 167, 3, 43, "Text",ExpressionUUID->"a56a31bc-d208-42a3-8edf-70ae3f7eaa42"],
Cell[61690, 1661, 4308, 110, 519, "Code",ExpressionUUID->"a917f8bd-b942-4fef-bef1-e7e2d75f9555"]
}, Open  ]],
Cell[CellGroupData[{
Cell[66035, 1776, 98, 0, 40, "Subsubsection",ExpressionUUID->"ff896531-5212-437b-a0cb-d9cf42549c49"],
Cell[66136, 1778, 173, 3, 43, "Text",ExpressionUUID->"64d07adf-fe0e-4a95-bb82-2ef045a1d2db"],
Cell[66312, 1783, 6370, 160, 833, "Code",ExpressionUUID->"826a3a28-93fd-49af-9d61-e096bcf92b04"]
}, Open  ]],
Cell[CellGroupData[{
Cell[72719, 1948, 98, 0, 40, "Subsubsection",ExpressionUUID->"6fa12b92-2657-489d-9b90-983db24ebb7f"],
Cell[72820, 1950, 186, 3, 43, "Text",ExpressionUUID->"e8beeadd-35b5-433d-ac33-1a3a3b99a170"],
Cell[73009, 1955, 1685, 48, 229, "Code",ExpressionUUID->"b459918a-b059-4568-9bcd-814c0008c712"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[74743, 2009, 99, 0, 43, "Subsection",ExpressionUUID->"46263ad1-ddba-4426-8571-c4e99c40db3a"],
Cell[CellGroupData[{
Cell[74867, 2013, 92, 0, 31, "Subsubsection",ExpressionUUID->"33cf2e0d-d4ac-427c-a479-06d544c2ded2"],
Cell[74962, 2015, 217, 3, 61, "Text",ExpressionUUID->"610550a7-9fa5-48a2-be36-42157d33af76"],
Cell[75182, 2020, 537, 16, 96, "Code",ExpressionUUID->"02043997-233a-4ff2-af7e-6048f6b0d8d8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[75756, 2041, 94, 0, 31, "Subsubsection",ExpressionUUID->"f6d6e1c0-d5cf-4f99-b910-d03582e0afc5"],
Cell[75853, 2043, 152, 2, 37, "Text",ExpressionUUID->"e218cf59-ec63-44c1-8eec-9b03f9f9c09d"],
Cell[76008, 2047, 413, 12, 95, "Code",ExpressionUUID->"56b79bd5-a23f-48dc-b4d5-699c8c30cd3f"],
Cell[76424, 2061, 333, 5, 85, "Text",ExpressionUUID->"4815a298-4c6b-4a9e-b2fd-fd0f491b406a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[76794, 2071, 92, 0, 31, "Subsubsection",ExpressionUUID->"0f7ac5d8-7068-4e62-a0eb-bb2edb7bbb4c"],
Cell[76889, 2073, 324, 10, 70, "Code",ExpressionUUID->"49946210-c585-4b90-9a10-2c64c9760acc"],
Cell[77216, 2085, 509, 15, 95, "Code",ExpressionUUID->"c3232d3d-0d58-402f-95be-ff32ba0f3730"],
Cell[77728, 2102, 170, 3, 37, "Text",ExpressionUUID->"06c58083-4b34-4b11-8273-7d366c6dd61f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[77935, 2110, 94, 0, 31, "Subsubsection",ExpressionUUID->"2b6b980c-8e9c-4133-b9ba-78b7443c14f5"],
Cell[78032, 2112, 304, 9, 70, "Code",ExpressionUUID->"a4219dca-5ba2-4cf3-b534-102716fd015d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[78373, 2126, 93, 0, 31, "Subsubsection",ExpressionUUID->"9f965e8e-bef6-47ea-9da0-8a4275469fa3"],
Cell[78469, 2128, 369, 11, 95, "Code",ExpressionUUID->"488a84dc-3614-4700-8bb7-321faa177540"]
}, Open  ]],
Cell[CellGroupData[{
Cell[78875, 2144, 97, 0, 31, "Subsubsection",ExpressionUUID->"0d9b5c56-3da7-4a45-a274-4db66500f516"],
Cell[78975, 2146, 314, 10, 95, "Code",ExpressionUUID->"66c532e1-d2bc-4d59-bdd5-b87504f14f62"]
}, Open  ]],
Cell[CellGroupData[{
Cell[79326, 2161, 94, 0, 31, "Subsubsection",ExpressionUUID->"120510c5-ca36-4ded-9ec4-f7ae137f3000"],
Cell[79423, 2163, 586, 18, 95, "Code",ExpressionUUID->"2159909d-bf03-4c85-916e-de51a30770ba"]
}, Open  ]],
Cell[CellGroupData[{
Cell[80046, 2186, 96, 0, 31, "Subsubsection",ExpressionUUID->"f692d81d-4cfc-4bf5-ac76-19b50e488124"],
Cell[80145, 2188, 415, 12, 95, "Code",ExpressionUUID->"f9c7aa01-52bd-443a-8a62-c4f21f117eb9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[80597, 2205, 92, 0, 31, "Subsubsection",ExpressionUUID->"4fb81854-8969-445c-a63c-cdeedec25e50"],
Cell[80692, 2207, 256, 7, 70, "Code",ExpressionUUID->"597c9a7b-cb85-4aac-af12-d964b5771945"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[80997, 2220, 84, 0, 43, "Subsection",ExpressionUUID->"a2c17488-cfe3-4d95-91da-7c91a822d51e"],
Cell[81084, 2222, 131, 0, 37, "Text",ExpressionUUID->"598bf210-0202-43e0-8e88-084e8a5c1174"],
Cell[CellGroupData[{
Cell[81240, 2226, 90, 0, 31, "Subsubsection",ExpressionUUID->"65e30f49-b0a2-4c7a-bd29-3d04929b1c09"],
Cell[81333, 2228, 324, 9, 70, "Code",ExpressionUUID->"e3dd561a-b447-4bb4-a399-2c105b3a4e57"]
}, Open  ]],
Cell[CellGroupData[{
Cell[81694, 2242, 93, 0, 31, "Subsubsection",ExpressionUUID->"f0cc4ca9-a706-43bd-a13a-2e5b86139b8f"],
Cell[81790, 2244, 254, 7, 70, "Code",ExpressionUUID->"53f0deae-1003-463e-baaa-5e598a7b4f74"]
}, Open  ]],
Cell[CellGroupData[{
Cell[82081, 2256, 105, 0, 31, "Subsubsection",ExpressionUUID->"ee76c6c6-37a4-4190-bd28-78159af347e5"],
Cell[82189, 2258, 347, 10, 70, "Code",ExpressionUUID->"8c419a34-3cfc-43b5-84ea-5ee55cbbdbfa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[82573, 2273, 113, 0, 31, "Subsubsection",ExpressionUUID->"9095b6ca-e686-4182-bdac-27318a063c4b"],
Cell[82689, 2275, 836, 24, 120, "Code",ExpressionUUID->"da090593-ae5d-42db-9bdf-f1e77c5b8eb1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[83562, 2304, 115, 0, 31, "Subsubsection",ExpressionUUID->"1047390f-e80e-4ca9-a1aa-9529dbbb1fd4"],
Cell[CellGroupData[{
Cell[83702, 2308, 220, 5, 59, "Code",ExpressionUUID->"774130da-2a55-4280-882a-b668cd1700a9"],
Cell[83925, 2315, 751, 14, 58, "Output",ExpressionUUID->"fb47bf13-1a44-4a50-9eba-35e370c4a302"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[84725, 2335, 106, 0, 31, "Subsubsection",ExpressionUUID->"1a8c3e9f-c007-417c-94b4-788803312b41"],
Cell[84834, 2337, 1064, 32, 167, "Code",ExpressionUUID->"89b44096-01e0-486b-b576-15e4c3b58db5"],
Cell[85901, 2371, 677, 19, 120, "Code",ExpressionUUID->"90465746-6595-4544-a1eb-e341aa572c85"]
}, Open  ]],
Cell[CellGroupData[{
Cell[86615, 2395, 107, 0, 31, "Subsubsection",ExpressionUUID->"035e76b0-94c0-402f-a231-5645d3ce32c7"],
Cell[86725, 2397, 1109, 33, 167, "Code",ExpressionUUID->"25f43776-7a4f-4b0e-9ea6-600d38c889a1"],
Cell[87837, 2432, 937, 27, 143, "Code",ExpressionUUID->"477bcb51-cfd2-4495-9d86-ba5849529d56"]
}, Open  ]],
Cell[CellGroupData[{
Cell[88811, 2464, 94, 0, 31, "Subsubsection",ExpressionUUID->"6de63c0a-4ffd-45a0-bbf2-97a669e5cac7"],
Cell[88908, 2466, 186, 3, 37, "Text",ExpressionUUID->"67617f14-0411-463f-9d78-b50f4bd07c1d"],
Cell[89097, 2471, 333, 8, 70, "Code",ExpressionUUID->"f4b84fe8-4c79-4185-a7f1-c193fe6772c8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[89467, 2484, 100, 0, 31, "Subsubsection",ExpressionUUID->"86b8e9dc-18c6-464d-b23a-f1c855c15aae"],
Cell[89570, 2486, 112, 0, 37, "Text",ExpressionUUID->"535115cb-8379-43e2-8f1c-0e7904c599ba"],
Cell[89685, 2488, 765, 16, 346, "Text",ExpressionUUID->"0a3aa4ca-05d6-4e50-be19-a613e74c726d"],
Cell[90453, 2506, 227, 5, 37, "Text",ExpressionUUID->"2ee40c92-fcc5-472c-a94a-503d9f7a7f28"],
Cell[90683, 2513, 1695, 47, 335, "Code",ExpressionUUID->"14063c84-a90b-4a73-8ad7-82f2a12b99ec"]
}, Open  ]]
}, Open  ]],
Cell[92405, 2564, 96, 0, 43, "Subsection",ExpressionUUID->"07c64c2f-40d7-4221-9cf6-8682dd90c0b6"],
Cell[CellGroupData[{
Cell[92526, 2568, 95, 0, 32, "Subsection",ExpressionUUID->"ab3f2eb0-f9f7-4fd5-a141-f24d1b08e415"],
Cell[CellGroupData[{
Cell[92646, 2572, 90, 0, 31, "Subsubsection",ExpressionUUID->"e43ea9f6-0401-436b-a2b8-46fcdc03a98a"],
Cell[92739, 2574, 310, 10, 95, "Code",ExpressionUUID->"c4297c05-4376-4173-a9b7-408421132848"]
}, Open  ]],
Cell[CellGroupData[{
Cell[93086, 2589, 94, 0, 31, "Subsubsection",ExpressionUUID->"a07d77cb-e5f4-4f48-8b5a-5358726a499d"],
Cell[93183, 2591, 322, 10, 95, "Code",ExpressionUUID->"d69fe4f4-8d7b-4e5e-b408-28e816d9ceef"]
}, Open  ]],
Cell[CellGroupData[{
Cell[93542, 2606, 93, 0, 31, "Subsubsection",ExpressionUUID->"b10faf00-874e-41bb-b557-2a5a01a01cbe"],
Cell[93638, 2608, 319, 10, 95, "Code",ExpressionUUID->"656f411a-9077-4834-af21-a4a596804243"]
}, Open  ]],
Cell[CellGroupData[{
Cell[93994, 2623, 99, 0, 31, "Subsubsection",ExpressionUUID->"ba6d866b-504e-49db-9a30-df2065584969"],
Cell[94096, 2625, 529, 11, 191, "Code",ExpressionUUID->"23f3c509-fbd5-44cf-a831-83b1249b59da"]
}, Open  ]],
Cell[CellGroupData[{
Cell[94662, 2641, 107, 0, 31, "Subsubsection",ExpressionUUID->"b91a0667-cb08-4981-a962-a40c4200e2ad"],
Cell[94772, 2643, 1933, 47, 311, "Code",ExpressionUUID->"15710599-fccc-4125-adcb-a2344f902993"]
}, Open  ]],
Cell[CellGroupData[{
Cell[96742, 2695, 112, 0, 31, "Subsubsection",ExpressionUUID->"779ea5ac-4c09-406d-b00e-25cdf5a92d18"],
Cell[96857, 2697, 557, 16, 120, "Code",ExpressionUUID->"1b2b0eca-9614-4779-9350-9a597f3af8cc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[97451, 2718, 107, 0, 31, "Subsubsection",ExpressionUUID->"64f384e7-d84e-47cc-9a3b-21d0e678b3a8"],
Cell[97561, 2720, 2109, 57, 311, "Code",ExpressionUUID->"f7f832b3-d4cf-4895-ad75-e75da95ad9bb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[99707, 2782, 118, 0, 31, "Subsubsection",ExpressionUUID->"06cb47e4-942d-4e8d-8a2b-dd9d43216abd"],
Cell[99828, 2784, 1591, 42, 311, "Code",ExpressionUUID->"a9b4d18e-789d-48ad-bd8e-c6d8daf427e4"],
Cell[101422, 2828, 4224, 107, 600, "Code",ExpressionUUID->"51405276-84f9-4b73-ba1b-98506edef722"]
}, Open  ]],
Cell[CellGroupData[{
Cell[105683, 2940, 122, 0, 31, "Subsubsection",ExpressionUUID->"aa8ce791-0606-40d4-a073-6cbe6e7523f6"],
Cell[105808, 2942, 290, 5, 61, "Text",ExpressionUUID->"e0495811-9f7a-43e8-bd85-f47240250a40"],
Cell[106101, 2949, 2451, 61, 335, "Code",ExpressionUUID->"306d768b-d6cb-46d8-81b8-75939009aa0f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[108589, 3015, 111, 0, 31, "Subsubsection",ExpressionUUID->"121290ff-9d40-49c7-ac1e-5f7c1a0d52b5"],
Cell[108703, 3017, 166, 3, 37, "Text",ExpressionUUID->"f2fceb92-150f-4cae-8745-4bbae8620deb"],
Cell[108872, 3022, 2366, 60, 335, "Code",ExpressionUUID->"76578a01-67bb-459c-a9c0-7256955da92e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[111275, 3087, 116, 0, 31, "Subsubsection",ExpressionUUID->"b085029e-bd6f-4762-aa80-0ba04e001886"],
Cell[111394, 3089, 731, 21, 167, "Code",ExpressionUUID->"1464075a-b52f-488d-b2ee-8b8007e60ea7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[112162, 3115, 111, 0, 31, "Subsubsection",ExpressionUUID->"f5a43370-15b8-42e3-8ec9-45887a4198f8"],
Cell[112276, 3117, 369, 9, 95, "Code",ExpressionUUID->"477e72ca-3b01-482f-9aa3-87f5ec426a04"]
}, Open  ]],
Cell[CellGroupData[{
Cell[112682, 3131, 190, 4, 31, "Subsubsection",ExpressionUUID->"2cc45493-c126-409b-8901-bd244cd50da9"],
Cell[112875, 3137, 90, 0, 37, "Text",ExpressionUUID->"cdc8f236-b4b7-4ee2-aa45-2c3749289d76"],
Cell[112968, 3139, 307, 8, 70, "Code",ExpressionUUID->"57eea2b1-aca1-4f71-9323-23c932632e23"],
Cell[113278, 3149, 86, 0, 37, "Text",ExpressionUUID->"74b070ab-3112-4f2a-99d3-a20723991b47"],
Cell[113367, 3151, 624, 17, 95, "Code",ExpressionUUID->"01f4f13e-882d-4e72-a3fa-5442cd7291ee"],
Cell[113994, 3170, 90, 0, 37, "Text",ExpressionUUID->"88c2a0f7-8e22-4bf7-aa43-61161e0ef262"],
Cell[114087, 3172, 677, 19, 120, "Code",ExpressionUUID->"0d0f910a-85bf-4510-b6dd-0536f21fb131"]
}, Open  ]],
Cell[CellGroupData[{
Cell[114801, 3196, 200, 6, 50, "Subsubsection",ExpressionUUID->"e048f0f5-245a-4b3c-81c5-0fd2b13137c5"],
Cell[115004, 3204, 90, 0, 37, "Text",ExpressionUUID->"044ea3d0-29d1-4de3-ad82-789d17be06f5"],
Cell[115097, 3206, 310, 8, 70, "Code",ExpressionUUID->"9023e997-46f8-4347-ac17-48ee847bb478"],
Cell[115410, 3216, 86, 0, 37, "Text",ExpressionUUID->"f46658da-1596-4c34-a8e5-d73c13d61800"],
Cell[115499, 3218, 566, 15, 95, "Code",ExpressionUUID->"33a319ac-0141-4410-90e5-f7771a9fd9ed"],
Cell[116068, 3235, 90, 0, 37, "Text",ExpressionUUID->"dc53ce3a-6dea-4a1c-a1a4-1cded0fda1f2"],
Cell[116161, 3237, 689, 19, 120, "Code",ExpressionUUID->"39dfff29-299f-438c-af3f-8c3250f1ec3b"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[116899, 3262, 97, 0, 43, "Subsection",ExpressionUUID->"c519b766-fcd6-4f21-b960-4d48feeeeceb"],
Cell[116999, 3264, 3540, 79, 887, "Code",ExpressionUUID->"51550212-b5de-4a85-bd26-fed049b702d9"],
Cell[120542, 3345, 3285, 74, 840, "Code",ExpressionUUID->"7ebffded-c1ff-4f56-a44b-d2ffcb061ea1"],
Cell[123830, 3421, 602, 13, 167, "Code",ExpressionUUID->"d2e5cf96-63d1-445d-b7fe-b10041eb290c"],
Cell[124435, 3436, 741, 17, 191, "Code",ExpressionUUID->"1d170215-7ab6-4159-aa6e-9ee878f0a4ad"],
Cell[125179, 3455, 877, 20, 215, "Code",ExpressionUUID->"529a0009-0cb0-402e-a6a5-79cd3fa60a68"],
Cell[126059, 3477, 707, 17, 167, "Code",ExpressionUUID->"05c30c5e-d804-498c-8ca7-82201b500ba9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[126803, 3499, 85, 0, 43, "Subsection",ExpressionUUID->"8c5ddae0-b0cf-4bc5-ac71-417c0d3d0505"],
Cell[126891, 3501, 211, 6, 70, "Code",ExpressionUUID->"459f5e5f-5bd3-47e1-ae7c-c309ca659771"],
Cell[127105, 3509, 158, 4, 70, "Code",ExpressionUUID->"3eef6b0e-c01f-407f-86c5-160f66e0a549"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[127312, 3519, 160, 3, 68, "Section",ExpressionUUID->"848f5fa1-8468-4e79-a18e-1fcd555481bc"],
Cell[CellGroupData[{
Cell[127497, 3526, 5493, 135, 881, "Code",ExpressionUUID->"bafc37bc-6e78-4ae2-9c98-37927a46eba2"],
Cell[132993, 3663, 665, 10, 58, "Output",ExpressionUUID->"66e6d699-273d-4d9c-aedd-32b896da5f8e"],
Cell[133661, 3675, 673, 10, 58, "Output",ExpressionUUID->"67861fa6-2769-4d1e-b5f4-858182c76f3f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[134371, 3690, 85, 0, 42, "Subsection",ExpressionUUID->"399e4ade-a969-45da-ab3a-5615072ef3c2"],
Cell[134459, 3692, 102, 0, 43, "Text",ExpressionUUID->"c0051b6c-fe97-4b09-abcd-de3bc5916e1e"],
Cell[134564, 3694, 109, 0, 43, "Text",ExpressionUUID->"d7a8cc17-8e75-4227-aa5d-516d4398e27a"],
Cell[134676, 3696, 446, 13, 70, "Code",ExpressionUUID->"9277348a-d098-4e81-80db-2121577778ac"]
}, Open  ]],
Cell[CellGroupData[{
Cell[135159, 3714, 88, 0, 43, "Subsection",ExpressionUUID->"9c063747-0019-4898-b04f-387feb691b33"],
Cell[135250, 3716, 280, 7, 70, "Code",ExpressionUUID->"f54d8663-9003-4102-abe7-240e8195613c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[135567, 3728, 93, 0, 43, "Subsection",ExpressionUUID->"bacedb08-e20a-4b0b-b146-84051c8daafd"],
Cell[135663, 3730, 1485, 40, 287, "Code",ExpressionUUID->"35a8caee-ae3e-4376-9d4c-b1ada8a279cc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[137185, 3775, 88, 0, 43, "Subsection",ExpressionUUID->"9d317536-3b41-41ff-9586-5e65686069ff"],
Cell[137276, 3777, 1393, 42, 240, "Code",ExpressionUUID->"37123f02-9bbe-4002-a42a-667d3e165727"]
}, Open  ]],
Cell[CellGroupData[{
Cell[138706, 3824, 85, 0, 43, "Subsection",ExpressionUUID->"c24a2d98-84b4-4028-8a82-b8294029608c"],
Cell[138794, 3826, 160, 3, 37, "Text",ExpressionUUID->"65a97c36-5497-4ea9-a3ae-543c13bf89f1"],
Cell[138957, 3831, 347, 5, 61, "Text",ExpressionUUID->"c986234b-f192-42ae-b213-034683d4a651"],
Cell[139307, 3838, 141, 1, 37, "Text",ExpressionUUID->"e4ab0f98-597f-4558-a008-7b479d95beb1"],
Cell[139451, 3841, 269, 4, 61, "Text",ExpressionUUID->"8201bbd3-40e9-4624-ae1a-948380c1e6d7"],
Cell[139723, 3847, 272, 4, 61, "Text",ExpressionUUID->"038c5fa6-c526-4029-a561-2331c72a6718"],
Cell[139998, 3853, 133, 0, 37, "Text",ExpressionUUID->"5710e4e6-ec9c-4692-a9a6-34b5f7d03b88"],
Cell[140134, 3855, 520, 13, 143, "Code",ExpressionUUID->"b3a088a6-e59c-4d3f-8449-655ae92a132f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[140691, 3873, 102, 0, 43, "Subsection",ExpressionUUID->"c1e391ce-5a86-40fe-b27b-a3e8422d8eec"],
Cell[140796, 3875, 3259, 94, 551, "Code",ExpressionUUID->"30f0f903-6c82-4dd9-8905-d72c040f6b5e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[144092, 3974, 86, 0, 43, "Subsection",ExpressionUUID->"82daccf0-6e70-4785-9a6e-c7acecd20906"],
Cell[144181, 3976, 281, 7, 70, "Code",ExpressionUUID->"d2d45997-663e-42ac-9a4e-d4eac50cb351"]
}, Open  ]],
Cell[CellGroupData[{
Cell[144499, 3988, 87, 0, 43, "Subsection",ExpressionUUID->"3c18b113-398d-4584-8e78-53b9f51516bf"],
Cell[144589, 3990, 313, 8, 70, "Code",ExpressionUUID->"08f8d2ef-d9cf-4809-9ef0-e7d7f90477af"]
}, Open  ]],
Cell[CellGroupData[{
Cell[144939, 4003, 91, 0, 43, "Subsection",ExpressionUUID->"36cfb484-1b22-4f35-8773-46002b3a485f"],
Cell[145033, 4005, 398, 11, 70, "Code",ExpressionUUID->"10657cfd-8e75-4482-ac07-dc00d7da624d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[145468, 4021, 90, 0, 43, "Subsection",ExpressionUUID->"12ad9100-ddf6-41a5-b117-72237be06fe0"],
Cell[145561, 4023, 577, 17, 95, "Code",ExpressionUUID->"b5bfef87-16c4-477f-be6a-a6f405e62f1b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[146175, 4045, 88, 0, 43, "Subsection",ExpressionUUID->"7c256164-75ad-4afb-aa2c-761dcd965841"],
Cell[146266, 4047, 454, 13, 70, "Code",ExpressionUUID->"b077585e-59d9-4d26-a0f1-3ae9854fea54"]
}, Open  ]],
Cell[CellGroupData[{
Cell[146757, 4065, 81, 0, 43, "Subsection",ExpressionUUID->"981b795d-ccf9-4c33-9557-835bc2c16c89"],
Cell[146841, 4067, 384, 11, 70, "Code",ExpressionUUID->"f0863c79-7778-4265-9776-fdf38b0798e5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[147262, 4083, 87, 0, 43, "Subsection",ExpressionUUID->"aa989be7-0b76-49d1-ae11-4d635c424692"],
Cell[147352, 4085, 1879, 49, 360, "Code",ExpressionUUID->"003f7cf0-1b94-4f84-b3a6-6a14753e4a97"]
}, Open  ]],
Cell[CellGroupData[{
Cell[149268, 4139, 87, 0, 43, "Subsection",ExpressionUUID->"e01cdeb1-121a-4789-a5a5-2f5f329f3d5d"],
Cell[149358, 4141, 1359, 38, 191, "Code",ExpressionUUID->"b8ecad00-fd96-4e61-adc3-90f6359a28bd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[150754, 4184, 92, 0, 43, "Subsection",ExpressionUUID->"5eaa4588-8ade-4135-97df-e8a3a6a09225"],
Cell[150849, 4186, 1156, 33, 120, "Code",ExpressionUUID->"f4b5d965-e0e6-4012-b0e6-3d74ae415cf4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[152042, 4224, 85, 0, 43, "Subsection",ExpressionUUID->"4ea2a31e-5ed8-4f4c-bd0e-aa4a661dcbfe"],
Cell[152130, 4226, 177, 3, 37, "Text",ExpressionUUID->"85dc289b-981f-4787-8fce-5c3bccf008de"],
Cell[152310, 4231, 548, 14, 70, "Code",ExpressionUUID->"1f590c99-e473-4d62-a4ef-aafbd05f3fe5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[152895, 4250, 87, 0, 43, "Subsection",ExpressionUUID->"bcf33d24-752b-4708-9376-25f466f7ffe3"],
Cell[152985, 4252, 544, 14, 70, "Code",ExpressionUUID->"8978f440-6f28-4a2f-99a4-52570e9d0a01"]
}, Open  ]],
Cell[CellGroupData[{
Cell[153566, 4271, 86, 0, 43, "Subsection",ExpressionUUID->"3d1e14a7-6e80-46ff-80f1-f0b057331b77"],
Cell[153655, 4273, 839, 22, 191, "Code",ExpressionUUID->"c74855b7-d881-472f-afb2-ab152cb2953f"],
Cell[154497, 4297, 700, 18, 167, "Code",ExpressionUUID->"939a355c-645a-44b6-926a-0e78ee7d4cb7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[155234, 4320, 145, 3, 43, "Subsection",ExpressionUUID->"c17399a7-72b6-491c-9b6c-3b3d3bd74888"],
Cell[155382, 4325, 231, 6, 70, "Code",ExpressionUUID->"f08f4ef2-c42f-485b-b5c6-9f2203d853c1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[155650, 4336, 84, 0, 43, "Subsection",ExpressionUUID->"93ef96f8-cdd4-4a74-9dec-0a5c9c453d84"],
Cell[CellGroupData[{
Cell[155759, 4340, 239, 6, 59, "Code",ExpressionUUID->"f65015db-7c2f-46e6-8fd0-4c554e235f60"],
Cell[156001, 4348, 674, 10, 58, "Output",ExpressionUUID->"2b7f13db-f8d3-4b9c-aa03-f71ba27a4ce1"]
}, Open  ]],
Cell[156690, 4361, 140, 3, 70, "Code",ExpressionUUID->"da96e4bb-6742-4fdf-947f-cfb4a7154ca5"],
Cell[156833, 4366, 243, 5, 52, "Input",ExpressionUUID->"61746ed5-bbf8-41e4-b8f0-14c0ca47e0fb",
 InitializationCell->True],
Cell[157079, 4373, 511, 13, 61, "Text",ExpressionUUID->"55d453db-05f8-4e44-ada6-95403f2d9ff5"],
Cell[157593, 4388, 505, 9, 105, "Input",ExpressionUUID->"504ea0b2-cf1b-43f8-ae18-65a5cba5770d"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[158159, 4404, 214, 4, 121, "Title",ExpressionUUID->"c6fea088-9084-404a-9dbd-dfd1fc71b462"],
Cell[158376, 4410, 526, 10, 72, "Text",ExpressionUUID->"8f130eb3-d9d5-4a18-a9ce-98a468fb2728"],
Cell[CellGroupData[{
Cell[158927, 4424, 158, 3, 87, "Section",ExpressionUUID->"9cd88974-9d17-4a85-86cd-7ea469772cfd"],
Cell[159088, 4429, 370, 6, 43, "Text",ExpressionUUID->"b6cab472-0ccd-46b5-9b0b-7a47c2c3739b"],
Cell[159461, 4437, 2132, 48, 72, "Text",ExpressionUUID->"4c8c4044-cfcf-4280-8e3c-8de099459c90"],
Cell[161596, 4487, 762, 18, 42, "Text",ExpressionUUID->"293d5200-c565-4422-803f-6683e92b04f2"],
Cell[162361, 4507, 1811, 40, 42, "Text",ExpressionUUID->"ed2d5464-fd3d-4cee-a2f5-999f0724b1ec"],
Cell[164175, 4549, 1151, 25, 42, "Text",ExpressionUUID->"0369d8cc-054a-49cd-a1bf-bce4db72f007"],
Cell[165329, 4576, 1226, 28, 42, "Text",ExpressionUUID->"bfe7cd85-f0a4-46e7-8e2d-54db03fe6e99"],
Cell[166558, 4606, 589, 17, 42, "Text",ExpressionUUID->"296a1dd8-fb06-4580-9711-11638900fcbc"],
Cell[167150, 4625, 459, 16, 42, "Text",ExpressionUUID->"80269b5b-1d0e-46c8-88d6-8950d4deda8e"],
Cell[167612, 4643, 706, 15, 42, "Text",ExpressionUUID->"e3ae6d4c-5e44-482a-9157-6da7bac6e294"],
Cell[168321, 4660, 1732, 29, 42, "Text",ExpressionUUID->"1f84c7ce-ed5d-4ac9-a96e-5868e07a603c"],
Cell[170056, 4691, 1214, 24, 42, "Text",ExpressionUUID->"9cd60e70-1465-4be6-9bdd-f54f5cf80bd2"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[171319, 4721, 249, 4, 120, "Title",ExpressionUUID->"d459bd98-b9b3-43e1-9fb5-83abae0cf75c"],
Cell[171571, 4727, 991, 16, 100, "Text",ExpressionUUID->"3655ecaa-0df0-481a-8c95-4841ac1b5078"],
Cell[172565, 4745, 1228, 21, 52, "Input",ExpressionUUID->"232a65c7-f0f6-419b-826f-f6d4389cf925"],
Cell[173796, 4768, 331, 9, 43, "Text",ExpressionUUID->"3e3cbe39-c425-472e-b497-b59985910f2f"],
Cell[CellGroupData[{
Cell[174152, 4781, 576, 8, 86, "Section",ExpressionUUID->"4ddfca37-297d-4fe3-8d4a-f8cab00d9f99"],
Cell[174731, 4791, 653, 11, 100, "Text",ExpressionUUID->"9a5ae521-99a8-4ebd-8ec9-844f298ac87b"],
Cell[175387, 4804, 343, 7, 43, "Text",ExpressionUUID->"eebf4a24-1554-4a32-ac3c-c9d942060304"],
Cell[175733, 4813, 289, 4, 43, "Text",ExpressionUUID->"cc8a8618-26a5-4005-a7c6-f96b8741aca1"],
Cell[176025, 4819, 1180, 23, 93, "Input",ExpressionUUID->"de28d666-0494-4d73-baf6-395cb1a22825"],
Cell[177208, 4844, 675, 21, 44, "Text",ExpressionUUID->"fba77f8e-38cc-408b-933c-bc2459a687e7"],
Cell[177886, 4867, 1221, 24, 113, "Input",ExpressionUUID->"45bb61eb-0ca0-47aa-9371-60b258c5f066"],
Cell[179110, 4893, 571, 13, 44, "Text",ExpressionUUID->"e1ea35f2-619c-4f81-bbdd-6a0cc8ede241"],
Cell[179684, 4908, 1198, 21, 52, "Input",ExpressionUUID->"ae5a5620-12cf-45ae-9a82-c0b8083b30ab"],
Cell[180885, 4931, 173, 3, 43, "Text",ExpressionUUID->"66a354ed-596e-4f60-bbb2-aef364cc68bd"],
Cell[181061, 4936, 270, 8, 130, "Text",ExpressionUUID->"59c3ab88-8a66-4380-950e-b9cc1f5e2bc6"],
Cell[181334, 4946, 1366, 25, 113, "Input",ExpressionUUID->"bfa9c90d-bf2a-4f5e-bb7d-03aa1f9ef383"],
Cell[182703, 4973, 203, 3, 43, "Text",ExpressionUUID->"a1062f64-3522-48e4-8fe9-9d825c479e75"],
Cell[182909, 4978, 1262, 21, 52, "Input",ExpressionUUID->"f30f1a2b-4d21-4f0f-b8de-8af2383728ce"],
Cell[184174, 5001, 154, 3, 43, "Text",ExpressionUUID->"a1602603-5b5e-42bd-9732-b63b9c27cf6a"],
Cell[CellGroupData[{
Cell[184353, 5008, 194, 4, 52, "Input",ExpressionUUID->"efa24837-3574-4c1f-ac32-a0efb3e5351b"],
Cell[184550, 5014, 12539, 302, 441, "Output",ExpressionUUID->"b6f13e5b-5fd9-45de-97aa-d90b6e7eaf40"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[197138, 5322, 340, 5, 86, "Section",ExpressionUUID->"40b9ef41-4c06-4488-bb4b-89f230be020c"],
Cell[197481, 5329, 612, 12, 43, "Text",ExpressionUUID->"bfb91be7-80d8-4b6f-830d-a098e8a5c20d"],
Cell[CellGroupData[{
Cell[198118, 5345, 295, 6, 52, "Input",ExpressionUUID->"220e7906-1147-45dc-af23-fa970a11d088"],
Cell[198416, 5353, 2256, 65, 155, "Output",ExpressionUUID->"f600b538-9c00-486d-92e0-46c237805462"]
}, Open  ]],
Cell[200687, 5421, 1014, 19, 100, "Text",ExpressionUUID->"019d4216-3d1b-410e-a628-d00052ccc5a2"],
Cell[CellGroupData[{
Cell[201726, 5444, 1023, 29, 130, "Input",ExpressionUUID->"afefb7a9-c834-471f-b897-c105a723e2fa"],
Cell[202752, 5475, 29942, 795, 790, "Output",ExpressionUUID->"ba4a4f21-45ee-48c3-9b20-810ec9e2b303"]
}, Open  ]],
Cell[232709, 6273, 170, 3, 43, "Text",ExpressionUUID->"f47bac72-4b93-405e-9854-3762c7cdd921"],
Cell[232882, 6278, 582, 15, 79, "Input",ExpressionUUID->"c8435255-caf6-40f1-af3d-12988e3b4b31"],
Cell[CellGroupData[{
Cell[233489, 6297, 360, 9, 52, "Input",ExpressionUUID->"0d8c1064-d99b-4647-a49b-d1cc279f69d9"],
Cell[233852, 6308, 241, 5, 70, "Output",ExpressionUUID->"1cc2680f-d3b6-4f9d-a266-546053f0dfb9"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[234142, 6319, 388, 6, 86, "Section",ExpressionUUID->"b69821c9-b032-441a-a6a3-dbc282268e73"],
Cell[234533, 6327, 544, 10, 43, "Text",ExpressionUUID->"7c8ace97-2057-40ce-8724-32a5c669c804"],
Cell[235080, 6339, 637, 16, 79, "Input",ExpressionUUID->"e490d708-2abb-4def-9ce8-8a6ed2abc2ba"],
Cell[235720, 6357, 968, 29, 72, "Text",ExpressionUUID->"c17595f9-8017-4fba-be6a-ee085fcc82e6"],
Cell[CellGroupData[{
Cell[236713, 6390, 346, 8, 52, "Input",ExpressionUUID->"811aeb9a-9d90-4324-948e-bac779c8d6de"],
Cell[237062, 6400, 7091, 209, 480, "Output",ExpressionUUID->"2602527b-0e96-42d7-babf-9703d2b1c6f8"]
}, Open  ]],
Cell[244168, 6612, 487, 11, 43, "Text",ExpressionUUID->"119cf89d-1777-4b86-90bd-15d200583ce2"],
Cell[CellGroupData[{
Cell[244680, 6627, 244, 5, 52, "Input",ExpressionUUID->"e5ad9465-2130-4327-af87-803ec2800b75"],
Cell[244927, 6634, 309, 8, 70, "Output",ExpressionUUID->"ceb655d1-f1c4-4a6b-a4b7-60d2c95a83de"]
}, Open  ]],
Cell[245251, 6645, 736, 16, 156, "Input",ExpressionUUID->"e1a30d71-ec62-4d9d-81de-e0234deb3007"],
Cell[245990, 6663, 215, 4, 43, "Text",ExpressionUUID->"97ed0780-f93f-4c36-9161-8b2135152516"],
Cell[CellGroupData[{
Cell[246230, 6671, 681, 13, 52, "Input",ExpressionUUID->"b31907a7-fbfe-4894-9d88-de4e1d4509ac"],
Cell[246914, 6686, 615, 11, 70, "Output",ExpressionUUID->"c8ad83a7-a2ec-4a9a-bd0c-9727d7388d8f"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[247578, 6703, 378, 6, 86, "Section",ExpressionUUID->"de58f9e4-ce80-4697-a283-a7dce78e64b5"],
Cell[247959, 6711, 295, 9, 43, "Text",ExpressionUUID->"091e059f-0018-4f24-adf2-eb950150555b"],
Cell[CellGroupData[{
Cell[248279, 6724, 233, 4, 42, "Subsection",ExpressionUUID->"ac7cd585-7ee7-4b0d-b074-520964b4683f"],
Cell[248515, 6730, 1019, 17, 100, "Text",ExpressionUUID->"0cf3ea91-98ba-4f77-bb8a-baefeb991566"],
Cell[249537, 6749, 3941, 83, 440, "Input",ExpressionUUID->"32f333a9-f192-4fee-ac40-c53289832f66"],
Cell[253481, 6834, 626, 12, 72, "Text",ExpressionUUID->"8335e098-b38b-472e-a387-e02f2bb9ccad"],
Cell[254110, 6848, 764, 21, 124, "Input",ExpressionUUID->"f253462d-e344-472c-b1c0-1fbe75de0abd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[254911, 6874, 279, 4, 42, "Subsection",ExpressionUUID->"1c10531e-5aef-4bf6-bbdc-06b56a0fe7a5"],
Cell[255193, 6880, 265, 6, 43, "Text",ExpressionUUID->"67d5e350-62bf-4bcb-bdb8-5f62ed7ef90a"],
Cell[255461, 6888, 893, 17, 79, "Input",ExpressionUUID->"c828d464-32a0-4b83-9f75-ed11ac10b60b"],
Cell[256357, 6907, 442, 10, 43, "Text",ExpressionUUID->"579dfdf7-0350-4bbb-8874-e4fe9b2fa30e"],
Cell[CellGroupData[{
Cell[256824, 6921, 332, 7, 52, "Input",ExpressionUUID->"6865ac32-f370-4948-b971-2c73834aba59"],
Cell[257159, 6930, 4517, 122, 277, "Output",ExpressionUUID->"e1ce4b51-7e8d-439a-9eb2-49808e67e586"]
}, Open  ]],
Cell[261691, 7055, 749, 16, 72, "Text",ExpressionUUID->"a2400838-dc2c-4e8e-a744-701512898d56"],
Cell[CellGroupData[{
Cell[262465, 7075, 1242, 32, 130, "Input",ExpressionUUID->"999cd3d7-dfcb-453d-b675-edfac083d4ac"],
Cell[263710, 7109, 94998, 2311, 1397, "Output",ExpressionUUID->"a5d3e86b-cf20-4ac7-a819-73d813bd81f7"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[358757, 9426, 172, 3, 42, "Subsection",ExpressionUUID->"0054a0ba-857f-47c4-910f-7bec8952e275"],
Cell[358932, 9431, 244, 6, 43, "Text",ExpressionUUID->"4416d463-87e5-4652-98ad-5a9157c19230"],
Cell[CellGroupData[{
Cell[359201, 9441, 176, 3, 40, "Subsubsection",ExpressionUUID->"4d4352e8-9f58-4287-8ffd-9aa3140dad03"],
Cell[359380, 9446, 2678, 43, 72, "Text",ExpressionUUID->"b3186b13-6ab5-417c-8eab-99ebcdbdf7c3"],
Cell[362061, 9491, 2737, 44, 79, "Input",ExpressionUUID->"f5707359-66ac-4c45-9776-e8ddc176aeb5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[364835, 9540, 223, 4, 40, "Subsubsection",ExpressionUUID->"7d8ab04d-3362-49e1-af5e-c9d90f88bbc3"],
Cell[365061, 9546, 2724, 40, 72, "Text",ExpressionUUID->"28756831-3542-40d1-aa60-483c3a4cd0bd"],
Cell[367788, 9588, 3907, 75, 182, "Input",ExpressionUUID->"cfc9d35c-953c-4520-bc5c-b43e6dc6c33d"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[371744, 9669, 473, 9, 42, "Subsection",ExpressionUUID->"613354b5-bbd3-4abd-bf80-6d92f5128966"],
Cell[372220, 9680, 576, 13, 43, "Text",ExpressionUUID->"d7f99f2e-af13-4274-86ee-0b648bf64556"],
Cell[CellGroupData[{
Cell[372821, 9697, 268, 4, 40, "Subsubsection",ExpressionUUID->"77f478ec-bc47-4fd1-a1e1-3445e73f9f2c"],
Cell[373092, 9703, 477, 14, 43, "Text",ExpressionUUID->"a3d0e713-e4dd-4b67-8e8d-973b0e1a98bf"],
Cell[373572, 9719, 701, 17, 79, "Input",ExpressionUUID->"7bdb4e0e-503a-42bd-8247-d309af24c67a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[374310, 9741, 218, 4, 40, "Subsubsection",ExpressionUUID->"88fdf6b6-8885-4a77-b43f-6b550f1245a9"],
Cell[374531, 9747, 358, 7, 43, "Text",ExpressionUUID->"ade8db40-6411-4aaa-8533-872310a7916b"],
Cell[374892, 9756, 2190, 32, 52, "Input",ExpressionUUID->"5a3b8b5d-1c30-4787-a065-64e756d1f0f5"],
Cell[377085, 9790, 224, 4, 43, "Text",ExpressionUUID->"dc011c32-cbb7-4120-880b-e3012322489a"],
Cell[377312, 9796, 3642, 59, 130, "Input",ExpressionUUID->"09c9a31f-d33c-41ed-b1c9-0ff028a1d006"],
Cell[380957, 9857, 340, 4, 43, "Text",ExpressionUUID->"3a3a4cee-fb44-45c2-b794-9e916f47f6b0"],
Cell[381300, 9863, 8580, 165, 621, "Input",ExpressionUUID->"f2aaf48e-9741-463f-97cc-829ea378b918"],
Cell[389883, 10030, 2366, 32, 43, "Text",ExpressionUUID->"7572c186-9387-4870-bbc8-66e830432a00"],
Cell[392252, 10064, 4523, 79, 156, "Input",ExpressionUUID->"864691ab-c843-4e7e-bb8c-16581c848d66"]
}, Open  ]],
Cell[CellGroupData[{
Cell[396812, 10148, 205, 3, 40, "Subsubsection",ExpressionUUID->"c04cef19-7726-4b2a-a30b-ff89946c6072"],
Cell[397020, 10153, 1349, 20, 52, "Input",ExpressionUUID->"71b720d9-659a-45c9-b0f6-40fdd31ca60b"],
Cell[398372, 10175, 2355, 44, 105, "Input",ExpressionUUID->"e9be814a-67ce-480d-ab13-498a1120acf8"],
Cell[400730, 10221, 255, 6, 43, "Text",ExpressionUUID->"af62170d-b67f-4c74-bd44-568804f7dbb9"],
Cell[CellGroupData[{
Cell[401010, 10231, 3345, 50, 105, "Input",ExpressionUUID->"225b4bf0-98f9-45e1-accf-4e096e2126b2"],
Cell[404358, 10283, 766, 14, 93, "Output",ExpressionUUID->"141083fe-6ed9-4349-b57b-b883d770c2bf"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[405173, 10303, 184, 3, 40, "Subsubsection",ExpressionUUID->"7dd5770a-4987-4516-a28c-9821c99a95c7"],
Cell[405360, 10308, 446, 8, 43, "Text",ExpressionUUID->"478c8696-ba88-4254-b736-f486bc913e85"],
Cell[405809, 10318, 1065, 18, 52, "Input",ExpressionUUID->"110f3dc1-39a7-4f5c-8eb4-195879d466fa"],
Cell[406877, 10338, 1528, 29, 79, "Input",ExpressionUUID->"c170bc2d-3143-4e59-b236-e9397d44c2ac"],
Cell[CellGroupData[{
Cell[408430, 10371, 333, 6, 52, "Input",ExpressionUUID->"99e000aa-5237-4544-a1f9-95b5b4335a3d"],
Cell[408766, 10379, 811, 12, 70, "Output",ExpressionUUID->"969cccc2-1134-45bf-8c8e-9913a7e68802"]
}, Open  ]],
Cell[CellGroupData[{
Cell[409614, 10396, 237, 4, 52, "Input",ExpressionUUID->"deffa611-f4ba-4a6d-9e38-4bbd8bbe8173"],
Cell[409854, 10402, 573, 9, 70, "Output",ExpressionUUID->"0de6eb7f-fba4-4e63-8eb1-6829cfa53c0d"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[410488, 10418, 174, 3, 42, "Subsection",ExpressionUUID->"fc77d8e4-ea7a-44e5-bc50-60ff23ffcb07"],
Cell[410665, 10423, 4082, 91, 260, "Input",ExpressionUUID->"6d148c47-98d2-47f2-a356-5a0383539cb6"],
Cell[414750, 10516, 225, 5, 43, "Text",ExpressionUUID->"322f5fc0-f242-43b7-987b-18a99b9af03e"],
Cell[CellGroupData[{
Cell[415000, 10525, 939, 21, 130, "Input",ExpressionUUID->"2aaf10f4-9967-4156-841b-a04c1752182e"],
Cell[415942, 10548, 2457, 46, 239, "Output",ExpressionUUID->"518bcf93-a6b0-414b-83ff-8cf9bddb149a"]
}, Open  ]],
Cell[418414, 10597, 353, 8, 43, "Text",ExpressionUUID->"c13058ea-ab09-4302-92aa-3595f4e1578d"],
Cell[CellGroupData[{
Cell[418792, 10609, 340, 8, 52, "Input",ExpressionUUID->"91326c65-611f-48be-82dd-40c12254f322"],
Cell[419135, 10619, 2170, 43, 331, "Output",ExpressionUUID->"4087d345-37d2-4811-960e-249627034b53"]
}, Open  ]],
Cell[421320, 10665, 197, 3, 43, "Text",ExpressionUUID->"3e0c89ea-a467-41c0-8cc5-6e4960507c31"],
Cell[CellGroupData[{
Cell[421542, 10672, 217, 4, 52, "Input",ExpressionUUID->"afac0e73-05e1-4523-8c0d-8a021c47d703"],
Cell[421762, 10678, 529, 9, 148, "Output",ExpressionUUID->"6fc7e388-2e69-4231-821c-12f45774251f"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[422340, 10693, 217, 4, 42, "Subsection",ExpressionUUID->"77afeab6-4687-4038-b998-583aa5837234"],
Cell[422560, 10699, 200, 3, 43, "Text",ExpressionUUID->"a5947deb-7cb6-418f-993e-738d5e58db13"],
Cell[CellGroupData[{
Cell[422785, 10706, 811, 16, 105, "Input",ExpressionUUID->"be587091-8930-4e2f-9703-619dc11aab2a"],
Cell[423599, 10724, 521, 9, 70, "Output",ExpressionUUID->"e534a2b9-ab49-4e31-ad08-ad1fa4910002"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[424181, 10740, 154, 3, 86, "Section",ExpressionUUID->"f03389af-0505-4f92-9176-33ed17317e57"],
Cell[424338, 10745, 349, 7, 43, "Text",ExpressionUUID->"11ba8125-0fc1-4496-b636-a8e748b158c6"],
Cell[424690, 10754, 512, 11, 72, "Text",ExpressionUUID->"b60e45aa-9282-4ab3-8093-bbda4de5241f"],
Cell[CellGroupData[{
Cell[425227, 10769, 199, 3, 42, "Subsection",ExpressionUUID->"4451dfb0-1865-4d4f-a6dd-2ab22e1d9ae9"],
Cell[425429, 10774, 914, 13, 43, "Text",ExpressionUUID->"0634c781-9dc6-4d37-9bb5-ba42c4d6c192"],
Cell[426346, 10789, 359, 7, 43, "Text",ExpressionUUID->"b483cdf3-a3c5-4e82-8e35-ca0a042a5f2b"],
Cell[426708, 10798, 538, 11, 79, "Input",ExpressionUUID->"9aafb3ae-2995-42bc-975d-01c3d3fdb828"],
Cell[427249, 10811, 1910, 28, 52, "Input",ExpressionUUID->"c2f4e638-1913-40c5-80dd-b4d14255cbed"],
Cell[429162, 10841, 417, 10, 43, "Text",ExpressionUUID->"0d5dd3af-a9c5-46c6-9b77-efaeb6ac361f"],
Cell[CellGroupData[{
Cell[429604, 10855, 205, 4, 52, "Input",ExpressionUUID->"3a37bb25-ab1d-4c8b-b3dc-b961b95396a5"],
Cell[429812, 10861, 14016, 327, 227, "Output",ExpressionUUID->"ea3c50ab-9c3c-46f1-bd1f-5fb4703687d8"]
}, Open  ]],
Cell[443843, 11191, 465, 8, 72, "Text",ExpressionUUID->"abf84e5e-99fd-4ffc-812f-1338e8eaa07d"],
Cell[444311, 11201, 5374, 136, 492, "Input",ExpressionUUID->"b36fbf91-c4c3-4949-a523-5b89941744fb"],
Cell[449688, 11339, 223, 5, 43, "Text",ExpressionUUID->"afb15955-a826-4a17-8f8f-e6bc5572f501"],
Cell[CellGroupData[{
Cell[449936, 11348, 4527, 99, 337, "Input",ExpressionUUID->"2ee1bf78-47aa-471b-9a1f-e91a436964b6"],
Cell[454466, 11449, 6076, 136, 530, "Output",ExpressionUUID->"7a82aaa7-6686-4623-9f87-b18782ae9c5a"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[460603, 11592, 217, 4, 86, "Section",ExpressionUUID->"d92ffcbc-9f80-4bef-bc3e-c04e4499c54a"],
Cell[460823, 11598, 635, 13, 72, "Text",ExpressionUUID->"524e96a9-af81-44bd-ad9b-48f2386f9495"],
Cell[461461, 11613, 614, 11, 43, "Text",ExpressionUUID->"f60a7c78-847c-46bd-9552-2906164d5936"],
Cell[462078, 11626, 159, 3, 43, "Text",ExpressionUUID->"3e16c00a-bd9d-497c-a778-a97c11c9d4b7"],
Cell[CellGroupData[{
Cell[462262, 11633, 345, 7, 52, "Input",ExpressionUUID->"80672418-2dc1-4b80-b419-c850f8d30180"],
Cell[462610, 11642, 2260, 65, 155, "Output",ExpressionUUID->"bd892b8a-dfca-426f-8504-e4d959ff6272"]
}, Open  ]],
Cell[CellGroupData[{
Cell[464907, 11712, 338, 10, 177, "Subsection",ExpressionUUID->"36e32a9d-5bcc-4960-b4fd-405da8b8b783"],
Cell[465248, 11724, 1040, 17, 156, "Input",ExpressionUUID->"aebe5819-f0cb-456b-89e3-74f23ecda387"],
Cell[466291, 11743, 886, 15, 52, "Input",ExpressionUUID->"3301b22c-c588-42ac-b72f-f878b5fc808c"],
Cell[467180, 11760, 1229, 27, 79, "Input",ExpressionUUID->"1d4628ef-36f8-4b95-9e63-545e84460510"],
Cell[468412, 11789, 1680, 38, 156, "Input",ExpressionUUID->"24deb93c-24d8-4cab-9b18-60d4bf2be014"],
Cell[470095, 11829, 1567, 35, 130, "Input",ExpressionUUID->"792ce188-984a-4908-a965-4b0f6e4c07f5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[471699, 11869, 210, 3, 42, "Subsection",ExpressionUUID->"3e07325c-6177-4ccc-8d67-8e39374cdc37"],
Cell[471912, 11874, 3655, 53, 52, "Input",ExpressionUUID->"353a9312-83d2-46bb-b6c7-62e214743a0e"],
Cell[475570, 11929, 166, 3, 43, "Text",ExpressionUUID->"4f6aafd7-3aeb-4397-99f0-80755bc12b18"],
Cell[475739, 11934, 3871, 59, 79, "Input",ExpressionUUID->"345fb820-3dde-4a95-b0cc-7b9702ce6e5d"],
Cell[479613, 11995, 240, 4, 43, "Text",ExpressionUUID->"7feadf99-fc45-4efb-b558-76eb9d6eb4c5"],
Cell[479856, 12001, 4476, 76, 130, "Input",ExpressionUUID->"876773fd-7a70-4239-b947-a10b5bfd96ee"],
Cell[484335, 12079, 604, 16, 72, "Text",ExpressionUUID->"ecdf866c-dffd-4766-b2c2-930a04c91e33"],
Cell[484942, 12097, 7107, 134, 466, "Input",ExpressionUUID->"75bc6916-e6f8-4415-8671-3faa870d4c00"],
Cell[492052, 12233, 352, 8, 43, "Text",ExpressionUUID->"e672e468-d9ac-4bcd-99e7-e4ac08d91933"],
Cell[492407, 12243, 936, 24, 156, "Input",ExpressionUUID->"313aecf1-7186-4400-ab0f-e5a278ac39f4"],
Cell[493346, 12269, 574, 13, 43, "Text",ExpressionUUID->"fcdd07f7-6174-422f-b8c3-b92e5476c9a9"],
Cell[CellGroupData[{
Cell[493945, 12286, 445, 10, 105, "Input",ExpressionUUID->"8ecc70b8-cd1c-4858-8431-212bdc5d4843"],
Cell[494393, 12298, 3318, 91, 162, "Output",ExpressionUUID->"0af98db6-2fce-4abd-a5cf-8b04e27e448f"]
}, Open  ]],
Cell[497726, 12392, 596, 15, 72, "Text",ExpressionUUID->"4fe10e09-dac1-427d-849a-c1bdec78c3e0"],
Cell[CellGroupData[{
Cell[498347, 12411, 6311, 140, 570, "Input",ExpressionUUID->"02f2c6cd-afff-430e-ae81-28e70dbba943"],
Cell[504661, 12553, 7213, 156, 472, "Output",ExpressionUUID->"cca2d1ce-e5da-4ba5-b14d-2e6b3972640d"]
}, Open  ]],
Cell[511889, 12712, 454, 8, 72, "Text",ExpressionUUID->"27d57ffc-0758-4e6c-a901-e670b02e8391"]
}, Open  ]],
Cell[CellGroupData[{
Cell[512380, 12725, 179, 3, 42, "Subsection",ExpressionUUID->"c0644aa6-626c-4272-b503-5cccb3d44a3d"],
Cell[512562, 12730, 253, 6, 43, "Text",ExpressionUUID->"e7b6a9ca-a216-4ae6-a574-c4730cb627ce"],
Cell[512818, 12738, 182, 3, 43, "Text",ExpressionUUID->"cb46621a-6feb-4216-8813-fc24008147a6"],
Cell[CellGroupData[{
Cell[513025, 12745, 199, 4, 52, "Input",ExpressionUUID->"7fbc33e0-c397-4986-aa4a-5f37d323e71b"],
Cell[513227, 12751, 10619, 262, 265, "Output",ExpressionUUID->"6261f5dd-a0ef-479b-ba2d-a623c8a7c77d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[523883, 13018, 201, 4, 52, "Input",ExpressionUUID->"b77ed330-0d90-4998-ba5e-66ec7dfd2056"],
Cell[524087, 13024, 10655, 262, 265, "Output",ExpressionUUID->"b3d3ed28-fe28-4385-a5da-2bfdcf77f84a"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[534791, 13292, 171, 3, 42, "Subsection",ExpressionUUID->"44907b1f-18e8-4696-bb1d-ee9c2aa930a1"],
Cell[534965, 13297, 415, 10, 52, "Input",ExpressionUUID->"f4f5d667-82c5-4698-8c9f-83f954abebba"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[535429, 13313, 154, 3, 86, "Section",ExpressionUUID->"749dac53-cffb-4b10-917c-6e18d39a1e85"],
Cell[535586, 13318, 385, 9, 43, "Text",ExpressionUUID->"a06cace3-3a67-4477-bfe6-7cb43bf0b7c1"],
Cell[CellGroupData[{
Cell[535996, 13331, 159, 3, 42, "Subsection",ExpressionUUID->"d0a2591f-dd7e-49e6-8d5f-c82496ea1c86"],
Cell[536158, 13336, 1732, 48, 156, "Input",ExpressionUUID->"b3cf67c2-2b5f-45f3-939d-74900d6f5d4b"],
Cell[537893, 13386, 154, 3, 43, "Text",ExpressionUUID->"4ed72e9f-3989-4924-902b-29c607dff595"],
Cell[CellGroupData[{
Cell[538072, 13393, 453, 11, 52, "Input",ExpressionUUID->"84f75a87-9162-40ea-83ca-615a1710dc9f"],
Cell[538528, 13406, 645, 12, 70, "Output",ExpressionUUID->"08f3ee2f-3e60-460c-ac23-658743181896"]
}, Open  ]],
Cell[539188, 13421, 157, 3, 43, "Text",ExpressionUUID->"92325328-dad8-490a-b119-97e4ef261114"],
Cell[CellGroupData[{
Cell[539370, 13428, 217, 4, 52, "Input",ExpressionUUID->"b726dc7a-daca-4d6e-850f-509a9b45d966"],
Cell[539590, 13434, 980, 20, 34, "Message",ExpressionUUID->"ac9ecc05-f909-4180-8b69-1c2717afc72f"],
Cell[540573, 13456, 1052, 22, 70, "Output",ExpressionUUID->"b6276ec1-7da1-489c-8c0a-a8c7cc5bff81"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[541674, 13484, 216, 4, 42, "Subsection",ExpressionUUID->"fe5210d8-b7c0-42f4-b9a2-6f75c2e3e1cc"],
Cell[CellGroupData[{
Cell[541915, 13492, 271, 4, 40, "Subsubsection",ExpressionUUID->"fc329d95-083e-477b-8846-75f97f4a9d44"],
Cell[542189, 13498, 4316, 61, 52, "Input",ExpressionUUID->"a6dbe215-2f24-4f5c-b75d-127b4f6fc604"],
Cell[546508, 13561, 6953, 127, 389, "Input",ExpressionUUID->"56846bc5-e99d-40b8-be87-d6a9d45da8ad"],
Cell[CellGroupData[{
Cell[553486, 13692, 736, 17, 156, "Input",ExpressionUUID->"f41a5497-0920-48bd-bfae-0d30db4f640b"],
Cell[554225, 13711, 2934, 80, 139, "Output",ExpressionUUID->"73204b68-33e5-4b9e-ae25-10153885e788"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[557208, 13797, 162, 3, 40, "Subsubsection",ExpressionUUID->"0be39cb2-e1f9-4c0d-846e-10da0f0a5359"],
Cell[CellGroupData[{
Cell[557395, 13804, 478, 12, 52, "Input",ExpressionUUID->"133e7598-fdc3-4063-ac51-8a1d57417dd5"],
Cell[557876, 13818, 1995, 29, 70, "Output",ExpressionUUID->"2b5fd68a-0692-41ae-b320-c90d851e5a33"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[559920, 13853, 162, 3, 40, "Subsubsection",ExpressionUUID->"c319db26-cc98-4b7e-96af-fef0d8e9cf44"],
Cell[560085, 13858, 243, 6, 43, "Text",ExpressionUUID->"9bba6329-fdc4-4b4c-b5b4-b10f469d6373"],
Cell[CellGroupData[{
Cell[560353, 13868, 1216, 30, 105, "Input",ExpressionUUID->"dbc22a21-4113-4d60-9194-9dce0045bb75"],
Cell[561572, 13900, 2149, 31, 70, "Output",ExpressionUUID->"2c88e90e-6378-49c4-8fbd-59220883cb5c"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[563794, 13939, 250, 4, 86, "Section",ExpressionUUID->"88b9463b-57a6-463d-9fd0-76e9e74cca07"],
Cell[564047, 13945, 306, 5, 43, "Text",ExpressionUUID->"fb24135d-0193-42a0-bce9-2efff7b51e6c"],
Cell[564356, 13952, 284, 4, 43, "Text",ExpressionUUID->"36777c0e-bbfc-413e-8501-15b38a126fb5"],
Cell[CellGroupData[{
Cell[564665, 13960, 162, 3, 42, "Subsection",ExpressionUUID->"7e915fa0-a85a-4c82-8aa5-6094c045b0b2"],
Cell[564830, 13965, 1016, 17, 79, "Input",ExpressionUUID->"71cd8910-30a8-43d3-b7eb-cdc0c122e9db"],
Cell[CellGroupData[{
Cell[565871, 13986, 324, 5, 40, "Subsubsection",ExpressionUUID->"0d1bd6d8-70ca-4e07-a6c3-c102b6a30c1e"],
Cell[566198, 13993, 923, 18, 100, "Text",ExpressionUUID->"5731802f-0c99-4e18-949c-4c046629aa2c"],
Cell[CellGroupData[{
Cell[567146, 14015, 216, 4, 52, "Input",ExpressionUUID->"a5e5fad0-2ba2-4e44-8b79-98a5877f37bd"],
Cell[567365, 14021, 1808, 29, 70, "Output",ExpressionUUID->"01c665c6-b640-4b37-96e7-972c4289a438"]
}, Open  ]],
Cell[569188, 14053, 296, 4, 43, "Text",ExpressionUUID->"2d7fe856-8d83-4115-8830-e8f616c7128c"],
Cell[569487, 14059, 318, 8, 52, "Input",ExpressionUUID->"b248bd51-5811-4f2b-b98b-d04d7b9bbd68"],
Cell[569808, 14069, 785, 21, 130, "Input",ExpressionUUID->"c10ce219-eba7-4e67-87c0-edb27b230ee3"],
Cell[570596, 14092, 560, 19, 43, "Text",ExpressionUUID->"60fffdc9-2575-461f-b6aa-51412f973118"],
Cell[571159, 14113, 523, 12, 52, "Input",ExpressionUUID->"515ecae2-26af-42e0-8fda-0a76bb2ad836"],
Cell[571685, 14127, 568, 10, 72, "Text",ExpressionUUID->"187ebfe9-ce32-49ba-996a-79da4cce3b64"],
Cell[572256, 14139, 768, 10, 43, "Text",ExpressionUUID->"7f2929e8-3021-4713-8cb0-24b2cd37e28c"],
Cell[573027, 14151, 1311, 26, 79, "Input",ExpressionUUID->"010415cd-5c00-49d7-8bd2-e196382a7cbb"],
Cell[574341, 14179, 166, 2, 43, "Text",ExpressionUUID->"8e370ef3-5e2e-4d49-8f2f-f62272c83eb7"],
Cell[574510, 14183, 265, 4, 43, "Text",ExpressionUUID->"d2dbb9cd-ed23-4334-a723-8cebb6a54b94"],
Cell[CellGroupData[{
Cell[574800, 14191, 234, 5, 52, "Input",ExpressionUUID->"a8f7fb5b-598e-4958-b1f0-2f35babdd9d3"],
Cell[575037, 14198, 340, 7, 70, "Output",ExpressionUUID->"1e202047-4d95-49f4-916c-c77dc64d180e"]
}, Open  ]],
Cell[575392, 14208, 168, 3, 43, "Text",ExpressionUUID->"7d80e810-4bb4-4f35-b1b6-82a05a31d728"],
Cell[CellGroupData[{
Cell[575585, 14215, 335, 7, 52, "Input",ExpressionUUID->"5c901eb0-b4f4-4906-b665-da5cfe37dc6b"],
Cell[575923, 14224, 249, 5, 70, "Output",ExpressionUUID->"bb225d46-516d-4835-97d4-135801a53ff0"]
}, Open  ]],
Cell[576187, 14232, 166, 3, 43, "Text",ExpressionUUID->"925fe4bf-34e4-4e4e-8bce-305c47d7596e"],
Cell[CellGroupData[{
Cell[576378, 14239, 363, 8, 52, "Input",ExpressionUUID->"b0194591-2f3d-429d-8311-36e598660512"],
Cell[576744, 14249, 283, 5, 70, "Output",ExpressionUUID->"d9f825a9-04d1-4804-9377-6bd78bfe8e77"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[577076, 14260, 272, 4, 40, "Subsubsection",ExpressionUUID->"99d78953-8c65-4fe4-b31b-4153ca3dcf93"],
Cell[577351, 14266, 2023, 41, 44, "Text",ExpressionUUID->"41ce08d8-a9f1-46fb-9281-22ceac002058"],
Cell[579377, 14309, 1971, 37, 105, "Input",ExpressionUUID->"91fa7d87-bfc9-4867-92e5-ea1776ff5f4b"],
Cell[581351, 14348, 532, 11, 72, "Text",ExpressionUUID->"2b344a99-86a3-4694-b3fb-a16516100c4d"],
Cell[581886, 14361, 329, 13, 43, "Text",ExpressionUUID->"8a0c78a6-7046-4b28-a3da-ed3013d4e941"],
Cell[582218, 14376, 796, 13, 100, "Text",ExpressionUUID->"85848ab0-5cdb-42a2-8f44-e5ff7c2c7544"]
}, Open  ]],
Cell[CellGroupData[{
Cell[583051, 14394, 251, 4, 40, "Subsubsection",ExpressionUUID->"afbacb94-c20c-46c9-b9f8-b9c48c63fda0"],
Cell[583305, 14400, 526, 12, 43, "Text",ExpressionUUID->"a9f4f0c3-9ea7-4cf5-b398-6b68709758eb"],
Cell[583834, 14414, 288, 7, 43, "Text",ExpressionUUID->"bc7afd5e-ca2b-4a0f-ad28-c09383266246"],
Cell[584125, 14423, 2091, 39, 105, "Input",ExpressionUUID->"0e8fda2b-0a9a-4a8c-9d52-e65b29827461"],
Cell[586219, 14464, 536, 9, 72, "Text",ExpressionUUID->"2a443756-d677-4cbf-821b-602ce795a738"],
Cell[586758, 14475, 1642, 28, 52, "Input",ExpressionUUID->"b090521a-379f-4c86-a9bc-7cb9c41e6dd4"],
Cell[588403, 14505, 166, 2, 43, "Text",ExpressionUUID->"1ea179d0-b611-459f-91e2-cd16547d79c1"],
Cell[588572, 14509, 177, 3, 43, "Text",ExpressionUUID->"be71a2eb-b9ed-473c-ac22-e1c74d9e0e2c"],
Cell[CellGroupData[{
Cell[588774, 14516, 442, 11, 52, "Input",ExpressionUUID->"21d4c6bb-bdd5-4de7-8c4f-58e72744a66f"],
Cell[589219, 14529, 270, 5, 70, "Output",ExpressionUUID->"c1c03cdb-29ad-4a34-ac8a-10794e3c78b0"]
}, Open  ]],
Cell[589504, 14537, 188, 3, 43, "Text",ExpressionUUID->"3de20d9a-e5d4-445c-a147-3a51d3b92159"],
Cell[CellGroupData[{
Cell[589717, 14544, 567, 13, 52, "Input",ExpressionUUID->"f445b0de-bb05-4e71-9fc2-9645633b219c"],
Cell[590287, 14559, 440, 10, 70, "Output",ExpressionUUID->"7cd8f6cc-c9eb-4923-9239-3270a47e16e2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[590764, 14574, 770, 20, 52, "Input",ExpressionUUID->"c855ab79-c194-4fae-9f58-e16fcbc6e842"],
Cell[591537, 14596, 225, 4, 70, "Output",ExpressionUUID->"ad0bdfb3-98a6-4ee3-a792-7ed085800eda"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[591811, 14606, 249, 4, 40, "Subsubsection",ExpressionUUID->"e47e62a7-f7a7-4735-b20f-5189f4693781"],
Cell[592063, 14612, 659, 13, 72, "Text",ExpressionUUID->"27826ebb-00c9-4f2d-a582-f89c7a810db1"],
Cell[CellGroupData[{
Cell[592747, 14629, 214, 4, 52, "Input",ExpressionUUID->"6ca4929a-d3dc-4189-9777-9a21ebb53046"],
Cell[592964, 14635, 1576, 25, 70, "Output",ExpressionUUID->"9d219e55-bd12-464e-ba07-c826cba1e66a"]
}, Open  ]],
Cell[594555, 14663, 3080, 67, 208, "Input",ExpressionUUID->"a6e7eb8f-55c2-42b0-809b-f3e3e5b396b1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[597672, 14735, 272, 4, 40, "Subsubsection",ExpressionUUID->"98b95049-aeee-47c6-a5ae-188b5c952598"],
Cell[597947, 14741, 1126, 20, 43, "Text",ExpressionUUID->"8cb69cb5-6599-4ad0-a37a-df56ceafa82f"],
Cell[599076, 14763, 1852, 39, 105, "Input",ExpressionUUID->"ad86dd7b-6e89-468d-a61c-1d6343af9b26"]
}, Open  ]],
Cell[CellGroupData[{
Cell[600965, 14807, 275, 4, 40, "Subsubsection",ExpressionUUID->"6e345ede-566e-4313-b84f-167fa571ef3f"],
Cell[601243, 14813, 366, 6, 43, "Text",ExpressionUUID->"b6fa98e3-6ef4-4a31-9f0e-081c7c8851c5"],
Cell[601612, 14821, 1339, 27, 52, "Input",ExpressionUUID->"9f4ffd3b-c8d7-4bba-9e24-f0d5cfb34713"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[603000, 14854, 162, 3, 42, "Subsection",ExpressionUUID->"a0a6a5bb-0294-4ee7-ae7b-e6bc0b003437"],
Cell[603165, 14859, 229, 4, 43, "Text",ExpressionUUID->"72197689-548c-4300-a16e-4e7c2367738a"],
Cell[603397, 14865, 2189, 53, 208, "Input",ExpressionUUID->"9a7548f5-ca6f-4c21-af20-a4cb66363467"],
Cell[605589, 14920, 832, 15, 43, "Text",ExpressionUUID->"d0f64d53-5953-4b38-9892-92e27d361739"],
Cell[606424, 14937, 1582, 36, 105, "Input",ExpressionUUID->"d63f254d-4a98-435d-8c81-40b129528c21"],
Cell[608009, 14975, 194, 4, 43, "Text",ExpressionUUID->"7c9df154-3d84-47ad-a8f6-be8227ba686c"],
Cell[608206, 14981, 1694, 38, 105, "Input",ExpressionUUID->"7c5d80cc-87b9-45bc-9d78-00894339bca7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[609937, 15024, 156, 3, 42, "Subsection",ExpressionUUID->"8a0d4b60-736b-4e3a-80e4-fbfc4e7a36e5"],
Cell[CellGroupData[{
Cell[610118, 15031, 159, 2, 40, "Subsubsection",ExpressionUUID->"844d10e6-bf17-420d-aadc-bd5f0c97a119"],
Cell[610280, 15035, 154, 3, 43, "Text",ExpressionUUID->"8ce2e632-dc59-43bf-833f-4d128af55030"],
Cell[CellGroupData[{
Cell[610459, 15042, 237, 5, 52, "Input",ExpressionUUID->"6e234509-3698-48a9-ab6f-e743189d4477"],
Cell[610699, 15049, 1986, 31, 70, "Output",ExpressionUUID->"2b4e2ec6-c2fc-441e-8baa-fc8aaadef973"]
}, Open  ]],
Cell[612700, 15083, 183, 3, 43, "Text",ExpressionUUID->"63f4d661-8180-4536-ad9e-46efdc9695d6"],
Cell[CellGroupData[{
Cell[612908, 15090, 358, 7, 52, "Input",ExpressionUUID->"a664055f-bcf7-42f0-82a3-8fad1cc8ecfc"],
Cell[613269, 15099, 1972, 31, 70, "Output",ExpressionUUID->"f450c841-1b37-45a6-bc6b-9e22e1bc4c53"]
}, Open  ]],
Cell[615256, 15133, 189, 3, 43, "Text",ExpressionUUID->"1523f2e3-5f7f-4ec3-af13-d356aea74ca7"],
Cell[CellGroupData[{
Cell[615470, 15140, 408, 8, 52, "Input",ExpressionUUID->"f7d9d0a4-b0c7-4ef3-88d9-3787ec5ffe0a"],
Cell[615881, 15150, 2235, 34, 70, "Output",ExpressionUUID->"2bbe58f8-3da0-40d6-86c4-8034911b9e29"]
}, Open  ]],
Cell[618131, 15187, 179, 3, 43, "Text",ExpressionUUID->"f872a13b-72ac-47ed-9799-62a22576494e"],
Cell[CellGroupData[{
Cell[618335, 15194, 339, 9, 52, "Input",ExpressionUUID->"d05f96ad-74df-4b45-a44f-b6fc157cbc94"],
Cell[618677, 15205, 1838, 27, 70, "Output",ExpressionUUID->"34c4cc2c-b950-4af9-8eb6-a78475a796da"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[620564, 15238, 319, 5, 40, "Subsubsection",ExpressionUUID->"70404561-2ceb-4f26-8ae2-ce2702b396b7"],
Cell[CellGroupData[{
Cell[620908, 15247, 237, 5, 52, "Input",ExpressionUUID->"97aa2ae1-425f-4af4-8f77-e189e79673ff"],
Cell[621148, 15254, 2224, 37, 70, "Output",ExpressionUUID->"f106a864-fa41-4356-8dff-b1540e642897"]
}, Open  ]],
Cell[CellGroupData[{
Cell[623409, 15296, 318, 8, 52, "Input",ExpressionUUID->"4cdfd3b8-b582-452b-8d35-5b5916e045b5"],
Cell[623730, 15306, 1846, 27, 70, "Output",ExpressionUUID->"ad7cc283-4a3c-4a8f-a84d-c00052d0e923"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[625625, 15339, 271, 4, 40, "Subsubsection",ExpressionUUID->"a957b771-e83b-4ca3-acf1-9b91de5fbeef"],
Cell[CellGroupData[{
Cell[625921, 15347, 340, 8, 52, "Input",ExpressionUUID->"a9ac5ddc-2b5f-4ef8-b8ed-dd60ff9fd381"],
Cell[626264, 15357, 1851, 28, 70, "Output",ExpressionUUID->"49b70e6e-2510-467e-9ff7-6c74d525b6db"]
}, Open  ]],
Cell[CellGroupData[{
Cell[628152, 15390, 322, 8, 52, "Input",ExpressionUUID->"059bf818-e9aa-417f-9515-a93c92d0e47c"],
Cell[628477, 15400, 1877, 27, 70, "Output",ExpressionUUID->"72145628-c57f-4cdd-8d33-8a39b8666537"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[630403, 15433, 345, 5, 40, "Subsubsection",ExpressionUUID->"65a61b2b-82fd-4ae7-8620-81bb9921bcf1"],
Cell[CellGroupData[{
Cell[630773, 15442, 456, 12, 52, "Input",ExpressionUUID->"862240a8-9e9e-4f86-973a-14d3cff718ed"],
Cell[631232, 15456, 1853, 27, 70, "Output",ExpressionUUID->"a2deea49-6375-4c89-963c-615c9d900bce"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[633134, 15489, 242, 4, 40, "Subsubsection",ExpressionUUID->"6067e4fc-0ee7-4ad1-a0df-77d48d85eb83"],
Cell[633379, 15495, 197, 3, 43, "Text",ExpressionUUID->"6877a156-a447-44a9-bfbd-455ed725666d"],
Cell[CellGroupData[{
Cell[633601, 15502, 452, 13, 52, "Input",ExpressionUUID->"f9795451-ed47-4cd5-8a40-7d1ad358aaa9"],
Cell[634056, 15517, 1877, 27, 70, "Output",ExpressionUUID->"27b83bd5-e681-4363-91f2-079cbebac79c"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[635982, 15550, 238, 4, 40, "Subsubsection",ExpressionUUID->"94368d1b-bf7f-4147-9fda-0eac9d8629e8"],
Cell[CellGroupData[{
Cell[636245, 15558, 512, 12, 52, "Input",ExpressionUUID->"db671569-d1da-43e1-a5d3-9de8f6f6a63e"],
Cell[636760, 15572, 1855, 28, 70, "Output",ExpressionUUID->"901cc9d0-f622-4443-a01e-0d28c33c4aa7"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[638664, 15606, 241, 4, 40, "Subsubsection",ExpressionUUID->"486dba37-7a28-4016-b68d-b0db0028450f"],
Cell[638908, 15612, 468, 10, 72, "Text",ExpressionUUID->"f9b355f9-dba8-41d0-b3fb-ac3a87802180"],
Cell[CellGroupData[{
Cell[639401, 15626, 273, 6, 52, "Input",ExpressionUUID->"72014098-97eb-4ea0-aecc-af3fa6ad1ae9"],
Cell[639677, 15634, 18804, 463, 285, "Output",ExpressionUUID->"bfcf6755-4b05-4052-89d1-d092e8af2b46"]
}, Open  ]],
Cell[658496, 16100, 509, 11, 43, "Text",ExpressionUUID->"9bebeb37-1f36-48f2-a8ba-fb5ad1dd2820"],
Cell[659008, 16113, 1528, 41, 208, "Input",ExpressionUUID->"d69ea9e2-674c-406b-acc2-150266436460"],
Cell[660539, 16156, 992, 25, 182, "Input",ExpressionUUID->"32f95c3a-8de7-490a-ac89-e0641ce4d7bd"],
Cell[661534, 16183, 184, 3, 43, "Text",ExpressionUUID->"36248010-e00b-4b5f-a6e7-757acad5d800"],
Cell[CellGroupData[{
Cell[661743, 16190, 388, 10, 52, "Input",ExpressionUUID->"41590731-6a11-42cb-8aec-63f4b61fc54e"],
Cell[662134, 16202, 1227, 24, 70, "Output",ExpressionUUID->"028e63f4-0975-480d-8232-cdf89e83589b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[663398, 16231, 461, 12, 52, "Input",ExpressionUUID->"7ad93786-2a83-45cf-b94d-235e63993ee1"],
Cell[663862, 16245, 6723, 157, 109, "Output",ExpressionUUID->"7d891349-dbb6-44cf-8d35-ac3a26e365cc"]
}, Open  ]],
Cell[670600, 16405, 260, 5, 43, "Text",ExpressionUUID->"9f421dd3-f1be-43fc-b015-50fbd3a85185"],
Cell[CellGroupData[{
Cell[670885, 16414, 422, 10, 52, "Input",ExpressionUUID->"8901db53-9ee3-4f3d-841d-e14c108ef6f3"],
Cell[671310, 16426, 2075, 39, 75, "Output",ExpressionUUID->"4fc851b2-8855-4579-9b21-5804736ad9bd"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[673434, 16471, 253, 4, 40, "Subsubsection",ExpressionUUID->"0015983c-8b1a-426b-a2fe-c8c74afbc89d"],
Cell[CellGroupData[{
Cell[673712, 16479, 1403, 31, 260, "Input",ExpressionUUID->"cf1de138-3a7b-454e-8238-8b9894444d81"],
Cell[675118, 16512, 1688, 25, 70, "Output",ExpressionUUID->"2dfaa1b3-7297-4cbb-82ab-b5c6ac7484fc"]
}, Open  ]],
Cell[676821, 16540, 567, 12, 72, "Text",ExpressionUUID->"e900c724-94e0-465c-a2d2-e0229182a7aa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[677425, 16557, 244, 4, 40, "Subsubsection",ExpressionUUID->"8a6859f3-1d66-4a96-bb8a-17ce7eec5881"],
Cell[677672, 16563, 215, 3, 43, "Text",ExpressionUUID->"545d0f4f-ac90-4286-b3cf-0a1a37ddee6d"],
Cell[CellGroupData[{
Cell[677912, 16570, 571, 12, 79, "Input",ExpressionUUID->"fd1d6ad5-f584-4f55-911a-fa09edfa0daf"],
Cell[678486, 16584, 6816, 158, 109, "Output",ExpressionUUID->"ff83476d-324c-40d0-9815-d6b959a880ac"]
}, Open  ]],
Cell[685317, 16745, 223, 5, 43, "Text",ExpressionUUID->"0a89cdfd-cad0-4309-823d-72abe9d83db9"],
Cell[CellGroupData[{
Cell[685565, 16754, 674, 14, 79, "Input",ExpressionUUID->"9229b6af-8e5b-4028-8696-9d5748fe3453"],
Cell[686242, 16770, 6993, 161, 109, "Output",ExpressionUUID->"a0a0c41e-6e20-4f44-b9cd-c53ccf6f7a01"]
}, Open  ]],
Cell[CellGroupData[{
Cell[693272, 16936, 619, 13, 79, "Input",ExpressionUUID->"a59adf18-2558-432b-8683-113f79b9ccd1"],
Cell[693894, 16951, 6796, 158, 109, "Output",ExpressionUUID->"df53a0c9-977f-48c3-8ca0-9cc55dcfc7d8"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[700739, 17115, 239, 4, 40, "Subsubsection",ExpressionUUID->"aa41ccc5-f4b8-4ce2-81f3-ec77febcf07f"],
Cell[700981, 17121, 180, 3, 43, "Text",ExpressionUUID->"affd6003-ca8a-4d9b-975f-7a241a005a30"],
Cell[701164, 17126, 469, 9, 72, "Text",ExpressionUUID->"087478bc-24cd-44a2-80ff-9f3ac6b56bbe"],
Cell[CellGroupData[{
Cell[701658, 17139, 492, 11, 79, "Input",ExpressionUUID->"ff26f956-bd04-4672-a470-adfe0fefa246"],
Cell[702153, 17152, 35558, 901, 419, "Output",ExpressionUUID->"8b116e08-865b-4fe9-8e71-f67317911d31"]
}, Open  ]],
Cell[737726, 18056, 946, 24, 182, "Input",ExpressionUUID->"96d7efbc-667e-491b-bb26-7b001722106d"],
Cell[CellGroupData[{
Cell[738697, 18084, 900, 19, 79, "Input",ExpressionUUID->"a3321495-eb4c-45a5-8835-d8fad932d642"],
Cell[739600, 18105, 10737, 256, 144, "Output",ExpressionUUID->"357681e3-eb8a-4a61-8276-a6bc98ae757f"]
}, Open  ]],
Cell[750352, 18364, 399, 8, 43, "Text",ExpressionUUID->"84633997-60f3-4703-b5e9-38245a7a5856"],
Cell[CellGroupData[{
Cell[750776, 18376, 463, 12, 52, "Input",ExpressionUUID->"3ca0ed18-82ae-4187-9540-471ca8cd2ca5"],
Cell[751242, 18390, 1898, 28, 70, "Output",ExpressionUUID->"8494a3c1-f9cf-4dae-990d-1ad93ca37739"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[753189, 18424, 223, 4, 40, "Subsubsection",ExpressionUUID->"5b9c6ac3-0dbf-432f-8387-75dfc55219a5"],
Cell[753415, 18430, 218, 5, 43, "Text",ExpressionUUID->"7b02f625-1cff-4fe3-b4df-02dc22353d95"],
Cell[CellGroupData[{
Cell[753658, 18439, 460, 12, 52, "Input",ExpressionUUID->"ad16d26e-0764-421f-a1e6-10b6d6e5a611"],
Cell[754121, 18453, 1765, 26, 70, "Output",ExpressionUUID->"d2e32b61-0942-4b64-8f91-bb83ad831e1e"]
}, Open  ]],
Cell[755901, 18482, 336, 7, 43, "Text",ExpressionUUID->"23e0ec28-17f5-405e-a360-e561581c86cd"],
Cell[CellGroupData[{
Cell[756262, 18493, 691, 17, 105, "Input",ExpressionUUID->"30cc3c8b-28f5-43f5-a611-2a29c88110ba"],
Cell[756956, 18512, 10551, 253, 144, "Output",ExpressionUUID->"6581a3fc-be7f-46fc-b35d-80e12bc06f54"]
}, Open  ]],
Cell[767522, 18768, 211, 4, 43, "Text",ExpressionUUID->"09703189-fd9a-4fe4-b9ca-b6170ba4667c"],
Cell[CellGroupData[{
Cell[767758, 18776, 1107, 27, 130, "Input",ExpressionUUID->"6d52799b-af8d-4f66-96c4-9c53c6ff71f9"],
Cell[768868, 18805, 1865, 27, 70, "Output",ExpressionUUID->"4f7db43a-97e5-434e-9c33-7e03a2f51aa4"]
}, Open  ]],
Cell[770748, 18835, 241, 4, 43, "Text",ExpressionUUID->"85fc9dac-a7cd-4cbe-91d4-20b4dcedf87d"],
Cell[CellGroupData[{
Cell[771014, 18843, 557, 12, 105, "Input",ExpressionUUID->"335d266a-d0a5-4653-bd8a-de454b453b62"],
Cell[771574, 18857, 1829, 26, 70, "Output",ExpressionUUID->"2c636458-7c95-4f83-bc4d-a63d1afa224b"]
}, Open  ]],
Cell[773418, 18886, 182, 3, 43, "Text",ExpressionUUID->"18d56511-e934-45e3-8203-a4f202c2a660"],
Cell[CellGroupData[{
Cell[773625, 18893, 533, 12, 79, "Input",ExpressionUUID->"cad6961e-7b19-4736-96a7-11476714f821"],
Cell[774161, 18907, 6793, 157, 109, "Output",ExpressionUUID->"93f486f9-7425-4623-8057-0149c4c4bd5e"]
}, Open  ]],
Cell[780969, 19067, 189, 3, 43, "Text",ExpressionUUID->"22c0c9ec-03d3-4706-9a08-c58c8cc2d8be"],
Cell[CellGroupData[{
Cell[781183, 19074, 563, 12, 105, "Input",ExpressionUUID->"3c39f1db-94a4-42c2-bfdb-295d5742fc7d"],
Cell[781749, 19088, 1752, 26, 70, "Output",ExpressionUUID->"8a67ab63-6adf-40e5-aab2-0dcffc0ede72"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[783562, 19121, 167, 3, 42, "Subsection",ExpressionUUID->"600d6d7e-8a2d-4247-aab7-0ae5a0a915e1"],
Cell[783732, 19126, 3727, 91, 311, "Input",ExpressionUUID->"4ffd2518-bd32-4add-88de-8fa5a272ea0d"],
Cell[CellGroupData[{
Cell[787484, 19221, 246, 4, 40, "Subsubsection",ExpressionUUID->"1f8f1751-2a45-4646-bbed-3b7d6ec54336"],
Cell[CellGroupData[{
Cell[787755, 19229, 889, 21, 52, "Input",ExpressionUUID->"d72a73b8-cb0b-4873-af42-79900fe42577"],
Cell[788647, 19252, 2292, 35, 70, "Output",ExpressionUUID->"a005c420-a6c0-40d2-878d-f411b4b9555e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[790988, 19293, 270, 4, 40, "Subsubsection",ExpressionUUID->"bf32541e-c64a-49cd-bc59-394f4fd0bdb2"],
Cell[CellGroupData[{
Cell[791283, 19301, 851, 23, 52, "Input",ExpressionUUID->"67fc4a1d-e251-4d4c-8e98-3b65661378c0"],
Cell[792137, 19326, 1672, 27, 70, "Output",ExpressionUUID->"c3fcae0e-e3d2-4850-9e8f-c60bb4ef8e0f"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[793858, 19359, 297, 5, 40, "Subsubsection",ExpressionUUID->"300f2711-7dcf-47b9-900b-41a1f40d543b"],
Cell[CellGroupData[{
Cell[794180, 19368, 634, 19, 52, "Input",ExpressionUUID->"088bdad2-0ef5-4779-bd82-3fce412fda2f"],
Cell[794817, 19389, 1670, 26, 70, "Output",ExpressionUUID->"5aef6484-251d-4535-bcbf-23b53dbfc048"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[796536, 19421, 348, 5, 40, "Subsubsection",ExpressionUUID->"913a2136-ce9c-4721-9e06-3e6c1421457c"],
Cell[CellGroupData[{
Cell[796909, 19430, 775, 24, 52, "Input",ExpressionUUID->"4b4253ac-c220-4d38-9510-393d7d95b822"],
Cell[797687, 19456, 1706, 26, 70, "Output",ExpressionUUID->"a150159b-68db-4222-bec3-963ab79a8107"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[799442, 19488, 272, 4, 40, "Subsubsection",ExpressionUUID->"eb818e05-97da-4e7c-8381-a59eb84a8525"],
Cell[CellGroupData[{
Cell[799739, 19496, 895, 26, 182, "Input",ExpressionUUID->"52ee4449-b56b-4eeb-ac7b-652f375bd619"],
Cell[800637, 19524, 1696, 26, 70, "Output",ExpressionUUID->"80902113-dba4-4a2e-9c7b-ccf3535639ec"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[802382, 19556, 272, 4, 40, "Subsubsection",ExpressionUUID->"cb0341e8-2fab-4fb5-88cc-a7a769c07df0"],
Cell[CellGroupData[{
Cell[802679, 19564, 1103, 30, 234, "Input",ExpressionUUID->"bead8975-3320-4516-bc7b-4ab9a955b4b8"],
Cell[803785, 19596, 1739, 27, 70, "Output",ExpressionUUID->"d183a2dd-f21e-4ff5-9278-e6795f95200d"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[805573, 19629, 195, 3, 40, "Subsubsection",ExpressionUUID->"c05a3fc3-d16b-4b59-84de-4dac3d84929f"],
Cell[CellGroupData[{
Cell[805793, 19636, 1056, 29, 234, "Input",ExpressionUUID->"3bb25496-5d45-4223-993e-e7bc05053500"],
Cell[806852, 19667, 1731, 27, 70, "Output",ExpressionUUID->"ddf5bbe6-3ccf-44d2-9d3c-aa66b5700db8"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[808632, 19700, 198, 3, 40, "Subsubsection",ExpressionUUID->"07b19590-2a31-41d1-8523-076c28fcd6c7"],
Cell[CellGroupData[{
Cell[808855, 19707, 1054, 29, 234, "Input",ExpressionUUID->"de3b629c-3e6d-412f-876a-60b4893d6a12"],
Cell[809912, 19738, 1724, 27, 70, "Output",ExpressionUUID->"464aa625-3ce2-4251-b2c9-759784fc5c89"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[811685, 19771, 195, 3, 40, "Subsubsection",ExpressionUUID->"2b488a47-0063-45e4-95ac-a0a3301dc4a2"],
Cell[CellGroupData[{
Cell[811905, 19778, 1045, 30, 234, "Input",ExpressionUUID->"ca8c7b38-6dbc-4db6-83b8-8852a7608bdb"],
Cell[812953, 19810, 1714, 28, 70, "Output",ExpressionUUID->"c7a64cc7-a0ed-4845-9dc1-3485cd885ce3"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[814716, 19844, 197, 3, 40, "Subsubsection",ExpressionUUID->"23059900-68ff-4168-8e37-0d46e6bb8421"],
Cell[814916, 19849, 182, 3, 43, "Text",ExpressionUUID->"688715bd-a1c5-44c1-8013-962f46321161"],
Cell[CellGroupData[{
Cell[815123, 19856, 1214, 30, 260, "Input",ExpressionUUID->"b66a466c-a69e-4222-b893-fd2c696f5279"],
Cell[816340, 19888, 2186, 45, 199, "Output",ExpressionUUID->"edc547f0-a373-4187-a6d2-2c492c3c86c8"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[818575, 19939, 251, 4, 40, "Subsubsection",ExpressionUUID->"2082e808-2ff9-4c15-a69a-bc713c6960d9"],
Cell[CellGroupData[{
Cell[818851, 19947, 907, 24, 156, "Input",ExpressionUUID->"08f267f3-7056-4f09-8a49-564d4c3590d2"],
Cell[819761, 19973, 2109, 42, 155, "Output",ExpressionUUID->"0a539ac6-649d-497a-a578-138497e1ab78"]
}, Open  ]],
Cell[821885, 20018, 681, 19, 72, "Text",ExpressionUUID->"32693f53-4234-49a8-bdef-3e247061ee96"],
Cell[822569, 20039, 2866, 42, 52, "Input",ExpressionUUID->"37f94f28-d7b2-4f45-8531-ebea88425d00"],
Cell[825438, 20083, 7751, 178, 466, "Input",ExpressionUUID->"053fa2cd-6da6-4a86-bd5d-df68b2439722"]
}, Open  ]],
Cell[CellGroupData[{
Cell[833226, 20266, 219, 3, 40, "Subsubsection",ExpressionUUID->"7124ee21-5068-4c67-b6b0-eb9e4aea84a2"],
Cell[CellGroupData[{
Cell[833470, 20273, 1269, 29, 156, "Input",ExpressionUUID->"937c1f57-7f0e-4fe8-9ca2-ca4f07875fc0"],
Cell[834742, 20304, 3201, 55, 155, "Output",ExpressionUUID->"6f4aebcc-8eb9-4c27-87e6-d3b5172d32bd"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[837992, 20365, 263, 4, 40, "Subsubsection",ExpressionUUID->"a44e780d-c00d-4d01-9f05-a016a6959211"],
Cell[CellGroupData[{
Cell[838280, 20373, 1280, 34, 234, "Input",ExpressionUUID->"0f788a3e-3def-4873-9f79-8d383bf8d056"],
Cell[839563, 20409, 2481, 49, 245, "Output",ExpressionUUID->"0c6c4346-2dad-4693-ba9a-f8f266a6d4bf"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[842093, 20464, 259, 4, 40, "Subsubsection",ExpressionUUID->"59bb1290-1cd8-4d78-a4c3-3352f574abfe"],
Cell[CellGroupData[{
Cell[842377, 20472, 1312, 36, 234, "Input",ExpressionUUID->"fa3e076b-e02d-4d64-b184-80a0f1e387aa"],
Cell[843692, 20510, 2496, 50, 245, "Output",ExpressionUUID->"66c372ce-b04d-4057-a55f-777882e785ee"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[846237, 20566, 214, 3, 40, "Subsubsection",ExpressionUUID->"1558a096-fa42-4232-9682-c4f50e279655"],
Cell[CellGroupData[{
Cell[846476, 20573, 1086, 30, 182, "Input",ExpressionUUID->"c3e93c60-44d1-4b40-946a-bd1615bb42dc"],
Cell[847565, 20605, 2388, 47, 200, "Output",ExpressionUUID->"448b4a53-2b6e-4d1e-9f0f-b7e04403cce7"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[850014, 20659, 165, 3, 42, "Subsection",ExpressionUUID->"2906ff61-be3e-4960-a1f9-13476e2a59cd"],
Cell[CellGroupData[{
Cell[850204, 20666, 199, 3, 40, "Subsubsection",ExpressionUUID->"d0791ed6-e194-470c-b374-ac2732c21cc5"],
Cell[CellGroupData[{
Cell[850428, 20673, 1241, 31, 208, "Input",ExpressionUUID->"ce8b4ab8-a8dd-4eec-81f8-d5377826e767"],
Cell[851672, 20706, 2475, 46, 200, "Output",ExpressionUUID->"519ff0d2-cdac-40c2-9105-bbd9af7189ba"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[854196, 20758, 199, 3, 40, "Subsubsection",ExpressionUUID->"539e4e07-bb91-4c92-aa7f-c6651bf1209c"],
Cell[CellGroupData[{
Cell[854420, 20765, 1534, 36, 285, "Input",ExpressionUUID->"a8216bfe-d372-4f56-b63d-dd8a124cdd9e"],
Cell[855957, 20803, 2633, 48, 202, "Output",ExpressionUUID->"a494496c-31c8-44f4-b1d5-fa15576f103b"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[858639, 20857, 197, 3, 40, "Subsubsection",ExpressionUUID->"75f1c7fa-89fa-4b50-9e4e-9f6c4913bfff"],
Cell[CellGroupData[{
Cell[858861, 20864, 1187, 28, 234, "Input",ExpressionUUID->"fca0f141-d2f9-4345-ab32-76af85d7c293"],
Cell[860051, 20894, 2359, 44, 155, "Output",ExpressionUUID->"436fc7eb-ea02-412a-9f85-922fdb05bbb9"]
}, Open  ]],
Cell[862425, 20941, 999, 17, 130, "Text",ExpressionUUID->"ef3220f4-7df2-40de-a19d-fe11222b5c7d"],
Cell[863427, 20960, 224, 5, 43, "Text",ExpressionUUID->"6993b8b0-68a2-4b84-bc48-96a1e50a78ec"],
Cell[863654, 20967, 247, 4, 43, "Text",ExpressionUUID->"47238d23-b5a0-48ff-840e-e747af82b97c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[863938, 20976, 201, 3, 40, "Subsubsection",ExpressionUUID->"e56b5a4c-792c-43e7-aed6-80ac45269c55"],
Cell[CellGroupData[{
Cell[864164, 20983, 1304, 31, 234, "Input",ExpressionUUID->"77e40b36-5a37-4877-b012-68829824da78"],
Cell[865471, 21016, 2347, 43, 155, "Output",ExpressionUUID->"c9df8d9d-82ea-41da-94b7-e88eec1fbd37"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[867867, 21065, 197, 3, 40, "Subsubsection",ExpressionUUID->"1240922c-7761-40f8-a93b-6b1219d70bc4"],
Cell[CellGroupData[{
Cell[868089, 21072, 1664, 38, 285, "Input",ExpressionUUID->"91642047-40d9-48b0-aef5-6c22264a3f46"],
Cell[869756, 21112, 2541, 47, 202, "Output",ExpressionUUID->"45ac79c9-16f6-4136-b17a-13d46a037619"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[872346, 21165, 296, 4, 40, "Subsubsection",ExpressionUUID->"7232f489-7936-4d48-ba33-05add2d3aec9"],
Cell[CellGroupData[{
Cell[872667, 21173, 1393, 34, 260, "Input",ExpressionUUID->"3c077e73-fc16-4867-8b66-2348caf0ade9"],
Cell[874063, 21209, 2395, 45, 179, "Output",ExpressionUUID->"c279449b-9fbd-4c24-be34-a89645cd03ba"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[876507, 21260, 249, 4, 40, "Subsubsection",ExpressionUUID->"b2b415fc-3688-48a8-96f3-f223ce4932e6"],
Cell[876759, 21266, 364, 7, 72, "Text",ExpressionUUID->"c1fbe267-261e-4cd8-80cd-4b7026023554"],
Cell[CellGroupData[{
Cell[877148, 21277, 1535, 37, 285, "Input",ExpressionUUID->"e45e8fdc-d47b-47a6-a065-95dcb862416b"],
Cell[878686, 21316, 2501, 46, 200, "Output",ExpressionUUID->"43f09141-74e9-464f-bfbc-64ab7bece93c"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[881236, 21368, 252, 4, 40, "Subsubsection",ExpressionUUID->"86e45765-293f-46fa-b8af-0f843bbf8255"],
Cell[CellGroupData[{
Cell[881513, 21376, 2340, 55, 389, "Input",ExpressionUUID->"81e5ed9d-83d3-4345-9057-f9ca9cd13688"],
Cell[883856, 21433, 3051, 56, 290, "Output",ExpressionUUID->"5ac34c7d-5994-409d-bb1d-e2282ebd78f5"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[886956, 21495, 304, 5, 40, "Subsubsection",ExpressionUUID->"02f9fd38-b720-434d-8318-aadae177f61b"],
Cell[887263, 21502, 573, 10, 72, "Text",ExpressionUUID->"f11a622f-3f11-4fd8-b7e0-932c06a40753"],
Cell[887839, 21514, 724, 12, 100, "Text",ExpressionUUID->"1fa04959-0650-4871-81e5-ec27c99953a4"],
Cell[CellGroupData[{
Cell[888588, 21530, 2646, 60, 440, "Input",ExpressionUUID->"36706161-3a85-4a3e-9aae-b1908dc81cdc"],
Cell[891237, 21592, 3220, 59, 335, "Output",ExpressionUUID->"32388e25-6f8f-4848-a5be-794ffa5acad1"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[894518, 21658, 258, 4, 42, "Subsection",ExpressionUUID->"e732d8ac-6b78-46e2-a18c-5330cd16cee2"],
Cell[894779, 21664, 507, 10, 52, "Input",ExpressionUUID->"8546cfb5-ac3b-427f-a5b2-413497c1b619"],
Cell[CellGroupData[{
Cell[895311, 21678, 1136, 28, 234, "Input",ExpressionUUID->"c26491f4-41fe-4588-8b3e-bd5483c1b998"],
Cell[896450, 21708, 2252, 41, 155, "Output",ExpressionUUID->"39692c1a-9220-45bf-8acb-261d9230ae62"]
}, Open  ]],
Cell[898717, 21752, 291, 4, 43, "Text",ExpressionUUID->"7fe1c85f-bec5-4829-a137-d8e74b56580a"],
Cell[CellGroupData[{
Cell[899033, 21760, 288, 6, 70, "Input",ExpressionUUID->"c8e5b257-f1c6-4684-b007-e81d30490996"],
Cell[899324, 21768, 1489, 26, 70, "Output",ExpressionUUID->"0325321b-db9f-4a52-ad9a-8d02403f0adf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[900850, 21799, 206, 4, 52, "Input",ExpressionUUID->"90d4db87-0cfb-45e2-a22e-08c4de2b435f"],
Cell[901059, 21805, 1662, 34, 70, "Output",ExpressionUUID->"0a3fa0f0-4665-406a-a583-579c772bd471"]
}, Open  ]],
Cell[CellGroupData[{
Cell[902758, 21844, 177, 3, 52, "Input",ExpressionUUID->"9fd2b6c3-865d-4208-b483-17a8102fa0e8"],
Cell[902938, 21849, 1424, 25, 70, "Output",ExpressionUUID->"6b9b3057-08d7-4d0b-b4fd-db897930f76c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[904399, 21879, 382, 10, 52, "Input",ExpressionUUID->"9f01e593-1ca1-47af-add3-4613f20604c0"],
Cell[904784, 21891, 1409, 25, 70, "Output",ExpressionUUID->"a206f8a9-3354-4b66-9d24-44de22521bf5"]
}, Open  ]],
Cell[906208, 21919, 261, 6, 43, "Text",ExpressionUUID->"ae0eecf5-d869-485e-9361-584676f40272"],
Cell[CellGroupData[{
Cell[906494, 21929, 3449, 74, 518, "Input",ExpressionUUID->"3c82dfec-9cbe-47c1-ae9a-c8431ef20835"],
Cell[909946, 22005, 3073, 65, 325, "Output",ExpressionUUID->"1399de03-88d0-4e87-a1e2-aad4b95ff422"]
}, Open  ]],
Cell[913034, 22073, 274, 6, 43, "Text",ExpressionUUID->"f7e409e4-3679-44ff-b14f-d27937708855"],
Cell[CellGroupData[{
Cell[913333, 22083, 212, 4, 52, "Input",ExpressionUUID->"100e0aee-ca4a-403a-9132-2bfd743272ad"],
Cell[913548, 22089, 1270, 19, 70, "Output",ExpressionUUID->"2c35e891-4591-43d3-8b35-8ebde65a3462"]
}, Open  ]],
Cell[CellGroupData[{
Cell[914855, 22113, 1048, 21, 251, "Input",ExpressionUUID->"f2b3b043-018f-4d82-ba5e-4962997f1267"],
Cell[915906, 22136, 2363, 43, 294, "Output",ExpressionUUID->"1cff8a12-d996-4b4a-a24f-bc9cd9b0e825"]
}, Open  ]],
Cell[CellGroupData[{
Cell[918306, 22184, 1262, 23, 251, "Input",ExpressionUUID->"baa34b90-4447-4100-a05f-4386ebe18e1f"],
Cell[919571, 22209, 2443, 42, 294, "Output",ExpressionUUID->"721a915c-6493-42bd-9f71-52df67e90850"]
}, Open  ]],
Cell[CellGroupData[{
Cell[922051, 22256, 1322, 24, 251, "Input",ExpressionUUID->"1a69b8ae-9738-4052-81ae-162cdeba643f"],
Cell[923376, 22282, 2314, 40, 294, "Output",ExpressionUUID->"cb3523a2-b9bd-46af-8c2c-47fddb0df1a0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[925727, 22327, 1437, 28, 251, "Input",ExpressionUUID->"456c13b0-8c2c-4d73-8391-fe46cd0e4635"],
Cell[927167, 22357, 2295, 40, 294, "Output",ExpressionUUID->"f2577a04-a5d6-47af-8cba-1e7b95d45d42"]
}, Open  ]],
Cell[CellGroupData[{
Cell[929499, 22402, 1427, 28, 251, "Input",ExpressionUUID->"e096d739-e2e5-46ba-aa47-1dd6fae6a26b"],
Cell[930929, 22432, 2327, 41, 294, "Output",ExpressionUUID->"64483dc9-f7b0-477f-8f1b-5f94d5149604"]
}, Open  ]],
Cell[933271, 22476, 276, 6, 52, "Input",ExpressionUUID->"abd44feb-180a-4120-8291-eacfd0b4e5a2"],
Cell[CellGroupData[{
Cell[933572, 22486, 1413, 26, 295, "Input",ExpressionUUID->"3cd9a13f-81de-48f3-8bf5-569677b1c352"],
Cell[934988, 22514, 2756, 48, 339, "Output",ExpressionUUID->"4fdb2e35-609b-40f2-8554-9a6b5c9a8eb8"]
}, Open  ]],
Cell[937759, 22565, 247, 4, 43, "Text",ExpressionUUID->"a843f954-f40b-4793-afc3-1bdba07be951"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[938055, 22575, 290, 4, 103, "Chapter",ExpressionUUID->"1cf83c4e-35a0-4ed6-bd9f-d4d82cff5000"],
Cell[938348, 22581, 240, 6, 43, "Text",ExpressionUUID->"7b1a639d-6065-4bd1-b8ba-2e35260044b2"],
Cell[938591, 22589, 615, 12, 72, "Text",ExpressionUUID->"c7afdeca-2126-423e-a96c-cf65625aa091"],
Cell[939209, 22603, 3819, 110, 360, "Input",ExpressionUUID->"82afbe68-cfd3-4a0a-970f-2121f98c6b7d"],
Cell[943031, 22715, 1198, 32, 182, "Input",ExpressionUUID->"baaf8c78-1560-4ba5-8fb3-c7dda29c644a"],
Cell[CellGroupData[{
Cell[944254, 22751, 207, 4, 52, "Input",ExpressionUUID->"8cccf803-e167-464f-b224-8c59cf1d9a2b"],
Cell[944464, 22757, 43898, 1138, 889, "Output",ExpressionUUID->"8ca3bbf5-2d66-42c7-8135-77e75d446335"]
}, Open  ]],
Cell[CellGroupData[{
Cell[988399, 23900, 1078, 24, 156, "Input",ExpressionUUID->"143ee985-1f63-4f1c-940b-ab0888ca39cd"],
Cell[989480, 23926, 129084, 3128, 1682, "Output",ExpressionUUID->"1c868cf1-bc19-4028-abf7-0afdcf278e2f"]
}, Open  ]],
Cell[1118579, 27057, 358, 8, 79, "Input",ExpressionUUID->"e7e77504-70bf-4b1d-9fbd-685aa440462a"],
Cell[CellGroupData[{
Cell[1118962, 27069, 1438, 35, 156, "Input",ExpressionUUID->"a67a97fb-6326-49f5-977e-7cc57bfa74e0"],
Cell[1120403, 27106, 2354, 48, 186, "Output",ExpressionUUID->"5edf7bde-fb8b-48f8-bf77-701cd5e0606c"]
}, Open  ]],
Cell[1122772, 27157, 2423, 59, 286, "Input",ExpressionUUID->"763d4777-830e-4997-ac56-ab4dde17d4a1"],
Cell[CellGroupData[{
Cell[1125220, 27220, 1851, 47, 234, "Input",ExpressionUUID->"b710322f-65df-42c5-bbdf-5917777e52e6"],
Cell[1127074, 27269, 2665, 51, 431, "Output",ExpressionUUID->"cfde2fbf-94b8-470a-af46-dd683f4641f1"]
}, Open  ]],
Cell[1129754, 27323, 167, 3, 43, "Text",ExpressionUUID->"c24aee65-aa09-4dfb-a78e-a25e89eab448"],
Cell[CellGroupData[{
Cell[1129946, 27330, 305, 6, 52, "Input",ExpressionUUID->"8f3a2375-99a9-4809-b005-8de4b66526d1"],
Cell[1130254, 27338, 504, 9, 87, "Output",ExpressionUUID->"d36d1ebb-9c83-41c3-ba25-3166e8a7bf0c"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[1130819, 27354, 180, 3, 120, "Title",ExpressionUUID->"ddacce19-fbd6-4069-97b5-9322a4d7cb10"],
Cell[1131002, 27359, 593, 13, 43, "Text",ExpressionUUID->"bf26fa1c-55a1-4749-a5f8-4a4d236f6fbd"],
Cell[1131598, 27374, 771, 13, 72, "Text",ExpressionUUID->"3c195400-a6e2-41f9-9af8-62bb8ad853b8"],
Cell[CellGroupData[{
Cell[1132394, 27391, 163, 3, 86, "Section",ExpressionUUID->"33d5a204-314b-4864-b459-da23156e9b34"],
Cell[1132560, 27396, 285, 4, 43, "Text",ExpressionUUID->"941aea95-1173-4764-9e13-40097f32d1f2"],
Cell[1132848, 27402, 591, 12, 72, "Text",ExpressionUUID->"c3a6d848-13d4-4706-bb25-eddb9456f818"],
Cell[1133442, 27416, 2381, 68, 380, "Input",ExpressionUUID->"dc6189f6-8e02-4ba3-8945-1bb4c56a8207"],
Cell[1135826, 27486, 159, 3, 43, "Text",ExpressionUUID->"8fc9ef42-ab8b-4a6f-a7e2-34ec2d28bd8b"],
Cell[CellGroupData[{
Cell[1136010, 27493, 1535, 43, 311, "Input",ExpressionUUID->"96deaf1f-2131-4d32-beee-ea4641fe5439"],
Cell[1137548, 27538, 396, 6, 70, "Output",ExpressionUUID->"40ddd2c2-b99f-4f0c-95db-3f3a2cd9283b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1137981, 27549, 1247, 33, 182, "Input",ExpressionUUID->"90afcd9a-6840-4bc1-a9ce-48da59c74132"],
Cell[1139231, 27584, 26096, 690, 649, "Output",ExpressionUUID->"b7357967-ead3-4b27-834a-8c3fed39a2d5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1165364, 28279, 250, 5, 52, "Input",ExpressionUUID->"dd555f39-c8ce-4d8d-b714-560b0ba872e4"],
Cell[1165617, 28286, 6519, 186, 417, "Output",ExpressionUUID->"5e6d3a5c-4edc-429a-8992-cadd8e6bcb88"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1172173, 28477, 506, 11, 105, "Input",ExpressionUUID->"3cfcd030-2e14-42ee-a9e3-6c48448dcc5c"],
Cell[1172682, 28490, 3660, 96, 162, "Output",ExpressionUUID->"041ac9a9-109a-4099-b355-d25326a5afe6"]
}, Open  ]],
Cell[1176357, 28589, 396, 8, 43, "Text",ExpressionUUID->"2a3e85b4-0b9f-44e8-9b5b-258eaf2c6356"],
Cell[CellGroupData[{
Cell[1176778, 28601, 212, 4, 52, "Input",ExpressionUUID->"09b751e4-5db4-4109-84ae-a4d809163d5d"],
Cell[1176993, 28607, 11132, 279, 273, "Output",ExpressionUUID->"8bd3702f-4196-44dc-b45f-8278b5a50972"]
}, Open  ]],
Cell[1188140, 28889, 997, 23, 105, "Input",ExpressionUUID->"bc07953d-bf07-4cbb-8eb0-ebd03d0e503f"],
Cell[CellGroupData[{
Cell[1189162, 28916, 473, 11, 52, "Input",ExpressionUUID->"e4528f40-5bf2-446f-80d4-f2ae610ee34e"],
Cell[1189638, 28929, 81208, 1975, 1162, "Output",ExpressionUUID->"dfe78b0b-8082-4216-b5f6-e375a9841758"]
}, Open  ]],
Cell[1270861, 30907, 494, 12, 79, "Input",ExpressionUUID->"c227a189-9e9e-43e0-88e2-1f6f0e50af7d"],
Cell[CellGroupData[{
Cell[1271380, 30923, 707, 14, 79, "Input",ExpressionUUID->"8bbe5212-e7cd-4dde-93cc-b2f8537c2527"],
Cell[1272090, 30939, 1299, 19, 70, "Output",ExpressionUUID->"8f6a4ed9-0ab5-4eca-9fcd-ae6f7b81d218"]
}, Open  ]],
Cell[1273404, 30961, 460, 11, 43, "Text",ExpressionUUID->"b672a40d-ba4c-432b-8dcb-a02026005d18"],
Cell[CellGroupData[{
Cell[1273889, 30976, 989, 23, 130, "Input",ExpressionUUID->"a03bb016-2adf-47af-9cf5-009519e182e6"],
Cell[1274881, 31001, 2923, 56, 212, "Output",ExpressionUUID->"0301f499-9d18-4a63-ad5e-b3f3aaa9b819"]
}, Open  ]],
Cell[1277819, 31060, 211, 5, 43, "Text",ExpressionUUID->"ed61996f-f8ce-46da-9d8a-22c916260f2c"],
Cell[CellGroupData[{
Cell[1278055, 31069, 3038, 72, 337, "Input",ExpressionUUID->"6cb28901-02d2-40cf-a9af-e67a2548df2f"],
Cell[1281096, 31143, 6015, 123, 543, "Output",ExpressionUUID->"103e9deb-8d3b-4d70-b890-436d69a98977"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[1287160, 31272, 177, 3, 86, "Section",ExpressionUUID->"0115f12c-e900-4c3a-9766-ac1e10bb7017"],
Cell[1287340, 31277, 158, 3, 43, "Text",ExpressionUUID->"7f804028-0e97-4e42-9566-0f50b1be8ee5"],
Cell[CellGroupData[{
Cell[1287523, 31284, 794, 19, 105, "Input",ExpressionUUID->"fa28991c-af7e-4b13-9ade-4f580e0a78c7"],
Cell[1288320, 31305, 1207, 23, 253, "Output",ExpressionUUID->"7f04a3e4-9d31-4554-b364-c4c27d832962"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1289564, 31333, 172, 3, 42, "Subsection",ExpressionUUID->"d28fa07d-9cb8-4542-b945-2b9264208629"],
Cell[1289739, 31338, 3219, 76, 311, "Input",ExpressionUUID->"9358cfee-bc28-4191-a296-e8cad9102b39"],
Cell[CellGroupData[{
Cell[1292983, 31418, 404, 9, 52, "Input",ExpressionUUID->"ee72d0ba-a569-42d1-a9b4-0648b35a9d54"],
Cell[1293390, 31429, 1670, 37, 96, "Output",ExpressionUUID->"7725bbfa-01e7-4b6c-ac06-cfbe6b86746b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1295097, 31471, 1488, 34, 130, "Input",ExpressionUUID->"cd6226df-5be2-40d7-bf3b-da44978ba5d6"],
Cell[1296588, 31507, 1677, 37, 96, "Output",ExpressionUUID->"582f74c0-bada-451b-9e62-6a9fe3308943"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1298302, 31549, 405, 9, 52, "Input",ExpressionUUID->"42122803-f284-4e20-b998-8171ea6406a6"],
Cell[1298710, 31560, 499, 9, 70, "Output",ExpressionUUID->"6d2196aa-3d7d-4c7f-b201-652ddcc56358"]
}, Open  ]],
Cell[1299224, 31572, 222, 5, 43, "Text",ExpressionUUID->"26a2b549-2046-4e03-bdd5-54af2c0bcd89"],
Cell[CellGroupData[{
Cell[1299471, 31581, 830, 20, 79, "Input",ExpressionUUID->"10f79d79-c0b8-4bb2-844e-70fe3f05bd91"],
Cell[1300304, 31603, 472, 8, 70, "Output",ExpressionUUID->"3d755b1d-74ce-4275-8979-b5840c1cdb2b"]
}, Open  ]],
Cell[1300791, 31614, 364, 7, 43, "Text",ExpressionUUID->"42540005-4625-4691-9fb6-2a7e61fc009a"],
Cell[CellGroupData[{
Cell[1301180, 31625, 3054, 73, 389, "Input",ExpressionUUID->"18392566-355d-4ff2-ad29-e6b6040c519e"],
Cell[1304237, 31700, 1512, 25, 70, "Output",ExpressionUUID->"c525208d-7e7a-448e-a185-e1355ce64808"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[1305798, 31731, 174, 3, 42, "Subsection",ExpressionUUID->"36777c42-1123-4b09-ba78-4bc013558988"],
Cell[CellGroupData[{
Cell[1305997, 31738, 2129, 57, 358, "Input",ExpressionUUID->"ccdad6e6-6216-4088-b7f1-d2ee3914ee5a"],
Cell[1308129, 31797, 491, 9, 70, "Output",ExpressionUUID->"80c7b775-4e70-4ceb-a7d4-16c3aa1c1161"]
}, Open  ]],
Cell[1308635, 31809, 167, 3, 43, "Text",ExpressionUUID->"14d8642a-f3ee-4b0d-9523-a3af33f0ba2f"],
Cell[CellGroupData[{
Cell[1308827, 31816, 1279, 33, 156, "Input",ExpressionUUID->"0c615124-212a-4f4a-8c73-4b830afe4564"],
Cell[1310109, 31851, 2725, 54, 186, "Output",ExpressionUUID->"0d0120da-939e-47f5-8adf-d78a52ed2bc7"]
}, Open  ]],
Cell[1312849, 31908, 437, 11, 43, "Text",ExpressionUUID->"7bcc4159-fff9-43e2-a3da-17e6c0acfa6d"],
Cell[1313289, 31921, 2567, 62, 285, "Input",ExpressionUUID->"fed6421b-0e9f-49fd-af2d-d9216b30c6c8"],
Cell[1315859, 31985, 164, 3, 43, "Text",ExpressionUUID->"1dddc054-2e5c-445e-801c-53cef788aae4"],
Cell[CellGroupData[{
Cell[1316048, 31992, 2224, 57, 234, "Input",ExpressionUUID->"f325b6c6-1e88-4da8-91b8-00349cc21025"],
Cell[1318275, 32051, 1037, 20, 70, "Output",ExpressionUUID->"9e212e69-c4f7-4040-b114-7b6ed4e55f5b"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

