(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    328016,       7376]
NotebookOptionsPosition[    311827,       6950]
NotebookOutlinePosition[    312218,       6967]
CellTagsIndexPosition[    312175,       6964]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Quaternions and Rotation Matrices", "Title",
 CellChangeTimes->{{3.633008294791596*^9, 3.6330083317167883`*^9}, {
  3.633014669536908*^9, 3.633014676295738*^9}}],

Cell[CellGroupData[{

Cell["References", "Chapter",
 CellChangeTimes->{{3.6330146523297577`*^9, 3.633014653512723*^9}}],

Cell["\<\
Quaternions and Rotation Sequences, Jack B. Kuipers, Princeton U. Press, 1999.\
\>", "Text",
 CellChangeTimes->{{3.633014659666325*^9, 3.633014663352579*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Preliminaries", "Chapter",
 CellChangeTimes->{{3.633011096519361*^9, 3.633011099526075*^9}}],

Cell[BoxData[
 RowBox[{"<<", "Quaternions`"}]], "Input",
 CellChangeTimes->{{3.632999203995829*^9, 3.632999232951932*^9}}],

Cell[BoxData[
 RowBox[{"UnitQuaternions", ";"}]], "Input",
 CellChangeTimes->{{3.633003337634285*^9, 3.633003340799415*^9}, 
   3.633009473320429*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"e", "[", "n_", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"o", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", "3"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"o", "\[LeftDoubleBracket]", "n", "\[RightDoubleBracket]"}], 
      "=", "1"}], ";", "o"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6330080059477863`*^9, 3.6330080120882473`*^9}, {
  3.633008063843329*^9, 3.633008196002467*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"e", "/@", 
   RowBox[{"Range", "[", "3", "]"}]}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.6330081771317596`*^9, 3.6330082030592337`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0"},
     {"0", "1", "0"},
     {"0", "0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.633008181889728*^9, 3.6330082041978817`*^9}, 
   3.633009495743886*^9, 3.633017858271346*^9, 3.633018200669319*^9, 
   3.667737873901497*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"RotationMatrix", "[", 
   RowBox[{"\[Psi]", ",", 
    RowBox[{"e", "[", "3", "]"}]}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.6330082072556953`*^9, 3.6330082300193357`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"Cos", "[", "\[Psi]", "]"}], 
      RowBox[{"-", 
       RowBox[{"Sin", "[", "\[Psi]", "]"}]}], "0"},
     {
      RowBox[{"Sin", "[", "\[Psi]", "]"}], 
      RowBox[{"Cos", "[", "\[Psi]", "]"}], "0"},
     {"0", "0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.63300822422884*^9, 3.6330082311491623`*^9}, 
   3.6330094957666063`*^9, 3.633017858314336*^9, 3.6330182006969347`*^9, 
   3.667737873936883*^9}]
}, Open  ]],

Cell["\<\
Note this rotates the OBJECT and not the FRAME in a right-handed coordinate \
system.\
\>", "Text",
 CellChangeTimes->{{3.633008413132037*^9, 3.633008427697296*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TransformationFunction", "[", 
  RowBox[{"RotationTransform", "[", 
   RowBox[{"\[Psi]", ",", 
    RowBox[{"e", "[", "3", "]"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.633008437381858*^9, 3.6330084707208223`*^9}}],

Cell[BoxData[
 RowBox[{"TransformationFunction", "[", 
  RowBox[{"TransformationFunction", "[", 
   RowBox[{"(", 
    TagBox[GridBox[{
       {
        RowBox[{"Cos", "[", "\[Psi]", "]"}], 
        RowBox[{"-", 
         RowBox[{"Sin", "[", "\[Psi]", "]"}]}], "0", "0"},
       {
        RowBox[{"Sin", "[", "\[Psi]", "]"}], 
        RowBox[{"Cos", "[", "\[Psi]", "]"}], "0", "0"},
       {"0", "0", "1", "0"},
       {"0", "0", "0", "1"}
      },
      AutoDelete->False,
      GridBoxDividers->{
       "Columns" -> {{False}}, "ColumnsIndexed" -> {-2 -> True}, 
        "Rows" -> {{False}}, "RowsIndexed" -> {-2 -> True}},
      GridBoxItemSize->{
       "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
     #& ], ")"}], "]"}], "]"}]], "Output",
 CellChangeTimes->{3.633008471072381*^9, 3.63300949579932*^9, 
  3.63301785835148*^9, 3.6330182007448063`*^9, 3.667737873979319*^9}]
}, Open  ]],

Cell["frameRotationMatrix", "Item",
 CellChangeTimes->{{3.6330087105835257`*^9, 3.63300871565541*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"frameRotationMatrix", "[", 
   RowBox[{"angle_", ",", "vector_"}], "]"}], ":=", 
  RowBox[{"RotationMatrix", "[", 
   RowBox[{
    RowBox[{"-", "angle"}], ",", "vector"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6330085706786213`*^9, 3.633008601699999*^9}}],

Cell["\<\
Yaw = \[Psi]  (looks like a \
\[OpenCurlyDoubleQuote]y\[CloseCurlyDoubleQuote]); positive to the right; \
points in the Earth-Fixed Frame (EFF = E) as measured in the Body-Fixed Frame \
(BFF = B) will have as B yaws will have new coordinates given by the \
following left-multiplying the prior B-coordinates.\
\>", "Text",
 CellChangeTimes->{{3.633008779838353*^9, 3.633008816363709*^9}, {
  3.6330088981609364`*^9, 3.633009024220634*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"frameRotationMatrix", "[", 
   RowBox[{"\[Psi]", ",", 
    RowBox[{"e", "[", "3", "]"}]}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.633008718455638*^9, 3.6330087546501637`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"Cos", "[", "\[Psi]", "]"}], 
      RowBox[{"Sin", "[", "\[Psi]", "]"}], "0"},
     {
      RowBox[{"-", 
       RowBox[{"Sin", "[", "\[Psi]", "]"}]}], 
      RowBox[{"Cos", "[", "\[Psi]", "]"}], "0"},
     {"0", "0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.6330087471475677`*^9, 3.633008755879552*^9}, 
   3.633009503036154*^9, 3.633017858403204*^9, 3.6330182007840023`*^9, 
   3.667737874021885*^9}]
}, Open  ]],

Cell["\<\
Roll = \[Phi] (the line through the \[Phi] looks like a roll axis); positive \
with the right-hand wing tipping earth-ward.\
\>", "Text",
 CellChangeTimes->{{3.633008878129724*^9, 3.6330088871691513`*^9}, {
  3.6330090298441467`*^9, 3.633009058587401*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"frameRotationMatrix", "[", 
   RowBox[{"\[Phi]", ",", 
    RowBox[{"e", "[", "1", "]"}]}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.633008758671041*^9, 3.633008762023169*^9}, {
  3.633008857499633*^9, 3.6330088684310627`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0"},
     {"0", 
      RowBox[{"Cos", "[", "\[Phi]", "]"}], 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]},
     {"0", 
      RowBox[{"-", 
       RowBox[{"Sin", "[", "\[Phi]", "]"}]}], 
      RowBox[{"Cos", "[", "\[Phi]", "]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.633008863552931*^9, 3.633008869825326*^9}, 
   3.633009503083063*^9, 3.63301785844681*^9, 3.6330182008238173`*^9, 
   3.667737874043413*^9}]
}, Open  ]],

Cell["\<\
Pitch = \[Theta] (the like through the \[Theta] looks like a pitch axis): \
positive is nose-up\
\>", "Text",
 CellChangeTimes->{{3.633009075426651*^9, 3.6330091088655643`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"frameRotationMatrix", "[", 
   RowBox[{"\[Theta]", ",", 
    RowBox[{"e", "[", "2", "]"}]}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.633009061710559*^9, 3.633009069931842*^9}, {
  3.6330091149464827`*^9, 3.6330091165307093`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"Cos", "[", "\[Theta]", "]"}], "0", 
      RowBox[{"-", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}]},
     {"0", "1", "0"},
     {
      RowBox[{"Sin", "[", "\[Theta]", "]"}], "0", 
      RowBox[{"Cos", "[", "\[Theta]", "]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.63300911147092*^9, 3.633009117359305*^9}, 
   3.633009503115116*^9, 3.633017858481126*^9, 3.633018200857259*^9, 
   3.6677378740806704`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Visual Checks", "Subchapter",
 CellChangeTimes->{{3.6330092869165087`*^9, 3.633009289082971*^9}}],

Cell[CellGroupData[{

Cell["Labeled Cubes", "Section"],

Cell[TextData[{
 StyleBox["ran3[]",
  FontWeight->"Bold"],
 " (random 3-vector)\n",
 StyleBox["s2",
  FontWeight->"Bold"],
 " (box, axes, lighting, no grids)\n",
 StyleBox["s3",
  FontWeight->"Bold"],
 " (axes, grids, lighting), \n",
 StyleBox["s3p",
  FontWeight->"Bold"],
 " (axes, grids, no lighting)\n",
 StyleBox["ocube ",
  FontWeight->"Bold"],
 "(with floating labels, center at 0,0,0)"
}], "Text",
 CellChangeTimes->{3.633014632425158*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ran3", "[", "]"}], ":=", 
  RowBox[{"RandomReal", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}], ",", "3"}], "]"}]}]], "Input",
 CellChangeTimes->{3.633014632425413*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"c", "[", "constant_", "]"}], ":=", 
  RowBox[{"ConstantArray", "[", 
   RowBox[{"constant", ",", "3"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.429299108855163*^9, 3.42929913940064*^9}, 
   3.633009404419632*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"o", "=", 
   RowBox[{"c", "[", "0", "]"}]}], ";", 
  RowBox[{"a", "=", 
   RowBox[{"c", "[", "1", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.633010099076687*^9, 3.6330101056554832`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"axes", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.429300282165619*^9, 3.429300302746006*^9}, 
   3.633009514315838*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"s2", "=", 
   RowBox[{
    RowBox[{"Show", "[", 
     RowBox[{"Graphics3D", "[", 
      RowBox[{"#1", ",", "\[IndentingNewLine]", 
       RowBox[{"Boxed", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Axes", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
       RowBox[{"AxesLabel", "\[Rule]", "axes"}], ",", "\[IndentingNewLine]", 
       RowBox[{"ImageSize", "\[Rule]", "Automatic"}]}], "]"}], "]"}], "&"}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.387819333397182*^9, 3.387819385272182*^9}, 
   3.3878201662565565`*^9, {3.429280121523982*^9, 3.429280140061576*^9}, {
   3.429280701635849*^9, 3.4292807270848017`*^9}, {3.429300351466634*^9, 
   3.429300352801794*^9}, 3.633009527155814*^9, 3.633014632425583*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"s3", "=", 
   RowBox[{
    RowBox[{"Show", "[", 
     RowBox[{"Graphics3D", "[", 
      RowBox[{"#1", ",", "\[IndentingNewLine]", 
       RowBox[{"FaceGrids", "\[Rule]", "All"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Axes", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
       RowBox[{"AxesLabel", "\[Rule]", "axes"}]}], "]"}], "]"}], "&"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.387731518570932*^9, 3.387731599956348*^9}, 
   3.387820134428432*^9, 3.3878201662565565`*^9, {3.429280656079949*^9, 
   3.429280693055263*^9}, 3.4293003639624662`*^9, 3.633009532624571*^9, 
   3.6330146324257107`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"s3p", "=", 
   RowBox[{
    RowBox[{"Show", "[", 
     RowBox[{
      RowBox[{"Graphics3D", "[", 
       RowBox[{"#1", ",", "\[IndentingNewLine]", 
        RowBox[{"FaceGrids", "\[Rule]", "All"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Axes", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
        RowBox[{"AxesLabel", "\[Rule]", "axes"}], ",", "\[IndentingNewLine]", 
        
        RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ImageSize", "\[Rule]", "Automatic"}]}], "]"}], "&"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.387365466157651*^9, 3.387365467709883*^9}, {
   3.387365564038397*^9, 3.38736556732312*^9}, {3.387731518570932*^9, 
   3.387731599956348*^9}, 3.387820134428432*^9, 3.3878201662565565`*^9, {
   3.429280157525174*^9, 3.4292801701282663`*^9}, 3.429300371299842*^9, 
   3.6330095378040237`*^9, 3.633014632425836*^9}],

Cell["\<\
Text gadgets to go pairwise in a unit box. Rotate and Translate as needed:\
\>", "Text",
 CellChangeTimes->{{3.387731518570932*^9, 3.387731599956348*^9}, 
   3.387820134428432*^9, 3.3878201662565565`*^9, {3.4292817013305893`*^9, 
   3.429281774354583*^9}, 3.6330146324259167`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"xpols", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"FaceForm", "[", 
      RowBox[{"Red", ",", "Cyan"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Polygon", "[", 
      RowBox[{"Reverse", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"2.5", ",", "6", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"3", ",", "6", ",", "0"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"3", ",", 
            RowBox[{"4", "+", 
             RowBox[{"1", "/", "3"}]}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"2", ",", "1", ",", "0"}], "}"}]}], "}"}], "/", "12."}], 
       "]"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Polygon", "[", 
      RowBox[{"Reverse", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"4", ",", "1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"3", ",", 
            RowBox[{"4", "+", 
             RowBox[{"1", "/", "3"}]}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"3", ",", "6", ",", "0"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"3.5", ",", "6", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"5", ",", "1", ",", "0"}], "}"}]}], "}"}], "/", "12."}], 
       "]"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Polygon", "[", 
      RowBox[{"Reverse", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"3", ",", "6", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"2.5", ",", "6", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "11", ",", "0"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"2", ",", "11", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"3", ",", 
            RowBox[{"7", "+", 
             RowBox[{"2", "/", "3"}]}], ",", "0"}], "}"}]}], "}"}], "/", 
        "12."}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Polygon", "[", 
      RowBox[{"Reverse", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"3", ",", "6", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"3", ",", 
            RowBox[{"7", "+", 
             RowBox[{"2", "/", "3"}]}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"4", ",", "11", ",", "0"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"5", ",", "11", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"3.5", ",", "6", ",", "0"}], "}"}]}], "}"}], "/", "12."}], 
       "]"}], "]"}]}], " ", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.387731518570932*^9, 3.387731599956348*^9}, 
   3.387820134428432*^9, 3.3878201662565565`*^9, {3.4292779556600122`*^9, 
   3.429277964200198*^9}, {3.4292807595147*^9, 3.4292808130644293`*^9}, {
   3.429281430911586*^9, 3.4292814324499807`*^9}, {3.4292817859169893`*^9, 
   3.429281799209421*^9}, 3.4292999660779953`*^9, 3.429300017316691*^9, 
   3.633014632426113*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ypols", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"FaceForm", "[", 
      RowBox[{"Green", ",", "Magenta"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Polygon", "[", 
      RowBox[{"Reverse", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"2.5", ",", "1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"2.5", ",", "6", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"3.5", ",", "6", ",", "0"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"3.5", ",", "1", ",", "0"}], "}"}]}], "}"}], "/", "12."}], 
       "]"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Polygon", "[", 
      RowBox[{"Reverse", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"3", ",", "6", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"2.5", ",", "6", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "11", ",", "0"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"2", ",", "11", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"3", ",", 
            RowBox[{"7", "+", 
             RowBox[{"2", "/", "3"}]}], ",", "0"}], "}"}]}], "}"}], "/", 
        "12."}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Polygon", "[", 
      RowBox[{"Reverse", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"3", ",", "6", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"3", ",", 
            RowBox[{"7", "+", 
             RowBox[{"2", "/", "3"}]}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"4", ",", "11", ",", "0"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"5", ",", "11", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"3.5", ",", "6", ",", "0"}], "}"}]}], "}"}], "/", "12."}], 
       "]"}], "]"}]}], " ", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.387731518570932*^9, 3.387731599956348*^9}, 
   3.387820134428432*^9, 3.3878201662565565`*^9, {3.429280825971822*^9, 
   3.429280852453969*^9}, {3.429281425608132*^9, 3.4292814269009027`*^9}, {
   3.429281802039763*^9, 3.4292818084599648`*^9}, 3.4292999804159613`*^9, 
   3.4293000357978067`*^9, 3.633014632426276*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"zpols", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"FaceForm", "[", 
      RowBox[{"Blue", ",", "Yellow"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Polygon", "[", 
      RowBox[{"Reverse", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1.3", ",", "2", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"5", ",", "2", ",", "0"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"5", ",", "1", ",", "0"}], "}"}]}], "}"}], "/", "12."}], 
       "]"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Polygon", "[", 
      RowBox[{"Reverse", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1.3", ",", "2", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"3.7", ",", "10", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"4.7", ",", "10", ",", "0"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"2.3", ",", "2", ",", "0"}], "}"}]}], "}"}], "/", "12."}], 
       "]"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Polygon", "[", 
      RowBox[{"Reverse", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "11", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"5", ",", "11", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"4.7", ",", "10", ",", "0"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"1", ",", "10", ",", "0"}], "}"}]}], "}"}], "/", "12."}], 
       "]"}], "]"}]}], " ", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.387731518570932*^9, 3.387731599956348*^9}, 
   3.387820134428432*^9, 3.3878201662565565`*^9, {3.4292808585275517`*^9, 
   3.429280872397241*^9}, {3.429281436584285*^9, 3.4292814378335867`*^9}, {
   3.429281815601506*^9, 3.429281846875702*^9}, 3.429299993868217*^9, 
   3.429300048294999*^9, 3.6330146324264307`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"xtext", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"2", "+", 
         RowBox[{"1", "/", "2"}]}], ",", "6", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "11", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "11", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", 
        RowBox[{"7", "+", 
         RowBox[{"2", "/", "3"}]}], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "11", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"5", ",", "11", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"3", "+", 
         RowBox[{"1", "/", "2"}]}], ",", "6", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"5", ",", "1", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "1", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", 
        RowBox[{"4", "+", 
         RowBox[{"1", "/", "3"}]}], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "1", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "0"}], "}"}]}], "}"}], "/", "12."}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.387731518570932*^9, 3.387731599956348*^9}, 
   3.387820134428432*^9, 3.3878201662565565`*^9, 3.429277938887204*^9, 
   3.429277991986598*^9, 3.633014632426565*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ytext", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"2.5", ",", "1", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2.5", ",", "6", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "11", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "11", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", 
        RowBox[{"7", "+", 
         RowBox[{"2", "/", "3"}]}], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "11", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"5", ",", "11", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3.5", ",", "6", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3.5", ",", "1", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2.5", ",", "1", ",", "0"}], "}"}]}], "}"}], "/", "12."}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.387731518570932*^9, 3.387731599956348*^9}, 
   3.387820134428432*^9, 3.3878201662565565`*^9, 3.63301463242668*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ztext", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3.7", ",", "10", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "10", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "11", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"5", ",", "11", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2.3", ",", "2", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"5", ",", "2", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"5", ",", "1", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "0"}], "}"}]}], "}"}], "/", "12."}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.387731518570932*^9, 3.387731599956348*^9}, 
   3.387820134428432*^9, 3.3878201662565565`*^9, 3.633014632426783*^9}],

Cell[CellGroupData[{

Cell["Shapes", "Subsection",
 CellChangeTimes->{{3.429279783813246*^9, 3.429279794240905*^9}, 
   3.429279909585877*^9, {3.429280086299171*^9, 3.4292800871848993`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"combo", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Line", "[", "#1", "]"}], ",", " ", 
      RowBox[{"Translate", "[", 
       RowBox[{
        RowBox[{"Line", "[", "#2", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.5", ",", "0", ",", "0"}], "}"}]}], "]"}]}], "}"}], 
    "&"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.429280193423544*^9, 3.429280251408724*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"xyshape", "=", 
   RowBox[{"combo", "[", 
    RowBox[{"xtext", ",", "ytext"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.42928025471484*^9, 3.429280263573606*^9}, 
   3.4292803968486967`*^9, 3.429280448860684*^9, {3.42928117428542*^9, 
   3.429281185766062*^9}, 3.429281899887779*^9, 3.429281930307836*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"combp", "=", 
   RowBox[{
    RowBox[{"Join", "[", 
     RowBox[{"#1", ",", 
      RowBox[{"{", 
       RowBox[{"Translate", "[", 
        RowBox[{"#2", ",", 
         RowBox[{"{", 
          RowBox[{"0.5", ",", "0", ",", "0"}], "}"}]}], "]"}], "}"}]}], "]"}],
     "&"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4292802669457006`*^9, 3.429280298198759*^9}, {
  3.429280482432467*^9, 3.429280491203207*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"xyp", "=", 
   RowBox[{"combp", "[", 
    RowBox[{"xpols", ",", "ypols"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.429280301523006*^9, 3.429280311486434*^9}, {
  3.4292808901794147`*^9, 3.4292808914014797`*^9}, {3.4292811943039303`*^9, 
  3.429281210081667*^9}, {3.429281242951836*^9, 3.4292812504531937`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"yzshape", "=", 
   RowBox[{"combo", "[", 
    RowBox[{"ytext", ",", "ztext"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.387731518570932*^9, 3.387731599956348*^9}, 
   3.387820134428432*^9, 3.3878201662565565`*^9, 3.633011379894945*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"yzp", "=", 
   RowBox[{"combp", "[", 
    RowBox[{"ypols", ",", "zpols"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.387731518570932*^9, 3.387731599956348*^9}, 
   3.387820134428432*^9, 3.3878201662565565`*^9, 3.633011379895048*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"zxshape", "=", 
   RowBox[{"combo", "[", 
    RowBox[{"ztext", ",", "xtext"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.387731518570932*^9, 3.387731599956348*^9}, 
   3.387820134428432*^9, 3.3878201662565565`*^9, 3.633011379895129*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"zxp", "=", 
   RowBox[{"combp", "[", 
    RowBox[{"zpols", ",", "xpols"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.387731518570932*^9, 3.387731599956348*^9}, 
   3.387820134428432*^9, 3.3878201662565565`*^9, 3.63301137989529*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cubes", "Subsection",
 CellChangeTimes->{{3.633011358093989*^9, 3.633011358877638*^9}}],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["mcube",
  FontWeight->"Bold"],
 " (just the 2-form shapes)\n",
 StyleBox["ucube",
  FontWeight->"Bold"],
 " (my personal Cuboid that works under \"RotateShape\")\n",
 StyleBox["ncube",
  FontWeight->"Bold"],
 " (labels float above surfaces)\n",
 StyleBox["lcube",
  FontWeight->"Bold"],
 " (non-colored labels on surfaces [use lighting])\n",
 StyleBox["ocube",
  FontWeight->"Bold"],
 " (origin-centered, labels floating)"
}], "Item",
 CellChangeTimes->{{3.633009586281042*^9, 3.633009586824831*^9}, 
   3.633014632426846*^9}],

Cell["Rotate3 (TODO: Check!)", "Item",
 CellChangeTimes->{{3.429282739652931*^9, 3.429282746374514*^9}, {
  3.633010955635066*^9, 3.63301096264235*^9}, {3.633011447470111*^9, 
  3.63301144855789*^9}}]
}, Open  ]],

Cell["\<\
Old Euler angles in terms of new yaw, pitch, roll: (TODO: Check This!!!)\
\>", "Text",
 CellChangeTimes->{{3.4292968310316353`*^9, 3.4292968508439283`*^9}, {
  3.6330101178874493`*^9, 3.6330101234779453`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Rotate3", "[", 
   RowBox[{"shape_", ",", "\[Psi]_", ",", "\[Theta]_", ",", "\[Phi]_"}], 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"pi", "=", 
      RowBox[{"N", "@", "Pi"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Rotate", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Rotate", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Rotate", "[", 
         RowBox[{"shape", ",", "\[IndentingNewLine]", 
          RowBox[{"pi", "-", "\[Psi]"}], ",", 
          RowBox[{"e", "[", "3", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
        "\[Theta]", ",", 
        RowBox[{"e", "[", "1", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"pi", "-", "\[Phi]"}], ",", 
      RowBox[{"e", "[", "3", "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.633009685139732*^9, 3.633009704326068*^9}, {
  3.633009744749833*^9, 3.6330097697791147`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mcube", "=", "\[IndentingNewLine]", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"pi", "=", 
       RowBox[{"N", "@", "Pi"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"zx", "=", 
          RowBox[{"{", 
           RowBox[{"Translate", "[", 
            RowBox[{
             RowBox[{"Rotate3", "[", 
              RowBox[{"zxp", ",", "pi", ",", 
               RowBox[{"pi", "/", "2"}], ",", "0"}], "]"}], ",", 
             RowBox[{"e", "[", "1", "]"}]}], "]"}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"yz", "=", 
          RowBox[{"{", 
           RowBox[{"Rotate3", "[", 
            RowBox[{"yzp", ",", "0", ",", 
             RowBox[{
              RowBox[{"-", "pi"}], "/", "2"}], ",", 
             RowBox[{
              RowBox[{"-", "pi"}], "/", "2"}]}], "]"}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"xy", "=", "xyp"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Chop", "[", 
        RowBox[{"Join", "[", "\[IndentingNewLine]", 
         RowBox[{"xy", ",", 
          RowBox[{"{", 
           RowBox[{"Translate", "[", 
            RowBox[{"xy", ",", 
             RowBox[{"e", "[", "3", "]"}]}], "]"}], "}"}], ",", 
          "\[IndentingNewLine]", "zx", ",", 
          RowBox[{"{", 
           RowBox[{"Translate", "[", 
            RowBox[{"zx", ",", 
             RowBox[{"e", "[", "2", "]"}]}], "]"}], "}"}], ",", 
          "\[IndentingNewLine]", "yz", ",", 
          RowBox[{"{", 
           RowBox[{"Translate", "[", 
            RowBox[{"yz", ",", 
             RowBox[{"e", "[", "1", "]"}]}], "]"}], "}"}]}], "]"}], "]"}]}], 
      "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6330098390760612`*^9, 3.633009856185946*^9}, {
   3.6330100151420803`*^9, 3.633010015195387*^9}, 3.6330146324269133`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"s3p", "[", "mcube", "]"}]], "Input",
 CellChangeTimes->{
  3.3873654052901278`*^9, {3.387731518570932*^9, 3.387731599956348*^9}, 
   3.387820134428432*^9, 3.3878201662565565`*^9, 3.633014632426976*^9}],

Cell[BoxData[
 Graphics3DBox[
  {FaceForm[RGBColor[1, 0, 0], RGBColor[0, 1, 1]], 
   Polygon3DBox[{{0.16666666666666666`, 0.08333333333333333, 0}, {
     0.25, 0.36111111111111105`, 0}, {0.25, 0.5, 0}, {
     0.20833333333333331`, 0.5, 0}, {
     0.08333333333333333, 0.08333333333333333, 0}}], 
   Polygon3DBox[{{0.41666666666666663`, 0.08333333333333333, 0}, {
     0.29166666666666663`, 0.5, 0}, {0.25, 0.5, 0}, {
     0.25, 0.36111111111111105`, 0}, {
     0.3333333333333333, 0.08333333333333333, 0}}], 
   Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
     0.16666666666666666`, 0.9166666666666666, 0}, {
     0.08333333333333333, 0.9166666666666666, 0}, {
     0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
   Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
     0.41666666666666663`, 0.9166666666666666, 0}, {
     0.3333333333333333, 0.9166666666666666, 0}, {
     0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}], 
   GeometricTransformation3DBox[
    {FaceForm[RGBColor[0, 1, 0], RGBColor[1, 0, 1]], 
     Polygon3DBox[{{0.29166666666666663`, 0.08333333333333333, 0}, {
       0.29166666666666663`, 0.5, 0}, {0.20833333333333331`, 0.5, 0}, {
       0.20833333333333331`, 0.08333333333333333, 0}}], 
     Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
       0.16666666666666666`, 0.9166666666666666, 0}, {
       0.08333333333333333, 0.9166666666666666, 0}, {
       0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
     Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
       0.41666666666666663`, 0.9166666666666666, 0}, {
       0.3333333333333333, 0.9166666666666666, 0}, {
       0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}]}, {0.5, 0, 0}], 
   GeometricTransformation3DBox[
    {FaceForm[RGBColor[1, 0, 0], RGBColor[0, 1, 1]], 
     Polygon3DBox[{{0.16666666666666666`, 0.08333333333333333, 0}, {
       0.25, 0.36111111111111105`, 0}, {0.25, 0.5, 0}, {
       0.20833333333333331`, 0.5, 0}, {
       0.08333333333333333, 0.08333333333333333, 0}}], 
     Polygon3DBox[{{0.41666666666666663`, 0.08333333333333333, 0}, {
       0.29166666666666663`, 0.5, 0}, {0.25, 0.5, 0}, {
       0.25, 0.36111111111111105`, 0}, {
       0.3333333333333333, 0.08333333333333333, 0}}], 
     Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
       0.16666666666666666`, 0.9166666666666666, 0}, {
       0.08333333333333333, 0.9166666666666666, 0}, {
       0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
     Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
       0.41666666666666663`, 0.9166666666666666, 0}, {
       0.3333333333333333, 0.9166666666666666, 0}, {
       0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}], 
     GeometricTransformation3DBox[
      {FaceForm[RGBColor[0, 1, 0], RGBColor[1, 0, 1]], 
       Polygon3DBox[{{0.29166666666666663`, 0.08333333333333333, 0}, {
         0.29166666666666663`, 0.5, 0}, {0.20833333333333331`, 0.5, 0}, {
         0.20833333333333331`, 0.08333333333333333, 0}}], 
       Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
         0.16666666666666666`, 0.9166666666666666, 0}, {
         0.08333333333333333, 0.9166666666666666, 0}, {
         0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
       Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
         0.41666666666666663`, 0.9166666666666666, 0}, {
         0.3333333333333333, 0.9166666666666666, 0}, {
         0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}]}, {0.5, 0, 0}]}, {0, 
    0, 1}], GeometricTransformation3DBox[
    GeometricTransformation3DBox[
     GeometricTransformation3DBox[GeometricTransformation3DBox[
       {FaceForm[RGBColor[0, 0, 1], RGBColor[1, 1, 0]], 
        Polygon3DBox[{{0.41666666666666663`, 0.08333333333333333, 0}, {
          0.41666666666666663`, 0.16666666666666666`, 0}, {
          0.10833333333333334`, 0.16666666666666666`, 0}, {
          0.08333333333333333, 0.08333333333333333, 0}}], 
        Polygon3DBox[{{0.19166666666666665`, 0.16666666666666666`, 0}, {
          0.39166666666666666`, 0.8333333333333333, 0}, {
          0.30833333333333335`, 0.8333333333333333, 0}, {
          0.10833333333333334`, 0.16666666666666666`, 0}}], 
        Polygon3DBox[{{0.08333333333333333, 0.8333333333333333, 0}, {
          0.39166666666666666`, 0.8333333333333333, 0}, {
          0.41666666666666663`, 0.9166666666666666, 0}, {
          0.08333333333333333, 0.9166666666666666, 0}}], 
        GeometricTransformation3DBox[
         {FaceForm[RGBColor[1, 0, 0], RGBColor[0, 1, 1]], 
          Polygon3DBox[{{0.16666666666666666`, 0.08333333333333333, 0}, {
            0.25, 0.36111111111111105`, 0}, {0.25, 0.5, 0}, {
            0.20833333333333331`, 0.5, 0}, {
            0.08333333333333333, 0.08333333333333333, 0}}], 
          Polygon3DBox[{{0.41666666666666663`, 0.08333333333333333, 0}, {
            0.29166666666666663`, 0.5, 0}, {0.25, 0.5, 0}, {
            0.25, 0.36111111111111105`, 0}, {
            0.3333333333333333, 0.08333333333333333, 0}}], 
          Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
            0.16666666666666666`, 0.9166666666666666, 0}, {
            0.08333333333333333, 0.9166666666666666, 0}, {
            0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
          Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
            0.41666666666666663`, 0.9166666666666666, 0}, {
            0.3333333333333333, 0.9166666666666666, 0}, {
            0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}]}, {0.5, 0, 0}]}, {{
       1, 0, 0}, {0, 1, 0}, {0, 0, 1}}], {{1., 0., 0.}, {0., 
      6.123233995736766*^-17, -1.}, {0., 1., 
      6.123233995736766*^-17}}], {{-1., -1.2246467991473532`*^-16, 0.}, {
     1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}], {1, 0, 0}], 
   GeometricTransformation3DBox[
    GeometricTransformation3DBox[
     GeometricTransformation3DBox[
      GeometricTransformation3DBox[GeometricTransformation3DBox[
        {FaceForm[RGBColor[0, 0, 1], RGBColor[1, 1, 0]], 
         Polygon3DBox[{{0.41666666666666663`, 0.08333333333333333, 0}, {
           0.41666666666666663`, 0.16666666666666666`, 0}, {
           0.10833333333333334`, 0.16666666666666666`, 0}, {
           0.08333333333333333, 0.08333333333333333, 0}}], 
         Polygon3DBox[{{0.19166666666666665`, 0.16666666666666666`, 0}, {
           0.39166666666666666`, 0.8333333333333333, 0}, {
           0.30833333333333335`, 0.8333333333333333, 0}, {
           0.10833333333333334`, 0.16666666666666666`, 0}}], 
         Polygon3DBox[{{0.08333333333333333, 0.8333333333333333, 0}, {
           0.39166666666666666`, 0.8333333333333333, 0}, {
           0.41666666666666663`, 0.9166666666666666, 0}, {
           0.08333333333333333, 0.9166666666666666, 0}}], 
         GeometricTransformation3DBox[
          {FaceForm[RGBColor[1, 0, 0], RGBColor[0, 1, 1]], 
           Polygon3DBox[{{0.16666666666666666`, 0.08333333333333333, 0}, {
             0.25, 0.36111111111111105`, 0}, {0.25, 0.5, 0}, {
             0.20833333333333331`, 0.5, 0}, {
             0.08333333333333333, 0.08333333333333333, 0}}], 
           Polygon3DBox[{{0.41666666666666663`, 0.08333333333333333, 0}, {
             0.29166666666666663`, 0.5, 0}, {0.25, 0.5, 0}, {
             0.25, 0.36111111111111105`, 0}, {
             0.3333333333333333, 0.08333333333333333, 0}}], 
           Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
             0.16666666666666666`, 0.9166666666666666, 0}, {
             0.08333333333333333, 0.9166666666666666, 0}, {
             0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
           Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
             0.41666666666666663`, 0.9166666666666666, 0}, {
             0.3333333333333333, 0.9166666666666666, 0}, {
             0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}]}, {
          0.5, 0, 0}]}, {{1, 0, 0}, {0, 1, 0}, {0, 0, 1}}], {{1., 0., 0.}, {
       0., 6.123233995736766*^-17, -1.}, {0., 1., 
       6.123233995736766*^-17}}], {{-1., -1.2246467991473532`*^-16, 0.}, {
      1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}], {1, 0, 0}], {0, 1, 
    0}], GeometricTransformation3DBox[
    GeometricTransformation3DBox[GeometricTransformation3DBox[
      {FaceForm[RGBColor[0, 1, 0], RGBColor[1, 0, 1]], 
       Polygon3DBox[{{0.29166666666666663`, 0.08333333333333333, 0}, {
         0.29166666666666663`, 0.5, 0}, {0.20833333333333331`, 0.5, 0}, {
         0.20833333333333331`, 0.08333333333333333, 0}}], 
       Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
         0.16666666666666666`, 0.9166666666666666, 0}, {
         0.08333333333333333, 0.9166666666666666, 0}, {
         0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
       Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
         0.41666666666666663`, 0.9166666666666666, 0}, {
         0.3333333333333333, 0.9166666666666666, 0}, {
         0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}], 
       GeometricTransformation3DBox[
        {FaceForm[RGBColor[0, 0, 1], RGBColor[1, 1, 0]], 
         Polygon3DBox[{{0.41666666666666663`, 0.08333333333333333, 0}, {
           0.41666666666666663`, 0.16666666666666666`, 0}, {
           0.10833333333333334`, 0.16666666666666666`, 0}, {
           0.08333333333333333, 0.08333333333333333, 0}}], 
         Polygon3DBox[{{0.19166666666666665`, 0.16666666666666666`, 0}, {
           0.39166666666666666`, 0.8333333333333333, 0}, {
           0.30833333333333335`, 0.8333333333333333, 0}, {
           0.10833333333333334`, 0.16666666666666666`, 0}}], 
         Polygon3DBox[{{0.08333333333333333, 0.8333333333333333, 0}, {
           0.39166666666666666`, 0.8333333333333333, 0}, {
           0.41666666666666663`, 0.9166666666666666, 0}, {
           0.08333333333333333, 0.9166666666666666, 0}}]}, {
        0.5, 0, 0}]}, {{-1., -1.2246467991473532`*^-16, 0.}, {
      1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}], {{1., 0., 0.}, {0., 
     6.123233995736766*^-17, 1.}, {0., -1., 
     6.123233995736766*^-17}}], {{-1.8369701987210297`*^-16, 1., 
    0.}, {-1., -1.8369701987210297`*^-16, 0.}, {0., 0., 1.}}], 
   GeometricTransformation3DBox[
    GeometricTransformation3DBox[
     GeometricTransformation3DBox[GeometricTransformation3DBox[
       {FaceForm[RGBColor[0, 1, 0], RGBColor[1, 0, 1]], 
        Polygon3DBox[{{0.29166666666666663`, 0.08333333333333333, 0}, {
          0.29166666666666663`, 0.5, 0}, {0.20833333333333331`, 0.5, 0}, {
          0.20833333333333331`, 0.08333333333333333, 0}}], 
        Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
          0.16666666666666666`, 0.9166666666666666, 0}, {
          0.08333333333333333, 0.9166666666666666, 0}, {
          0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
        Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
          0.41666666666666663`, 0.9166666666666666, 0}, {
          0.3333333333333333, 0.9166666666666666, 0}, {
          0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}], 
        GeometricTransformation3DBox[
         {FaceForm[RGBColor[0, 0, 1], RGBColor[1, 1, 0]], 
          Polygon3DBox[{{0.41666666666666663`, 0.08333333333333333, 0}, {
            0.41666666666666663`, 0.16666666666666666`, 0}, {
            0.10833333333333334`, 0.16666666666666666`, 0}, {
            0.08333333333333333, 0.08333333333333333, 0}}], 
          Polygon3DBox[{{0.19166666666666665`, 0.16666666666666666`, 0}, {
            0.39166666666666666`, 0.8333333333333333, 0}, {
            0.30833333333333335`, 0.8333333333333333, 0}, {
            0.10833333333333334`, 0.16666666666666666`, 0}}], 
          Polygon3DBox[{{0.08333333333333333, 0.8333333333333333, 0}, {
            0.39166666666666666`, 0.8333333333333333, 0}, {
            0.41666666666666663`, 0.9166666666666666, 0}, {
            0.08333333333333333, 0.9166666666666666, 0}}]}, {
         0.5, 0, 0}]}, {{-1., -1.2246467991473532`*^-16, 0.}, {
       1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}], {{1., 0., 0.}, {0.,
       6.123233995736766*^-17, 1.}, {0., -1., 
      6.123233995736766*^-17}}], {{-1.8369701987210297`*^-16, 1., 
     0.}, {-1., -1.8369701987210297`*^-16, 0.}, {0., 0., 1.}}], {1, 0, 0}]},
  Axes->True,
  AxesLabel->{
    FormBox["\"x\"", TraditionalForm], 
    FormBox["\"y\"", TraditionalForm], 
    FormBox["\"z\"", TraditionalForm]},
  FaceGrids->All,
  ImageSize->Automatic,
  Lighting->"Neutral"]], "Output",
 CellChangeTimes->{3.633009878394043*^9, 3.633010021348926*^9, 
  3.6330178587868423`*^9, 3.633018201128182*^9, 3.6677378743559103`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"ucube", "=", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"FaceForm", "[", 
      RowBox[{"Gray", ",", "Gray"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Polygon", "[", 
      RowBox[{"Reverse", "[", 
       RowBox[{"{", 
        RowBox[{"o", ",", 
         RowBox[{"e", "[", "1", "]"}], ",", 
         RowBox[{"a", "-", 
          RowBox[{"e", "[", "3", "]"}]}], ",", 
         RowBox[{"e", "[", "2", "]"}]}], "}"}], "]"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Polygon", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"e", "[", "3", "]"}], ",", 
        RowBox[{"a", "-", 
         RowBox[{"e", "[", "2", "]"}]}], ",", "a", ",", 
        RowBox[{"a", "-", 
         RowBox[{"e", "[", "1", "]"}]}]}], "}"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Polygon", "[", 
      RowBox[{"Reverse", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"e", "[", "2", "]"}], ",", 
         RowBox[{"a", "-", 
          RowBox[{"e", "[", "3", "]"}]}], ",", "a", ",", 
         RowBox[{"a", "-", 
          RowBox[{"e", "[", "1", "]"}]}]}], "}"}], "]"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Polygon", "[", 
      RowBox[{"{", 
       RowBox[{"o", ",", 
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"a", "-", 
         RowBox[{"e", "[", "2", "]"}]}], ",", 
        RowBox[{"e", "[", "3", "]"}]}], "}"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Polygon", "[", 
      RowBox[{"Reverse", "[", 
       RowBox[{"{", 
        RowBox[{"o", ",", 
         RowBox[{"e", "[", "2", "]"}], ",", 
         RowBox[{"a", "-", 
          RowBox[{"e", "[", "1", "]"}]}], ",", 
         RowBox[{"e", "[", "3", "]"}]}], "}"}], "]"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Polygon", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"a", "-", 
         RowBox[{"e", "[", "3", "]"}]}], ",", "a", ",", 
        RowBox[{"a", "-", 
         RowBox[{"e", "[", "2", "]"}]}]}], "}"}], "]"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.387731518570932*^9, 3.387731599956348*^9}, 
   3.387820134428432*^9, 3.3878201662565565`*^9, {3.4292957335365257`*^9, 
   3.42929582231931*^9}, {3.429299546154066*^9, 3.429299548028908*^9}, {
   3.429299710486974*^9, 3.4292997642345057`*^9}, {3.4293002524834948`*^9, 
   3.4293002524888897`*^9}, {3.4293005781282387`*^9, 3.4293006389058867`*^9}, 
   3.6330100798816767`*^9, {3.6330101420805283`*^9, 3.633010189534121*^9}, {
   3.63301023664439*^9, 3.63301025398005*^9}, 3.63301463242703*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"s3", "[", "ucube", "]"}]], "Input",
 CellChangeTimes->{{3.4292958305193357`*^9, 3.429295835590711*^9}, {
  3.63301032239194*^9, 3.633010327402843*^9}}],

Cell[BoxData[
 Graphics3DBox[
  {FaceForm[GrayLevel[0.5]], 
   Polygon3DBox[{{0, 1, 0}, {1, 1, 0}, {1, 0, 0}, {0, 0, 0}}], 
   Polygon3DBox[{{0, 0, 1}, {1, 0, 1}, {1, 1, 1}, {0, 1, 1}}], 
   Polygon3DBox[{{0, 1, 1}, {1, 1, 1}, {1, 1, 0}, {0, 1, 0}}], 
   Polygon3DBox[{{0, 0, 0}, {1, 0, 0}, {1, 0, 1}, {0, 0, 1}}], 
   Polygon3DBox[{{0, 0, 1}, {0, 1, 1}, {0, 1, 0}, {0, 0, 0}}], 
   Polygon3DBox[{{1, 0, 0}, {1, 1, 0}, {1, 1, 1}, {1, 0, 1}}]},
  Axes->True,
  AxesLabel->{
    FormBox["\"x\"", TraditionalForm], 
    FormBox["\"y\"", TraditionalForm], 
    FormBox["\"z\"", TraditionalForm]},
  FaceGrids->All,
  ImageSize->Automatic]], "Output",
 CellChangeTimes->{{3.633010317591132*^9, 3.633010328028583*^9}, 
   3.633017858821249*^9, 3.633018201189805*^9, 3.667737874400288*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"ncube", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"mcube", ",", 
     RowBox[{"{", 
      RowBox[{"Translate", "[", 
       RowBox[{
        RowBox[{"Scale", "[", 
         RowBox[{"ucube", ",", 
          RowBox[{"c", "[", 
           RowBox[{"7.", "/", "8."}], "]"}], ",", "o"}], "]"}], ",", 
        RowBox[{"c", "[", 
         RowBox[{"1.", "/", "16."}], "]"}]}], "]"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{
  3.6330102375809927`*^9, {3.6330103445077887`*^9, 3.633010345011709*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"s3p", "[", "ncube", "]"}]], "Input",
 CellChangeTimes->{{3.429295984956645*^9, 3.4292959886297407`*^9}}],

Cell[BoxData[
 Graphics3DBox[
  {FaceForm[RGBColor[1, 0, 0], RGBColor[0, 1, 1]], 
   Polygon3DBox[{{0.16666666666666666`, 0.08333333333333333, 0}, {
     0.25, 0.36111111111111105`, 0}, {0.25, 0.5, 0}, {
     0.20833333333333331`, 0.5, 0}, {
     0.08333333333333333, 0.08333333333333333, 0}}], 
   Polygon3DBox[{{0.41666666666666663`, 0.08333333333333333, 0}, {
     0.29166666666666663`, 0.5, 0}, {0.25, 0.5, 0}, {
     0.25, 0.36111111111111105`, 0}, {
     0.3333333333333333, 0.08333333333333333, 0}}], 
   Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
     0.16666666666666666`, 0.9166666666666666, 0}, {
     0.08333333333333333, 0.9166666666666666, 0}, {
     0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
   Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
     0.41666666666666663`, 0.9166666666666666, 0}, {
     0.3333333333333333, 0.9166666666666666, 0}, {
     0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}], 
   GeometricTransformation3DBox[
    {FaceForm[RGBColor[0, 1, 0], RGBColor[1, 0, 1]], 
     Polygon3DBox[{{0.29166666666666663`, 0.08333333333333333, 0}, {
       0.29166666666666663`, 0.5, 0}, {0.20833333333333331`, 0.5, 0}, {
       0.20833333333333331`, 0.08333333333333333, 0}}], 
     Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
       0.16666666666666666`, 0.9166666666666666, 0}, {
       0.08333333333333333, 0.9166666666666666, 0}, {
       0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
     Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
       0.41666666666666663`, 0.9166666666666666, 0}, {
       0.3333333333333333, 0.9166666666666666, 0}, {
       0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}]}, {0.5, 0, 0}], 
   GeometricTransformation3DBox[
    {FaceForm[RGBColor[1, 0, 0], RGBColor[0, 1, 1]], 
     Polygon3DBox[{{0.16666666666666666`, 0.08333333333333333, 0}, {
       0.25, 0.36111111111111105`, 0}, {0.25, 0.5, 0}, {
       0.20833333333333331`, 0.5, 0}, {
       0.08333333333333333, 0.08333333333333333, 0}}], 
     Polygon3DBox[{{0.41666666666666663`, 0.08333333333333333, 0}, {
       0.29166666666666663`, 0.5, 0}, {0.25, 0.5, 0}, {
       0.25, 0.36111111111111105`, 0}, {
       0.3333333333333333, 0.08333333333333333, 0}}], 
     Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
       0.16666666666666666`, 0.9166666666666666, 0}, {
       0.08333333333333333, 0.9166666666666666, 0}, {
       0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
     Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
       0.41666666666666663`, 0.9166666666666666, 0}, {
       0.3333333333333333, 0.9166666666666666, 0}, {
       0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}], 
     GeometricTransformation3DBox[
      {FaceForm[RGBColor[0, 1, 0], RGBColor[1, 0, 1]], 
       Polygon3DBox[{{0.29166666666666663`, 0.08333333333333333, 0}, {
         0.29166666666666663`, 0.5, 0}, {0.20833333333333331`, 0.5, 0}, {
         0.20833333333333331`, 0.08333333333333333, 0}}], 
       Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
         0.16666666666666666`, 0.9166666666666666, 0}, {
         0.08333333333333333, 0.9166666666666666, 0}, {
         0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
       Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
         0.41666666666666663`, 0.9166666666666666, 0}, {
         0.3333333333333333, 0.9166666666666666, 0}, {
         0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}]}, {0.5, 0, 0}]}, {0, 
    0, 1}], GeometricTransformation3DBox[
    GeometricTransformation3DBox[
     GeometricTransformation3DBox[GeometricTransformation3DBox[
       {FaceForm[RGBColor[0, 0, 1], RGBColor[1, 1, 0]], 
        Polygon3DBox[{{0.41666666666666663`, 0.08333333333333333, 0}, {
          0.41666666666666663`, 0.16666666666666666`, 0}, {
          0.10833333333333334`, 0.16666666666666666`, 0}, {
          0.08333333333333333, 0.08333333333333333, 0}}], 
        Polygon3DBox[{{0.19166666666666665`, 0.16666666666666666`, 0}, {
          0.39166666666666666`, 0.8333333333333333, 0}, {
          0.30833333333333335`, 0.8333333333333333, 0}, {
          0.10833333333333334`, 0.16666666666666666`, 0}}], 
        Polygon3DBox[{{0.08333333333333333, 0.8333333333333333, 0}, {
          0.39166666666666666`, 0.8333333333333333, 0}, {
          0.41666666666666663`, 0.9166666666666666, 0}, {
          0.08333333333333333, 0.9166666666666666, 0}}], 
        GeometricTransformation3DBox[
         {FaceForm[RGBColor[1, 0, 0], RGBColor[0, 1, 1]], 
          Polygon3DBox[{{0.16666666666666666`, 0.08333333333333333, 0}, {
            0.25, 0.36111111111111105`, 0}, {0.25, 0.5, 0}, {
            0.20833333333333331`, 0.5, 0}, {
            0.08333333333333333, 0.08333333333333333, 0}}], 
          Polygon3DBox[{{0.41666666666666663`, 0.08333333333333333, 0}, {
            0.29166666666666663`, 0.5, 0}, {0.25, 0.5, 0}, {
            0.25, 0.36111111111111105`, 0}, {
            0.3333333333333333, 0.08333333333333333, 0}}], 
          Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
            0.16666666666666666`, 0.9166666666666666, 0}, {
            0.08333333333333333, 0.9166666666666666, 0}, {
            0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
          Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
            0.41666666666666663`, 0.9166666666666666, 0}, {
            0.3333333333333333, 0.9166666666666666, 0}, {
            0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}]}, {0.5, 0, 0}]}, {{
       1, 0, 0}, {0, 1, 0}, {0, 0, 1}}], {{1., 0., 0.}, {0., 
      6.123233995736766*^-17, -1.}, {0., 1., 
      6.123233995736766*^-17}}], {{-1., -1.2246467991473532`*^-16, 0.}, {
     1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}], {1, 0, 0}], 
   GeometricTransformation3DBox[
    GeometricTransformation3DBox[
     GeometricTransformation3DBox[
      GeometricTransformation3DBox[GeometricTransformation3DBox[
        {FaceForm[RGBColor[0, 0, 1], RGBColor[1, 1, 0]], 
         Polygon3DBox[{{0.41666666666666663`, 0.08333333333333333, 0}, {
           0.41666666666666663`, 0.16666666666666666`, 0}, {
           0.10833333333333334`, 0.16666666666666666`, 0}, {
           0.08333333333333333, 0.08333333333333333, 0}}], 
         Polygon3DBox[{{0.19166666666666665`, 0.16666666666666666`, 0}, {
           0.39166666666666666`, 0.8333333333333333, 0}, {
           0.30833333333333335`, 0.8333333333333333, 0}, {
           0.10833333333333334`, 0.16666666666666666`, 0}}], 
         Polygon3DBox[{{0.08333333333333333, 0.8333333333333333, 0}, {
           0.39166666666666666`, 0.8333333333333333, 0}, {
           0.41666666666666663`, 0.9166666666666666, 0}, {
           0.08333333333333333, 0.9166666666666666, 0}}], 
         GeometricTransformation3DBox[
          {FaceForm[RGBColor[1, 0, 0], RGBColor[0, 1, 1]], 
           Polygon3DBox[{{0.16666666666666666`, 0.08333333333333333, 0}, {
             0.25, 0.36111111111111105`, 0}, {0.25, 0.5, 0}, {
             0.20833333333333331`, 0.5, 0}, {
             0.08333333333333333, 0.08333333333333333, 0}}], 
           Polygon3DBox[{{0.41666666666666663`, 0.08333333333333333, 0}, {
             0.29166666666666663`, 0.5, 0}, {0.25, 0.5, 0}, {
             0.25, 0.36111111111111105`, 0}, {
             0.3333333333333333, 0.08333333333333333, 0}}], 
           Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
             0.16666666666666666`, 0.9166666666666666, 0}, {
             0.08333333333333333, 0.9166666666666666, 0}, {
             0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
           Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
             0.41666666666666663`, 0.9166666666666666, 0}, {
             0.3333333333333333, 0.9166666666666666, 0}, {
             0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}]}, {
          0.5, 0, 0}]}, {{1, 0, 0}, {0, 1, 0}, {0, 0, 1}}], {{1., 0., 0.}, {
       0., 6.123233995736766*^-17, -1.}, {0., 1., 
       6.123233995736766*^-17}}], {{-1., -1.2246467991473532`*^-16, 0.}, {
      1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}], {1, 0, 0}], {0, 1, 
    0}], GeometricTransformation3DBox[
    GeometricTransformation3DBox[GeometricTransformation3DBox[
      {FaceForm[RGBColor[0, 1, 0], RGBColor[1, 0, 1]], 
       Polygon3DBox[{{0.29166666666666663`, 0.08333333333333333, 0}, {
         0.29166666666666663`, 0.5, 0}, {0.20833333333333331`, 0.5, 0}, {
         0.20833333333333331`, 0.08333333333333333, 0}}], 
       Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
         0.16666666666666666`, 0.9166666666666666, 0}, {
         0.08333333333333333, 0.9166666666666666, 0}, {
         0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
       Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
         0.41666666666666663`, 0.9166666666666666, 0}, {
         0.3333333333333333, 0.9166666666666666, 0}, {
         0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}], 
       GeometricTransformation3DBox[
        {FaceForm[RGBColor[0, 0, 1], RGBColor[1, 1, 0]], 
         Polygon3DBox[{{0.41666666666666663`, 0.08333333333333333, 0}, {
           0.41666666666666663`, 0.16666666666666666`, 0}, {
           0.10833333333333334`, 0.16666666666666666`, 0}, {
           0.08333333333333333, 0.08333333333333333, 0}}], 
         Polygon3DBox[{{0.19166666666666665`, 0.16666666666666666`, 0}, {
           0.39166666666666666`, 0.8333333333333333, 0}, {
           0.30833333333333335`, 0.8333333333333333, 0}, {
           0.10833333333333334`, 0.16666666666666666`, 0}}], 
         Polygon3DBox[{{0.08333333333333333, 0.8333333333333333, 0}, {
           0.39166666666666666`, 0.8333333333333333, 0}, {
           0.41666666666666663`, 0.9166666666666666, 0}, {
           0.08333333333333333, 0.9166666666666666, 0}}]}, {
        0.5, 0, 0}]}, {{-1., -1.2246467991473532`*^-16, 0.}, {
      1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}], {{1., 0., 0.}, {0., 
     6.123233995736766*^-17, 1.}, {0., -1., 
     6.123233995736766*^-17}}], {{-1.8369701987210297`*^-16, 1., 
    0.}, {-1., -1.8369701987210297`*^-16, 0.}, {0., 0., 1.}}], 
   GeometricTransformation3DBox[
    GeometricTransformation3DBox[
     GeometricTransformation3DBox[GeometricTransformation3DBox[
       {FaceForm[RGBColor[0, 1, 0], RGBColor[1, 0, 1]], 
        Polygon3DBox[{{0.29166666666666663`, 0.08333333333333333, 0}, {
          0.29166666666666663`, 0.5, 0}, {0.20833333333333331`, 0.5, 0}, {
          0.20833333333333331`, 0.08333333333333333, 0}}], 
        Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
          0.16666666666666666`, 0.9166666666666666, 0}, {
          0.08333333333333333, 0.9166666666666666, 0}, {
          0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
        Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
          0.41666666666666663`, 0.9166666666666666, 0}, {
          0.3333333333333333, 0.9166666666666666, 0}, {
          0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}], 
        GeometricTransformation3DBox[
         {FaceForm[RGBColor[0, 0, 1], RGBColor[1, 1, 0]], 
          Polygon3DBox[{{0.41666666666666663`, 0.08333333333333333, 0}, {
            0.41666666666666663`, 0.16666666666666666`, 0}, {
            0.10833333333333334`, 0.16666666666666666`, 0}, {
            0.08333333333333333, 0.08333333333333333, 0}}], 
          Polygon3DBox[{{0.19166666666666665`, 0.16666666666666666`, 0}, {
            0.39166666666666666`, 0.8333333333333333, 0}, {
            0.30833333333333335`, 0.8333333333333333, 0}, {
            0.10833333333333334`, 0.16666666666666666`, 0}}], 
          Polygon3DBox[{{0.08333333333333333, 0.8333333333333333, 0}, {
            0.39166666666666666`, 0.8333333333333333, 0}, {
            0.41666666666666663`, 0.9166666666666666, 0}, {
            0.08333333333333333, 0.9166666666666666, 0}}]}, {
         0.5, 0, 0}]}, {{-1., -1.2246467991473532`*^-16, 0.}, {
       1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}], {{1., 0., 0.}, {0.,
       6.123233995736766*^-17, 1.}, {0., -1., 
      6.123233995736766*^-17}}], {{-1.8369701987210297`*^-16, 1., 
     0.}, {-1., -1.8369701987210297`*^-16, 0.}, {0., 0., 1.}}], {1, 0, 0}], 
   GeometricTransformation3DBox[GeometricTransformation3DBox[
     {FaceForm[GrayLevel[0.5]], 
      Polygon3DBox[{{0, 1, 0}, {1, 1, 0}, {1, 0, 0}, {0, 0, 0}}], 
      Polygon3DBox[{{0, 0, 1}, {1, 0, 1}, {1, 1, 1}, {0, 1, 1}}], 
      Polygon3DBox[{{0, 1, 1}, {1, 1, 1}, {1, 1, 0}, {0, 1, 0}}], 
      Polygon3DBox[{{0, 0, 0}, {1, 0, 0}, {1, 0, 1}, {0, 0, 1}}], 
      Polygon3DBox[{{0, 0, 1}, {0, 1, 1}, {0, 1, 0}, {0, 0, 0}}], 
      Polygon3DBox[{{1, 0, 0}, {1, 1, 0}, {1, 1, 1}, {1, 0, 1}}]}, {{{0.875, 
      0., 0.}, {0., 0.875, 0.}, {0., 0., 0.875}}, {0., 0., 0.}}], {0.0625, 
    0.0625, 0.0625}]},
  Axes->True,
  AxesLabel->{
    FormBox["\"x\"", TraditionalForm], 
    FormBox["\"y\"", TraditionalForm], 
    FormBox["\"z\"", TraditionalForm]},
  FaceGrids->All,
  ImageSize->Automatic,
  Lighting->"Neutral"]], "Output",
 CellChangeTimes->{3.633010357124814*^9, 3.633017858862351*^9, 
  3.6330182012508917`*^9, 3.667737874447401*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"lcube", "=", "\[IndentingNewLine]", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"pi", "=", 
       RowBox[{"N", "@", "Pi"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Chop", "[", 
      RowBox[{"Join", "[", 
       RowBox[{"ucube", ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Rotate3", "[", 
           RowBox[{"zxshape", ",", "0", ",", 
            RowBox[{
             RowBox[{"-", "pi"}], "/", "2"}], ",", "0"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Translate", "[", 
           RowBox[{
            RowBox[{"Rotate3", "[", 
             RowBox[{"zxshape", ",", "0", ",", 
              RowBox[{
               RowBox[{"-", "pi"}], "/", "2"}], ",", "0"}], "]"}], ",", 
            RowBox[{"e", "[", "2", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Rotate3", "[", 
           RowBox[{"yzshape", ",", "0", ",", 
            RowBox[{
             RowBox[{"-", "pi"}], "/", "2"}], ",", 
            RowBox[{
             RowBox[{"-", "pi"}], "/", "2"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Translate", "[", 
           RowBox[{
            RowBox[{"Rotate3", "[", 
             RowBox[{"yzshape", ",", "0", ",", 
              RowBox[{
               RowBox[{"-", "pi"}], "/", "2"}], ",", 
              RowBox[{
               RowBox[{"-", "pi"}], "/", "2"}]}], "]"}], ",", 
            RowBox[{"e", "[", "1", "]"}]}], "]"}], ",", "xyshape", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Translate", "[", 
           RowBox[{"xyshape", ",", 
            RowBox[{"e", "[", "3", "]"}]}], "]"}]}], "}"}]}], "]"}], "]"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.633010146935601*^9, 3.633010190270686*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"s3", "[", "lcube", "]"}]], "Input",
 CellChangeTimes->{{3.429296980311009*^9, 3.429296983195272*^9}}],

Cell[BoxData[
 Graphics3DBox[
  {FaceForm[GrayLevel[0.5]], 
   Polygon3DBox[{{0, 1, 0}, {1, 1, 0}, {1, 0, 0}, {0, 0, 0}}], 
   Polygon3DBox[{{0, 0, 1}, {1, 0, 1}, {1, 1, 1}, {0, 1, 1}}], 
   Polygon3DBox[{{0, 1, 1}, {1, 1, 1}, {1, 1, 0}, {0, 1, 0}}], 
   Polygon3DBox[{{0, 0, 0}, {1, 0, 0}, {1, 0, 1}, {0, 0, 1}}], 
   Polygon3DBox[{{0, 0, 1}, {0, 1, 1}, {0, 1, 0}, {0, 0, 0}}], 
   Polygon3DBox[{{1, 0, 0}, {1, 1, 0}, {1, 1, 1}, {1, 0, 1}}], 
   GeometricTransformation3DBox[
    GeometricTransformation3DBox[
     GeometricTransformation3DBox[{
       Line3DBox[{{0.08333333333333333, 0.08333333333333333, 0}, {
         0.30833333333333335`, 0.8333333333333333, 0}, {
         0.08333333333333333, 0.8333333333333333, 0}, {
         0.08333333333333333, 0.9166666666666666, 0}, {
         0.41666666666666663`, 0.9166666666666666, 0}, {
         0.19166666666666665`, 0.16666666666666666`, 0}, {
         0.41666666666666663`, 0.16666666666666666`, 0}, {
         0.41666666666666663`, 0.08333333333333333, 0}, {
         0.08333333333333333, 0.08333333333333333, 0}}], 
       GeometricTransformation3DBox[
        Line3DBox[{{0.08333333333333333, 0.08333333333333333, 0}, {
          0.20833333333333331`, 0.5, 0}, {
          0.08333333333333333, 0.9166666666666666, 0}, {
          0.16666666666666666`, 0.9166666666666666, 0}, {
          0.25, 0.6388888888888888, 0}, {
          0.3333333333333333, 0.9166666666666666, 0}, {
          0.41666666666666663`, 0.9166666666666666, 0}, {
          0.29166666666666663`, 0.5, 0}, {
          0.41666666666666663`, 0.08333333333333333, 0}, {
          0.3333333333333333, 0.08333333333333333, 0}, {
          0.25, 0.36111111111111105`, 0}, {
          0.16666666666666666`, 0.08333333333333333, 0}, {
          0.08333333333333333, 0.08333333333333333, 0}}], {
        0.5, 0, 0}]}, {{-1., -1.2246467991473532`*^-16, 0.}, {
      1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}], {{1., 0., 0.}, {0., 
     6.123233995736766*^-17, 1.}, {0., -1., 
     6.123233995736766*^-17}}], {{-1., -1.2246467991473532`*^-16, 0.}, {
    1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}], 
   GeometricTransformation3DBox[
    GeometricTransformation3DBox[
     GeometricTransformation3DBox[
      GeometricTransformation3DBox[{
        Line3DBox[{{0.08333333333333333, 0.08333333333333333, 0}, {
          0.30833333333333335`, 0.8333333333333333, 0}, {
          0.08333333333333333, 0.8333333333333333, 0}, {
          0.08333333333333333, 0.9166666666666666, 0}, {
          0.41666666666666663`, 0.9166666666666666, 0}, {
          0.19166666666666665`, 0.16666666666666666`, 0}, {
          0.41666666666666663`, 0.16666666666666666`, 0}, {
          0.41666666666666663`, 0.08333333333333333, 0}, {
          0.08333333333333333, 0.08333333333333333, 0}}], 
        GeometricTransformation3DBox[
         Line3DBox[{{0.08333333333333333, 0.08333333333333333, 0}, {
           0.20833333333333331`, 0.5, 0}, {
           0.08333333333333333, 0.9166666666666666, 0}, {
           0.16666666666666666`, 0.9166666666666666, 0}, {
           0.25, 0.6388888888888888, 0}, {
           0.3333333333333333, 0.9166666666666666, 0}, {
           0.41666666666666663`, 0.9166666666666666, 0}, {
           0.29166666666666663`, 0.5, 0}, {
           0.41666666666666663`, 0.08333333333333333, 0}, {
           0.3333333333333333, 0.08333333333333333, 0}, {
           0.25, 0.36111111111111105`, 0}, {
           0.16666666666666666`, 0.08333333333333333, 0}, {
           0.08333333333333333, 0.08333333333333333, 0}}], {
         0.5, 0, 0}]}, {{-1., -1.2246467991473532`*^-16, 0.}, {
       1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}], {{1., 0., 0.}, {0.,
       6.123233995736766*^-17, 1.}, {0., -1., 
      6.123233995736766*^-17}}], {{-1., -1.2246467991473532`*^-16, 0.}, {
     1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}], {0, 1, 0}], 
   GeometricTransformation3DBox[
    GeometricTransformation3DBox[
     GeometricTransformation3DBox[{
       Line3DBox[{{0.20833333333333331`, 0.08333333333333333, 0}, {
         0.20833333333333331`, 0.5, 0}, {
         0.08333333333333333, 0.9166666666666666, 0}, {
         0.16666666666666666`, 0.9166666666666666, 0}, {
         0.25, 0.6388888888888888, 0}, {
         0.3333333333333333, 0.9166666666666666, 0}, {
         0.41666666666666663`, 0.9166666666666666, 0}, {
         0.29166666666666663`, 0.5, 0}, {
         0.29166666666666663`, 0.08333333333333333, 0}, {
         0.20833333333333331`, 0.08333333333333333, 0}}], 
       GeometricTransformation3DBox[
        Line3DBox[{{0.08333333333333333, 0.08333333333333333, 0}, {
          0.30833333333333335`, 0.8333333333333333, 0}, {
          0.08333333333333333, 0.8333333333333333, 0}, {
          0.08333333333333333, 0.9166666666666666, 0}, {
          0.41666666666666663`, 0.9166666666666666, 0}, {
          0.19166666666666665`, 0.16666666666666666`, 0}, {
          0.41666666666666663`, 0.16666666666666666`, 0}, {
          0.41666666666666663`, 0.08333333333333333, 0}, {
          0.08333333333333333, 0.08333333333333333, 0}}], {
        0.5, 0, 0}]}, {{-1., -1.2246467991473532`*^-16, 0.}, {
      1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}], {{1., 0., 0.}, {0., 
     6.123233995736766*^-17, 1.}, {0., -1., 
     6.123233995736766*^-17}}], {{-1.8369701987210297`*^-16, 1., 
    0.}, {-1., -1.8369701987210297`*^-16, 0.}, {0., 0., 1.}}], 
   GeometricTransformation3DBox[
    GeometricTransformation3DBox[
     GeometricTransformation3DBox[
      GeometricTransformation3DBox[{
        Line3DBox[{{0.20833333333333331`, 0.08333333333333333, 0}, {
          0.20833333333333331`, 0.5, 0}, {
          0.08333333333333333, 0.9166666666666666, 0}, {
          0.16666666666666666`, 0.9166666666666666, 0}, {
          0.25, 0.6388888888888888, 0}, {
          0.3333333333333333, 0.9166666666666666, 0}, {
          0.41666666666666663`, 0.9166666666666666, 0}, {
          0.29166666666666663`, 0.5, 0}, {
          0.29166666666666663`, 0.08333333333333333, 0}, {
          0.20833333333333331`, 0.08333333333333333, 0}}], 
        GeometricTransformation3DBox[
         Line3DBox[{{0.08333333333333333, 0.08333333333333333, 0}, {
           0.30833333333333335`, 0.8333333333333333, 0}, {
           0.08333333333333333, 0.8333333333333333, 0}, {
           0.08333333333333333, 0.9166666666666666, 0}, {
           0.41666666666666663`, 0.9166666666666666, 0}, {
           0.19166666666666665`, 0.16666666666666666`, 0}, {
           0.41666666666666663`, 0.16666666666666666`, 0}, {
           0.41666666666666663`, 0.08333333333333333, 0}, {
           0.08333333333333333, 0.08333333333333333, 0}}], {
         0.5, 0, 0}]}, {{-1., -1.2246467991473532`*^-16, 0.}, {
       1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}], {{1., 0., 0.}, {0.,
       6.123233995736766*^-17, 1.}, {0., -1., 
      6.123233995736766*^-17}}], {{-1.8369701987210297`*^-16, 1., 
     0.}, {-1., -1.8369701987210297`*^-16, 0.}, {0., 0., 1.}}], {1, 0, 0}], {
    Line3DBox[{{0.08333333333333333, 0.08333333333333333, 0}, {
      0.20833333333333331`, 0.5, 0}, {
      0.08333333333333333, 0.9166666666666666, 0}, {
      0.16666666666666666`, 0.9166666666666666, 0}, {
      0.25, 0.6388888888888888, 0}, {
      0.3333333333333333, 0.9166666666666666, 0}, {
      0.41666666666666663`, 0.9166666666666666, 0}, {
      0.29166666666666663`, 0.5, 0}, {
      0.41666666666666663`, 0.08333333333333333, 0}, {
      0.3333333333333333, 0.08333333333333333, 0}, {
      0.25, 0.36111111111111105`, 0}, {
      0.16666666666666666`, 0.08333333333333333, 0}, {
      0.08333333333333333, 0.08333333333333333, 0}}], 
    GeometricTransformation3DBox[
     Line3DBox[{{0.20833333333333331`, 0.08333333333333333, 0}, {
       0.20833333333333331`, 0.5, 0}, {
       0.08333333333333333, 0.9166666666666666, 0}, {
       0.16666666666666666`, 0.9166666666666666, 0}, {
       0.25, 0.6388888888888888, 0}, {
       0.3333333333333333, 0.9166666666666666, 0}, {
       0.41666666666666663`, 0.9166666666666666, 0}, {
       0.29166666666666663`, 0.5, 0}, {
       0.29166666666666663`, 0.08333333333333333, 0}, {
       0.20833333333333331`, 0.08333333333333333, 0}}], {0.5, 0, 0}]}, 
   GeometricTransformation3DBox[{
     Line3DBox[{{0.08333333333333333, 0.08333333333333333, 0}, {
       0.20833333333333331`, 0.5, 0}, {
       0.08333333333333333, 0.9166666666666666, 0}, {
       0.16666666666666666`, 0.9166666666666666, 0}, {
       0.25, 0.6388888888888888, 0}, {
       0.3333333333333333, 0.9166666666666666, 0}, {
       0.41666666666666663`, 0.9166666666666666, 0}, {
       0.29166666666666663`, 0.5, 0}, {
       0.41666666666666663`, 0.08333333333333333, 0}, {
       0.3333333333333333, 0.08333333333333333, 0}, {
       0.25, 0.36111111111111105`, 0}, {
       0.16666666666666666`, 0.08333333333333333, 0}, {
       0.08333333333333333, 0.08333333333333333, 0}}], 
     GeometricTransformation3DBox[
      Line3DBox[{{0.20833333333333331`, 0.08333333333333333, 0}, {
        0.20833333333333331`, 0.5, 0}, {
        0.08333333333333333, 0.9166666666666666, 0}, {
        0.16666666666666666`, 0.9166666666666666, 0}, {
        0.25, 0.6388888888888888, 0}, {
        0.3333333333333333, 0.9166666666666666, 0}, {
        0.41666666666666663`, 0.9166666666666666, 0}, {
        0.29166666666666663`, 0.5, 0}, {
        0.29166666666666663`, 0.08333333333333333, 0}, {
        0.20833333333333331`, 0.08333333333333333, 0}}], {0.5, 0, 0}]}, {0, 0,
     1}]},
  Axes->True,
  AxesLabel->{
    FormBox["\"x\"", TraditionalForm], 
    FormBox["\"y\"", TraditionalForm], 
    FormBox["\"z\"", TraditionalForm]},
  FaceGrids->All]], "Output",
 CellChangeTimes->{3.6330103662007236`*^9, 3.633017858910081*^9, 
  3.63301820132981*^9, 3.6677378744868727`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"ocube", "=", 
   RowBox[{"Translate", "[", 
    RowBox[{"ncube", ",", 
     RowBox[{"c", "[", 
      RowBox[{"-", "0.5"}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4292970159565496`*^9, 3.429297042702669*^9}, {
   3.429299175736161*^9, 3.429299179729761*^9}, 3.6330103458190727`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"s3p", "[", "ocube", "]"}]], "Input",
 CellChangeTimes->{{3.429297044429565*^9, 3.429297047632374*^9}}],

Cell[BoxData[
 Graphics3DBox[GeometricTransformation3DBox[
   {FaceForm[RGBColor[1, 0, 0], RGBColor[0, 1, 1]], 
    Polygon3DBox[{{0.16666666666666666`, 0.08333333333333333, 0}, {
      0.25, 0.36111111111111105`, 0}, {0.25, 0.5, 0}, {
      0.20833333333333331`, 0.5, 0}, {
      0.08333333333333333, 0.08333333333333333, 0}}], 
    Polygon3DBox[{{0.41666666666666663`, 0.08333333333333333, 0}, {
      0.29166666666666663`, 0.5, 0}, {0.25, 0.5, 0}, {
      0.25, 0.36111111111111105`, 0}, {
      0.3333333333333333, 0.08333333333333333, 0}}], 
    Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
      0.16666666666666666`, 0.9166666666666666, 0}, {
      0.08333333333333333, 0.9166666666666666, 0}, {
      0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
    Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
      0.41666666666666663`, 0.9166666666666666, 0}, {
      0.3333333333333333, 0.9166666666666666, 0}, {
      0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}], 
    GeometricTransformation3DBox[
     {FaceForm[RGBColor[0, 1, 0], RGBColor[1, 0, 1]], 
      Polygon3DBox[{{0.29166666666666663`, 0.08333333333333333, 0}, {
        0.29166666666666663`, 0.5, 0}, {0.20833333333333331`, 0.5, 0}, {
        0.20833333333333331`, 0.08333333333333333, 0}}], 
      Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
        0.16666666666666666`, 0.9166666666666666, 0}, {
        0.08333333333333333, 0.9166666666666666, 0}, {
        0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
      Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
        0.41666666666666663`, 0.9166666666666666, 0}, {
        0.3333333333333333, 0.9166666666666666, 0}, {
        0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}]}, {0.5, 0, 0}], 
    GeometricTransformation3DBox[
     {FaceForm[RGBColor[1, 0, 0], RGBColor[0, 1, 1]], 
      Polygon3DBox[{{0.16666666666666666`, 0.08333333333333333, 0}, {
        0.25, 0.36111111111111105`, 0}, {0.25, 0.5, 0}, {
        0.20833333333333331`, 0.5, 0}, {
        0.08333333333333333, 0.08333333333333333, 0}}], 
      Polygon3DBox[{{0.41666666666666663`, 0.08333333333333333, 0}, {
        0.29166666666666663`, 0.5, 0}, {0.25, 0.5, 0}, {
        0.25, 0.36111111111111105`, 0}, {
        0.3333333333333333, 0.08333333333333333, 0}}], 
      Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
        0.16666666666666666`, 0.9166666666666666, 0}, {
        0.08333333333333333, 0.9166666666666666, 0}, {
        0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
      Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
        0.41666666666666663`, 0.9166666666666666, 0}, {
        0.3333333333333333, 0.9166666666666666, 0}, {
        0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}], 
      GeometricTransformation3DBox[
       {FaceForm[RGBColor[0, 1, 0], RGBColor[1, 0, 1]], 
        Polygon3DBox[{{0.29166666666666663`, 0.08333333333333333, 0}, {
          0.29166666666666663`, 0.5, 0}, {0.20833333333333331`, 0.5, 0}, {
          0.20833333333333331`, 0.08333333333333333, 0}}], 
        Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
          0.16666666666666666`, 0.9166666666666666, 0}, {
          0.08333333333333333, 0.9166666666666666, 0}, {
          0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
        Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
          0.41666666666666663`, 0.9166666666666666, 0}, {
          0.3333333333333333, 0.9166666666666666, 0}, {
          0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}]}, {0.5, 0, 0}]}, {0, 
     0, 1}], GeometricTransformation3DBox[
     GeometricTransformation3DBox[
      GeometricTransformation3DBox[GeometricTransformation3DBox[
        {FaceForm[RGBColor[0, 0, 1], RGBColor[1, 1, 0]], 
         Polygon3DBox[{{0.41666666666666663`, 0.08333333333333333, 0}, {
           0.41666666666666663`, 0.16666666666666666`, 0}, {
           0.10833333333333334`, 0.16666666666666666`, 0}, {
           0.08333333333333333, 0.08333333333333333, 0}}], 
         Polygon3DBox[{{0.19166666666666665`, 0.16666666666666666`, 0}, {
           0.39166666666666666`, 0.8333333333333333, 0}, {
           0.30833333333333335`, 0.8333333333333333, 0}, {
           0.10833333333333334`, 0.16666666666666666`, 0}}], 
         Polygon3DBox[{{0.08333333333333333, 0.8333333333333333, 0}, {
           0.39166666666666666`, 0.8333333333333333, 0}, {
           0.41666666666666663`, 0.9166666666666666, 0}, {
           0.08333333333333333, 0.9166666666666666, 0}}], 
         GeometricTransformation3DBox[
          {FaceForm[RGBColor[1, 0, 0], RGBColor[0, 1, 1]], 
           Polygon3DBox[{{0.16666666666666666`, 0.08333333333333333, 0}, {
             0.25, 0.36111111111111105`, 0}, {0.25, 0.5, 0}, {
             0.20833333333333331`, 0.5, 0}, {
             0.08333333333333333, 0.08333333333333333, 0}}], 
           Polygon3DBox[{{0.41666666666666663`, 0.08333333333333333, 0}, {
             0.29166666666666663`, 0.5, 0}, {0.25, 0.5, 0}, {
             0.25, 0.36111111111111105`, 0}, {
             0.3333333333333333, 0.08333333333333333, 0}}], 
           Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
             0.16666666666666666`, 0.9166666666666666, 0}, {
             0.08333333333333333, 0.9166666666666666, 0}, {
             0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
           Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
             0.41666666666666663`, 0.9166666666666666, 0}, {
             0.3333333333333333, 0.9166666666666666, 0}, {
             0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}]}, {
          0.5, 0, 0}]}, {{1, 0, 0}, {0, 1, 0}, {0, 0, 1}}], {{1., 0., 0.}, {
       0., 6.123233995736766*^-17, -1.}, {0., 1., 
       6.123233995736766*^-17}}], {{-1., -1.2246467991473532`*^-16, 0.}, {
      1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}], {1, 0, 0}], 
    GeometricTransformation3DBox[
     GeometricTransformation3DBox[
      GeometricTransformation3DBox[
       GeometricTransformation3DBox[GeometricTransformation3DBox[
         {FaceForm[RGBColor[0, 0, 1], RGBColor[1, 1, 0]], 
          Polygon3DBox[{{0.41666666666666663`, 0.08333333333333333, 0}, {
            0.41666666666666663`, 0.16666666666666666`, 0}, {
            0.10833333333333334`, 0.16666666666666666`, 0}, {
            0.08333333333333333, 0.08333333333333333, 0}}], 
          Polygon3DBox[{{0.19166666666666665`, 0.16666666666666666`, 0}, {
            0.39166666666666666`, 0.8333333333333333, 0}, {
            0.30833333333333335`, 0.8333333333333333, 0}, {
            0.10833333333333334`, 0.16666666666666666`, 0}}], 
          Polygon3DBox[{{0.08333333333333333, 0.8333333333333333, 0}, {
            0.39166666666666666`, 0.8333333333333333, 0}, {
            0.41666666666666663`, 0.9166666666666666, 0}, {
            0.08333333333333333, 0.9166666666666666, 0}}], 
          GeometricTransformation3DBox[
           {FaceForm[RGBColor[1, 0, 0], RGBColor[0, 1, 1]], 
            Polygon3DBox[{{0.16666666666666666`, 0.08333333333333333, 0}, {
              0.25, 0.36111111111111105`, 0}, {0.25, 0.5, 0}, {
              0.20833333333333331`, 0.5, 0}, {
              0.08333333333333333, 0.08333333333333333, 0}}], 
            Polygon3DBox[{{0.41666666666666663`, 0.08333333333333333, 0}, {
              0.29166666666666663`, 0.5, 0}, {0.25, 0.5, 0}, {
              0.25, 0.36111111111111105`, 0}, {
              0.3333333333333333, 0.08333333333333333, 0}}], 
            Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
              0.16666666666666666`, 0.9166666666666666, 0}, {
              0.08333333333333333, 0.9166666666666666, 0}, {
              0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
            Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
              0.41666666666666663`, 0.9166666666666666, 0}, {
              0.3333333333333333, 0.9166666666666666, 0}, {
              0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}]}, {
           0.5, 0, 0}]}, {{1, 0, 0}, {0, 1, 0}, {0, 0, 1}}], {{1., 0., 0.}, {
        0., 6.123233995736766*^-17, -1.}, {0., 1., 
        6.123233995736766*^-17}}], {{-1., -1.2246467991473532`*^-16, 0.}, {
       1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}], {1, 0, 0}], {0, 1, 
     0}], GeometricTransformation3DBox[
     GeometricTransformation3DBox[GeometricTransformation3DBox[
       {FaceForm[RGBColor[0, 1, 0], RGBColor[1, 0, 1]], 
        Polygon3DBox[{{0.29166666666666663`, 0.08333333333333333, 0}, {
          0.29166666666666663`, 0.5, 0}, {0.20833333333333331`, 0.5, 0}, {
          0.20833333333333331`, 0.08333333333333333, 0}}], 
        Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
          0.16666666666666666`, 0.9166666666666666, 0}, {
          0.08333333333333333, 0.9166666666666666, 0}, {
          0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
        Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
          0.41666666666666663`, 0.9166666666666666, 0}, {
          0.3333333333333333, 0.9166666666666666, 0}, {
          0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}], 
        GeometricTransformation3DBox[
         {FaceForm[RGBColor[0, 0, 1], RGBColor[1, 1, 0]], 
          Polygon3DBox[{{0.41666666666666663`, 0.08333333333333333, 0}, {
            0.41666666666666663`, 0.16666666666666666`, 0}, {
            0.10833333333333334`, 0.16666666666666666`, 0}, {
            0.08333333333333333, 0.08333333333333333, 0}}], 
          Polygon3DBox[{{0.19166666666666665`, 0.16666666666666666`, 0}, {
            0.39166666666666666`, 0.8333333333333333, 0}, {
            0.30833333333333335`, 0.8333333333333333, 0}, {
            0.10833333333333334`, 0.16666666666666666`, 0}}], 
          Polygon3DBox[{{0.08333333333333333, 0.8333333333333333, 0}, {
            0.39166666666666666`, 0.8333333333333333, 0}, {
            0.41666666666666663`, 0.9166666666666666, 0}, {
            0.08333333333333333, 0.9166666666666666, 0}}]}, {
         0.5, 0, 0}]}, {{-1., -1.2246467991473532`*^-16, 0.}, {
       1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}], {{1., 0., 0.}, {0.,
       6.123233995736766*^-17, 1.}, {0., -1., 
      6.123233995736766*^-17}}], {{-1.8369701987210297`*^-16, 1., 
     0.}, {-1., -1.8369701987210297`*^-16, 0.}, {0., 0., 1.}}], 
    GeometricTransformation3DBox[
     GeometricTransformation3DBox[
      GeometricTransformation3DBox[GeometricTransformation3DBox[
        {FaceForm[RGBColor[0, 1, 0], RGBColor[1, 0, 1]], 
         Polygon3DBox[{{0.29166666666666663`, 0.08333333333333333, 0}, {
           0.29166666666666663`, 0.5, 0}, {0.20833333333333331`, 0.5, 0}, {
           0.20833333333333331`, 0.08333333333333333, 0}}], 
         Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
           0.16666666666666666`, 0.9166666666666666, 0}, {
           0.08333333333333333, 0.9166666666666666, 0}, {
           0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
         Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
           0.41666666666666663`, 0.9166666666666666, 0}, {
           0.3333333333333333, 0.9166666666666666, 0}, {
           0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}], 
         GeometricTransformation3DBox[
          {FaceForm[RGBColor[0, 0, 1], RGBColor[1, 1, 0]], 
           Polygon3DBox[{{0.41666666666666663`, 0.08333333333333333, 0}, {
             0.41666666666666663`, 0.16666666666666666`, 0}, {
             0.10833333333333334`, 0.16666666666666666`, 0}, {
             0.08333333333333333, 0.08333333333333333, 0}}], 
           Polygon3DBox[{{0.19166666666666665`, 0.16666666666666666`, 0}, {
             0.39166666666666666`, 0.8333333333333333, 0}, {
             0.30833333333333335`, 0.8333333333333333, 0}, {
             0.10833333333333334`, 0.16666666666666666`, 0}}], 
           Polygon3DBox[{{0.08333333333333333, 0.8333333333333333, 0}, {
             0.39166666666666666`, 0.8333333333333333, 0}, {
             0.41666666666666663`, 0.9166666666666666, 0}, {
             0.08333333333333333, 0.9166666666666666, 0}}]}, {
          0.5, 0, 0}]}, {{-1., -1.2246467991473532`*^-16, 0.}, {
        1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}], {{1., 0., 0.}, {
       0., 6.123233995736766*^-17, 1.}, {0., -1., 
       6.123233995736766*^-17}}], {{-1.8369701987210297`*^-16, 1., 
      0.}, {-1., -1.8369701987210297`*^-16, 0.}, {0., 0., 1.}}], {1, 0, 0}], 
    GeometricTransformation3DBox[GeometricTransformation3DBox[
      {FaceForm[GrayLevel[0.5]], 
       Polygon3DBox[{{0, 1, 0}, {1, 1, 0}, {1, 0, 0}, {0, 0, 0}}], 
       Polygon3DBox[{{0, 0, 1}, {1, 0, 1}, {1, 1, 1}, {0, 1, 1}}], 
       Polygon3DBox[{{0, 1, 1}, {1, 1, 1}, {1, 1, 0}, {0, 1, 0}}], 
       Polygon3DBox[{{0, 0, 0}, {1, 0, 0}, {1, 0, 1}, {0, 0, 1}}], 
       Polygon3DBox[{{0, 0, 1}, {0, 1, 1}, {0, 1, 0}, {0, 0, 0}}], 
       Polygon3DBox[{{1, 0, 0}, {1, 1, 0}, {1, 1, 1}, {1, 0, 1}}]}, {{{0.875, 
       0., 0.}, {0., 0.875, 0.}, {0., 0., 0.875}}, {0., 0., 0.}}], {0.0625, 
     0.0625, 0.0625}]}, {-0.5, -0.5, -0.5}],
  Axes->True,
  AxesLabel->{
    FormBox["\"x\"", TraditionalForm], 
    FormBox["\"y\"", TraditionalForm], 
    FormBox["\"z\"", TraditionalForm]},
  FaceGrids->All,
  ImageSize->Automatic,
  Lighting->"Neutral",
  ViewAngle->0.5151557224057146,
  ViewPoint->{-1.4524540955320975`, -2.8196298890885814`, 1.1790099189278929`},
  ViewVertical->{0.1648754010122891, -0.4213498557811014, 
   0.8917849523143357}]], "Output",
 CellChangeTimes->{3.633010371720147*^9, 3.633017858971115*^9, 
  3.633018201391775*^9, 3.6677378745325317`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Better Cubes", "Subsection",
 CellChangeTimes->{{3.6330161462363033`*^9, 3.6330161481884403`*^9}}],

Cell[TextData[{
 StyleBox["wcube",
  FontWeight->"Bold"],
 " (centered, colored, with black & grey labels)\n",
 StyleBox["xcube",
  FontWeight->"Bold"],
 " (wcube plus axes)\n",
 StyleBox["s3l2",
  FontWeight->"Bold"],
 " (axes, no grids, yes lighting)\n",
 StyleBox["s3p2",
  FontWeight->"Bold"],
 " (axes, no grids, no lighting)"
}], "Item",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],

Cell["\<\
Xcube is the main test-pattern object. It's a colored and labeled cube \
pierced with three colored axes.The axes are labeled:\
\>", "Text"],

Cell["\<\
Red = +x, Green = +y, Blue = +z, (evoking the usual orderings, RGB, XYZ);
Anti-Red = Cyan = -x, Anti-Green = Magenta = -y, Anti-Blue = Yellow = -z.\
\>", "Text"],

Cell["The faces are labeled : ", "Text"],

Cell["\<\
Red = YZ = normal-to-X, postive frame-rotation angles rotate axis Y toward \
axis Z
Green = ZX = normal-to-Y, positive frame-rotation angles rotate axis Z toward \
axis X
Blue = XY = normal-to-Z, position frame-rotation angles rotate axis X toward \
axis Y
Anti-Red = Cyan = ZY = anti-normal-to-X
Anti-Green = Magenta = XZ = anti-normal-to-Y
Anti-Blue = Yellow = YX = anti-normal-to-Z\
\>", "Text",
 CellChangeTimes->{{3.63301624509166*^9, 3.633016301719111*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"vcube", "=", "\[IndentingNewLine]", 
   RowBox[{"Translate", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FaceForm", "[", 
        RowBox[{"Blue", ",", "Yellow"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Polygon", "[", 
        RowBox[{"{", 
         RowBox[{"o", ",", 
          RowBox[{"e", "[", "1", "]"}], ",", 
          RowBox[{"a", "-", 
           RowBox[{"e", "[", "3", "]"}]}], ",", 
          RowBox[{"e", "[", "2", "]"}]}], "}"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Polygon", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"e", "[", "3", "]"}], ",", 
          RowBox[{"a", "-", 
           RowBox[{"e", "[", "2", "]"}]}], ",", "a", ",", 
          RowBox[{"a", "-", 
           RowBox[{"e", "[", "1", "]"}]}]}], "}"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"FaceForm", "[", 
        RowBox[{"Green", ",", "Magenta"}], "]"}], ",", 
       RowBox[{"Polygon", "[", 
        RowBox[{"Reverse", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"e", "[", "2", "]"}], ",", 
           RowBox[{"a", "-", 
            RowBox[{"e", "[", "3", "]"}]}], ",", "a", ",", 
           RowBox[{"a", "-", 
            RowBox[{"e", "[", "1", "]"}]}]}], "}"}], "]"}], "]"}], ",", 
       RowBox[{"Polygon", "[", 
        RowBox[{"Reverse", "[", 
         RowBox[{"{", 
          RowBox[{"o", ",", 
           RowBox[{"e", "[", "1", "]"}], ",", 
           RowBox[{"a", "-", 
            RowBox[{"e", "[", "2", "]"}]}], ",", 
           RowBox[{"e", "[", "3", "]"}]}], "}"}], "]"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"FaceForm", "[", 
        RowBox[{"Red", ",", "Cyan"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Polygon", "[", 
        RowBox[{"{", 
         RowBox[{"o", ",", 
          RowBox[{"e", "[", "2", "]"}], ",", 
          RowBox[{"a", "-", 
           RowBox[{"e", "[", "1", "]"}]}], ",", 
          RowBox[{"e", "[", "3", "]"}]}], "}"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Polygon", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"e", "[", "1", "]"}], ",", 
          RowBox[{"a", "-", 
           RowBox[{"e", "[", "3", "]"}]}], ",", "a", ",", 
          RowBox[{"a", "-", 
           RowBox[{"e", "[", "2", "]"}]}]}], "}"}], "]"}]}], "}"}], ",", 
     RowBox[{"c", "[", 
      RowBox[{"-", ".5"}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.429298352410907*^9, 3.4292985283747253`*^9}, {
  3.4292995577686567`*^9, 3.429299559607119*^9}, {3.4292997105071287`*^9, 
  3.429299764248459*^9}, {3.4292999657754173`*^9, 3.4293000485482273`*^9}, {
  3.429300700705142*^9, 3.4293008518828773`*^9}, {3.633016314166044*^9, 
  3.6330163476485977`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"s3p", "[", "vcube", "]"}]], "Input",
 CellChangeTimes->{{3.4292985341236057`*^9, 3.429298538592112*^9}}],

Cell[BoxData[
 Graphics3DBox[GeometricTransformation3DBox[{
    {FaceForm[RGBColor[0, 0, 1], RGBColor[1, 1, 0]], 
     Polygon3DBox[{{0, 0, 0}, {1, 0, 0}, {1, 1, 0}, {0, 1, 0}}], 
     Polygon3DBox[{{0, 0, 1}, {1, 0, 1}, {1, 1, 1}, {0, 1, 1}}]}, 
    {FaceForm[RGBColor[0, 1, 0], RGBColor[1, 0, 1]], 
     Polygon3DBox[{{0, 1, 1}, {1, 1, 1}, {1, 1, 0}, {0, 1, 0}}], 
     Polygon3DBox[{{0, 0, 1}, {1, 0, 1}, {1, 0, 0}, {0, 0, 0}}]}, 
    {FaceForm[RGBColor[1, 0, 0], RGBColor[0, 1, 1]], 
     Polygon3DBox[{{0, 0, 0}, {0, 1, 0}, {0, 1, 1}, {0, 0, 1}}], 
     Polygon3DBox[{{1, 0, 0}, {1, 1, 0}, {1, 1, 1}, {1, 0, 
      1}}]}}, {-0.5, -0.5, -0.5}],
  Axes->True,
  AxesLabel->{
    FormBox["\"x\"", TraditionalForm], 
    FormBox["\"y\"", TraditionalForm], 
    FormBox["\"z\"", TraditionalForm]},
  FaceGrids->All,
  ImageSize->Automatic,
  Lighting->"Neutral"]], "Output",
 CellChangeTimes->{3.633016359680936*^9, 3.6330178590100327`*^9, 
  3.633018201469058*^9, 3.667737874870887*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"faceLabels", "=", "\[IndentingNewLine]", 
   RowBox[{"Translate", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Translate", "[", 
        RowBox[{
         RowBox[{"Rotate3", "[", 
          RowBox[{"zxshape", ",", "Pi", ",", 
           RowBox[{"Pi", "/", "2"}], ",", "0"}], "]"}], ",", " ", 
         RowBox[{"e", "[", "1", "]"}]}], "]"}], ",", 
       RowBox[{"Translate", "[", 
        RowBox[{
         RowBox[{"Rotate3", "[", 
          RowBox[{"zxshape", ",", "Pi", ",", 
           RowBox[{"Pi", "/", "2"}], ",", "0"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1", ",", "0"}], "}"}]}], "]"}], ",", 
       RowBox[{"Rotate3", "[", 
        RowBox[{"yzshape", ",", "0", ",", 
         RowBox[{
          RowBox[{"-", "Pi"}], "/", "2"}], ",", 
         RowBox[{
          RowBox[{"-", "Pi"}], "/", "2"}]}], "]"}], ",", 
       RowBox[{"Translate", "[", 
        RowBox[{
         RowBox[{"Rotate3", "[", 
          RowBox[{"yzshape", ",", "0", ",", 
           RowBox[{
            RowBox[{"-", "Pi"}], "/", "2"}], ",", 
           RowBox[{
            RowBox[{"-", "Pi"}], "/", "2"}]}], "]"}], ",", 
         RowBox[{"e", "[", "1", "]"}]}], "]"}], ",", "xyshape", ",", 
       RowBox[{"Translate", "[", 
        RowBox[{"xyshape", ",", 
         RowBox[{"e", "[", "3", "]"}]}], "]"}]}], "}"}], ",", 
     RowBox[{"c", "[", 
      RowBox[{"-", ".5"}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.387806125139502*^9, {3.3878197436940565`*^9, 3.3878197862565565`*^9}, {
   3.387819825365932*^9, 3.3878198439440565`*^9}, {3.429298568379612*^9, 
   3.429298617319653*^9}, {3.429299710514879*^9, 3.429299710516789*^9}, 
   3.4292997642503223`*^9, 3.429300883925252*^9, {3.6330163141912107`*^9, 
   3.633016347652176*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"x2pols", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"FaceForm", "[", 
      RowBox[{"Black", ",", "Gray"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Polygon", "[", 
      RowBox[{"Reverse", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"2.5", ",", "6", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"3", ",", "6", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"3", ",", 
            RowBox[{"4", "+", 
             RowBox[{"1", "/", "3"}]}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"2", ",", "1", ",", "0"}], "}"}]}], "}"}], "/", "12."}], 
       "]"}], "]"}], ",", 
     RowBox[{"Polygon", "[", 
      RowBox[{"Reverse", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"4", ",", "1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"3", ",", 
            RowBox[{"4", "+", 
             RowBox[{"1", "/", "3"}]}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"3", ",", "6", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"3.5", ",", "6", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"5", ",", "1", ",", "0"}], "}"}]}], "}"}], "/", "12."}], 
       "]"}], "]"}], ",", 
     RowBox[{"Polygon", "[", 
      RowBox[{"Reverse", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"3", ",", "6", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"2.5", ",", "6", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "11", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"2", ",", "11", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"3", ",", 
            RowBox[{"7", "+", 
             RowBox[{"2", "/", "3"}]}], ",", "0"}], "}"}]}], "}"}], "/", 
        "12."}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Polygon", "[", 
      RowBox[{"Reverse", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"3", ",", "6", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"3", ",", 
            RowBox[{"7", "+", 
             RowBox[{"2", "/", "3"}]}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"4", ",", "11", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"5", ",", "11", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"3.5", ",", "6", ",", "0"}], "}"}]}], "}"}], "/", "12."}], 
       "]"}], "]"}]}], "}"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.387806125139502*^9, {3.3878197436940565`*^9, 3.3878197862565565`*^9}, {
   3.387819825365932*^9, 3.3878198439440565`*^9}, {3.429298664354766*^9, 
   3.4292987610241213`*^9}, {3.429300178896347*^9, 3.4293002060544977`*^9}, 
   3.4293002523719807`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"y2pols", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"FaceForm", "[", 
      RowBox[{"Black", ",", "Gray"}], "]"}], ",", 
     RowBox[{"Polygon", "[", 
      RowBox[{"Reverse", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"2.5", ",", "1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"2.5", ",", "6", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"3.5", ",", "6", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"3.5", ",", "1", ",", "0"}], "}"}]}], "}"}], "/", "12."}], 
       "]"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Polygon", "[", 
      RowBox[{"Reverse", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"3", ",", "6", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"2.5", ",", "6", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "11", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"2", ",", "11", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"3", ",", 
            RowBox[{"7", "+", 
             RowBox[{"2", "/", "3"}]}], ",", "0"}], "}"}]}], "}"}], "/", 
        "12."}], "]"}], "]"}], ",", 
     RowBox[{"Polygon", "[", 
      RowBox[{"Reverse", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"3", ",", "6", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"3", ",", 
            RowBox[{"7", "+", 
             RowBox[{"2", "/", "3"}]}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"4", ",", "11", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"5", ",", "11", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"3.5", ",", "6", ",", "0"}], "}"}]}], "}"}], "/", "12."}], 
       "]"}], "]"}]}], "}"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.387806125139502*^9, {3.3878197436940565`*^9, 3.3878197862565565`*^9}, {
   3.387819825365932*^9, 3.3878198439440565`*^9}, {3.429298780684943*^9, 
   3.42929882793526*^9}, 3.429300178609563*^9, 3.429300252406322*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"z2pols", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"FaceForm", "[", 
      RowBox[{"Black", ",", "Gray"}], "]"}], ",", 
     RowBox[{"Polygon", "[", 
      RowBox[{"Reverse", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1.3", ",", "2", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"5", ",", "2", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"5", ",", "1", ",", "0"}], "}"}]}], "}"}], "/", "12."}], 
       "]"}], "]"}], ",", 
     RowBox[{"Polygon", "[", 
      RowBox[{"Reverse", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1.3", ",", "2", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"3.7", ",", "10", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"4.7", ",", "10", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"2.3", ",", "2", ",", "0"}], "}"}]}], "}"}], "/", "12."}], 
       "]"}], "]"}], ",", 
     RowBox[{"Polygon", "[", 
      RowBox[{"Reverse", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "11", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"5", ",", "11", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"4.7", ",", "10", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "10", ",", "0"}], "}"}]}], "}"}], "/", "12."}], 
       "]"}], "]"}]}], "}"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.387806125139502*^9, {3.3878197436940565`*^9, 3.3878197862565565`*^9}, {
   3.387819825365932*^9, 3.3878198439440565`*^9}, {3.429298855398934*^9, 
   3.429298883721375*^9}, 3.429300178746277*^9, 3.429300252441092*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"xy2p", "=", 
   RowBox[{"combp", "[", 
    RowBox[{"x2pols", ",", "y2pols"}], "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.387806125139502*^9, {3.3878197436940565`*^9, 3.3878197862565565`*^9}, {
   3.387819825365932*^9, 3.3878198439440565`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"yz2p", "=", 
   RowBox[{"combp", "[", 
    RowBox[{"y2pols", ",", "z2pols"}], "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.387806125139502*^9, {3.3878197436940565`*^9, 3.3878197862565565`*^9}, {
   3.387819825365932*^9, 3.3878198439440565`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"zx2p", "=", 
   RowBox[{"combp", "[", 
    RowBox[{"z2pols", ",", "x2pols"}], "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.387806125139502*^9, {3.3878197436940565`*^9, 3.3878197862565565`*^9}, {
   3.387819825365932*^9, 3.3878198439440565`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"face2labels", "=", "\[IndentingNewLine]", 
   RowBox[{"Translate", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Translate", "[", 
        RowBox[{
         RowBox[{"Rotate3", "[", 
          RowBox[{"zx2p", ",", "Pi", ",", 
           RowBox[{"Pi", "/", "2"}], ",", "0"}], "]"}], ",", " ", 
         RowBox[{"e", "[", "1", "]"}]}], "]"}], ",", 
       RowBox[{"Translate", "[", 
        RowBox[{
         RowBox[{"Rotate3", "[", 
          RowBox[{"zx2p", ",", "Pi", ",", 
           RowBox[{"Pi", "/", "2"}], ",", "0"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1", ",", "0"}], "}"}]}], "]"}], ",", 
       RowBox[{"Rotate3", "[", 
        RowBox[{"yz2p", ",", "0", ",", 
         RowBox[{
          RowBox[{"-", "Pi"}], "/", "2"}], ",", 
         RowBox[{
          RowBox[{"-", "Pi"}], "/", "2"}]}], "]"}], ",", 
       RowBox[{"Translate", "[", 
        RowBox[{
         RowBox[{"Rotate3", "[", 
          RowBox[{"yz2p", ",", "0", ",", 
           RowBox[{
            RowBox[{"-", "Pi"}], "/", "2"}], ",", 
           RowBox[{
            RowBox[{"-", "Pi"}], "/", "2"}]}], "]"}], ",", 
         RowBox[{"e", "[", "1", "]"}]}], "]"}], ",", "xy2p", ",", 
       RowBox[{"Translate", "[", 
        RowBox[{"xy2p", ",", 
         RowBox[{"e", "[", "3", "]"}]}], "]"}]}], "}"}], ",", 
     RowBox[{"c", "[", 
      RowBox[{"-", ".5"}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.387806125139502*^9, {3.3878197436940565`*^9, 3.3878197862565565`*^9}, {
   3.387819825365932*^9, 3.3878198439440565`*^9}, {3.429298915588889*^9, 
   3.4292989659710693`*^9}, {3.429299710521079*^9, 3.429299710523006*^9}, 
   3.429299764252067*^9, {3.429300146362661*^9, 3.429300156242025*^9}, {
   3.63301631419652*^9, 3.633016347655772*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"wcube", "=", 
   RowBox[{"Chop", "[", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Scale", "[", 
        RowBox[{"vcube", ",", 
         RowBox[{"c", "[", "0.99", "]"}], ",", "o"}], "]"}], "}"}], ",", 
      RowBox[{"{", "face2labels", "}"}]}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.429299000581994*^9, 3.429299052315996*^9}, {
  3.429299186146402*^9, 3.429299191242271*^9}, {3.6330163360244017`*^9, 
  3.633016347660145*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"s3p", "[", "wcube", "]"}]], "Input",
 CellChangeTimes->{{3.4292990384686737`*^9, 3.4292990423361387`*^9}}],

Cell[BoxData[
 Graphics3DBox[{GeometricTransformation3DBox[GeometricTransformation3DBox[{
      {FaceForm[RGBColor[0, 0, 1], RGBColor[1, 1, 0]], 
       Polygon3DBox[{{0, 0, 0}, {1, 0, 0}, {1, 1, 0}, {0, 1, 0}}], 
       Polygon3DBox[{{0, 0, 1}, {1, 0, 1}, {1, 1, 1}, {0, 1, 1}}]}, 
      {FaceForm[RGBColor[0, 1, 0], RGBColor[1, 0, 1]], 
       Polygon3DBox[{{0, 1, 1}, {1, 1, 1}, {1, 1, 0}, {0, 1, 0}}], 
       Polygon3DBox[{{0, 0, 1}, {1, 0, 1}, {1, 0, 0}, {0, 0, 0}}]}, 
      {FaceForm[RGBColor[1, 0, 0], RGBColor[0, 1, 1]], 
       Polygon3DBox[{{0, 0, 0}, {0, 1, 0}, {0, 1, 1}, {0, 0, 1}}], 
       Polygon3DBox[{{1, 0, 0}, {1, 1, 0}, {1, 1, 1}, {1, 0, 
        1}}]}}, {-0.5, -0.5, -0.5}], {{{0.99, 0., 0.}, {0., 0.99, 0.}, {0., 
     0., 0.99}}, {0., 0., 0.}}], 
   GeometricTransformation3DBox[{
     GeometricTransformation3DBox[
      GeometricTransformation3DBox[
       GeometricTransformation3DBox[GeometricTransformation3DBox[
         {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
          Polygon3DBox[{{0.41666666666666663`, 0.08333333333333333, 0}, {
            0.41666666666666663`, 0.16666666666666666`, 0}, {
            0.10833333333333334`, 0.16666666666666666`, 0}, {
            0.08333333333333333, 0.08333333333333333, 0}}], 
          Polygon3DBox[{{0.19166666666666665`, 0.16666666666666666`, 0}, {
            0.39166666666666666`, 0.8333333333333333, 0}, {
            0.30833333333333335`, 0.8333333333333333, 0}, {
            0.10833333333333334`, 0.16666666666666666`, 0}}], 
          Polygon3DBox[{{0.08333333333333333, 0.8333333333333333, 0}, {
            0.39166666666666666`, 0.8333333333333333, 0}, {
            0.41666666666666663`, 0.9166666666666666, 0}, {
            0.08333333333333333, 0.9166666666666666, 0}}], 
          GeometricTransformation3DBox[
           {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
            Polygon3DBox[{{0.16666666666666666`, 0.08333333333333333, 0}, {
              0.25, 0.36111111111111105`, 0}, {0.25, 0.5, 0}, {
              0.20833333333333331`, 0.5, 0}, {
              0.08333333333333333, 0.08333333333333333, 0}}], 
            Polygon3DBox[{{0.41666666666666663`, 0.08333333333333333, 0}, {
              0.29166666666666663`, 0.5, 0}, {0.25, 0.5, 0}, {
              0.25, 0.36111111111111105`, 0}, {
              0.3333333333333333, 0.08333333333333333, 0}}], 
            Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
              0.16666666666666666`, 0.9166666666666666, 0}, {
              0.08333333333333333, 0.9166666666666666, 0}, {
              0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
            Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
              0.41666666666666663`, 0.9166666666666666, 0}, {
              0.3333333333333333, 0.9166666666666666, 0}, {
              0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}]}, {
           0.5, 0, 0}]}, {{1, 0, 0}, {0, 1, 0}, {0, 0, 1}}], {{1, 0, 0}, {0, 
        0, -1}, {0, 1, 0}}], {{-1., -1.2246467991473532`*^-16, 0.}, {
       1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}], {1, 0, 0}], 
     GeometricTransformation3DBox[
      GeometricTransformation3DBox[
       GeometricTransformation3DBox[GeometricTransformation3DBox[
         {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
          Polygon3DBox[{{0.41666666666666663`, 0.08333333333333333, 0}, {
            0.41666666666666663`, 0.16666666666666666`, 0}, {
            0.10833333333333334`, 0.16666666666666666`, 0}, {
            0.08333333333333333, 0.08333333333333333, 0}}], 
          Polygon3DBox[{{0.19166666666666665`, 0.16666666666666666`, 0}, {
            0.39166666666666666`, 0.8333333333333333, 0}, {
            0.30833333333333335`, 0.8333333333333333, 0}, {
            0.10833333333333334`, 0.16666666666666666`, 0}}], 
          Polygon3DBox[{{0.08333333333333333, 0.8333333333333333, 0}, {
            0.39166666666666666`, 0.8333333333333333, 0}, {
            0.41666666666666663`, 0.9166666666666666, 0}, {
            0.08333333333333333, 0.9166666666666666, 0}}], 
          GeometricTransformation3DBox[
           {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
            Polygon3DBox[{{0.16666666666666666`, 0.08333333333333333, 0}, {
              0.25, 0.36111111111111105`, 0}, {0.25, 0.5, 0}, {
              0.20833333333333331`, 0.5, 0}, {
              0.08333333333333333, 0.08333333333333333, 0}}], 
            Polygon3DBox[{{0.41666666666666663`, 0.08333333333333333, 0}, {
              0.29166666666666663`, 0.5, 0}, {0.25, 0.5, 0}, {
              0.25, 0.36111111111111105`, 0}, {
              0.3333333333333333, 0.08333333333333333, 0}}], 
            Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
              0.16666666666666666`, 0.9166666666666666, 0}, {
              0.08333333333333333, 0.9166666666666666, 0}, {
              0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
            Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
              0.41666666666666663`, 0.9166666666666666, 0}, {
              0.3333333333333333, 0.9166666666666666, 0}, {
              0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}]}, {
           0.5, 0, 0}]}, {{1, 0, 0}, {0, 1, 0}, {0, 0, 1}}], {{1, 0, 0}, {0, 
        0, -1}, {0, 1, 0}}], {{-1., -1.2246467991473532`*^-16, 0.}, {
       1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}], {1, 1, 0}], 
     GeometricTransformation3DBox[
      GeometricTransformation3DBox[GeometricTransformation3DBox[
        {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
         Polygon3DBox[{{0.29166666666666663`, 0.08333333333333333, 0}, {
           0.29166666666666663`, 0.5, 0}, {0.20833333333333331`, 0.5, 0}, {
           0.20833333333333331`, 0.08333333333333333, 0}}], 
         Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
           0.16666666666666666`, 0.9166666666666666, 0}, {
           0.08333333333333333, 0.9166666666666666, 0}, {
           0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
         Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
           0.41666666666666663`, 0.9166666666666666, 0}, {
           0.3333333333333333, 0.9166666666666666, 0}, {
           0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}], 
         GeometricTransformation3DBox[
          {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
           Polygon3DBox[{{0.41666666666666663`, 0.08333333333333333, 0}, {
             0.41666666666666663`, 0.16666666666666666`, 0}, {
             0.10833333333333334`, 0.16666666666666666`, 0}, {
             0.08333333333333333, 0.08333333333333333, 0}}], 
           Polygon3DBox[{{0.19166666666666665`, 0.16666666666666666`, 0}, {
             0.39166666666666666`, 0.8333333333333333, 0}, {
             0.30833333333333335`, 0.8333333333333333, 0}, {
             0.10833333333333334`, 0.16666666666666666`, 0}}], 
           Polygon3DBox[{{0.08333333333333333, 0.8333333333333333, 0}, {
             0.39166666666666666`, 0.8333333333333333, 0}, {
             0.41666666666666663`, 0.9166666666666666, 0}, {
             0.08333333333333333, 0.9166666666666666, 0}}]}, {
          0.5, 0, 0}]}, {{-1., -1.2246467991473532`*^-16, 0.}, {
        1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}], {{1, 0, 0}, {0, 0,
        1}, {0, -1, 0}}], {{-1.8369701987210297`*^-16, 1., 
      0.}, {-1., -1.8369701987210297`*^-16, 0.}, {0., 0., 1.}}], 
     GeometricTransformation3DBox[
      GeometricTransformation3DBox[
       GeometricTransformation3DBox[GeometricTransformation3DBox[
         {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
          Polygon3DBox[{{0.29166666666666663`, 0.08333333333333333, 0}, {
            0.29166666666666663`, 0.5, 0}, {0.20833333333333331`, 0.5, 0}, {
            0.20833333333333331`, 0.08333333333333333, 0}}], 
          Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
            0.16666666666666666`, 0.9166666666666666, 0}, {
            0.08333333333333333, 0.9166666666666666, 0}, {
            0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
          Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
            0.41666666666666663`, 0.9166666666666666, 0}, {
            0.3333333333333333, 0.9166666666666666, 0}, {
            0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}], 
          GeometricTransformation3DBox[
           {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
            Polygon3DBox[{{0.41666666666666663`, 0.08333333333333333, 0}, {
              0.41666666666666663`, 0.16666666666666666`, 0}, {
              0.10833333333333334`, 0.16666666666666666`, 0}, {
              0.08333333333333333, 0.08333333333333333, 0}}], 
            Polygon3DBox[{{0.19166666666666665`, 0.16666666666666666`, 0}, {
              0.39166666666666666`, 0.8333333333333333, 0}, {
              0.30833333333333335`, 0.8333333333333333, 0}, {
              0.10833333333333334`, 0.16666666666666666`, 0}}], 
            Polygon3DBox[{{0.08333333333333333, 0.8333333333333333, 0}, {
              0.39166666666666666`, 0.8333333333333333, 0}, {
              0.41666666666666663`, 0.9166666666666666, 0}, {
              0.08333333333333333, 0.9166666666666666, 0}}]}, {
           0.5, 0, 0}]}, {{-1., -1.2246467991473532`*^-16, 0.}, {
         1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}], {{1, 0, 0}, {0, 
        0, 1}, {0, -1, 0}}], {{-1.8369701987210297`*^-16, 1., 
       0.}, {-1., -1.8369701987210297`*^-16, 0.}, {0., 0., 1.}}], {1, 0, 
      0}], 
     {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
      Polygon3DBox[{{0.16666666666666666`, 0.08333333333333333, 0}, {
        0.25, 0.36111111111111105`, 0}, {0.25, 0.5, 0}, {
        0.20833333333333331`, 0.5, 0}, {
        0.08333333333333333, 0.08333333333333333, 0}}], 
      Polygon3DBox[{{0.41666666666666663`, 0.08333333333333333, 0}, {
        0.29166666666666663`, 0.5, 0}, {0.25, 0.5, 0}, {
        0.25, 0.36111111111111105`, 0}, {
        0.3333333333333333, 0.08333333333333333, 0}}], 
      Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
        0.16666666666666666`, 0.9166666666666666, 0}, {
        0.08333333333333333, 0.9166666666666666, 0}, {
        0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
      Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
        0.41666666666666663`, 0.9166666666666666, 0}, {
        0.3333333333333333, 0.9166666666666666, 0}, {
        0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}], 
      GeometricTransformation3DBox[
       {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
        Polygon3DBox[{{0.29166666666666663`, 0.08333333333333333, 0}, {
          0.29166666666666663`, 0.5, 0}, {0.20833333333333331`, 0.5, 0}, {
          0.20833333333333331`, 0.08333333333333333, 0}}], 
        Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
          0.16666666666666666`, 0.9166666666666666, 0}, {
          0.08333333333333333, 0.9166666666666666, 0}, {
          0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
        Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
          0.41666666666666663`, 0.9166666666666666, 0}, {
          0.3333333333333333, 0.9166666666666666, 0}, {
          0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}]}, {0.5, 0, 0}]}, 
     GeometricTransformation3DBox[
      {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
       Polygon3DBox[{{0.16666666666666666`, 0.08333333333333333, 0}, {
         0.25, 0.36111111111111105`, 0}, {0.25, 0.5, 0}, {
         0.20833333333333331`, 0.5, 0}, {
         0.08333333333333333, 0.08333333333333333, 0}}], 
       Polygon3DBox[{{0.41666666666666663`, 0.08333333333333333, 0}, {
         0.29166666666666663`, 0.5, 0}, {0.25, 0.5, 0}, {
         0.25, 0.36111111111111105`, 0}, {
         0.3333333333333333, 0.08333333333333333, 0}}], 
       Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
         0.16666666666666666`, 0.9166666666666666, 0}, {
         0.08333333333333333, 0.9166666666666666, 0}, {
         0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
       Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
         0.41666666666666663`, 0.9166666666666666, 0}, {
         0.3333333333333333, 0.9166666666666666, 0}, {
         0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}], 
       GeometricTransformation3DBox[
        {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
         Polygon3DBox[{{0.29166666666666663`, 0.08333333333333333, 0}, {
           0.29166666666666663`, 0.5, 0}, {0.20833333333333331`, 0.5, 0}, {
           0.20833333333333331`, 0.08333333333333333, 0}}], 
         Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
           0.16666666666666666`, 0.9166666666666666, 0}, {
           0.08333333333333333, 0.9166666666666666, 0}, {
           0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
         Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
           0.41666666666666663`, 0.9166666666666666, 0}, {
           0.3333333333333333, 0.9166666666666666, 0}, {
           0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}]}, {0.5, 0, 0}]}, {0,
       0, 1}]}, {-0.5, -0.5, -0.5}]},
  Axes->True,
  AxesLabel->{
    FormBox["\"x\"", TraditionalForm], 
    FormBox["\"y\"", TraditionalForm], 
    FormBox["\"z\"", TraditionalForm]},
  FaceGrids->All,
  ImageSize->Automatic,
  Lighting->"Neutral"]], "Output",
 CellChangeTimes->{3.6330163735735064`*^9, 3.6330178591394043`*^9, 
  3.633018201609399*^9, 3.667737875049239*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"s3p2", "=", 
   RowBox[{
    RowBox[{"Graphics3D", "[", 
     RowBox[{"#1", ",", "\[IndentingNewLine]", 
      RowBox[{"Boxed", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Axes", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
      RowBox[{"AxesLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], "}"}]}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ImageSize", "\[Rule]", "Automatic"}]}], "]"}], "&"}]}], 
  ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.387366323200018*^9, 3.387806125139502*^9, {3.3878197436940565`*^9, 
   3.3878197862565565`*^9}, {3.387819825365932*^9, 3.3878198439440565`*^9}, {
   3.42929931558801*^9, 3.429299339977209*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"s3l2", "=", 
   RowBox[{
    RowBox[{"Graphics3D", "[", 
     RowBox[{"#1", ",", "\[IndentingNewLine]", 
      RowBox[{"Boxed", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Axes", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
      RowBox[{"AxesLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], "}"}]}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ImageSize", "\[Rule]", "Automatic"}]}], "]"}], "&"}]}], 
  ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.3878196537878065`*^9, 3.387819657897182*^9}, {
  3.387819760647182*^9, 3.3878197862565565`*^9}, {3.387819825365932*^9, 
  3.3878198439440565`*^9}, {3.429299363495051*^9, 3.4292993806844378`*^9}}],

Cell[BoxData[
 RowBox[{"s3l2", "[", "wcube", "]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.387366350298984*^9, 3.387806125139502*^9, 3.387819665303432*^9, {
   3.387819760647182*^9, 3.3878197862565565`*^9}, {3.387819825365932*^9, 
   3.3878198439440565`*^9}}]
}, Open  ]],

Cell[BoxData[
 Graphics3DBox[{GeometricTransformation3DBox[GeometricTransformation3DBox[{
      {FaceForm[RGBColor[0, 0, 1], RGBColor[1, 1, 0]], 
       Polygon3DBox[{{0, 0, 0}, {1, 0, 0}, {1, 1, 0}, {0, 1, 0}}], 
       Polygon3DBox[{{0, 0, 1}, {1, 0, 1}, {1, 1, 1}, {0, 1, 1}}]}, 
      {FaceForm[RGBColor[0, 1, 0], RGBColor[1, 0, 1]], 
       Polygon3DBox[{{0, 1, 1}, {1, 1, 1}, {1, 1, 0}, {0, 1, 0}}], 
       Polygon3DBox[{{0, 0, 1}, {1, 0, 1}, {1, 0, 0}, {0, 0, 0}}]}, 
      {FaceForm[RGBColor[1, 0, 0], RGBColor[0, 1, 1]], 
       Polygon3DBox[{{0, 0, 0}, {0, 1, 0}, {0, 1, 1}, {0, 0, 1}}], 
       Polygon3DBox[{{1, 0, 0}, {1, 1, 0}, {1, 1, 1}, {1, 0, 
        1}}]}}, {-0.5, -0.5, -0.5}], {{{0.99, 0., 0.}, {0., 0.99, 0.}, {0., 
     0., 0.99}}, {0., 0., 0.}}], 
   GeometricTransformation3DBox[{
     GeometricTransformation3DBox[
      GeometricTransformation3DBox[
       GeometricTransformation3DBox[GeometricTransformation3DBox[
         {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
          Polygon3DBox[{{0.41666666666666663`, 0.08333333333333333, 0}, {
            0.41666666666666663`, 0.16666666666666666`, 0}, {
            0.10833333333333334`, 0.16666666666666666`, 0}, {
            0.08333333333333333, 0.08333333333333333, 0}}], 
          Polygon3DBox[{{0.19166666666666665`, 0.16666666666666666`, 0}, {
            0.39166666666666666`, 0.8333333333333333, 0}, {
            0.30833333333333335`, 0.8333333333333333, 0}, {
            0.10833333333333334`, 0.16666666666666666`, 0}}], 
          Polygon3DBox[{{0.08333333333333333, 0.8333333333333333, 0}, {
            0.39166666666666666`, 0.8333333333333333, 0}, {
            0.41666666666666663`, 0.9166666666666666, 0}, {
            0.08333333333333333, 0.9166666666666666, 0}}], 
          GeometricTransformation3DBox[
           {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
            Polygon3DBox[{{0.16666666666666666`, 0.08333333333333333, 0}, {
              0.25, 0.36111111111111105`, 0}, {0.25, 0.5, 0}, {
              0.20833333333333331`, 0.5, 0}, {
              0.08333333333333333, 0.08333333333333333, 0}}], 
            Polygon3DBox[{{0.41666666666666663`, 0.08333333333333333, 0}, {
              0.29166666666666663`, 0.5, 0}, {0.25, 0.5, 0}, {
              0.25, 0.36111111111111105`, 0}, {
              0.3333333333333333, 0.08333333333333333, 0}}], 
            Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
              0.16666666666666666`, 0.9166666666666666, 0}, {
              0.08333333333333333, 0.9166666666666666, 0}, {
              0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
            Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
              0.41666666666666663`, 0.9166666666666666, 0}, {
              0.3333333333333333, 0.9166666666666666, 0}, {
              0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}]}, {
           0.5, 0, 0}]}, {{1, 0, 0}, {0, 1, 0}, {0, 0, 1}}], {{1, 0, 0}, {0, 
        0, -1}, {0, 1, 0}}], {{-1., -1.2246467991473532`*^-16, 0.}, {
       1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}], {1, 0, 0}], 
     GeometricTransformation3DBox[
      GeometricTransformation3DBox[
       GeometricTransformation3DBox[GeometricTransformation3DBox[
         {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
          Polygon3DBox[{{0.41666666666666663`, 0.08333333333333333, 0}, {
            0.41666666666666663`, 0.16666666666666666`, 0}, {
            0.10833333333333334`, 0.16666666666666666`, 0}, {
            0.08333333333333333, 0.08333333333333333, 0}}], 
          Polygon3DBox[{{0.19166666666666665`, 0.16666666666666666`, 0}, {
            0.39166666666666666`, 0.8333333333333333, 0}, {
            0.30833333333333335`, 0.8333333333333333, 0}, {
            0.10833333333333334`, 0.16666666666666666`, 0}}], 
          Polygon3DBox[{{0.08333333333333333, 0.8333333333333333, 0}, {
            0.39166666666666666`, 0.8333333333333333, 0}, {
            0.41666666666666663`, 0.9166666666666666, 0}, {
            0.08333333333333333, 0.9166666666666666, 0}}], 
          GeometricTransformation3DBox[
           {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
            Polygon3DBox[{{0.16666666666666666`, 0.08333333333333333, 0}, {
              0.25, 0.36111111111111105`, 0}, {0.25, 0.5, 0}, {
              0.20833333333333331`, 0.5, 0}, {
              0.08333333333333333, 0.08333333333333333, 0}}], 
            Polygon3DBox[{{0.41666666666666663`, 0.08333333333333333, 0}, {
              0.29166666666666663`, 0.5, 0}, {0.25, 0.5, 0}, {
              0.25, 0.36111111111111105`, 0}, {
              0.3333333333333333, 0.08333333333333333, 0}}], 
            Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
              0.16666666666666666`, 0.9166666666666666, 0}, {
              0.08333333333333333, 0.9166666666666666, 0}, {
              0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
            Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
              0.41666666666666663`, 0.9166666666666666, 0}, {
              0.3333333333333333, 0.9166666666666666, 0}, {
              0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}]}, {
           0.5, 0, 0}]}, {{1, 0, 0}, {0, 1, 0}, {0, 0, 1}}], {{1, 0, 0}, {0, 
        0, -1}, {0, 1, 0}}], {{-1., -1.2246467991473532`*^-16, 0.}, {
       1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}], {1, 1, 0}], 
     GeometricTransformation3DBox[
      GeometricTransformation3DBox[GeometricTransformation3DBox[
        {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
         Polygon3DBox[{{0.29166666666666663`, 0.08333333333333333, 0}, {
           0.29166666666666663`, 0.5, 0}, {0.20833333333333331`, 0.5, 0}, {
           0.20833333333333331`, 0.08333333333333333, 0}}], 
         Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
           0.16666666666666666`, 0.9166666666666666, 0}, {
           0.08333333333333333, 0.9166666666666666, 0}, {
           0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
         Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
           0.41666666666666663`, 0.9166666666666666, 0}, {
           0.3333333333333333, 0.9166666666666666, 0}, {
           0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}], 
         GeometricTransformation3DBox[
          {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
           Polygon3DBox[{{0.41666666666666663`, 0.08333333333333333, 0}, {
             0.41666666666666663`, 0.16666666666666666`, 0}, {
             0.10833333333333334`, 0.16666666666666666`, 0}, {
             0.08333333333333333, 0.08333333333333333, 0}}], 
           Polygon3DBox[{{0.19166666666666665`, 0.16666666666666666`, 0}, {
             0.39166666666666666`, 0.8333333333333333, 0}, {
             0.30833333333333335`, 0.8333333333333333, 0}, {
             0.10833333333333334`, 0.16666666666666666`, 0}}], 
           Polygon3DBox[{{0.08333333333333333, 0.8333333333333333, 0}, {
             0.39166666666666666`, 0.8333333333333333, 0}, {
             0.41666666666666663`, 0.9166666666666666, 0}, {
             0.08333333333333333, 0.9166666666666666, 0}}]}, {
          0.5, 0, 0}]}, {{-1., -1.2246467991473532`*^-16, 0.}, {
        1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}], {{1, 0, 0}, {0, 0,
        1}, {0, -1, 0}}], {{-1.8369701987210297`*^-16, 1., 
      0.}, {-1., -1.8369701987210297`*^-16, 0.}, {0., 0., 1.}}], 
     GeometricTransformation3DBox[
      GeometricTransformation3DBox[
       GeometricTransformation3DBox[GeometricTransformation3DBox[
         {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
          Polygon3DBox[{{0.29166666666666663`, 0.08333333333333333, 0}, {
            0.29166666666666663`, 0.5, 0}, {0.20833333333333331`, 0.5, 0}, {
            0.20833333333333331`, 0.08333333333333333, 0}}], 
          Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
            0.16666666666666666`, 0.9166666666666666, 0}, {
            0.08333333333333333, 0.9166666666666666, 0}, {
            0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
          Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
            0.41666666666666663`, 0.9166666666666666, 0}, {
            0.3333333333333333, 0.9166666666666666, 0}, {
            0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}], 
          GeometricTransformation3DBox[
           {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
            Polygon3DBox[{{0.41666666666666663`, 0.08333333333333333, 0}, {
              0.41666666666666663`, 0.16666666666666666`, 0}, {
              0.10833333333333334`, 0.16666666666666666`, 0}, {
              0.08333333333333333, 0.08333333333333333, 0}}], 
            Polygon3DBox[{{0.19166666666666665`, 0.16666666666666666`, 0}, {
              0.39166666666666666`, 0.8333333333333333, 0}, {
              0.30833333333333335`, 0.8333333333333333, 0}, {
              0.10833333333333334`, 0.16666666666666666`, 0}}], 
            Polygon3DBox[{{0.08333333333333333, 0.8333333333333333, 0}, {
              0.39166666666666666`, 0.8333333333333333, 0}, {
              0.41666666666666663`, 0.9166666666666666, 0}, {
              0.08333333333333333, 0.9166666666666666, 0}}]}, {
           0.5, 0, 0}]}, {{-1., -1.2246467991473532`*^-16, 0.}, {
         1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}], {{1, 0, 0}, {0, 
        0, 1}, {0, -1, 0}}], {{-1.8369701987210297`*^-16, 1., 
       0.}, {-1., -1.8369701987210297`*^-16, 0.}, {0., 0., 1.}}], {1, 0, 
      0}], 
     {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
      Polygon3DBox[{{0.16666666666666666`, 0.08333333333333333, 0}, {
        0.25, 0.36111111111111105`, 0}, {0.25, 0.5, 0}, {
        0.20833333333333331`, 0.5, 0}, {
        0.08333333333333333, 0.08333333333333333, 0}}], 
      Polygon3DBox[{{0.41666666666666663`, 0.08333333333333333, 0}, {
        0.29166666666666663`, 0.5, 0}, {0.25, 0.5, 0}, {
        0.25, 0.36111111111111105`, 0}, {
        0.3333333333333333, 0.08333333333333333, 0}}], 
      Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
        0.16666666666666666`, 0.9166666666666666, 0}, {
        0.08333333333333333, 0.9166666666666666, 0}, {
        0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
      Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
        0.41666666666666663`, 0.9166666666666666, 0}, {
        0.3333333333333333, 0.9166666666666666, 0}, {
        0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}], 
      GeometricTransformation3DBox[
       {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
        Polygon3DBox[{{0.29166666666666663`, 0.08333333333333333, 0}, {
          0.29166666666666663`, 0.5, 0}, {0.20833333333333331`, 0.5, 0}, {
          0.20833333333333331`, 0.08333333333333333, 0}}], 
        Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
          0.16666666666666666`, 0.9166666666666666, 0}, {
          0.08333333333333333, 0.9166666666666666, 0}, {
          0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
        Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
          0.41666666666666663`, 0.9166666666666666, 0}, {
          0.3333333333333333, 0.9166666666666666, 0}, {
          0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}]}, {0.5, 0, 0}]}, 
     GeometricTransformation3DBox[
      {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
       Polygon3DBox[{{0.16666666666666666`, 0.08333333333333333, 0}, {
         0.25, 0.36111111111111105`, 0}, {0.25, 0.5, 0}, {
         0.20833333333333331`, 0.5, 0}, {
         0.08333333333333333, 0.08333333333333333, 0}}], 
       Polygon3DBox[{{0.41666666666666663`, 0.08333333333333333, 0}, {
         0.29166666666666663`, 0.5, 0}, {0.25, 0.5, 0}, {
         0.25, 0.36111111111111105`, 0}, {
         0.3333333333333333, 0.08333333333333333, 0}}], 
       Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
         0.16666666666666666`, 0.9166666666666666, 0}, {
         0.08333333333333333, 0.9166666666666666, 0}, {
         0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
       Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
         0.41666666666666663`, 0.9166666666666666, 0}, {
         0.3333333333333333, 0.9166666666666666, 0}, {
         0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}], 
       GeometricTransformation3DBox[
        {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
         Polygon3DBox[{{0.29166666666666663`, 0.08333333333333333, 0}, {
           0.29166666666666663`, 0.5, 0}, {0.20833333333333331`, 0.5, 0}, {
           0.20833333333333331`, 0.08333333333333333, 0}}], 
         Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
           0.16666666666666666`, 0.9166666666666666, 0}, {
           0.08333333333333333, 0.9166666666666666, 0}, {
           0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
         Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
           0.41666666666666663`, 0.9166666666666666, 0}, {
           0.3333333333333333, 0.9166666666666666, 0}, {
           0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}]}, {0.5, 0, 0}]}, {0,
       0, 1}]}, {-0.5, -0.5, -0.5}]},
  Axes->True,
  AxesLabel->{
    FormBox["\"x\"", TraditionalForm], 
    FormBox["\"y\"", TraditionalForm], 
    FormBox["\"z\"", TraditionalForm]},
  Boxed->True,
  ImageSize->Automatic,
  PlotRange->{{-1, 1}, {-1, 1}, {-1, 1}}]], "Output",
 CellChangeTimes->{3.633016380625716*^9, 3.633017859280073*^9, 
  3.63301820177878*^9, 3.667737875121416*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"thing3", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Thickness", "[", "0.010", "]"}], ",", "\[IndentingNewLine]", 
     "Red", ",", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{"o", ",", 
        RowBox[{"e", "[", "1", "]"}]}], "}"}], "]"}], ",", 
     "\[IndentingNewLine]", "Green", ",", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{"o", ",", 
        RowBox[{"e", "[", "2", "]"}]}], "}"}], "]"}], ",", 
     "\[IndentingNewLine]", "Blue", ",", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{"o", ",", 
        RowBox[{"e", "[", "3", "]"}]}], "}"}], "]"}], ",", 
     "\[IndentingNewLine]", "Cyan", ",", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{"o", ",", 
        RowBox[{"-", 
         RowBox[{"e", "[", "1", "]"}]}]}], "}"}], "]"}], ",", 
     "\[IndentingNewLine]", "Magenta", ",", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{"o", ",", 
        RowBox[{"-", 
         RowBox[{"e", "[", "2", "]"}]}]}], "}"}], "]"}], ",", 
     "\[IndentingNewLine]", "Yellow", ",", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{"o", ",", 
        RowBox[{"-", 
         RowBox[{"e", "[", "3", "]"}]}]}], "}"}], "]"}]}], "}"}]}], 
  ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.387806125139502*^9, {3.387819760647182*^9, 3.3878197862565565`*^9}, {
   3.387819825365932*^9, 3.3878198439440565`*^9}, {3.4292994092809963`*^9, 
   3.4292994256571493`*^9}, {3.4292995606771173`*^9, 
   3.4292995979048157`*^9}, {3.429299710526145*^9, 3.429299764253983*^9}, 
   3.4292998111747093`*^9, {3.429299847287312*^9, 3.429299863668479*^9}, {
   3.42929996592831*^9, 3.429300048682292*^9}, {3.633016314202588*^9, 
   3.633016335961773*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"s3l2", "[", 
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"{", "wcube", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"Scale", "[", 
      RowBox[{"thing3", ",", 
       RowBox[{"c", "[", "2", "]"}], ",", "o"}], "]"}], "}"}]}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.4292994427833242`*^9, 3.429299467261846*^9}, {
  3.633016335967616*^9, 3.633016347665619*^9}}],

Cell[BoxData[
 Graphics3DBox[{{GeometricTransformation3DBox[GeometricTransformation3DBox[{
       {FaceForm[RGBColor[0, 0, 1], RGBColor[1, 1, 0]], 
        Polygon3DBox[{{0, 0, 0}, {1, 0, 0}, {1, 1, 0}, {0, 1, 0}}], 
        Polygon3DBox[{{0, 0, 1}, {1, 0, 1}, {1, 1, 1}, {0, 1, 1}}]}, 
       {FaceForm[RGBColor[0, 1, 0], RGBColor[1, 0, 1]], 
        Polygon3DBox[{{0, 1, 1}, {1, 1, 1}, {1, 1, 0}, {0, 1, 0}}], 
        Polygon3DBox[{{0, 0, 1}, {1, 0, 1}, {1, 0, 0}, {0, 0, 0}}]}, 
       {FaceForm[RGBColor[1, 0, 0], RGBColor[0, 1, 1]], 
        Polygon3DBox[{{0, 0, 0}, {0, 1, 0}, {0, 1, 1}, {0, 0, 1}}], 
        Polygon3DBox[{{1, 0, 0}, {1, 1, 0}, {1, 1, 1}, {1, 0, 
         1}}]}}, {-0.5, -0.5, -0.5}], {{{0.99, 0., 0.}, {0., 0.99, 0.}, {0., 
      0., 0.99}}, {0., 0., 0.}}], 
    GeometricTransformation3DBox[{
      GeometricTransformation3DBox[
       GeometricTransformation3DBox[
        GeometricTransformation3DBox[GeometricTransformation3DBox[
          {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
           Polygon3DBox[{{0.41666666666666663`, 0.08333333333333333, 0}, {
             0.41666666666666663`, 0.16666666666666666`, 0}, {
             0.10833333333333334`, 0.16666666666666666`, 0}, {
             0.08333333333333333, 0.08333333333333333, 0}}], 
           Polygon3DBox[{{0.19166666666666665`, 0.16666666666666666`, 0}, {
             0.39166666666666666`, 0.8333333333333333, 0}, {
             0.30833333333333335`, 0.8333333333333333, 0}, {
             0.10833333333333334`, 0.16666666666666666`, 0}}], 
           Polygon3DBox[{{0.08333333333333333, 0.8333333333333333, 0}, {
             0.39166666666666666`, 0.8333333333333333, 0}, {
             0.41666666666666663`, 0.9166666666666666, 0}, {
             0.08333333333333333, 0.9166666666666666, 0}}], 
           GeometricTransformation3DBox[
            {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
             Polygon3DBox[{{0.16666666666666666`, 0.08333333333333333, 0}, {
               0.25, 0.36111111111111105`, 0}, {0.25, 0.5, 0}, {
               0.20833333333333331`, 0.5, 0}, {
               0.08333333333333333, 0.08333333333333333, 0}}], 
             Polygon3DBox[{{0.41666666666666663`, 0.08333333333333333, 0}, {
               0.29166666666666663`, 0.5, 0}, {0.25, 0.5, 0}, {
               0.25, 0.36111111111111105`, 0}, {
               0.3333333333333333, 0.08333333333333333, 0}}], 
             Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
               0.16666666666666666`, 0.9166666666666666, 0}, {
               0.08333333333333333, 0.9166666666666666, 0}, {
               0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
             Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
               0.41666666666666663`, 0.9166666666666666, 0}, {
               0.3333333333333333, 0.9166666666666666, 0}, {
               0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}]}, {
            0.5, 0, 0}]}, {{1, 0, 0}, {0, 1, 0}, {0, 0, 1}}], {{1, 0, 0}, {0, 
         0, -1}, {0, 1, 0}}], {{-1., -1.2246467991473532`*^-16, 0.}, {
        1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}], {1, 0, 0}], 
      GeometricTransformation3DBox[
       GeometricTransformation3DBox[
        GeometricTransformation3DBox[GeometricTransformation3DBox[
          {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
           Polygon3DBox[{{0.41666666666666663`, 0.08333333333333333, 0}, {
             0.41666666666666663`, 0.16666666666666666`, 0}, {
             0.10833333333333334`, 0.16666666666666666`, 0}, {
             0.08333333333333333, 0.08333333333333333, 0}}], 
           Polygon3DBox[{{0.19166666666666665`, 0.16666666666666666`, 0}, {
             0.39166666666666666`, 0.8333333333333333, 0}, {
             0.30833333333333335`, 0.8333333333333333, 0}, {
             0.10833333333333334`, 0.16666666666666666`, 0}}], 
           Polygon3DBox[{{0.08333333333333333, 0.8333333333333333, 0}, {
             0.39166666666666666`, 0.8333333333333333, 0}, {
             0.41666666666666663`, 0.9166666666666666, 0}, {
             0.08333333333333333, 0.9166666666666666, 0}}], 
           GeometricTransformation3DBox[
            {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
             Polygon3DBox[{{0.16666666666666666`, 0.08333333333333333, 0}, {
               0.25, 0.36111111111111105`, 0}, {0.25, 0.5, 0}, {
               0.20833333333333331`, 0.5, 0}, {
               0.08333333333333333, 0.08333333333333333, 0}}], 
             Polygon3DBox[{{0.41666666666666663`, 0.08333333333333333, 0}, {
               0.29166666666666663`, 0.5, 0}, {0.25, 0.5, 0}, {
               0.25, 0.36111111111111105`, 0}, {
               0.3333333333333333, 0.08333333333333333, 0}}], 
             Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
               0.16666666666666666`, 0.9166666666666666, 0}, {
               0.08333333333333333, 0.9166666666666666, 0}, {
               0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
             Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
               0.41666666666666663`, 0.9166666666666666, 0}, {
               0.3333333333333333, 0.9166666666666666, 0}, {
               0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}]}, {
            0.5, 0, 0}]}, {{1, 0, 0}, {0, 1, 0}, {0, 0, 1}}], {{1, 0, 0}, {0, 
         0, -1}, {0, 1, 0}}], {{-1., -1.2246467991473532`*^-16, 0.}, {
        1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}], {1, 1, 0}], 
      GeometricTransformation3DBox[
       GeometricTransformation3DBox[GeometricTransformation3DBox[
         {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
          Polygon3DBox[{{0.29166666666666663`, 0.08333333333333333, 0}, {
            0.29166666666666663`, 0.5, 0}, {0.20833333333333331`, 0.5, 0}, {
            0.20833333333333331`, 0.08333333333333333, 0}}], 
          Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
            0.16666666666666666`, 0.9166666666666666, 0}, {
            0.08333333333333333, 0.9166666666666666, 0}, {
            0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
          Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
            0.41666666666666663`, 0.9166666666666666, 0}, {
            0.3333333333333333, 0.9166666666666666, 0}, {
            0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}], 
          GeometricTransformation3DBox[
           {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
            Polygon3DBox[{{0.41666666666666663`, 0.08333333333333333, 0}, {
              0.41666666666666663`, 0.16666666666666666`, 0}, {
              0.10833333333333334`, 0.16666666666666666`, 0}, {
              0.08333333333333333, 0.08333333333333333, 0}}], 
            Polygon3DBox[{{0.19166666666666665`, 0.16666666666666666`, 0}, {
              0.39166666666666666`, 0.8333333333333333, 0}, {
              0.30833333333333335`, 0.8333333333333333, 0}, {
              0.10833333333333334`, 0.16666666666666666`, 0}}], 
            Polygon3DBox[{{0.08333333333333333, 0.8333333333333333, 0}, {
              0.39166666666666666`, 0.8333333333333333, 0}, {
              0.41666666666666663`, 0.9166666666666666, 0}, {
              0.08333333333333333, 0.9166666666666666, 0}}]}, {
           0.5, 0, 0}]}, {{-1., -1.2246467991473532`*^-16, 0.}, {
         1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}], {{1, 0, 0}, {0, 
        0, 1}, {0, -1, 0}}], {{-1.8369701987210297`*^-16, 1., 
       0.}, {-1., -1.8369701987210297`*^-16, 0.}, {0., 0., 1.}}], 
      GeometricTransformation3DBox[
       GeometricTransformation3DBox[
        GeometricTransformation3DBox[GeometricTransformation3DBox[
          {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
           Polygon3DBox[{{0.29166666666666663`, 0.08333333333333333, 0}, {
             0.29166666666666663`, 0.5, 0}, {0.20833333333333331`, 0.5, 0}, {
             0.20833333333333331`, 0.08333333333333333, 0}}], 
           Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
             0.16666666666666666`, 0.9166666666666666, 0}, {
             0.08333333333333333, 0.9166666666666666, 0}, {
             0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
           Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
             0.41666666666666663`, 0.9166666666666666, 0}, {
             0.3333333333333333, 0.9166666666666666, 0}, {
             0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}], 
           GeometricTransformation3DBox[
            {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
             Polygon3DBox[{{0.41666666666666663`, 0.08333333333333333, 0}, {
               0.41666666666666663`, 0.16666666666666666`, 0}, {
               0.10833333333333334`, 0.16666666666666666`, 0}, {
               0.08333333333333333, 0.08333333333333333, 0}}], 
             Polygon3DBox[{{0.19166666666666665`, 0.16666666666666666`, 0}, {
               0.39166666666666666`, 0.8333333333333333, 0}, {
               0.30833333333333335`, 0.8333333333333333, 0}, {
               0.10833333333333334`, 0.16666666666666666`, 0}}], 
             Polygon3DBox[{{0.08333333333333333, 0.8333333333333333, 0}, {
               0.39166666666666666`, 0.8333333333333333, 0}, {
               0.41666666666666663`, 0.9166666666666666, 0}, {
               0.08333333333333333, 0.9166666666666666, 0}}]}, {
            0.5, 0, 0}]}, {{-1., -1.2246467991473532`*^-16, 0.}, {
          1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}], {{1, 0, 0}, {0, 
         0, 1}, {0, -1, 0}}], {{-1.8369701987210297`*^-16, 1., 
        0.}, {-1., -1.8369701987210297`*^-16, 0.}, {0., 0., 1.}}], {1, 0, 0}], 
      {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
       Polygon3DBox[{{0.16666666666666666`, 0.08333333333333333, 0}, {
         0.25, 0.36111111111111105`, 0}, {0.25, 0.5, 0}, {
         0.20833333333333331`, 0.5, 0}, {
         0.08333333333333333, 0.08333333333333333, 0}}], 
       Polygon3DBox[{{0.41666666666666663`, 0.08333333333333333, 0}, {
         0.29166666666666663`, 0.5, 0}, {0.25, 0.5, 0}, {
         0.25, 0.36111111111111105`, 0}, {
         0.3333333333333333, 0.08333333333333333, 0}}], 
       Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
         0.16666666666666666`, 0.9166666666666666, 0}, {
         0.08333333333333333, 0.9166666666666666, 0}, {
         0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
       Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
         0.41666666666666663`, 0.9166666666666666, 0}, {
         0.3333333333333333, 0.9166666666666666, 0}, {
         0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}], 
       GeometricTransformation3DBox[
        {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
         Polygon3DBox[{{0.29166666666666663`, 0.08333333333333333, 0}, {
           0.29166666666666663`, 0.5, 0}, {0.20833333333333331`, 0.5, 0}, {
           0.20833333333333331`, 0.08333333333333333, 0}}], 
         Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
           0.16666666666666666`, 0.9166666666666666, 0}, {
           0.08333333333333333, 0.9166666666666666, 0}, {
           0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
         Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
           0.41666666666666663`, 0.9166666666666666, 0}, {
           0.3333333333333333, 0.9166666666666666, 0}, {
           0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}]}, {0.5, 0, 0}]}, 
      GeometricTransformation3DBox[
       {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
        Polygon3DBox[{{0.16666666666666666`, 0.08333333333333333, 0}, {
          0.25, 0.36111111111111105`, 0}, {0.25, 0.5, 0}, {
          0.20833333333333331`, 0.5, 0}, {
          0.08333333333333333, 0.08333333333333333, 0}}], 
        Polygon3DBox[{{0.41666666666666663`, 0.08333333333333333, 0}, {
          0.29166666666666663`, 0.5, 0}, {0.25, 0.5, 0}, {
          0.25, 0.36111111111111105`, 0}, {
          0.3333333333333333, 0.08333333333333333, 0}}], 
        Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
          0.16666666666666666`, 0.9166666666666666, 0}, {
          0.08333333333333333, 0.9166666666666666, 0}, {
          0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
        Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
          0.41666666666666663`, 0.9166666666666666, 0}, {
          0.3333333333333333, 0.9166666666666666, 0}, {
          0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}], 
        GeometricTransformation3DBox[
         {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
          Polygon3DBox[{{0.29166666666666663`, 0.08333333333333333, 0}, {
            0.29166666666666663`, 0.5, 0}, {0.20833333333333331`, 0.5, 0}, {
            0.20833333333333331`, 0.08333333333333333, 0}}], 
          Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
            0.16666666666666666`, 0.9166666666666666, 0}, {
            0.08333333333333333, 0.9166666666666666, 0}, {
            0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
          Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
            0.41666666666666663`, 0.9166666666666666, 0}, {
            0.3333333333333333, 0.9166666666666666, 0}, {
            0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}]}, {0.5, 0, 0}]}, {
       0, 0, 1}]}, {-0.5, -0.5, -0.5}]}, GeometricTransformation3DBox[
    {RGBColor[1, 0, 0], Thickness[0.01], Line3DBox[{{0, 0, 0}, {1, 0, 0}}], 
     {RGBColor[0, 1, 0], Line3DBox[{{0, 0, 0}, {0, 1, 0}}]}, 
     {RGBColor[0, 0, 1], Line3DBox[{{0, 0, 0}, {0, 0, 1}}]}, 
     {RGBColor[0, 1, 1], Line3DBox[{{0, 0, 0}, {-1, 0, 0}}]}, 
     {RGBColor[1, 0, 1], Line3DBox[{{0, 0, 0}, {0, -1, 0}}]}, 
     {RGBColor[1, 1, 0], Line3DBox[{{0, 0, 0}, {0, 0, -1}}]}}, {{{2, 0, 0}, {
     0, 2, 0}, {0, 0, 2}}, {0, 0, 0}}]},
  Axes->True,
  AxesLabel->{
    FormBox["\"x\"", TraditionalForm], 
    FormBox["\"y\"", TraditionalForm], 
    FormBox["\"z\"", TraditionalForm]},
  Boxed->True,
  ImageSize->Automatic,
  PlotRange->{{-1, 1}, {-1, 1}, {-1, 1}}]], "Output",
 CellChangeTimes->{3.633016386000635*^9, 3.633017859360454*^9, 
  3.633018201908609*^9, 3.6677378752023983`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ran\[Omega]", "[", "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"r", "=", 
       RowBox[{
        RowBox[{"2.0", 
         RowBox[{"ran3", "[", "]"}]}], "-", "1"}]}], "}"}], ",", 
     RowBox[{"2.0", "Pi", " ", 
      RowBox[{"r", "/", 
       RowBox[{"Norm", "[", "r", "]"}]}]}]}], "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],

Cell[BoxData[
 RowBox[{
  RowBox[{"w", "=", 
   RowBox[{"2.0", "Pi", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1.0", ",", "2.0", ",", "7.0"}], "}"}], "/", 
     RowBox[{"Norm", "[", 
      RowBox[{"{", 
       RowBox[{"1.0", ",", "2.0", ",", "7.0"}], "}"}], "]"}]}]}]}], 
  ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],

Cell[BoxData[
 RowBox[{
  RowBox[{"xcube", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Scale", "[", 
       RowBox[{"thing3", ",", 
        RowBox[{"c", "[", "2", "]"}], ",", "o"}], "]"}], "}"}], ",", 
     RowBox[{"{", "wcube", "}"}]}], "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.387806125139502*^9, {3.387819760647182*^9, 3.3878197862565565`*^9}, {
   3.387819825365932*^9, 3.3878198439440565`*^9}, {3.429300960478388*^9, 
   3.42930098624796*^9}, {3.633016335973521*^9, 3.633016347670871*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Euler-Angle Rotation", "Chapter",
 CellChangeTimes->{{3.633014965622542*^9, 3.633014969125608*^9}}],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["rot\[Omega]",
  FontWeight->"Bold"],
 "[",
 StyleBox["\[Omega]angle_, odirection_",
  FontWeight->"Bold"],
 "]\n",
 StyleBox["thing2",
  FontWeight->"Bold"],
 " (an axis object)\n",
 StyleBox["spin2\[Omega][\[Omega]angle_, odirection_, reps_:25]",
  FontWeight->"Bold"],
 " (no lighting)\n",
 StyleBox["spin3\[Omega][\[Omega]angle_, odirection_, reps_:25]",
  FontWeight->"Bold"],
 " (yes lighting)"
}], "Item",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 CellChangeTimes->{
  3.3877316182833*^9, {3.3878037849363766`*^9, 3.387803800858252*^9}, {
   3.387805991889502*^9, 3.3878060212176266`*^9}, 3.387806147889502*^9, {
   3.3878075441551266`*^9, 3.3878075572176266`*^9}, {3.3878077331551266`*^9, 
   3.387807770108252*^9}, {3.387810305615932*^9, 3.387810315709682*^9}, 
   3.4293588561999207`*^9}],

Cell["\<\
Define a right-handed \"twist vector\" whose magnitude is the angle of twist \
and whose direction specifies the axis of twist. \
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10002.}],

Cell[TextData[{
 "Consider a vector ",
 StyleBox["w",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 " representing angular velocity by its direction and magnitude. The \
direction specifies the axis of rotation and the magnitude specifies a \
positive twist rate in radians per unit time about this axis via the \
right-hand rule: thumb pointing along the axis, fingers curling in the sense \
of positive twist. To animate rotations, multiply ",
 Cell[BoxData[
  FormBox["w", TraditionalForm]],
  FontWeight->"Bold",
  FontSlant->"Italic"],
 " by ",
 Cell[BoxData[
  FormBox["dt", TraditionalForm]],
  FontWeight->"Bold",
  FontSlant->"Italic"],
 " to get ",
 StyleBox["dw",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 ", a small but finite actual rotation. Use \"Rotate3,\" which takes Euler \
angles, to depict such rotations. "
}], "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 CellChangeTimes->{
  3.3877316182833*^9, {3.387803771608252*^9, 3.387803800858252*^9}, {
   3.387806436483252*^9, 3.3878065222176266`*^9}, {3.3878075441551266`*^9, 
   3.3878075572176266`*^9}, {3.429297198394968*^9, 3.429297249070107*^9}}],

Cell[TextData[{
 "Task 1: figure out exactly which Euler-angle set: given ",
 StyleBox["dw",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 "'s components, what arguments to supply to \"Rotate3?\" There are lots of \
different Euler-angle sets. This one is ",
 StyleBox["zxz frame-wise",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 ":"
}], "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 CellChangeTimes->{
  3.3877316182833*^9, {3.387803771608252*^9, 3.387803800858252*^9}, {
   3.387806436483252*^9, 3.3878065222176266`*^9}, {3.3878075441551266`*^9, 
   3.3878075572176266`*^9}, 3.429297198394968*^9, {3.429297260654018*^9, 
   3.429297282655005*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"xaxis", "=", 
   RowBox[{"Line", "[", 
    RowBox[{"{", 
     RowBox[{"o", ",", 
      RowBox[{"e", "[", "1", "]"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yaxis", "=", 
   RowBox[{"Line", "[", 
    RowBox[{"{", 
     RowBox[{"o", ",", 
      RowBox[{"e", "[", "2", "]"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zaxis", "=", 
   RowBox[{"Line", "[", 
    RowBox[{"{", 
     RowBox[{"o", ",", 
      RowBox[{"e", "[", "3", "]"}]}], "}"}], "]"}]}], ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 CellChangeTimes->{
  3.3877316182833*^9, {3.387803771608252*^9, 3.387803800858252*^9}, {
   3.3878075441551266`*^9, 3.3878075572176266`*^9}, {3.42929954958316*^9, 
   3.429299552521146*^9}, {3.429299710497821*^9, 3.429299764237814*^9}, {
   3.633015023830483*^9, 3.633015060294429*^9}}],

Cell[TextData[{
 "Look at the ",
 StyleBox["x",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 " axis after rotating about ",
 StyleBox["+z",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 " counterclockwise by a small angle, say \[Pi]/6. If Rotate3 rotates the \
FRAME, expect a small negative ",
 StyleBox["y",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 " contribution (new ",
 StyleBox["y",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 " component of old ",
 StyleBox["x",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 "-axis is a small, negative number). If Rotate3 rotates the OBJECT, expect a \
small positive ",
 StyleBox["y",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 " contribution: "
}], "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 CellChangeTimes->{{3.3876509561397223`*^9, 3.3876509833081193`*^9}, 
   3.3877316182833*^9, {3.387803771608252*^9, 3.387803800858252*^9}, {
   3.3878065470613766`*^9, 3.3878065641551266`*^9}, {3.3878075441551266`*^9, 
   3.3878075572176266`*^9}, 3.429297306451931*^9, {3.42929735958154*^9, 
   3.4292973661842003`*^9}}],

Cell[BoxData[
 RowBox[{"s3", "[", 
  RowBox[{"Rotate3", "[", 
   RowBox[{"xaxis", ",", 
    RowBox[{"\[Pi]", "/", "6"}], ",", "0", ",", "0"}], "]"}], "]"}]], "Input",\

 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 CellChangeTimes->{
  3.3877316182833*^9, {3.387803771608252*^9, 3.387803800858252*^9}, {
   3.3878075441551266`*^9, 3.3878075572176266`*^9}, {3.429297372986117*^9, 
   3.429297396645323*^9}, {3.633015178927503*^9, 3.633015185802442*^9}}]
}, Open  ]],

Cell[BoxData[
 Graphics3DBox[
  GeometricTransformation3DBox[
   GeometricTransformation3DBox[
    GeometricTransformation3DBox[
     Line3DBox[{{0, 0, 0}, {1, 0, 
      0}}], {{-0.8660254037844387, -0.49999999999999994`, 0.}, {
     0.49999999999999994`, -0.8660254037844387, 0.}, {0., 0., 1.}}], {{1, 0, 
    0}, {0, 1, 0}, {0, 0, 1}}], {{-1., -1.2246467991473532`*^-16, 0.}, {
   1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}],
  Axes->True,
  AxesLabel->{
    FormBox["\"x\"", TraditionalForm], 
    FormBox["\"y\"", TraditionalForm], 
    FormBox["\"z\"", TraditionalForm]},
  FaceGrids->All,
  ImageSize->{391.24846814258916`, 227.95966631028375`},
  ViewPoint->{-0.24674327796619458`, -0.0588171085643398, 3.3742641127390463`},
  ViewVertical->{-0.13762805385733506`, 3.184348456981098, 
   0.6022406319786362}]], "Output",
 CellChangeTimes->{
  3.6330151427064323`*^9, {3.633015179807127*^9, 3.633015186288176*^9}, 
   3.63301785943472*^9, 3.6330182020489388`*^9, 3.667737875265777*^9}],

Cell["CONCLUSION: Rotate3 rotates the FRAME.", "Text",
 CellChangeTimes->{{3.63301519488585*^9, 3.63301520759953*^9}}],

Cell[CellGroupData[{

Cell[TextData[{
 "Picture an all-positive \[Omega], in the first octant of E3. To use \
\"Rotate3\" to rotate the image of an object about such a \[Omega], first get \
the frame's ",
 StyleBox["y",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 " axis directly under \[Omega] by a negative twist about ",
 StyleBox["z",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 ",then do a negative twist about new ",
 StyleBox["x",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 " to align ",
 StyleBox["z",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 " with \[Omega], then twist by negative ",
 StyleBox["Norm[\[Omega]]",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 ", to twist the OBJECT rather than the frame, then undo the first two \
twists. "
}], "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 CellChangeTimes->{
  3.3877316182833*^9, {3.387803771608252*^9, 3.387803800858252*^9}, {
   3.3878066584988766`*^9, 3.3878066770613766`*^9}, {3.387807423108252*^9, 
   3.3878074253738766`*^9}, {3.3878075441551266`*^9, 3.3878075572176266`*^9}, 
   3.42929754910017*^9, {3.633015217445095*^9, 3.6330152740591097`*^9}}],

Cell[TextData[{
 StyleBox["\[Phi]m[w]",
  FontWeight->"Bold"],
 " is the angle ",
 StyleBox["w",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 " makes with the ",
 StyleBox["y",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 " axis, measured CLOCKwise from ",
 StyleBox["y",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 " to ",
 StyleBox["w\[CloseCurlyQuote]",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 "s projection in the ",
 StyleBox["xy",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 " plane. The first Euler angle should be a negative ",
 StyleBox["z",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 " twist by this angle."
}], "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 CellChangeTimes->{
  3.387652498968275*^9, 3.3877316182833*^9, {3.387803771608252*^9, 
   3.387803800858252*^9}, {3.3878075441551266`*^9, 3.3878075572176266`*^9}, {
   3.633015672638771*^9, 3.633015674420895*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]m", "[", "w_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Chop", "[", 
       RowBox[{"w", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       "]"}], "\[Equal]", "0"}], ",", "0", ",", 
     RowBox[{"ArcTan", "[", 
      RowBox[{
       RowBox[{"w", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
       ",", 
       RowBox[{"w", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
      "]"}]}], "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 CellChangeTimes->{
  3.3877316182833*^9, {3.387803771608252*^9, 3.387803800858252*^9}, {
   3.3878075441551266`*^9, 3.3878075572176266`*^9}}],

Cell[TextData[{
 StyleBox["\[Theta]m[w]",
  FontWeight->"Bold"],
 " is the angle ",
 StyleBox["w",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 " makes with the ",
 StyleBox["z",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 " axis, measured counterclockwise from ",
 StyleBox["z",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 " to ",
 StyleBox["w",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 " in their common plane. The second Euler angle should be a negative ",
 StyleBox["x",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 " twist to align this new ",
 StyleBox["z",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 " axis with ",
 StyleBox["w",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 "."
}], "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 CellChangeTimes->{
  3.387652552592245*^9, 3.3877316182833*^9, {3.387803771608252*^9, 
   3.387803800858252*^9}, {3.387807412639502*^9, 3.387807412702002*^9}, {
   3.3878075441551266`*^9, 3.3878075572176266`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]m", "[", "w_", "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"r", "=", 
       RowBox[{"Norm", "[", 
        RowBox[{"w", "\[LeftDoubleBracket]", 
         RowBox[{"1", ";;", "2"}], "\[RightDoubleBracket]"}], "]"}]}], 
      RowBox[{"(*", 
       RowBox[{"Chop", "[", 
        RowBox[{"Sqrt", "[", 
         RowBox[{
          SuperscriptBox[
           RowBox[{
           "w", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "2"], 
          "+", 
          SuperscriptBox[
           RowBox[{
           "w", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
           "2"]}], "]"}], "]"}], "*)"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"r", "\[Equal]", "0"}], ",", "0", ",", 
       RowBox[{"ArcTan", "[", 
        RowBox[{
         RowBox[{"w", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
         ",", "r"}], "]"}]}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 CellChangeTimes->{{3.6330157170227213`*^9, 3.633015776144876*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"rot\[Omega]", "[", 
    RowBox[{"\[Omega]_", ",", "o_"}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Psi]", "=", 
        RowBox[{"Norm", "[", "\[Omega]", "]"}]}], 
       RowBox[{"(*", 
        RowBox[{"Sqrt", "[", 
         RowBox[{
          SuperscriptBox[
           RowBox[{
           "\[Omega]", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
            "2"], "+", 
          SuperscriptBox[
           RowBox[{
           "\[Omega]", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
            "2"], "+", 
          SuperscriptBox[
           RowBox[{
           "\[Omega]", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
            "2"]}], "]"}], "*)"}], ",", 
       RowBox[{"\[Theta]", "=", 
        RowBox[{"\[Theta]m", "[", "\[Omega]", "]"}]}], ",", 
       RowBox[{"\[Phi]", "=", 
        RowBox[{"\[Phi]m", "[", "\[Omega]", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Chop", "[", 
      RowBox[{"Rotate3", "[", 
       RowBox[{
        RowBox[{"Rotate3", "[", 
         RowBox[{
          RowBox[{"Rotate3", "[", 
           RowBox[{"o", ",", 
            RowBox[{"-", "\[Phi]"}], ",", 
            RowBox[{"-", "\[Theta]"}], ",", 
            RowBox[{"-", "\[Psi]"}]}], "]"}], ",", "0", ",", "\[Theta]", ",", 
          "0"}], "]"}], ",", "\[Phi]", ",", "0", ",", "0"}], "]"}], "]"}]}], 
    "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 CellChangeTimes->{{3.633015842816764*^9, 3.633015868085446*^9}}],

Cell["\<\
\[LineSeparator]The following should twist the thing a little around the Red \
= X axis:\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 CellChangeTimes->{{3.3876527126829214`*^9, 3.3876527265576553`*^9}, 
   3.3877316182833*^9, {3.387803771608252*^9, 3.387803800858252*^9}, {
   3.3878075380613766`*^9, 3.3878075572176266`*^9}, 3.429275813875867*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"s3p", "[", 
  RowBox[{"rot\[Omega]", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"e", "[", "1", "]"}], "/", "3"}], ",", "xcube"}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{
  3.429299710502945*^9, 3.633015035544174*^9, {3.633016910117672*^9, 
   3.6330169113062277`*^9}}],

Cell[BoxData[
 Graphics3DBox[
  GeometricTransformation3DBox[
   GeometricTransformation3DBox[
    GeometricTransformation3DBox[
     GeometricTransformation3DBox[
      GeometricTransformation3DBox[
       GeometricTransformation3DBox[
        GeometricTransformation3DBox[
         GeometricTransformation3DBox[
          GeometricTransformation3DBox[{GeometricTransformation3DBox[
             {RGBColor[1, 0, 0], Thickness[0.01], 
              Line3DBox[{{0, 0, 0}, {1, 0, 0}}], 
              {RGBColor[0, 1, 0], Line3DBox[{{0, 0, 0}, {0, 1, 0}}]}, 
              {RGBColor[0, 0, 1], Line3DBox[{{0, 0, 0}, {0, 0, 1}}]}, 
              {RGBColor[0, 1, 1], Line3DBox[{{0, 0, 0}, {-1, 0, 0}}]}, 
              {RGBColor[1, 0, 1], Line3DBox[{{0, 0, 0}, {0, -1, 0}}]}, 
              {RGBColor[1, 1, 0], Line3DBox[{{0, 0, 0}, {0, 0, -1}}]}}, {{{2, 
              0, 0}, {0, 2, 0}, {0, 0, 2}}, {0, 0, 0}}], {
             GeometricTransformation3DBox[GeometricTransformation3DBox[{
                {FaceForm[RGBColor[0, 0, 1], RGBColor[1, 1, 0]], 
                 Polygon3DBox[{{0, 0, 0}, {1, 0, 0}, {1, 1, 0}, {0, 1, 0}}], 
                 Polygon3DBox[{{0, 0, 1}, {1, 0, 1}, {1, 1, 1}, {0, 1, 
                  1}}]}, 
                {FaceForm[RGBColor[0, 1, 0], RGBColor[1, 0, 1]], 
                 Polygon3DBox[{{0, 1, 1}, {1, 1, 1}, {1, 1, 0}, {0, 1, 0}}], 
                 Polygon3DBox[{{0, 0, 1}, {1, 0, 1}, {1, 0, 0}, {0, 0, 
                  0}}]}, 
                {FaceForm[RGBColor[1, 0, 0], RGBColor[0, 1, 1]], 
                 Polygon3DBox[{{0, 0, 0}, {0, 1, 0}, {0, 1, 1}, {0, 0, 1}}], 
                 Polygon3DBox[{{1, 0, 0}, {1, 1, 0}, {1, 1, 1}, {1, 0, 
                  1}}]}}, {-0.5, -0.5, -0.5}], {{{0.99, 0., 0.}, {0., 0.99, 
               0.}, {0., 0., 0.99}}, {0., 0., 0.}}], 
             GeometricTransformation3DBox[{
               GeometricTransformation3DBox[
                GeometricTransformation3DBox[
                 GeometricTransformation3DBox[GeometricTransformation3DBox[
                   {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
                    Polygon3DBox[{{
                    0.41666666666666663`, 0.08333333333333333, 0}, {
                    0.41666666666666663`, 0.16666666666666666`, 0}, {
                    0.10833333333333334`, 0.16666666666666666`, 0}, {
                    0.08333333333333333, 0.08333333333333333, 0}}], 
                    Polygon3DBox[{{
                    0.19166666666666665`, 0.16666666666666666`, 0}, {
                    0.39166666666666666`, 0.8333333333333333, 0}, {
                    0.30833333333333335`, 0.8333333333333333, 0}, {
                    0.10833333333333334`, 0.16666666666666666`, 0}}], 
                    Polygon3DBox[{{
                    0.08333333333333333, 0.8333333333333333, 0}, {
                    0.39166666666666666`, 0.8333333333333333, 0}, {
                    0.41666666666666663`, 0.9166666666666666, 0}, {
                    0.08333333333333333, 0.9166666666666666, 0}}], 
                    GeometricTransformation3DBox[
                    {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
                    Polygon3DBox[{{
                    0.16666666666666666`, 0.08333333333333333, 0}, {
                    0.25, 0.36111111111111105`, 0}, {0.25, 0.5, 0}, {
                    0.20833333333333331`, 0.5, 0}, {
                    0.08333333333333333, 0.08333333333333333, 0}}], 
                    Polygon3DBox[{{
                    0.41666666666666663`, 0.08333333333333333, 0}, {
                    0.29166666666666663`, 0.5, 0}, {0.25, 0.5, 0}, {
                    0.25, 0.36111111111111105`, 0}, {
                    0.3333333333333333, 0.08333333333333333, 0}}], 
                    Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
                    0.16666666666666666`, 0.9166666666666666, 0}, {
                    0.08333333333333333, 0.9166666666666666, 0}, {
                    0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
                    Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
                    0.41666666666666663`, 0.9166666666666666, 0}, {
                    0.3333333333333333, 0.9166666666666666, 0}, {
                    0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}]}, {
                    0.5, 0, 0}]}, {{1, 0, 0}, {0, 1, 0}, {0, 0, 1}}], {{1, 0, 
                  0}, {0, 0, -1}, {0, 1, 
                  0}}], {{-1., -1.2246467991473532`*^-16, 0.}, {
                 1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}], {1, 0, 
                0}], GeometricTransformation3DBox[
                GeometricTransformation3DBox[
                 GeometricTransformation3DBox[GeometricTransformation3DBox[
                   {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
                    Polygon3DBox[{{
                    0.41666666666666663`, 0.08333333333333333, 0}, {
                    0.41666666666666663`, 0.16666666666666666`, 0}, {
                    0.10833333333333334`, 0.16666666666666666`, 0}, {
                    0.08333333333333333, 0.08333333333333333, 0}}], 
                    Polygon3DBox[{{
                    0.19166666666666665`, 0.16666666666666666`, 0}, {
                    0.39166666666666666`, 0.8333333333333333, 0}, {
                    0.30833333333333335`, 0.8333333333333333, 0}, {
                    0.10833333333333334`, 0.16666666666666666`, 0}}], 
                    Polygon3DBox[{{
                    0.08333333333333333, 0.8333333333333333, 0}, {
                    0.39166666666666666`, 0.8333333333333333, 0}, {
                    0.41666666666666663`, 0.9166666666666666, 0}, {
                    0.08333333333333333, 0.9166666666666666, 0}}], 
                    GeometricTransformation3DBox[
                    {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
                    Polygon3DBox[{{
                    0.16666666666666666`, 0.08333333333333333, 0}, {
                    0.25, 0.36111111111111105`, 0}, {0.25, 0.5, 0}, {
                    0.20833333333333331`, 0.5, 0}, {
                    0.08333333333333333, 0.08333333333333333, 0}}], 
                    Polygon3DBox[{{
                    0.41666666666666663`, 0.08333333333333333, 0}, {
                    0.29166666666666663`, 0.5, 0}, {0.25, 0.5, 0}, {
                    0.25, 0.36111111111111105`, 0}, {
                    0.3333333333333333, 0.08333333333333333, 0}}], 
                    Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
                    0.16666666666666666`, 0.9166666666666666, 0}, {
                    0.08333333333333333, 0.9166666666666666, 0}, {
                    0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
                    Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
                    0.41666666666666663`, 0.9166666666666666, 0}, {
                    0.3333333333333333, 0.9166666666666666, 0}, {
                    0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}]}, {
                    0.5, 0, 0}]}, {{1, 0, 0}, {0, 1, 0}, {0, 0, 1}}], {{1, 0, 
                  0}, {0, 0, -1}, {0, 1, 
                  0}}], {{-1., -1.2246467991473532`*^-16, 0.}, {
                 1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}], {1, 1, 
                0}], GeometricTransformation3DBox[
                GeometricTransformation3DBox[GeometricTransformation3DBox[
                  {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
                   Polygon3DBox[{{
                    0.29166666666666663`, 0.08333333333333333, 0}, {
                    0.29166666666666663`, 0.5, 0}, {
                    0.20833333333333331`, 0.5, 0}, {
                    0.20833333333333331`, 0.08333333333333333, 0}}], 
                   Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
                    0.16666666666666666`, 0.9166666666666666, 0}, {
                    0.08333333333333333, 0.9166666666666666, 0}, {
                    0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
                   Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
                    0.41666666666666663`, 0.9166666666666666, 0}, {
                    0.3333333333333333, 0.9166666666666666, 0}, {
                    0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}], 
                   GeometricTransformation3DBox[
                    {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
                    Polygon3DBox[{{
                    0.41666666666666663`, 0.08333333333333333, 0}, {
                    0.41666666666666663`, 0.16666666666666666`, 0}, {
                    0.10833333333333334`, 0.16666666666666666`, 0}, {
                    0.08333333333333333, 0.08333333333333333, 0}}], 
                    Polygon3DBox[{{
                    0.19166666666666665`, 0.16666666666666666`, 0}, {
                    0.39166666666666666`, 0.8333333333333333, 0}, {
                    0.30833333333333335`, 0.8333333333333333, 0}, {
                    0.10833333333333334`, 0.16666666666666666`, 0}}], 
                    Polygon3DBox[{{
                    0.08333333333333333, 0.8333333333333333, 0}, {
                    0.39166666666666666`, 0.8333333333333333, 0}, {
                    0.41666666666666663`, 0.9166666666666666, 0}, {
                    0.08333333333333333, 0.9166666666666666, 0}}]}, {
                    0.5, 0, 0}]}, {{-1., -1.2246467991473532`*^-16, 0.}, {
                  1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}], {{1, 0, 
                 0}, {0, 0, 1}, {0, -1, 0}}], {{-1.8369701987210297`*^-16, 1.,
                 0.}, {-1., -1.8369701987210297`*^-16, 0.}, {0., 0., 1.}}], 
               GeometricTransformation3DBox[
                GeometricTransformation3DBox[
                 GeometricTransformation3DBox[GeometricTransformation3DBox[
                   {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
                    Polygon3DBox[{{
                    0.29166666666666663`, 0.08333333333333333, 0}, {
                    0.29166666666666663`, 0.5, 0}, {
                    0.20833333333333331`, 0.5, 0}, {
                    0.20833333333333331`, 0.08333333333333333, 0}}], 
                    Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
                    0.16666666666666666`, 0.9166666666666666, 0}, {
                    0.08333333333333333, 0.9166666666666666, 0}, {
                    0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
                    Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
                    0.41666666666666663`, 0.9166666666666666, 0}, {
                    0.3333333333333333, 0.9166666666666666, 0}, {
                    0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}], 
                    GeometricTransformation3DBox[
                    {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
                    Polygon3DBox[{{
                    0.41666666666666663`, 0.08333333333333333, 0}, {
                    0.41666666666666663`, 0.16666666666666666`, 0}, {
                    0.10833333333333334`, 0.16666666666666666`, 0}, {
                    0.08333333333333333, 0.08333333333333333, 0}}], 
                    Polygon3DBox[{{
                    0.19166666666666665`, 0.16666666666666666`, 0}, {
                    0.39166666666666666`, 0.8333333333333333, 0}, {
                    0.30833333333333335`, 0.8333333333333333, 0}, {
                    0.10833333333333334`, 0.16666666666666666`, 0}}], 
                    Polygon3DBox[{{
                    0.08333333333333333, 0.8333333333333333, 0}, {
                    0.39166666666666666`, 0.8333333333333333, 0}, {
                    0.41666666666666663`, 0.9166666666666666, 0}, {
                    0.08333333333333333, 0.9166666666666666, 0}}]}, {
                    0.5, 0, 0}]}, {{-1., -1.2246467991473532`*^-16, 0.}, {
                   1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}], {{1, 0,
                   0}, {0, 0, 1}, {0, -1, 0}}], {{-1.8369701987210297`*^-16, 
                 1., 0.}, {-1., -1.8369701987210297`*^-16, 0.}, {0., 0., 
                 1.}}], {1, 0, 0}], 
               {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
                Polygon3DBox[{{
                  0.16666666666666666`, 0.08333333333333333, 0}, {
                  0.25, 0.36111111111111105`, 0}, {0.25, 0.5, 0}, {
                  0.20833333333333331`, 0.5, 0}, {
                  0.08333333333333333, 0.08333333333333333, 0}}], 
                Polygon3DBox[{{
                  0.41666666666666663`, 0.08333333333333333, 0}, {
                  0.29166666666666663`, 0.5, 0}, {0.25, 0.5, 0}, {
                  0.25, 0.36111111111111105`, 0}, {
                  0.3333333333333333, 0.08333333333333333, 0}}], 
                Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
                  0.16666666666666666`, 0.9166666666666666, 0}, {
                  0.08333333333333333, 0.9166666666666666, 0}, {
                  0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
                Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
                  0.41666666666666663`, 0.9166666666666666, 0}, {
                  0.3333333333333333, 0.9166666666666666, 0}, {
                  0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}], 
                GeometricTransformation3DBox[
                 {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
                  Polygon3DBox[{{
                    0.29166666666666663`, 0.08333333333333333, 0}, {
                    0.29166666666666663`, 0.5, 0}, {
                    0.20833333333333331`, 0.5, 0}, {
                    0.20833333333333331`, 0.08333333333333333, 0}}], 
                  Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
                    0.16666666666666666`, 0.9166666666666666, 0}, {
                    0.08333333333333333, 0.9166666666666666, 0}, {
                    0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
                  Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
                    0.41666666666666663`, 0.9166666666666666, 0}, {
                    0.3333333333333333, 0.9166666666666666, 0}, {
                    0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}]}, {
                 0.5, 0, 0}]}, GeometricTransformation3DBox[
                {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
                 Polygon3DBox[{{
                   0.16666666666666666`, 0.08333333333333333, 0}, {
                   0.25, 0.36111111111111105`, 0}, {0.25, 0.5, 0}, {
                   0.20833333333333331`, 0.5, 0}, {
                   0.08333333333333333, 0.08333333333333333, 0}}], 
                 Polygon3DBox[{{
                   0.41666666666666663`, 0.08333333333333333, 0}, {
                   0.29166666666666663`, 0.5, 0}, {0.25, 0.5, 0}, {
                   0.25, 0.36111111111111105`, 0}, {
                   0.3333333333333333, 0.08333333333333333, 0}}], 
                 Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
                   0.16666666666666666`, 0.9166666666666666, 0}, {
                   0.08333333333333333, 0.9166666666666666, 0}, {
                   0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
                 Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
                   0.41666666666666663`, 0.9166666666666666, 0}, {
                   0.3333333333333333, 0.9166666666666666, 0}, {
                   0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}], 
                 GeometricTransformation3DBox[
                  {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
                   Polygon3DBox[{{
                    0.29166666666666663`, 0.08333333333333333, 0}, {
                    0.29166666666666663`, 0.5, 0}, {
                    0.20833333333333331`, 0.5, 0}, {
                    0.20833333333333331`, 0.08333333333333333, 0}}], 
                   Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
                    0.16666666666666666`, 0.9166666666666666, 0}, {
                    0.08333333333333333, 0.9166666666666666, 0}, {
                    0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
                   Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
                    0.41666666666666663`, 0.9166666666666666, 0}, {
                    0.3333333333333333, 0.9166666666666666, 0}, {
                    0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}]}, {
                  0.5, 0, 0}]}, {0, 0, 
                1}]}, {-0.5, -0.5, -0.5}]}}, {{-1.8369701987210297`*^-16, 1., 
           0.}, {-1., -1.8369701987210297`*^-16, 0.}, {0., 0., 1.}}], {{1, 0, 
          0}, {0, 0, 1}, {0, -1, 0}}], {{-0.9449569463147377, 
         0.32719469679615226`, 
         0.}, {-0.32719469679615226`, -0.9449569463147377, 0.}, {0., 0., 
         1.}}], {{-1., -1.2246467991473532`*^-16, 0.}, {
        1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}], {{1, 0, 0}, {0, 
       0, -1}, {0, 1, 0}}], {{-1., -1.2246467991473532`*^-16, 0.}, {
      1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}], {{
     6.123233995736766*^-17, -1., 0.}, {1., 6.123233995736766*^-17, 0.}, {0., 
     0., 1.}}], {{1, 0, 0}, {0, 1, 0}, {0, 0, 
    1}}], {{-1., -1.2246467991473532`*^-16, 0.}, {
   1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}],
  Axes->True,
  AxesLabel->{
    FormBox["\"x\"", TraditionalForm], 
    FormBox["\"y\"", TraditionalForm], 
    FormBox["\"z\"", TraditionalForm]},
  FaceGrids->All,
  ImageSize->Automatic,
  Lighting->"Neutral",
  ViewPoint->{1.3148413203292661`, -2.60535932371058, 1.712686514429638},
  ViewVertical->{0.06744029659534997, -0.08449383857218751, 
   1.0524537179088225`}]], "Output",
 CellChangeTimes->{3.633015883259392*^9, 3.633016912357057*^9, 
  3.633017859537135*^9, 3.6330182021791058`*^9, 3.667737875364719*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["About the Green = Y axis:", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 CellChangeTimes->{{3.3876527340418863`*^9, 3.387652745604164*^9}, 
   3.3877316182833*^9, {3.387803771608252*^9, 3.387803800858252*^9}, {
   3.3878075380613766`*^9, 3.3878075572176266`*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"s3p", "[", 
   RowBox[{"rot\[Omega]", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"e", "[", "2", "]"}], "/", "3"}], ",", "xcube"}], "]"}], 
   "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 CellChangeTimes->{
  3.387366114189475*^9, 3.3877316182833*^9, {3.387803771608252*^9, 
   3.387803800858252*^9}, {3.3878075380613766`*^9, 3.3878075572176266`*^9}, 
   3.429299739493229*^9, 3.633015048045518*^9, 3.633015900565343*^9, {
   3.633016931452106*^9, 3.633016932169348*^9}}]
}, Open  ]],

Cell[BoxData[
 Graphics3DBox[
  GeometricTransformation3DBox[
   GeometricTransformation3DBox[
    GeometricTransformation3DBox[
     GeometricTransformation3DBox[
      GeometricTransformation3DBox[
       GeometricTransformation3DBox[
        GeometricTransformation3DBox[
         GeometricTransformation3DBox[
          GeometricTransformation3DBox[{GeometricTransformation3DBox[
             {RGBColor[1, 0, 0], Thickness[0.01], 
              Line3DBox[{{0, 0, 0}, {1, 0, 0}}], 
              {RGBColor[0, 1, 0], Line3DBox[{{0, 0, 0}, {0, 1, 0}}]}, 
              {RGBColor[0, 0, 1], Line3DBox[{{0, 0, 0}, {0, 0, 1}}]}, 
              {RGBColor[0, 1, 1], Line3DBox[{{0, 0, 0}, {-1, 0, 0}}]}, 
              {RGBColor[1, 0, 1], Line3DBox[{{0, 0, 0}, {0, -1, 0}}]}, 
              {RGBColor[1, 1, 0], Line3DBox[{{0, 0, 0}, {0, 0, -1}}]}}, {{{2, 
              0, 0}, {0, 2, 0}, {0, 0, 2}}, {0, 0, 0}}], {
             GeometricTransformation3DBox[GeometricTransformation3DBox[{
                {FaceForm[RGBColor[0, 0, 1], RGBColor[1, 1, 0]], 
                 Polygon3DBox[{{0, 0, 0}, {1, 0, 0}, {1, 1, 0}, {0, 1, 0}}], 
                 Polygon3DBox[{{0, 0, 1}, {1, 0, 1}, {1, 1, 1}, {0, 1, 
                  1}}]}, 
                {FaceForm[RGBColor[0, 1, 0], RGBColor[1, 0, 1]], 
                 Polygon3DBox[{{0, 1, 1}, {1, 1, 1}, {1, 1, 0}, {0, 1, 0}}], 
                 Polygon3DBox[{{0, 0, 1}, {1, 0, 1}, {1, 0, 0}, {0, 0, 
                  0}}]}, 
                {FaceForm[RGBColor[1, 0, 0], RGBColor[0, 1, 1]], 
                 Polygon3DBox[{{0, 0, 0}, {0, 1, 0}, {0, 1, 1}, {0, 0, 1}}], 
                 Polygon3DBox[{{1, 0, 0}, {1, 1, 0}, {1, 1, 1}, {1, 0, 
                  1}}]}}, {-0.5, -0.5, -0.5}], {{{0.99, 0., 0.}, {0., 0.99, 
               0.}, {0., 0., 0.99}}, {0., 0., 0.}}], 
             GeometricTransformation3DBox[{
               GeometricTransformation3DBox[
                GeometricTransformation3DBox[
                 GeometricTransformation3DBox[GeometricTransformation3DBox[
                   {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
                    Polygon3DBox[{{
                    0.41666666666666663`, 0.08333333333333333, 0}, {
                    0.41666666666666663`, 0.16666666666666666`, 0}, {
                    0.10833333333333334`, 0.16666666666666666`, 0}, {
                    0.08333333333333333, 0.08333333333333333, 0}}], 
                    Polygon3DBox[{{
                    0.19166666666666665`, 0.16666666666666666`, 0}, {
                    0.39166666666666666`, 0.8333333333333333, 0}, {
                    0.30833333333333335`, 0.8333333333333333, 0}, {
                    0.10833333333333334`, 0.16666666666666666`, 0}}], 
                    Polygon3DBox[{{
                    0.08333333333333333, 0.8333333333333333, 0}, {
                    0.39166666666666666`, 0.8333333333333333, 0}, {
                    0.41666666666666663`, 0.9166666666666666, 0}, {
                    0.08333333333333333, 0.9166666666666666, 0}}], 
                    GeometricTransformation3DBox[
                    {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
                    Polygon3DBox[{{
                    0.16666666666666666`, 0.08333333333333333, 0}, {
                    0.25, 0.36111111111111105`, 0}, {0.25, 0.5, 0}, {
                    0.20833333333333331`, 0.5, 0}, {
                    0.08333333333333333, 0.08333333333333333, 0}}], 
                    Polygon3DBox[{{
                    0.41666666666666663`, 0.08333333333333333, 0}, {
                    0.29166666666666663`, 0.5, 0}, {0.25, 0.5, 0}, {
                    0.25, 0.36111111111111105`, 0}, {
                    0.3333333333333333, 0.08333333333333333, 0}}], 
                    Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
                    0.16666666666666666`, 0.9166666666666666, 0}, {
                    0.08333333333333333, 0.9166666666666666, 0}, {
                    0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
                    Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
                    0.41666666666666663`, 0.9166666666666666, 0}, {
                    0.3333333333333333, 0.9166666666666666, 0}, {
                    0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}]}, {
                    0.5, 0, 0}]}, {{1, 0, 0}, {0, 1, 0}, {0, 0, 1}}], {{1, 0, 
                  0}, {0, 0, -1}, {0, 1, 
                  0}}], {{-1., -1.2246467991473532`*^-16, 0.}, {
                 1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}], {1, 0, 
                0}], GeometricTransformation3DBox[
                GeometricTransformation3DBox[
                 GeometricTransformation3DBox[GeometricTransformation3DBox[
                   {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
                    Polygon3DBox[{{
                    0.41666666666666663`, 0.08333333333333333, 0}, {
                    0.41666666666666663`, 0.16666666666666666`, 0}, {
                    0.10833333333333334`, 0.16666666666666666`, 0}, {
                    0.08333333333333333, 0.08333333333333333, 0}}], 
                    Polygon3DBox[{{
                    0.19166666666666665`, 0.16666666666666666`, 0}, {
                    0.39166666666666666`, 0.8333333333333333, 0}, {
                    0.30833333333333335`, 0.8333333333333333, 0}, {
                    0.10833333333333334`, 0.16666666666666666`, 0}}], 
                    Polygon3DBox[{{
                    0.08333333333333333, 0.8333333333333333, 0}, {
                    0.39166666666666666`, 0.8333333333333333, 0}, {
                    0.41666666666666663`, 0.9166666666666666, 0}, {
                    0.08333333333333333, 0.9166666666666666, 0}}], 
                    GeometricTransformation3DBox[
                    {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
                    Polygon3DBox[{{
                    0.16666666666666666`, 0.08333333333333333, 0}, {
                    0.25, 0.36111111111111105`, 0}, {0.25, 0.5, 0}, {
                    0.20833333333333331`, 0.5, 0}, {
                    0.08333333333333333, 0.08333333333333333, 0}}], 
                    Polygon3DBox[{{
                    0.41666666666666663`, 0.08333333333333333, 0}, {
                    0.29166666666666663`, 0.5, 0}, {0.25, 0.5, 0}, {
                    0.25, 0.36111111111111105`, 0}, {
                    0.3333333333333333, 0.08333333333333333, 0}}], 
                    Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
                    0.16666666666666666`, 0.9166666666666666, 0}, {
                    0.08333333333333333, 0.9166666666666666, 0}, {
                    0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
                    Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
                    0.41666666666666663`, 0.9166666666666666, 0}, {
                    0.3333333333333333, 0.9166666666666666, 0}, {
                    0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}]}, {
                    0.5, 0, 0}]}, {{1, 0, 0}, {0, 1, 0}, {0, 0, 1}}], {{1, 0, 
                  0}, {0, 0, -1}, {0, 1, 
                  0}}], {{-1., -1.2246467991473532`*^-16, 0.}, {
                 1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}], {1, 1, 
                0}], GeometricTransformation3DBox[
                GeometricTransformation3DBox[GeometricTransformation3DBox[
                  {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
                   Polygon3DBox[{{
                    0.29166666666666663`, 0.08333333333333333, 0}, {
                    0.29166666666666663`, 0.5, 0}, {
                    0.20833333333333331`, 0.5, 0}, {
                    0.20833333333333331`, 0.08333333333333333, 0}}], 
                   Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
                    0.16666666666666666`, 0.9166666666666666, 0}, {
                    0.08333333333333333, 0.9166666666666666, 0}, {
                    0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
                   Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
                    0.41666666666666663`, 0.9166666666666666, 0}, {
                    0.3333333333333333, 0.9166666666666666, 0}, {
                    0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}], 
                   GeometricTransformation3DBox[
                    {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
                    Polygon3DBox[{{
                    0.41666666666666663`, 0.08333333333333333, 0}, {
                    0.41666666666666663`, 0.16666666666666666`, 0}, {
                    0.10833333333333334`, 0.16666666666666666`, 0}, {
                    0.08333333333333333, 0.08333333333333333, 0}}], 
                    Polygon3DBox[{{
                    0.19166666666666665`, 0.16666666666666666`, 0}, {
                    0.39166666666666666`, 0.8333333333333333, 0}, {
                    0.30833333333333335`, 0.8333333333333333, 0}, {
                    0.10833333333333334`, 0.16666666666666666`, 0}}], 
                    Polygon3DBox[{{
                    0.08333333333333333, 0.8333333333333333, 0}, {
                    0.39166666666666666`, 0.8333333333333333, 0}, {
                    0.41666666666666663`, 0.9166666666666666, 0}, {
                    0.08333333333333333, 0.9166666666666666, 0}}]}, {
                    0.5, 0, 0}]}, {{-1., -1.2246467991473532`*^-16, 0.}, {
                  1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}], {{1, 0, 
                 0}, {0, 0, 1}, {0, -1, 0}}], {{-1.8369701987210297`*^-16, 1.,
                 0.}, {-1., -1.8369701987210297`*^-16, 0.}, {0., 0., 1.}}], 
               GeometricTransformation3DBox[
                GeometricTransformation3DBox[
                 GeometricTransformation3DBox[GeometricTransformation3DBox[
                   {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
                    Polygon3DBox[{{
                    0.29166666666666663`, 0.08333333333333333, 0}, {
                    0.29166666666666663`, 0.5, 0}, {
                    0.20833333333333331`, 0.5, 0}, {
                    0.20833333333333331`, 0.08333333333333333, 0}}], 
                    Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
                    0.16666666666666666`, 0.9166666666666666, 0}, {
                    0.08333333333333333, 0.9166666666666666, 0}, {
                    0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
                    Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
                    0.41666666666666663`, 0.9166666666666666, 0}, {
                    0.3333333333333333, 0.9166666666666666, 0}, {
                    0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}], 
                    GeometricTransformation3DBox[
                    {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
                    Polygon3DBox[{{
                    0.41666666666666663`, 0.08333333333333333, 0}, {
                    0.41666666666666663`, 0.16666666666666666`, 0}, {
                    0.10833333333333334`, 0.16666666666666666`, 0}, {
                    0.08333333333333333, 0.08333333333333333, 0}}], 
                    Polygon3DBox[{{
                    0.19166666666666665`, 0.16666666666666666`, 0}, {
                    0.39166666666666666`, 0.8333333333333333, 0}, {
                    0.30833333333333335`, 0.8333333333333333, 0}, {
                    0.10833333333333334`, 0.16666666666666666`, 0}}], 
                    Polygon3DBox[{{
                    0.08333333333333333, 0.8333333333333333, 0}, {
                    0.39166666666666666`, 0.8333333333333333, 0}, {
                    0.41666666666666663`, 0.9166666666666666, 0}, {
                    0.08333333333333333, 0.9166666666666666, 0}}]}, {
                    0.5, 0, 0}]}, {{-1., -1.2246467991473532`*^-16, 0.}, {
                   1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}], {{1, 0,
                   0}, {0, 0, 1}, {0, -1, 0}}], {{-1.8369701987210297`*^-16, 
                 1., 0.}, {-1., -1.8369701987210297`*^-16, 0.}, {0., 0., 
                 1.}}], {1, 0, 0}], 
               {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
                Polygon3DBox[{{
                  0.16666666666666666`, 0.08333333333333333, 0}, {
                  0.25, 0.36111111111111105`, 0}, {0.25, 0.5, 0}, {
                  0.20833333333333331`, 0.5, 0}, {
                  0.08333333333333333, 0.08333333333333333, 0}}], 
                Polygon3DBox[{{
                  0.41666666666666663`, 0.08333333333333333, 0}, {
                  0.29166666666666663`, 0.5, 0}, {0.25, 0.5, 0}, {
                  0.25, 0.36111111111111105`, 0}, {
                  0.3333333333333333, 0.08333333333333333, 0}}], 
                Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
                  0.16666666666666666`, 0.9166666666666666, 0}, {
                  0.08333333333333333, 0.9166666666666666, 0}, {
                  0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
                Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
                  0.41666666666666663`, 0.9166666666666666, 0}, {
                  0.3333333333333333, 0.9166666666666666, 0}, {
                  0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}], 
                GeometricTransformation3DBox[
                 {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
                  Polygon3DBox[{{
                    0.29166666666666663`, 0.08333333333333333, 0}, {
                    0.29166666666666663`, 0.5, 0}, {
                    0.20833333333333331`, 0.5, 0}, {
                    0.20833333333333331`, 0.08333333333333333, 0}}], 
                  Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
                    0.16666666666666666`, 0.9166666666666666, 0}, {
                    0.08333333333333333, 0.9166666666666666, 0}, {
                    0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
                  Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
                    0.41666666666666663`, 0.9166666666666666, 0}, {
                    0.3333333333333333, 0.9166666666666666, 0}, {
                    0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}]}, {
                 0.5, 0, 0}]}, GeometricTransformation3DBox[
                {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
                 Polygon3DBox[{{
                   0.16666666666666666`, 0.08333333333333333, 0}, {
                   0.25, 0.36111111111111105`, 0}, {0.25, 0.5, 0}, {
                   0.20833333333333331`, 0.5, 0}, {
                   0.08333333333333333, 0.08333333333333333, 0}}], 
                 Polygon3DBox[{{
                   0.41666666666666663`, 0.08333333333333333, 0}, {
                   0.29166666666666663`, 0.5, 0}, {0.25, 0.5, 0}, {
                   0.25, 0.36111111111111105`, 0}, {
                   0.3333333333333333, 0.08333333333333333, 0}}], 
                 Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
                   0.16666666666666666`, 0.9166666666666666, 0}, {
                   0.08333333333333333, 0.9166666666666666, 0}, {
                   0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
                 Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
                   0.41666666666666663`, 0.9166666666666666, 0}, {
                   0.3333333333333333, 0.9166666666666666, 0}, {
                   0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}], 
                 GeometricTransformation3DBox[
                  {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
                   Polygon3DBox[{{
                    0.29166666666666663`, 0.08333333333333333, 0}, {
                    0.29166666666666663`, 0.5, 0}, {
                    0.20833333333333331`, 0.5, 0}, {
                    0.20833333333333331`, 0.08333333333333333, 0}}], 
                   Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
                    0.16666666666666666`, 0.9166666666666666, 0}, {
                    0.08333333333333333, 0.9166666666666666, 0}, {
                    0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
                   Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
                    0.41666666666666663`, 0.9166666666666666, 0}, {
                    0.3333333333333333, 0.9166666666666666, 0}, {
                    0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}]}, {
                  0.5, 0, 0}]}, {0, 0, 
                1}]}, {-0.5, -0.5, -0.5}]}}, {{-1., -1.2246467991473532`*^-16,
            0.}, {1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}], {{1, 0, 
          0}, {0, 0, 1}, {0, -1, 0}}], {{-0.9449569463147377, 
         0.32719469679615226`, 
         0.}, {-0.32719469679615226`, -0.9449569463147377, 0.}, {0., 0., 
         1.}}], {{-1., -1.2246467991473532`*^-16, 0.}, {
        1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}], {{1, 0, 0}, {0, 
       0, -1}, {0, 1, 0}}], {{-1., -1.2246467991473532`*^-16, 0.}, {
      1.2246467991473532`*^-16, -1., 0.}, {0., 0., 
      1.}}], {{-1., -1.2246467991473532`*^-16, 0.}, {
     1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}], {{1, 0, 0}, {0, 1, 
    0}, {0, 0, 1}}], {{-1., -1.2246467991473532`*^-16, 0.}, {
   1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}],
  Axes->True,
  AxesLabel->{
    FormBox["\"x\"", TraditionalForm], 
    FormBox["\"y\"", TraditionalForm], 
    FormBox["\"z\"", TraditionalForm]},
  FaceGrids->All,
  ImageSize->Automatic,
  Lighting->"Neutral",
  ViewPoint->{1.447443314965113, -2.501008366050979, 1.7606433491499107`},
  ViewVertical->{0.09006067645050585, -0.04988452886777254, 
   1.0530877375065182`}]], "Output",
 CellChangeTimes->{3.633016933058972*^9, 3.633017859584079*^9, 
  3.633018202238122*^9, 3.6677378754068527`*^9}],

Cell[CellGroupData[{

Cell["And about the Blue = Z axis:", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 CellChangeTimes->{{3.3876527511665573`*^9, 3.387652756963321*^9}, 
   3.3877316182833*^9, {3.387803771608252*^9, 3.387803800858252*^9}, {
   3.3878075380613766`*^9, 3.3878075572176266`*^9}}],

Cell[BoxData[
 RowBox[{"s3p", "[", 
  RowBox[{"rot\[Omega]", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"e", "[", "3", "]"}], "/", "3"}], ",", "xcube"}], "]"}], 
  "]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 CellChangeTimes->{
  3.3873661183454514`*^9, 3.3877316182833*^9, {3.387803771608252*^9, 
   3.387803800858252*^9}, {3.3878075380613766`*^9, 3.3878075572176266`*^9}, 
   3.429299764241617*^9, 3.633015060291486*^9, {3.6330169407631693`*^9, 
   3.633016941921002*^9}}]
}, Open  ]],

Cell[BoxData[
 Graphics3DBox[
  GeometricTransformation3DBox[
   GeometricTransformation3DBox[
    GeometricTransformation3DBox[
     GeometricTransformation3DBox[
      GeometricTransformation3DBox[
       GeometricTransformation3DBox[
        GeometricTransformation3DBox[
         GeometricTransformation3DBox[
          GeometricTransformation3DBox[{GeometricTransformation3DBox[
             {RGBColor[1, 0, 0], Thickness[0.01], 
              Line3DBox[{{0, 0, 0}, {1, 0, 0}}], 
              {RGBColor[0, 1, 0], Line3DBox[{{0, 0, 0}, {0, 1, 0}}]}, 
              {RGBColor[0, 0, 1], Line3DBox[{{0, 0, 0}, {0, 0, 1}}]}, 
              {RGBColor[0, 1, 1], Line3DBox[{{0, 0, 0}, {-1, 0, 0}}]}, 
              {RGBColor[1, 0, 1], Line3DBox[{{0, 0, 0}, {0, -1, 0}}]}, 
              {RGBColor[1, 1, 0], Line3DBox[{{0, 0, 0}, {0, 0, -1}}]}}, {{{2, 
              0, 0}, {0, 2, 0}, {0, 0, 2}}, {0, 0, 0}}], {
             GeometricTransformation3DBox[GeometricTransformation3DBox[{
                {FaceForm[RGBColor[0, 0, 1], RGBColor[1, 1, 0]], 
                 Polygon3DBox[{{0, 0, 0}, {1, 0, 0}, {1, 1, 0}, {0, 1, 0}}], 
                 Polygon3DBox[{{0, 0, 1}, {1, 0, 1}, {1, 1, 1}, {0, 1, 
                  1}}]}, 
                {FaceForm[RGBColor[0, 1, 0], RGBColor[1, 0, 1]], 
                 Polygon3DBox[{{0, 1, 1}, {1, 1, 1}, {1, 1, 0}, {0, 1, 0}}], 
                 Polygon3DBox[{{0, 0, 1}, {1, 0, 1}, {1, 0, 0}, {0, 0, 
                  0}}]}, 
                {FaceForm[RGBColor[1, 0, 0], RGBColor[0, 1, 1]], 
                 Polygon3DBox[{{0, 0, 0}, {0, 1, 0}, {0, 1, 1}, {0, 0, 1}}], 
                 Polygon3DBox[{{1, 0, 0}, {1, 1, 0}, {1, 1, 1}, {1, 0, 
                  1}}]}}, {-0.5, -0.5, -0.5}], {{{0.99, 0., 0.}, {0., 0.99, 
               0.}, {0., 0., 0.99}}, {0., 0., 0.}}], 
             GeometricTransformation3DBox[{
               GeometricTransformation3DBox[
                GeometricTransformation3DBox[
                 GeometricTransformation3DBox[GeometricTransformation3DBox[
                   {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
                    Polygon3DBox[{{
                    0.41666666666666663`, 0.08333333333333333, 0}, {
                    0.41666666666666663`, 0.16666666666666666`, 0}, {
                    0.10833333333333334`, 0.16666666666666666`, 0}, {
                    0.08333333333333333, 0.08333333333333333, 0}}], 
                    Polygon3DBox[{{
                    0.19166666666666665`, 0.16666666666666666`, 0}, {
                    0.39166666666666666`, 0.8333333333333333, 0}, {
                    0.30833333333333335`, 0.8333333333333333, 0}, {
                    0.10833333333333334`, 0.16666666666666666`, 0}}], 
                    Polygon3DBox[{{
                    0.08333333333333333, 0.8333333333333333, 0}, {
                    0.39166666666666666`, 0.8333333333333333, 0}, {
                    0.41666666666666663`, 0.9166666666666666, 0}, {
                    0.08333333333333333, 0.9166666666666666, 0}}], 
                    GeometricTransformation3DBox[
                    {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
                    Polygon3DBox[{{
                    0.16666666666666666`, 0.08333333333333333, 0}, {
                    0.25, 0.36111111111111105`, 0}, {0.25, 0.5, 0}, {
                    0.20833333333333331`, 0.5, 0}, {
                    0.08333333333333333, 0.08333333333333333, 0}}], 
                    Polygon3DBox[{{
                    0.41666666666666663`, 0.08333333333333333, 0}, {
                    0.29166666666666663`, 0.5, 0}, {0.25, 0.5, 0}, {
                    0.25, 0.36111111111111105`, 0}, {
                    0.3333333333333333, 0.08333333333333333, 0}}], 
                    Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
                    0.16666666666666666`, 0.9166666666666666, 0}, {
                    0.08333333333333333, 0.9166666666666666, 0}, {
                    0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
                    Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
                    0.41666666666666663`, 0.9166666666666666, 0}, {
                    0.3333333333333333, 0.9166666666666666, 0}, {
                    0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}]}, {
                    0.5, 0, 0}]}, {{1, 0, 0}, {0, 1, 0}, {0, 0, 1}}], {{1, 0, 
                  0}, {0, 0, -1}, {0, 1, 
                  0}}], {{-1., -1.2246467991473532`*^-16, 0.}, {
                 1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}], {1, 0, 
                0}], GeometricTransformation3DBox[
                GeometricTransformation3DBox[
                 GeometricTransformation3DBox[GeometricTransformation3DBox[
                   {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
                    Polygon3DBox[{{
                    0.41666666666666663`, 0.08333333333333333, 0}, {
                    0.41666666666666663`, 0.16666666666666666`, 0}, {
                    0.10833333333333334`, 0.16666666666666666`, 0}, {
                    0.08333333333333333, 0.08333333333333333, 0}}], 
                    Polygon3DBox[{{
                    0.19166666666666665`, 0.16666666666666666`, 0}, {
                    0.39166666666666666`, 0.8333333333333333, 0}, {
                    0.30833333333333335`, 0.8333333333333333, 0}, {
                    0.10833333333333334`, 0.16666666666666666`, 0}}], 
                    Polygon3DBox[{{
                    0.08333333333333333, 0.8333333333333333, 0}, {
                    0.39166666666666666`, 0.8333333333333333, 0}, {
                    0.41666666666666663`, 0.9166666666666666, 0}, {
                    0.08333333333333333, 0.9166666666666666, 0}}], 
                    GeometricTransformation3DBox[
                    {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
                    Polygon3DBox[{{
                    0.16666666666666666`, 0.08333333333333333, 0}, {
                    0.25, 0.36111111111111105`, 0}, {0.25, 0.5, 0}, {
                    0.20833333333333331`, 0.5, 0}, {
                    0.08333333333333333, 0.08333333333333333, 0}}], 
                    Polygon3DBox[{{
                    0.41666666666666663`, 0.08333333333333333, 0}, {
                    0.29166666666666663`, 0.5, 0}, {0.25, 0.5, 0}, {
                    0.25, 0.36111111111111105`, 0}, {
                    0.3333333333333333, 0.08333333333333333, 0}}], 
                    Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
                    0.16666666666666666`, 0.9166666666666666, 0}, {
                    0.08333333333333333, 0.9166666666666666, 0}, {
                    0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
                    Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
                    0.41666666666666663`, 0.9166666666666666, 0}, {
                    0.3333333333333333, 0.9166666666666666, 0}, {
                    0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}]}, {
                    0.5, 0, 0}]}, {{1, 0, 0}, {0, 1, 0}, {0, 0, 1}}], {{1, 0, 
                  0}, {0, 0, -1}, {0, 1, 
                  0}}], {{-1., -1.2246467991473532`*^-16, 0.}, {
                 1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}], {1, 1, 
                0}], GeometricTransformation3DBox[
                GeometricTransformation3DBox[GeometricTransformation3DBox[
                  {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
                   Polygon3DBox[{{
                    0.29166666666666663`, 0.08333333333333333, 0}, {
                    0.29166666666666663`, 0.5, 0}, {
                    0.20833333333333331`, 0.5, 0}, {
                    0.20833333333333331`, 0.08333333333333333, 0}}], 
                   Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
                    0.16666666666666666`, 0.9166666666666666, 0}, {
                    0.08333333333333333, 0.9166666666666666, 0}, {
                    0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
                   Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
                    0.41666666666666663`, 0.9166666666666666, 0}, {
                    0.3333333333333333, 0.9166666666666666, 0}, {
                    0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}], 
                   GeometricTransformation3DBox[
                    {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
                    Polygon3DBox[{{
                    0.41666666666666663`, 0.08333333333333333, 0}, {
                    0.41666666666666663`, 0.16666666666666666`, 0}, {
                    0.10833333333333334`, 0.16666666666666666`, 0}, {
                    0.08333333333333333, 0.08333333333333333, 0}}], 
                    Polygon3DBox[{{
                    0.19166666666666665`, 0.16666666666666666`, 0}, {
                    0.39166666666666666`, 0.8333333333333333, 0}, {
                    0.30833333333333335`, 0.8333333333333333, 0}, {
                    0.10833333333333334`, 0.16666666666666666`, 0}}], 
                    Polygon3DBox[{{
                    0.08333333333333333, 0.8333333333333333, 0}, {
                    0.39166666666666666`, 0.8333333333333333, 0}, {
                    0.41666666666666663`, 0.9166666666666666, 0}, {
                    0.08333333333333333, 0.9166666666666666, 0}}]}, {
                    0.5, 0, 0}]}, {{-1., -1.2246467991473532`*^-16, 0.}, {
                  1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}], {{1, 0, 
                 0}, {0, 0, 1}, {0, -1, 0}}], {{-1.8369701987210297`*^-16, 1.,
                 0.}, {-1., -1.8369701987210297`*^-16, 0.}, {0., 0., 1.}}], 
               GeometricTransformation3DBox[
                GeometricTransformation3DBox[
                 GeometricTransformation3DBox[GeometricTransformation3DBox[
                   {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
                    Polygon3DBox[{{
                    0.29166666666666663`, 0.08333333333333333, 0}, {
                    0.29166666666666663`, 0.5, 0}, {
                    0.20833333333333331`, 0.5, 0}, {
                    0.20833333333333331`, 0.08333333333333333, 0}}], 
                    Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
                    0.16666666666666666`, 0.9166666666666666, 0}, {
                    0.08333333333333333, 0.9166666666666666, 0}, {
                    0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
                    Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
                    0.41666666666666663`, 0.9166666666666666, 0}, {
                    0.3333333333333333, 0.9166666666666666, 0}, {
                    0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}], 
                    GeometricTransformation3DBox[
                    {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
                    Polygon3DBox[{{
                    0.41666666666666663`, 0.08333333333333333, 0}, {
                    0.41666666666666663`, 0.16666666666666666`, 0}, {
                    0.10833333333333334`, 0.16666666666666666`, 0}, {
                    0.08333333333333333, 0.08333333333333333, 0}}], 
                    Polygon3DBox[{{
                    0.19166666666666665`, 0.16666666666666666`, 0}, {
                    0.39166666666666666`, 0.8333333333333333, 0}, {
                    0.30833333333333335`, 0.8333333333333333, 0}, {
                    0.10833333333333334`, 0.16666666666666666`, 0}}], 
                    Polygon3DBox[{{
                    0.08333333333333333, 0.8333333333333333, 0}, {
                    0.39166666666666666`, 0.8333333333333333, 0}, {
                    0.41666666666666663`, 0.9166666666666666, 0}, {
                    0.08333333333333333, 0.9166666666666666, 0}}]}, {
                    0.5, 0, 0}]}, {{-1., -1.2246467991473532`*^-16, 0.}, {
                   1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}], {{1, 0,
                   0}, {0, 0, 1}, {0, -1, 0}}], {{-1.8369701987210297`*^-16, 
                 1., 0.}, {-1., -1.8369701987210297`*^-16, 0.}, {0., 0., 
                 1.}}], {1, 0, 0}], 
               {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
                Polygon3DBox[{{
                  0.16666666666666666`, 0.08333333333333333, 0}, {
                  0.25, 0.36111111111111105`, 0}, {0.25, 0.5, 0}, {
                  0.20833333333333331`, 0.5, 0}, {
                  0.08333333333333333, 0.08333333333333333, 0}}], 
                Polygon3DBox[{{
                  0.41666666666666663`, 0.08333333333333333, 0}, {
                  0.29166666666666663`, 0.5, 0}, {0.25, 0.5, 0}, {
                  0.25, 0.36111111111111105`, 0}, {
                  0.3333333333333333, 0.08333333333333333, 0}}], 
                Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
                  0.16666666666666666`, 0.9166666666666666, 0}, {
                  0.08333333333333333, 0.9166666666666666, 0}, {
                  0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
                Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
                  0.41666666666666663`, 0.9166666666666666, 0}, {
                  0.3333333333333333, 0.9166666666666666, 0}, {
                  0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}], 
                GeometricTransformation3DBox[
                 {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
                  Polygon3DBox[{{
                    0.29166666666666663`, 0.08333333333333333, 0}, {
                    0.29166666666666663`, 0.5, 0}, {
                    0.20833333333333331`, 0.5, 0}, {
                    0.20833333333333331`, 0.08333333333333333, 0}}], 
                  Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
                    0.16666666666666666`, 0.9166666666666666, 0}, {
                    0.08333333333333333, 0.9166666666666666, 0}, {
                    0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
                  Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
                    0.41666666666666663`, 0.9166666666666666, 0}, {
                    0.3333333333333333, 0.9166666666666666, 0}, {
                    0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}]}, {
                 0.5, 0, 0}]}, GeometricTransformation3DBox[
                {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
                 Polygon3DBox[{{
                   0.16666666666666666`, 0.08333333333333333, 0}, {
                   0.25, 0.36111111111111105`, 0}, {0.25, 0.5, 0}, {
                   0.20833333333333331`, 0.5, 0}, {
                   0.08333333333333333, 0.08333333333333333, 0}}], 
                 Polygon3DBox[{{
                   0.41666666666666663`, 0.08333333333333333, 0}, {
                   0.29166666666666663`, 0.5, 0}, {0.25, 0.5, 0}, {
                   0.25, 0.36111111111111105`, 0}, {
                   0.3333333333333333, 0.08333333333333333, 0}}], 
                 Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
                   0.16666666666666666`, 0.9166666666666666, 0}, {
                   0.08333333333333333, 0.9166666666666666, 0}, {
                   0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
                 Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
                   0.41666666666666663`, 0.9166666666666666, 0}, {
                   0.3333333333333333, 0.9166666666666666, 0}, {
                   0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}], 
                 GeometricTransformation3DBox[
                  {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
                   Polygon3DBox[{{
                    0.29166666666666663`, 0.08333333333333333, 0}, {
                    0.29166666666666663`, 0.5, 0}, {
                    0.20833333333333331`, 0.5, 0}, {
                    0.20833333333333331`, 0.08333333333333333, 0}}], 
                   Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
                    0.16666666666666666`, 0.9166666666666666, 0}, {
                    0.08333333333333333, 0.9166666666666666, 0}, {
                    0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
                   Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
                    0.41666666666666663`, 0.9166666666666666, 0}, {
                    0.3333333333333333, 0.9166666666666666, 0}, {
                    0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}]}, {
                  0.5, 0, 0}]}, {0, 0, 
                1}]}, {-0.5, -0.5, -0.5}]}}, {{-1., -1.2246467991473532`*^-16,
            0.}, {1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}], {{1, 0, 
          0}, {0, 1, 0}, {0, 0, 1}}], {{-0.9449569463147377, 
         0.32719469679615226`, 
         0.}, {-0.32719469679615226`, -0.9449569463147377, 0.}, {0., 0., 
         1.}}], {{-1., -1.2246467991473532`*^-16, 0.}, {
        1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}], {{1, 0, 0}, {0, 1,
        0}, {0, 0, 1}}], {{-1., -1.2246467991473532`*^-16, 0.}, {
      1.2246467991473532`*^-16, -1., 0.}, {0., 0., 
      1.}}], {{-1., -1.2246467991473532`*^-16, 0.}, {
     1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}], {{1, 0, 0}, {0, 1, 
    0}, {0, 0, 1}}], {{-1., -1.2246467991473532`*^-16, 0.}, {
   1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}],
  Axes->True,
  AxesLabel->{
    FormBox["\"x\"", TraditionalForm], 
    FormBox["\"y\"", TraditionalForm], 
    FormBox["\"z\"", TraditionalForm]},
  FaceGrids->All,
  ImageSize->Automatic,
  Lighting->"Neutral",
  ViewPoint->{1.2196270830925158`, -2.389214253555572, 2.062562733299071},
  ViewVertical->{-0.03593500725972466, 0.008808428317650514, 
   0.9993886319728831}]], "Output",
 CellChangeTimes->{3.633015905351602*^9, 3.633016942686466*^9, 
  3.6330178596395817`*^9, 3.633018202304826*^9, 3.6677378754601297`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"spin2\[Omega]", "[", 
    RowBox[{"\[Omega]_", ",", "o_", ",", 
     RowBox[{"reps_", ":", "25"}]}], "]"}], ":=", 
   RowBox[{"Animate", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Graphics3D", "[", 
      RowBox[{
       RowBox[{"rot\[Omega]", "[", 
        RowBox[{
         RowBox[{"t", " ", "\[Omega]"}], ",", "o"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Axes", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"AxesLabel", "\[Rule]", "axes"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "1", ",", 
       FractionBox["1", "reps"]}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.429298189344571*^9, 3.429298220667191*^9}, {
   3.4293004558331842`*^9, 3.429300458303892*^9}, {3.429316733565239*^9, 
   3.42931673689198*^9}, 3.6330159163582687`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"spin3\[Omega]", "[", 
    RowBox[{"\[Omega]_", ",", "o_", ",", 
     RowBox[{"reps_", ":", "25"}]}], "]"}], ":=", 
   RowBox[{"Animate", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Graphics3D", "[", 
      RowBox[{
       RowBox[{"rot\[Omega]", "[", 
        RowBox[{
         RowBox[{"t", " ", "\[Omega]"}], ",", "o"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Axes", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Lighting", "\[Rule]", "Automatic"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"AxesLabel", "\[Rule]", "axes"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "1", ",", 
       FractionBox["1", "reps"]}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.429298247656785*^9, 3.429298272471951*^9}, {
   3.42930046358398*^9, 3.429300465071683*^9}, 3.6330159237024527`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Rotation Quaternion and Derivatives", "Chapter",
 CellChangeTimes->{{3.633016989136036*^9, 3.633016995422553*^9}}],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["rQ[\[Theta]_, x_, y_, z_], rQ[\[Theta]_, v_]",
  FontWeight->"Bold"],
 " (rotation quaternion as twist + direction)\n",
 StyleBox["qm[w_]",
  FontWeight->"Bold"],
 " (rotation quat from a twist vector)\n",
 StyleBox["rv[q_, v_]",
  FontWeight->"Bold"],
 " (rotate vector ",
 StyleBox["v",
  FontWeight->"Bold"],
 " by quaternion ",
 StyleBox["q",
  FontWeight->"Bold"],
 ")\n",
 StyleBox["rf[q_, v_]",
  FontWeight->"Bold"],
 " (get new components of vector ",
 StyleBox["v",
  FontWeight->"Bold"],
 " in a frame rotated by quaternion ",
 StyleBox["q",
  FontWeight->"Bold"],
 ")\n",
 StyleBox["wnEU[wnm1_, dt_]",
  FontWeight->"Bold"],
 " (Euler integration for free rotation of an angular-velocity vector)\n",
 StyleBox["wnRK[wnm1_, dt_]",
  FontWeight->"Bold"],
 " (Runge-Kutta-4 integration for free rotation of an angular-velocity \
vector)\n",
 StyleBox["wnRKmo[wnm1_, dt_, mo_]",
  FontWeight->"Bold"],
 " (RK-4 integration for forced rotation of an ang-vel vector)\n",
 StyleBox["qnRK[qnm1_, wnm1_, dt_]",
  FontWeight->"Bold"],
 " (RK-4 integration for any rotation of a quaternion)\n",
 StyleBox["tumble1[w0_]",
  FontWeight->"Bold"],
 " (free motion of a test body starting off at angular velocity w0 in body \
frame)\n",
 StyleBox["tumble2[w0_, mo_]",
  FontWeight->"Bold"],
 " (forced motion of test body under constant (world-frame) torque)\n",
 StyleBox["tumble3[w0_, mo_, n_: globalNsteps]",
  FontWeight->"Bold"],
 " (unfinished massive top model)"
}], "Item",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.3878061385926266`*^9, 3.387806141920752*^9}, {
   3.3878061930926266`*^9, 3.387806242264502*^9}, {3.387807666170752*^9, 
   3.387807678202002*^9}, {3.3878078414363766`*^9, 3.3878078879363766`*^9}, {
   3.3878088488800516`*^9, 3.387808869395808*^9}, {3.387809104647182*^9, 
   3.3878092018190565`*^9}, {3.3878131234440565`*^9, 
   3.3878131589753065`*^9}, {3.387813205647182*^9, 3.387813231615932*^9}, {
   3.3878132650378065`*^9, 3.387813330272182*^9}, 3.3878133736940565`*^9, 
   3.3878174090690565`*^9}],

Cell["A rotation quaternion has a normalized pure part:", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.3878133736940565`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rQ", "[", 
   RowBox[{"\[Theta]_", ",", "x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"r", "=", 
       RowBox[{"Norm", "[", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z"}], "}"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]", "/", "2"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"s", "=", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]", "/", "2"}], "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Quaternion", "[", 
     RowBox[{"c", ",", 
      FractionBox[
       RowBox[{"s", " ", "x"}], "r"], ",", 
      FractionBox[
       RowBox[{"s", " ", "y"}], "r"], ",", 
      FractionBox[
       RowBox[{"s", " ", "z"}], "r"]}], "]"}]}], "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.3878133736940565`*^9, {3.429315347146286*^9, 3.429315358439096*^9}, {
   3.633017096982011*^9, 3.633017114294427*^9}}],

Cell["Overload:", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.3878133736940565`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rQ", "[", 
   RowBox[{"\[Theta]_", ",", "v_"}], "]"}], ":=", 
  RowBox[{"rQ", "[", 
   RowBox[{"\[Theta]", ",", 
    RowBox[{"v", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
    
    RowBox[{"v", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
    
    RowBox[{"v", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
   "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.3878133736940565`*^9}],

Cell[BoxData[
 RowBox[{"N", "@", 
  RowBox[{"rQ", "[", 
   RowBox[{
    RowBox[{"Pi", "/", "4"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.3878133736940565`*^9}],

Cell[BoxData[
 RowBox[{"Quaternion", "[", 
  RowBox[{
  "0.9238795325112867`", ",", "0.`", ",", "0.3826834323650898`", ",", "0.`"}],
   "]"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.633017125640394*^9, 3.633017859733025*^9, 
  3.633018202391741*^9, 3.667737875547756*^9}],

Cell[TextData[{
 StyleBox["qm[w]",
  FontWeight->"Bold"],
 " gets a rotation quaternion from one of our ",
 StyleBox["w",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 " types, that is, a vector whose norm is the twist angle and whose direction \
is the twist axis via right-hand rule:"
}], "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.387807581920752*^9, 3.387807651889502*^9}, 
   3.3878133736940565`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"qm", "[", "w_", "]"}], ":=", 
  RowBox[{"rQ", "[", 
   RowBox[{
    RowBox[{"Norm", "[", "w", "]"}], ",", "w"}], "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.3878133736940565`*^9}],

Cell["\<\
Keep track of orientation in a normalized quaternion. Convert quaternion to a \
\"w\" type for rendering.\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.3878133736940565`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"wm", "[", "q_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"cos\[Theta]2", "=", 
        RowBox[{"q", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
        ",", "\[IndentingNewLine]", 
       RowBox[{"z", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"q", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
           ",", 
          RowBox[{"q", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
           ",", 
          RowBox[{
          "q", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], 
         "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     FractionBox[
      RowBox[{"2", 
       RowBox[{"ArcCos", "[", "cos\[Theta]2", "]"}], " ", "z"}], 
      RowBox[{"Norm", "[", "z", "]"}]]}], "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.3878133736940565`*^9, 3.429302520658209*^9, {3.429315485892083*^9, 
   3.4293155006974363`*^9}, {3.633017169644786*^9, 3.6330171769968557`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Unit Test", "Subsubsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"ww", "=", 
     RowBox[{"ran3", "[", "]"}]}], "}"}], ",", 
   RowBox[{
    RowBox[{"wm", "[", 
     RowBox[{"qm", "[", "ww", "]"}], "]"}], "\[Equal]", "ww"}]}], 
  "]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],

Cell[BoxData["True"], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.6330171858314037`*^9, 3.6330178597930803`*^9, 
  3.6330182026140127`*^9, 3.6677378757901897`*^9}]
}, Open  ]],

Cell["Test quaternion: a twist of angle \[Theta] about the z axis:", "Text",
 CellChangeTimes->{{3.429369966504532*^9, 3.429370002296111*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tq", "=", 
  RowBox[{"Quaternion", "[", 
   RowBox[{
    RowBox[{"Cos", "[", 
     FractionBox["\[Theta]", "2"], "]"}], ",", "0", ",", "0", ",", 
    RowBox[{"Sin", "[", 
     FractionBox["\[Theta]", "2"], "]"}]}], "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.3878133736940565`*^9, {3.633017302093755*^9, 3.633017311122101*^9}}],

Cell[BoxData[
 RowBox[{"Quaternion", "[", 
  RowBox[{
   RowBox[{"Cos", "[", 
    FractionBox["\[Theta]", "2"], "]"}], ",", "0", ",", "0", ",", 
   RowBox[{"Sin", "[", 
    FractionBox["\[Theta]", "2"], "]"}]}], "]"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.633017312171894*^9, 3.633017859814775*^9, 
  3.6330182026434927`*^9, 3.667737875832477*^9}]
}, Open  ]],

Cell["\<\
See how the OBJECT-rotation primitive affects the unit x-axis as an object:\
\>", "Text",
 CellChangeTimes->{{3.429370018520733*^9, 3.429370036680549*^9}, {
  3.6330173444661837`*^9, 3.6330173577058268`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "@", 
  RowBox[{"(", 
   RowBox[{"tq", "**", 
    RowBox[{"Quaternion", "[", 
     RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "]"}], "**", 
    SuperscriptBox["tq", "\[Conjugate]"]}], ")"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.3878133736940565`*^9, {3.633017387225388*^9, 3.63301739696323*^9}}],

Cell[BoxData[
 RowBox[{"Quaternion", "[", 
  RowBox[{"0", ",", 
   RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
   RowBox[{"Sin", "[", "\[Theta]", "]"}], ",", "0"}], "]"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.633017321720709*^9, 3.633017398163899*^9, 
  3.633017859858439*^9, 3.6330182027719593`*^9, 3.667737875873946*^9}]
}, Open  ]],

Cell["and the unit y-axis:", "Text",
 CellChangeTimes->{{3.4293700417720585`*^9, 3.429370050928974*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "@", 
  RowBox[{"(", 
   RowBox[{"tq", "**", 
    RowBox[{"Quaternion", "[", 
     RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "]"}], "**", 
    SuperscriptBox["tq", "\[Conjugate]"]}], ")"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.3878133736940565`*^9, 3.6330174335747013`*^9}],

Cell[BoxData[
 RowBox[{"Quaternion", "[", 
  RowBox[{"0", ",", 
   RowBox[{"-", 
    RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
   RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", "0"}], "]"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.633017435196123*^9, 3.633017859879668*^9, 
  3.633018202790962*^9, 3.667737875914898*^9}],

Cell["OBJECT-Rotate an arbitrary vector as an object:", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.3878133736940565`*^9, {3.429275906197578*^9, 3.429275909478766*^9}, {
   3.4293700615860395`*^9, 3.429370064202301*^9}, {3.633017440390994*^9, 
   3.633017446783087*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"rv", "[", 
    RowBox[{"q_", ",", "v_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"out", "=", "\[IndentingNewLine]", 
       RowBox[{"FullSimplify", "[", "\[IndentingNewLine]", 
        RowBox[{"q", "**", 
         RowBox[{"Quaternion", "[", 
          RowBox[{"0", ",", 
           RowBox[{
           "v", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
           RowBox[{
           "v", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
           RowBox[{
           "v", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
          "]"}], "**", 
         SuperscriptBox["q", "\[Conjugate]"]}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"out", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
       ",", 
       RowBox[{"out", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
       ",", 
       RowBox[{
       "out", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], 
      "}"}]}], "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.3878133736940565`*^9, {3.633017457949815*^9, 3.633017460179311*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"SetDelayed", "::", "write"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Tag \[NoBreak]\\!\\(\\*RowBox[{\\\"rv\\\"}]\\)\[NoBreak] \
in \[NoBreak]\\!\\(\\*RowBox[{\\\"rv\\\", \\\"[\\\", RowBox[{\\\"q_\\\", \
\\\",\\\", \\\"v_\\\"}], \\\"]\\\"}]\\)\[NoBreak] is Protected. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/write\\\", \
ButtonNote -> \\\"SetDelayed::write\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.667737875993936*^9}],

Cell[CellGroupData[{

Cell["Rotate a frame:", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.3878133736940565`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"rf", "[", 
    RowBox[{"q_", ",", "v_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"out", "=", "\[IndentingNewLine]", 
       RowBox[{"FullSimplify", "[", "\[IndentingNewLine]", 
        RowBox[{
         SuperscriptBox["q", "\[Conjugate]"], "**", 
         RowBox[{"Quaternion", "[", 
          RowBox[{"0", ",", 
           RowBox[{
           "v", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
           RowBox[{
           "v", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
           RowBox[{
           "v", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
          "]"}], "**", "q"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"out", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
       ",", 
       RowBox[{"out", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
       ",", 
       RowBox[{
       "out", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], 
      "}"}]}], "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.3878133736940565`*^9, {3.6330174792993593`*^9, 3.633017481474729*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"SetDelayed", "::", "write"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Tag \[NoBreak]\\!\\(\\*RowBox[{\\\"rf\\\"}]\\)\[NoBreak] \
in \[NoBreak]\\!\\(\\*RowBox[{\\\"rf\\\", \\\"[\\\", RowBox[{\\\"q_\\\", \
\\\",\\\", \\\"v_\\\"}], \\\"]\\\"}]\\)\[NoBreak] is Protected. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/write\\\", \
ButtonNote -> \\\"SetDelayed::write\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.6677378760977297`*^9}],

Cell[CellGroupData[{

Cell["Define a couple of objects to play with:", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.387808587703992*^9, 3.387808629501669*^9}, 
   3.3878133736940565`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"raf", "=", 
   RowBox[{"N", "@", 
    RowBox[{"Normalize", "@", 
     RowBox[{"{", 
      RowBox[{"40", ",", "35", ",", "45"}], "}"}]}]}]}], 
  RowBox[{"(*", 
   RowBox[{"ran3", "[", "]"}], "*)"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rw", "=", 
   RowBox[{"Scale", "[", 
    RowBox[{"xcube", ",", "raf", ",", "o"}], "]"}]}], ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.6330175067908382`*^9}],

Cell[BoxData[
 RowBox[{"s3p", "[", "rw", "]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.387367472983325*^9, 3.3878133736940565`*^9}]
}, Open  ]],

Cell[BoxData[
 Graphics3DBox[GeometricTransformation3DBox[{GeometricTransformation3DBox[
     {RGBColor[1, 0, 0], Thickness[0.01], Line3DBox[{{0, 0, 0}, {1, 0, 0}}], 
      {RGBColor[0, 1, 0], Line3DBox[{{0, 0, 0}, {0, 1, 0}}]}, 
      {RGBColor[0, 0, 1], Line3DBox[{{0, 0, 0}, {0, 0, 1}}]}, 
      {RGBColor[0, 1, 1], Line3DBox[{{0, 0, 0}, {-1, 0, 0}}]}, 
      {RGBColor[1, 0, 1], Line3DBox[{{0, 0, 0}, {0, -1, 0}}]}, 
      {RGBColor[1, 1, 0], Line3DBox[{{0, 0, 0}, {0, 0, -1}}]}}, {{{2, 0, 0}, {
      0, 2, 0}, {0, 0, 2}}, {0, 0, 0}}], {
     GeometricTransformation3DBox[GeometricTransformation3DBox[{
        {FaceForm[RGBColor[0, 0, 1], RGBColor[1, 1, 0]], 
         Polygon3DBox[{{0, 0, 0}, {1, 0, 0}, {1, 1, 0}, {0, 1, 0}}], 
         Polygon3DBox[{{0, 0, 1}, {1, 0, 1}, {1, 1, 1}, {0, 1, 1}}]}, 
        {FaceForm[RGBColor[0, 1, 0], RGBColor[1, 0, 1]], 
         Polygon3DBox[{{0, 1, 1}, {1, 1, 1}, {1, 1, 0}, {0, 1, 0}}], 
         Polygon3DBox[{{0, 0, 1}, {1, 0, 1}, {1, 0, 0}, {0, 0, 0}}]}, 
        {FaceForm[RGBColor[1, 0, 0], RGBColor[0, 1, 1]], 
         Polygon3DBox[{{0, 0, 0}, {0, 1, 0}, {0, 1, 1}, {0, 0, 1}}], 
         Polygon3DBox[{{1, 0, 0}, {1, 1, 0}, {1, 1, 1}, {1, 0, 
          1}}]}}, {-0.5, -0.5, -0.5}], {{{0.99, 0., 0.}, {0., 0.99, 0.}, {0., 
       0., 0.99}}, {0., 0., 0.}}], 
     GeometricTransformation3DBox[{
       GeometricTransformation3DBox[
        GeometricTransformation3DBox[
         GeometricTransformation3DBox[GeometricTransformation3DBox[
           {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
            Polygon3DBox[{{0.41666666666666663`, 0.08333333333333333, 0}, {
              0.41666666666666663`, 0.16666666666666666`, 0}, {
              0.10833333333333334`, 0.16666666666666666`, 0}, {
              0.08333333333333333, 0.08333333333333333, 0}}], 
            Polygon3DBox[{{0.19166666666666665`, 0.16666666666666666`, 0}, {
              0.39166666666666666`, 0.8333333333333333, 0}, {
              0.30833333333333335`, 0.8333333333333333, 0}, {
              0.10833333333333334`, 0.16666666666666666`, 0}}], 
            Polygon3DBox[{{0.08333333333333333, 0.8333333333333333, 0}, {
              0.39166666666666666`, 0.8333333333333333, 0}, {
              0.41666666666666663`, 0.9166666666666666, 0}, {
              0.08333333333333333, 0.9166666666666666, 0}}], 
            GeometricTransformation3DBox[
             {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
              Polygon3DBox[{{0.16666666666666666`, 0.08333333333333333, 0}, {
                0.25, 0.36111111111111105`, 0}, {0.25, 0.5, 0}, {
                0.20833333333333331`, 0.5, 0}, {
                0.08333333333333333, 0.08333333333333333, 0}}], 
              Polygon3DBox[{{0.41666666666666663`, 0.08333333333333333, 0}, {
                0.29166666666666663`, 0.5, 0}, {0.25, 0.5, 0}, {
                0.25, 0.36111111111111105`, 0}, {
                0.3333333333333333, 0.08333333333333333, 0}}], 
              Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
                0.16666666666666666`, 0.9166666666666666, 0}, {
                0.08333333333333333, 0.9166666666666666, 0}, {
                0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
              Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
                0.41666666666666663`, 0.9166666666666666, 0}, {
                0.3333333333333333, 0.9166666666666666, 0}, {
                0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}]}, {
             0.5, 0, 0}]}, {{1, 0, 0}, {0, 1, 0}, {0, 0, 1}}], {{1, 0, 0}, {0,
           0, -1}, {0, 1, 0}}], {{-1., -1.2246467991473532`*^-16, 0.}, {
         1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}], {1, 0, 0}], 
       GeometricTransformation3DBox[
        GeometricTransformation3DBox[
         GeometricTransformation3DBox[GeometricTransformation3DBox[
           {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
            Polygon3DBox[{{0.41666666666666663`, 0.08333333333333333, 0}, {
              0.41666666666666663`, 0.16666666666666666`, 0}, {
              0.10833333333333334`, 0.16666666666666666`, 0}, {
              0.08333333333333333, 0.08333333333333333, 0}}], 
            Polygon3DBox[{{0.19166666666666665`, 0.16666666666666666`, 0}, {
              0.39166666666666666`, 0.8333333333333333, 0}, {
              0.30833333333333335`, 0.8333333333333333, 0}, {
              0.10833333333333334`, 0.16666666666666666`, 0}}], 
            Polygon3DBox[{{0.08333333333333333, 0.8333333333333333, 0}, {
              0.39166666666666666`, 0.8333333333333333, 0}, {
              0.41666666666666663`, 0.9166666666666666, 0}, {
              0.08333333333333333, 0.9166666666666666, 0}}], 
            GeometricTransformation3DBox[
             {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
              Polygon3DBox[{{0.16666666666666666`, 0.08333333333333333, 0}, {
                0.25, 0.36111111111111105`, 0}, {0.25, 0.5, 0}, {
                0.20833333333333331`, 0.5, 0}, {
                0.08333333333333333, 0.08333333333333333, 0}}], 
              Polygon3DBox[{{0.41666666666666663`, 0.08333333333333333, 0}, {
                0.29166666666666663`, 0.5, 0}, {0.25, 0.5, 0}, {
                0.25, 0.36111111111111105`, 0}, {
                0.3333333333333333, 0.08333333333333333, 0}}], 
              Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
                0.16666666666666666`, 0.9166666666666666, 0}, {
                0.08333333333333333, 0.9166666666666666, 0}, {
                0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
              Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
                0.41666666666666663`, 0.9166666666666666, 0}, {
                0.3333333333333333, 0.9166666666666666, 0}, {
                0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}]}, {
             0.5, 0, 0}]}, {{1, 0, 0}, {0, 1, 0}, {0, 0, 1}}], {{1, 0, 0}, {0,
           0, -1}, {0, 1, 0}}], {{-1., -1.2246467991473532`*^-16, 0.}, {
         1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}], {1, 1, 0}], 
       GeometricTransformation3DBox[
        GeometricTransformation3DBox[GeometricTransformation3DBox[
          {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
           Polygon3DBox[{{0.29166666666666663`, 0.08333333333333333, 0}, {
             0.29166666666666663`, 0.5, 0}, {0.20833333333333331`, 0.5, 0}, {
             0.20833333333333331`, 0.08333333333333333, 0}}], 
           Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
             0.16666666666666666`, 0.9166666666666666, 0}, {
             0.08333333333333333, 0.9166666666666666, 0}, {
             0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
           Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
             0.41666666666666663`, 0.9166666666666666, 0}, {
             0.3333333333333333, 0.9166666666666666, 0}, {
             0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}], 
           GeometricTransformation3DBox[
            {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
             Polygon3DBox[{{0.41666666666666663`, 0.08333333333333333, 0}, {
               0.41666666666666663`, 0.16666666666666666`, 0}, {
               0.10833333333333334`, 0.16666666666666666`, 0}, {
               0.08333333333333333, 0.08333333333333333, 0}}], 
             Polygon3DBox[{{0.19166666666666665`, 0.16666666666666666`, 0}, {
               0.39166666666666666`, 0.8333333333333333, 0}, {
               0.30833333333333335`, 0.8333333333333333, 0}, {
               0.10833333333333334`, 0.16666666666666666`, 0}}], 
             Polygon3DBox[{{0.08333333333333333, 0.8333333333333333, 0}, {
               0.39166666666666666`, 0.8333333333333333, 0}, {
               0.41666666666666663`, 0.9166666666666666, 0}, {
               0.08333333333333333, 0.9166666666666666, 0}}]}, {
            0.5, 0, 0}]}, {{-1., -1.2246467991473532`*^-16, 0.}, {
          1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}], {{1, 0, 0}, {0, 
         0, 1}, {0, -1, 0}}], {{-1.8369701987210297`*^-16, 1., 
        0.}, {-1., -1.8369701987210297`*^-16, 0.}, {0., 0., 1.}}], 
       GeometricTransformation3DBox[
        GeometricTransformation3DBox[
         GeometricTransformation3DBox[GeometricTransformation3DBox[
           {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
            Polygon3DBox[{{0.29166666666666663`, 0.08333333333333333, 0}, {
              0.29166666666666663`, 0.5, 0}, {0.20833333333333331`, 0.5, 0}, {
              0.20833333333333331`, 0.08333333333333333, 0}}], 
            Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
              0.16666666666666666`, 0.9166666666666666, 0}, {
              0.08333333333333333, 0.9166666666666666, 0}, {
              0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
            Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
              0.41666666666666663`, 0.9166666666666666, 0}, {
              0.3333333333333333, 0.9166666666666666, 0}, {
              0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}], 
            GeometricTransformation3DBox[
             {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
              Polygon3DBox[{{0.41666666666666663`, 0.08333333333333333, 0}, {
                0.41666666666666663`, 0.16666666666666666`, 0}, {
                0.10833333333333334`, 0.16666666666666666`, 0}, {
                0.08333333333333333, 0.08333333333333333, 0}}], 
              Polygon3DBox[{{0.19166666666666665`, 0.16666666666666666`, 0}, {
                0.39166666666666666`, 0.8333333333333333, 0}, {
                0.30833333333333335`, 0.8333333333333333, 0}, {
                0.10833333333333334`, 0.16666666666666666`, 0}}], 
              Polygon3DBox[{{0.08333333333333333, 0.8333333333333333, 0}, {
                0.39166666666666666`, 0.8333333333333333, 0}, {
                0.41666666666666663`, 0.9166666666666666, 0}, {
                0.08333333333333333, 0.9166666666666666, 0}}]}, {
             0.5, 0, 0}]}, {{-1., -1.2246467991473532`*^-16, 0.}, {
           1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}], {{1, 0, 0}, {0,
           0, 1}, {0, -1, 0}}], {{-1.8369701987210297`*^-16, 1., 
         0.}, {-1., -1.8369701987210297`*^-16, 0.}, {0., 0., 1.}}], {1, 0, 
        0}], 
       {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
        Polygon3DBox[{{0.16666666666666666`, 0.08333333333333333, 0}, {
          0.25, 0.36111111111111105`, 0}, {0.25, 0.5, 0}, {
          0.20833333333333331`, 0.5, 0}, {
          0.08333333333333333, 0.08333333333333333, 0}}], 
        Polygon3DBox[{{0.41666666666666663`, 0.08333333333333333, 0}, {
          0.29166666666666663`, 0.5, 0}, {0.25, 0.5, 0}, {
          0.25, 0.36111111111111105`, 0}, {
          0.3333333333333333, 0.08333333333333333, 0}}], 
        Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
          0.16666666666666666`, 0.9166666666666666, 0}, {
          0.08333333333333333, 0.9166666666666666, 0}, {
          0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
        Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
          0.41666666666666663`, 0.9166666666666666, 0}, {
          0.3333333333333333, 0.9166666666666666, 0}, {
          0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}], 
        GeometricTransformation3DBox[
         {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
          Polygon3DBox[{{0.29166666666666663`, 0.08333333333333333, 0}, {
            0.29166666666666663`, 0.5, 0}, {0.20833333333333331`, 0.5, 0}, {
            0.20833333333333331`, 0.08333333333333333, 0}}], 
          Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
            0.16666666666666666`, 0.9166666666666666, 0}, {
            0.08333333333333333, 0.9166666666666666, 0}, {
            0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
          Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
            0.41666666666666663`, 0.9166666666666666, 0}, {
            0.3333333333333333, 0.9166666666666666, 0}, {
            0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}]}, {0.5, 0, 0}]}, 
       GeometricTransformation3DBox[
        {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
         Polygon3DBox[{{0.16666666666666666`, 0.08333333333333333, 0}, {
           0.25, 0.36111111111111105`, 0}, {0.25, 0.5, 0}, {
           0.20833333333333331`, 0.5, 0}, {
           0.08333333333333333, 0.08333333333333333, 0}}], 
         Polygon3DBox[{{0.41666666666666663`, 0.08333333333333333, 0}, {
           0.29166666666666663`, 0.5, 0}, {0.25, 0.5, 0}, {
           0.25, 0.36111111111111105`, 0}, {
           0.3333333333333333, 0.08333333333333333, 0}}], 
         Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
           0.16666666666666666`, 0.9166666666666666, 0}, {
           0.08333333333333333, 0.9166666666666666, 0}, {
           0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
         Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
           0.41666666666666663`, 0.9166666666666666, 0}, {
           0.3333333333333333, 0.9166666666666666, 0}, {
           0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}], 
         GeometricTransformation3DBox[
          {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
           Polygon3DBox[{{0.29166666666666663`, 0.08333333333333333, 0}, {
             0.29166666666666663`, 0.5, 0}, {0.20833333333333331`, 0.5, 0}, {
             0.20833333333333331`, 0.08333333333333333, 0}}], 
           Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
             0.16666666666666666`, 0.9166666666666666, 0}, {
             0.08333333333333333, 0.9166666666666666, 0}, {
             0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
           Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
             0.41666666666666663`, 0.9166666666666666, 0}, {
             0.3333333333333333, 0.9166666666666666, 0}, {
             0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}]}, {0.5, 0, 0}]}, {
        0, 0, 1}]}, {-0.5, -0.5, -0.5}]}}, {{{0.5743665268941904, 0., 0.}, {
    0., 0.5025707110324167, 0.}, {0., 0., 0.6461623427559644}}, {0., 0., 0.}}],
  Axes->True,
  AxesLabel->{
    FormBox["\"x\"", TraditionalForm], 
    FormBox["\"y\"", TraditionalForm], 
    FormBox["\"z\"", TraditionalForm]},
  FaceGrids->All,
  ImageSize->Automatic,
  Lighting->"Neutral",
  ViewPoint->{-2.17200167489646, 2.118001493976588, 1.498825672238077},
  ViewVertical->{-0.42319232283972014`, -0.06927202868361038, 
   1.0199101870700353`}]], "Output",
 CellChangeTimes->{{3.633017501744467*^9, 3.633017508205326*^9}, 
   3.633017859976636*^9, 3.633018202904086*^9, 3.667737876300609*^9}],

Cell[TextData[{
 StyleBox["mi",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 " is moment of inertia, ",
 StyleBox["mo",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 " is moment of forces, i.e., torque."
}], "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.3878133736940565`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"mi", "=", 
    RowBox[{"(", GridBox[{
       {
        FractionBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{
           "raf", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
           "2"], "+", 
          SuperscriptBox[
           RowBox[{
           "raf", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
           "2"]}], "12"], "0", "0"},
       {"0", 
        FractionBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{
           "raf", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
           "2"], "+", 
          SuperscriptBox[
           RowBox[{
           "raf", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           "2"]}], "12"], "0"},
       {"0", "0", 
        FractionBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{
           "raf", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           "2"], "+", 
          SuperscriptBox[
           RowBox[{
           "raf", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
           "2"]}], "12"]}
      }], ")"}]}], ")"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.6330175230588703`*^9, 3.633017622914036*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.05584192439862543`", "0", "0"},
     {"0", "0.062285223367697595`", "0"},
     {"0", "0", "0.04853951890034364`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.633017624080159*^9, 3.633017860004964*^9, 
  3.633018202948834*^9, 3.667737876389576*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"mii", "=", 
    RowBox[{"Inverse", "[", "mi", "]"}]}], ")"}], "//", 
  "MatrixForm"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"17.907692307692308`", "0.`", "0.`"},
     {"0.`", "16.055172413793102`", "0.`"},
     {"0.`", "0.`", "20.601769911504427`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.6330176296160707`*^9, 3.633017860051001*^9, 
  3.6330182029920464`*^9, 3.667737876455071*^9}],

Cell[CellGroupData[{

Cell[TextData[{
 "Euler's equations for rigid-body motion: components of ",
 StyleBox["w",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 " are in the body-fixed frame and must be rotated back to the inertial frame \
for display:"
}], "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.387807988389502*^9, 3.387808024389502*^9}, 
   3.3878133736940565`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dwdt", "[", 
   RowBox[{"w_", ",", "mi_", ",", "mii_", ",", "mo_"}], "]"}], ":=", 
  RowBox[{"mii", ".", 
   RowBox[{"(", 
    RowBox[{"mo", "-", 
     RowBox[{"w", "\[Cross]", 
      RowBox[{"(", 
       RowBox[{"mi", ".", "w"}], ")"}]}]}], ")"}]}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.3878133736940565`*^9, {3.633017642386235*^9, 3.633017670738926*^9}, {
   3.6330178243877296`*^9, 3.6330178275540657`*^9}}],

Cell[TextData[{
 "Euler integration for free rotation (no torques); yields ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["w", "n"], TraditionalForm]]],
 " given ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["w", 
    RowBox[{"n", "-", "1"}]], TraditionalForm]]],
 " and time",
 StyleBox[" dt",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 ":"
}], "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.3878083469676266`*^9, 3.387808414389502*^9}, {
   3.387808525280918*^9, 3.3878085388905544`*^9}, 3.3878133736940565`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"wnEU", "[", 
   RowBox[{"wnm1_", ",", "dt_"}], "]"}], ":=", 
  RowBox[{"wnm1", "+", 
   RowBox[{"dt", "*", 
    RowBox[{"dwdt", "[", 
     RowBox[{"wnm1", ",", "mi", ",", "mii", ",", "0"}], "]"}]}]}]}]], "Input",\

 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.3878133736940565`*^9}],

Cell[TextData[{
 "Runge-Kutta (order 4) integration for free rotation (no torques); yields ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["w", "n"], TraditionalForm]]],
 " given ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["w", 
    RowBox[{"n", "-", "1"}]], TraditionalForm]]],
 " and time",
 StyleBox[" dt",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 ":"
}], "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.387808497530385*^9, 3.387808516374497*^9}, 
   3.387808547046961*^9, 3.3878133736940565`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"wnRK", "[", 
   RowBox[{"wnm1_", ",", "dt_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"k1", "=", 
      RowBox[{"dt", "*", 
       RowBox[{"dwdt", "[", 
        RowBox[{"wnm1", ",", "mi", ",", "mii", ",", "0"}], "]"}]}]}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"k2", "=", 
        RowBox[{"dt", "*", 
         RowBox[{"dwdt", "[", 
          RowBox[{
           RowBox[{"wnm1", "+", 
            RowBox[{"k1", "/", "2"}]}], ",", "mi", ",", "mii", ",", "0"}], 
          "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"k3", "=", 
          RowBox[{"dt", "*", 
           RowBox[{"dwdt", "[", 
            RowBox[{
             RowBox[{"wnm1", "+", 
              RowBox[{"k2", "/", "2"}]}], ",", "mi", ",", "mii", ",", "0"}], 
            "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"k4", "=", 
            RowBox[{"dt", "*", 
             RowBox[{"dwdt", "[", 
              RowBox[{
               RowBox[{"wnm1", "+", "k3"}], ",", "mi", ",", "mii", ",", "0"}],
               "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"wnm1", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"k1", "+", 
              RowBox[{"2", "k2"}], "+", 
              RowBox[{"2", "k3"}], "+", "k4"}], ")"}], "/", "6"}]}]}], 
         "]"}]}], "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],

Cell[TextData[{
 "Runge-Kutta (order 4) integration for forced rotation (with torques); \
yields ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["w", "n"], TraditionalForm]]],
 " given ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["w", 
    RowBox[{"n", "-", "1"}]], TraditionalForm]]],
 " and time",
 StyleBox[" dt",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 " (undone: redo this with a default for ",
 StyleBox["mo",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 ")"
}], "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.387808497530385*^9, 3.387808516374497*^9}, 
   3.387808547046961*^9, {3.3878089566932416`*^9, 3.3878089871778116`*^9}, 
   3.3878133736940565`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"wnRKmo", "[", 
   RowBox[{"wnm1_", ",", "dt_", ",", "mo_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"k1", "=", 
      RowBox[{"dt", "*", 
       RowBox[{"dwdt", "[", 
        RowBox[{"wnm1", ",", "mi", ",", "mii", ",", "mo"}], "]"}]}]}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"k2", "=", 
        RowBox[{"dt", "*", 
         RowBox[{"dwdt", "[", 
          RowBox[{
           RowBox[{"wnm1", "+", 
            RowBox[{"k1", "/", "2"}]}], ",", "mi", ",", "mii", ",", "mo"}], 
          "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"k3", "=", 
          RowBox[{"dt", "*", 
           RowBox[{"dwdt", "[", 
            RowBox[{
             RowBox[{"wnm1", "+", 
              RowBox[{"k2", "/", "2"}]}], ",", "mi", ",", "mii", ",", "mo"}], 
            "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"k4", "=", 
            RowBox[{"dt", "*", 
             RowBox[{"dwdt", "[", 
              RowBox[{
               RowBox[{"wnm1", "+", "k3"}], ",", "mi", ",", "mii", ",", 
               "mo"}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"wnm1", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"k1", "+", 
              RowBox[{"2", "k2"}], "+", 
              RowBox[{"2", "k3"}], "+", "k4"}], ")"}], "/", "6"}]}]}], 
         "]"}]}], "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],

Cell[TextData[{
 "Time derivative of the rotation quaternion ",
 StyleBox["q",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 " given angular velocity vector ",
 StyleBox["w ",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 "in body-fixed coordinates:"
}], "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.387807935827002*^9, 3.3878079371551266`*^9}, {
   3.3878086403612523`*^9, 3.3878087719887795`*^9}, {3.387812836803432*^9, 
   3.387812906084682*^9}, {3.387812985053432*^9, 3.387813001584682*^9}, 
   3.3878133736940565`*^9, 3.429302776744568*^9}],

Cell[TextData[{
 "UNDONE: Prove this formula ",
 StyleBox["dqdt = (",
  FontWeight->"Bold"],
 StyleBox["q",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 StyleBox[" ** ",
  FontWeight->"Bold"],
 StyleBox["q",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 StyleBox["[0,",
  FontWeight->"Bold"],
 StyleBox["w",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 StyleBox["])/2",
  FontWeight->"Bold"],
 ", given that time derivative of vector",
 StyleBox[" r",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 " is ",
 StyleBox["w",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 " cross ",
 StyleBox["r",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 ". (Another time)"
}], "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.387807935827002*^9, 3.3878079371551266`*^9}, {
   3.3878086403612523`*^9, 3.3878087719887795`*^9}, {3.387812836803432*^9, 
   3.387812906084682*^9}, {3.387812985053432*^9, 3.387813001584682*^9}, 
   3.3878133736940565`*^9, 3.429302776744568*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dqdt", "[", 
   RowBox[{"q_", ",", "w_"}], "]"}], ":=", 
  FractionBox[
   RowBox[{"q", "**", 
    RowBox[{"Quaternion", "[", 
     RowBox[{"0", ",", 
      RowBox[{"w", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
      ",", 
      RowBox[{"w", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
      ",", 
      RowBox[{"w", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
     "]"}]}], "2"]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.3878133736940565`*^9, {3.633017720336422*^9, 3.633017735074937*^9}}],

Cell["Euler integration for free rotation of a quaternion:", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.387808797520348*^9, 3.3878088097548013`*^9}, 
   3.3878133736940565`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"qnEU", "[", 
   RowBox[{"qnm1_", ",", "wnm1_", ",", "dt_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Normalize", "[", 
   RowBox[{"qnm1", "+", 
    RowBox[{"dt", "*", 
     RowBox[{"dqdt", "[", 
      RowBox[{"qnm1", ",", "wnm1"}], "]"}]}]}], "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],

Cell["Runge-Kutta-4 integration for free rotation of a quaternion:", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.387808812739195*^9, 3.387808830848686*^9}, 
   3.3878133736940565`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"qnRK", "[", 
   RowBox[{"qnm1_", ",", "wnm1_", ",", "dt_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"k1", "=", 
      RowBox[{"dt", "*", 
       RowBox[{"dqdt", "[", 
        RowBox[{"qnm1", ",", "wnm1"}], "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"k2", "=", 
        RowBox[{"dt", "*", 
         RowBox[{"dqdt", "[", 
          RowBox[{
           RowBox[{"qnm1", "+", 
            RowBox[{"k1", "/", "2"}]}], ",", "wnm1"}], "]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"k3", "=", 
          RowBox[{"dt", "*", 
           RowBox[{"dqdt", "[", 
            RowBox[{
             RowBox[{"qnm1", "+", 
              RowBox[{"k2", "/", "2"}]}], ",", "wnm1"}], "]"}]}]}], "}"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"k4", "=", 
            RowBox[{"dt", "*", 
             RowBox[{"dqdt", "[", 
              RowBox[{
               RowBox[{"qnm1", "+", "k3"}], ",", "wnm1"}], "]"}]}]}], "}"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"Normalize", "[", 
           RowBox[{"qnm1", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"k1", "+", 
               RowBox[{"2", "k2"}], "+", 
               RowBox[{"2", "k3"}], "+", "k4"}], ")"}], "/", "6"}]}], "]"}]}],
          "]"}]}], "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],

Cell["Free rotation tests (no torques)", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.387808999037263*^9, 3.3878089999747686`*^9}, 
   3.3878133736940565`*^9}],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{"Global`w", ",", "Global`q"}], "]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.3878133736940565`*^9}],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{"w", ",", "q"}], "]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.387367666671835*^9, 3.3873676708478403`*^9}, 
   3.3878133736940565`*^9}],

Cell[TextData[{
 "Start off with a ",
 StyleBox["w",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 " that's mostly along the ",
 StyleBox["y",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 " axis with a tiny bit of ",
 StyleBox["x",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 ":"
}], "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.3878100111940565`*^9, 3.387810040178432*^9}, 
   3.3878133736940565`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"w", "[", "0", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"0.01", ",", "8", ",", "0"}], "}"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],

Cell["Global variables for controlling animated integrations:", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.387809058615769*^9, 3.3878090738502417`*^9}, 
   3.3878133736940565`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"globalNsteps", "=", "600"}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],

Cell[BoxData[
 RowBox[{
  RowBox[{"globalTimeStep", "=", 
   FractionBox["0.03", "2"]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],

Cell["Load up an array with integration results:", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.387810067490932*^9, 3.3878100741940565`*^9}, 
   3.3878133736940565`*^9}],

Cell[BoxData[
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"$i", "=", "1"}], ",", 
   RowBox[{"$i", "<", "globalNsteps"}], ",", 
   RowBox[{"$i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"w", "[", "$i", "]"}], "=", 
    RowBox[{"wnRK", "[", 
     RowBox[{
      RowBox[{"w", "[", 
       RowBox[{"$i", "-", "1"}], "]"}], ",", "globalTimeStep"}], "]"}]}]}], 
  "]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],

Cell[TextData[{
 "Start off with a quaternion twisting an object by 45 degrees around the ",
 StyleBox["y",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 " axis"
}], "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.387810061428432*^9, 3.387810100709682*^9}, 
   3.3878133736940565`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"q", "[", "0", "]"}], "=", 
  RowBox[{"N", "@", 
   RowBox[{"rQ", "[", 
    RowBox[{
     RowBox[{"Pi", "/", "4"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}]}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.3878133736940565`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Quaternion", "[", 
  RowBox[{
  "0.9238795325112867`", ",", "0.`", ",", "0.3826834323650898`", ",", "0.`"}],
   "]"}]], "Output",
 CellChangeTimes->{3.6330179039008627`*^9, 3.63301820344912*^9, 
  3.6677378774920197`*^9}],

Cell[BoxData[
 RowBox[{"s3p2", "[", 
  RowBox[{"rot\[Omega]", "[", 
   RowBox[{
    RowBox[{"wm", "[", 
     RowBox[{"q", "[", "0", "]"}], "]"}], ",", "rw"}], "]"}], "]"}]], "Input",\

 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.3878104130378065`*^9, 3.387810510053432*^9}, 
   3.3878111672878065`*^9, 3.3878133736940565`*^9, 3.42927667994619*^9, 
   3.4292767315368977`*^9}],

Cell[BoxData[
 Graphics3DBox[
  GeometricTransformation3DBox[
   GeometricTransformation3DBox[
    GeometricTransformation3DBox[
     GeometricTransformation3DBox[
      GeometricTransformation3DBox[
       GeometricTransformation3DBox[
        GeometricTransformation3DBox[
         GeometricTransformation3DBox[
          GeometricTransformation3DBox[
           GeometricTransformation3DBox[{GeometricTransformation3DBox[
              {RGBColor[1, 0, 0], Thickness[0.01], 
               Line3DBox[{{0, 0, 0}, {1, 0, 0}}], 
               {RGBColor[0, 1, 0], Line3DBox[{{0, 0, 0}, {0, 1, 0}}]}, 
               {RGBColor[0, 0, 1], Line3DBox[{{0, 0, 0}, {0, 0, 1}}]}, 
               {RGBColor[0, 1, 1], Line3DBox[{{0, 0, 0}, {-1, 0, 0}}]}, 
               {RGBColor[1, 0, 1], Line3DBox[{{0, 0, 0}, {0, -1, 0}}]}, 
               {RGBColor[1, 1, 0], Line3DBox[{{0, 0, 0}, {0, 0, -1}}]}}, {{{2,
                0, 0}, {0, 2, 0}, {0, 0, 2}}, {0, 0, 0}}], {
              GeometricTransformation3DBox[GeometricTransformation3DBox[{
                 {FaceForm[RGBColor[0, 0, 1], RGBColor[1, 1, 0]], 
                  Polygon3DBox[{{0, 0, 0}, {1, 0, 0}, {1, 1, 0}, {0, 1, 0}}], 
                  Polygon3DBox[{{0, 0, 1}, {1, 0, 1}, {1, 1, 1}, {0, 1, 1}}]}, 
                 {FaceForm[RGBColor[0, 1, 0], RGBColor[1, 0, 1]], 
                  Polygon3DBox[{{0, 1, 1}, {1, 1, 1}, {1, 1, 0}, {0, 1, 0}}], 
                  Polygon3DBox[{{0, 0, 1}, {1, 0, 1}, {1, 0, 0}, {0, 0, 0}}]}, 
                 {FaceForm[RGBColor[1, 0, 0], RGBColor[0, 1, 1]], 
                  Polygon3DBox[{{0, 0, 0}, {0, 1, 0}, {0, 1, 1}, {0, 0, 1}}], 
                  Polygon3DBox[{{1, 0, 0}, {1, 1, 0}, {1, 1, 1}, {1, 0, 
                   1}}]}}, {-0.5, -0.5, -0.5}], {{{0.99, 0., 0.}, {0., 0.99, 
                0.}, {0., 0., 0.99}}, {0., 0., 0.}}], 
              GeometricTransformation3DBox[{
                GeometricTransformation3DBox[
                 GeometricTransformation3DBox[
                  GeometricTransformation3DBox[GeometricTransformation3DBox[
                    {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
                    Polygon3DBox[{{
                    0.41666666666666663`, 0.08333333333333333, 0}, {
                    0.41666666666666663`, 0.16666666666666666`, 0}, {
                    0.10833333333333334`, 0.16666666666666666`, 0}, {
                    0.08333333333333333, 0.08333333333333333, 0}}], 
                    Polygon3DBox[{{
                    0.19166666666666665`, 0.16666666666666666`, 0}, {
                    0.39166666666666666`, 0.8333333333333333, 0}, {
                    0.30833333333333335`, 0.8333333333333333, 0}, {
                    0.10833333333333334`, 0.16666666666666666`, 0}}], 
                    Polygon3DBox[{{
                    0.08333333333333333, 0.8333333333333333, 0}, {
                    0.39166666666666666`, 0.8333333333333333, 0}, {
                    0.41666666666666663`, 0.9166666666666666, 0}, {
                    0.08333333333333333, 0.9166666666666666, 0}}], 
                    GeometricTransformation3DBox[
                    {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
                    Polygon3DBox[{{
                    0.16666666666666666`, 0.08333333333333333, 0}, {
                    0.25, 0.36111111111111105`, 0}, {0.25, 0.5, 0}, {
                    0.20833333333333331`, 0.5, 0}, {
                    0.08333333333333333, 0.08333333333333333, 0}}], 
                    Polygon3DBox[{{
                    0.41666666666666663`, 0.08333333333333333, 0}, {
                    0.29166666666666663`, 0.5, 0}, {0.25, 0.5, 0}, {
                    0.25, 0.36111111111111105`, 0}, {
                    0.3333333333333333, 0.08333333333333333, 0}}], 
                    Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
                    0.16666666666666666`, 0.9166666666666666, 0}, {
                    0.08333333333333333, 0.9166666666666666, 0}, {
                    0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
                    Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
                    0.41666666666666663`, 0.9166666666666666, 0}, {
                    0.3333333333333333, 0.9166666666666666, 0}, {
                    0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}]}, {
                    0.5, 0, 0}]}, {{1, 0, 0}, {0, 1, 0}, {0, 0, 1}}], {{1, 0, 
                   0}, {0, 0, -1}, {0, 1, 
                   0}}], {{-1., -1.2246467991473532`*^-16, 0.}, {
                  1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}], {1, 0, 
                 0}], GeometricTransformation3DBox[
                 GeometricTransformation3DBox[
                  GeometricTransformation3DBox[GeometricTransformation3DBox[
                    {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
                    Polygon3DBox[{{
                    0.41666666666666663`, 0.08333333333333333, 0}, {
                    0.41666666666666663`, 0.16666666666666666`, 0}, {
                    0.10833333333333334`, 0.16666666666666666`, 0}, {
                    0.08333333333333333, 0.08333333333333333, 0}}], 
                    Polygon3DBox[{{
                    0.19166666666666665`, 0.16666666666666666`, 0}, {
                    0.39166666666666666`, 0.8333333333333333, 0}, {
                    0.30833333333333335`, 0.8333333333333333, 0}, {
                    0.10833333333333334`, 0.16666666666666666`, 0}}], 
                    Polygon3DBox[{{
                    0.08333333333333333, 0.8333333333333333, 0}, {
                    0.39166666666666666`, 0.8333333333333333, 0}, {
                    0.41666666666666663`, 0.9166666666666666, 0}, {
                    0.08333333333333333, 0.9166666666666666, 0}}], 
                    GeometricTransformation3DBox[
                    {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
                    Polygon3DBox[{{
                    0.16666666666666666`, 0.08333333333333333, 0}, {
                    0.25, 0.36111111111111105`, 0}, {0.25, 0.5, 0}, {
                    0.20833333333333331`, 0.5, 0}, {
                    0.08333333333333333, 0.08333333333333333, 0}}], 
                    Polygon3DBox[{{
                    0.41666666666666663`, 0.08333333333333333, 0}, {
                    0.29166666666666663`, 0.5, 0}, {0.25, 0.5, 0}, {
                    0.25, 0.36111111111111105`, 0}, {
                    0.3333333333333333, 0.08333333333333333, 0}}], 
                    Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
                    0.16666666666666666`, 0.9166666666666666, 0}, {
                    0.08333333333333333, 0.9166666666666666, 0}, {
                    0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
                    Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
                    0.41666666666666663`, 0.9166666666666666, 0}, {
                    0.3333333333333333, 0.9166666666666666, 0}, {
                    0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}]}, {
                    0.5, 0, 0}]}, {{1, 0, 0}, {0, 1, 0}, {0, 0, 1}}], {{1, 0, 
                   0}, {0, 0, -1}, {0, 1, 
                   0}}], {{-1., -1.2246467991473532`*^-16, 0.}, {
                  1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}], {1, 1, 
                 0}], GeometricTransformation3DBox[
                 GeometricTransformation3DBox[GeometricTransformation3DBox[
                   {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
                    Polygon3DBox[{{
                    0.29166666666666663`, 0.08333333333333333, 0}, {
                    0.29166666666666663`, 0.5, 0}, {
                    0.20833333333333331`, 0.5, 0}, {
                    0.20833333333333331`, 0.08333333333333333, 0}}], 
                    Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
                    0.16666666666666666`, 0.9166666666666666, 0}, {
                    0.08333333333333333, 0.9166666666666666, 0}, {
                    0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
                    Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
                    0.41666666666666663`, 0.9166666666666666, 0}, {
                    0.3333333333333333, 0.9166666666666666, 0}, {
                    0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}], 
                    GeometricTransformation3DBox[
                    {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
                    Polygon3DBox[{{
                    0.41666666666666663`, 0.08333333333333333, 0}, {
                    0.41666666666666663`, 0.16666666666666666`, 0}, {
                    0.10833333333333334`, 0.16666666666666666`, 0}, {
                    0.08333333333333333, 0.08333333333333333, 0}}], 
                    Polygon3DBox[{{
                    0.19166666666666665`, 0.16666666666666666`, 0}, {
                    0.39166666666666666`, 0.8333333333333333, 0}, {
                    0.30833333333333335`, 0.8333333333333333, 0}, {
                    0.10833333333333334`, 0.16666666666666666`, 0}}], 
                    Polygon3DBox[{{
                    0.08333333333333333, 0.8333333333333333, 0}, {
                    0.39166666666666666`, 0.8333333333333333, 0}, {
                    0.41666666666666663`, 0.9166666666666666, 0}, {
                    0.08333333333333333, 0.9166666666666666, 0}}]}, {
                    0.5, 0, 0}]}, {{-1., -1.2246467991473532`*^-16, 0.}, {
                   1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}], {{1, 0,
                   0}, {0, 0, 1}, {0, -1, 0}}], {{-1.8369701987210297`*^-16, 
                 1., 0.}, {-1., -1.8369701987210297`*^-16, 0.}, {0., 0., 
                 1.}}], GeometricTransformation3DBox[
                 GeometricTransformation3DBox[
                  GeometricTransformation3DBox[GeometricTransformation3DBox[
                    {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
                    Polygon3DBox[{{
                    0.29166666666666663`, 0.08333333333333333, 0}, {
                    0.29166666666666663`, 0.5, 0}, {
                    0.20833333333333331`, 0.5, 0}, {
                    0.20833333333333331`, 0.08333333333333333, 0}}], 
                    Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
                    0.16666666666666666`, 0.9166666666666666, 0}, {
                    0.08333333333333333, 0.9166666666666666, 0}, {
                    0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
                    Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
                    0.41666666666666663`, 0.9166666666666666, 0}, {
                    0.3333333333333333, 0.9166666666666666, 0}, {
                    0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}], 
                    GeometricTransformation3DBox[
                    {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
                    Polygon3DBox[{{
                    0.41666666666666663`, 0.08333333333333333, 0}, {
                    0.41666666666666663`, 0.16666666666666666`, 0}, {
                    0.10833333333333334`, 0.16666666666666666`, 0}, {
                    0.08333333333333333, 0.08333333333333333, 0}}], 
                    Polygon3DBox[{{
                    0.19166666666666665`, 0.16666666666666666`, 0}, {
                    0.39166666666666666`, 0.8333333333333333, 0}, {
                    0.30833333333333335`, 0.8333333333333333, 0}, {
                    0.10833333333333334`, 0.16666666666666666`, 0}}], 
                    Polygon3DBox[{{
                    0.08333333333333333, 0.8333333333333333, 0}, {
                    0.39166666666666666`, 0.8333333333333333, 0}, {
                    0.41666666666666663`, 0.9166666666666666, 0}, {
                    0.08333333333333333, 0.9166666666666666, 0}}]}, {
                    0.5, 0, 0}]}, {{-1., -1.2246467991473532`*^-16, 0.}, {
                    1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}], {{1, 
                   0, 0}, {0, 0, 1}, {0, -1, 
                   0}}], {{-1.8369701987210297`*^-16, 1., 
                  0.}, {-1., -1.8369701987210297`*^-16, 0.}, {0., 0., 1.}}], {
                 1, 0, 0}], 
                {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
                 Polygon3DBox[{{
                   0.16666666666666666`, 0.08333333333333333, 0}, {
                   0.25, 0.36111111111111105`, 0}, {0.25, 0.5, 0}, {
                   0.20833333333333331`, 0.5, 0}, {
                   0.08333333333333333, 0.08333333333333333, 0}}], 
                 Polygon3DBox[{{
                   0.41666666666666663`, 0.08333333333333333, 0}, {
                   0.29166666666666663`, 0.5, 0}, {0.25, 0.5, 0}, {
                   0.25, 0.36111111111111105`, 0}, {
                   0.3333333333333333, 0.08333333333333333, 0}}], 
                 Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
                   0.16666666666666666`, 0.9166666666666666, 0}, {
                   0.08333333333333333, 0.9166666666666666, 0}, {
                   0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
                 Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
                   0.41666666666666663`, 0.9166666666666666, 0}, {
                   0.3333333333333333, 0.9166666666666666, 0}, {
                   0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}], 
                 GeometricTransformation3DBox[
                  {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
                   Polygon3DBox[{{
                    0.29166666666666663`, 0.08333333333333333, 0}, {
                    0.29166666666666663`, 0.5, 0}, {
                    0.20833333333333331`, 0.5, 0}, {
                    0.20833333333333331`, 0.08333333333333333, 0}}], 
                   Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
                    0.16666666666666666`, 0.9166666666666666, 0}, {
                    0.08333333333333333, 0.9166666666666666, 0}, {
                    0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
                   Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
                    0.41666666666666663`, 0.9166666666666666, 0}, {
                    0.3333333333333333, 0.9166666666666666, 0}, {
                    0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}]}, {
                  0.5, 0, 0}]}, GeometricTransformation3DBox[
                 {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
                  Polygon3DBox[{{
                    0.16666666666666666`, 0.08333333333333333, 0}, {
                    0.25, 0.36111111111111105`, 0}, {0.25, 0.5, 0}, {
                    0.20833333333333331`, 0.5, 0}, {
                    0.08333333333333333, 0.08333333333333333, 0}}], 
                  Polygon3DBox[{{
                    0.41666666666666663`, 0.08333333333333333, 0}, {
                    0.29166666666666663`, 0.5, 0}, {0.25, 0.5, 0}, {
                    0.25, 0.36111111111111105`, 0}, {
                    0.3333333333333333, 0.08333333333333333, 0}}], 
                  Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
                    0.16666666666666666`, 0.9166666666666666, 0}, {
                    0.08333333333333333, 0.9166666666666666, 0}, {
                    0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
                  Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
                    0.41666666666666663`, 0.9166666666666666, 0}, {
                    0.3333333333333333, 0.9166666666666666, 0}, {
                    0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}], 
                  GeometricTransformation3DBox[
                   {FaceForm[GrayLevel[0], GrayLevel[0.5]], 
                    Polygon3DBox[{{
                    0.29166666666666663`, 0.08333333333333333, 0}, {
                    0.29166666666666663`, 0.5, 0}, {
                    0.20833333333333331`, 0.5, 0}, {
                    0.20833333333333331`, 0.08333333333333333, 0}}], 
                    Polygon3DBox[{{0.25, 0.6388888888888888, 0}, {
                    0.16666666666666666`, 0.9166666666666666, 0}, {
                    0.08333333333333333, 0.9166666666666666, 0}, {
                    0.20833333333333331`, 0.5, 0}, {0.25, 0.5, 0}}], 
                    Polygon3DBox[{{0.29166666666666663`, 0.5, 0}, {
                    0.41666666666666663`, 0.9166666666666666, 0}, {
                    0.3333333333333333, 0.9166666666666666, 0}, {
                    0.25, 0.6388888888888888, 0}, {0.25, 0.5, 0}}]}, {
                   0.5, 0, 0}]}, {0, 0, 1}]}, {-0.5, -0.5, -0.5}]}}, {{{
             0.5743665268941904, 0., 0.}, {0., 0.5025707110324167, 0.}, {0., 
             0., 0.6461623427559644}}, {0., 0., 
             0.}}], {{-1., -1.2246467991473532`*^-16, 0.}, {
           1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}], {{1., 0., 
          0.}, {0., 6.123233995736766*^-17, 1.}, {0., -1., 
          6.123233995736766*^-17}}], {{-0.7071067811865477, 
         0.7071067811865475, 0.}, {-0.7071067811865475, -0.7071067811865477, 
         0.}, {0., 0., 1.}}], {{-1., -1.2246467991473532`*^-16, 0.}, {
        1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}], {{1., 0., 0.}, {
       0., 6.123233995736766*^-17, -1.}, {0., 1., 
       6.123233995736766*^-17}}], {{-1., -1.2246467991473532`*^-16, 0.}, {
      1.2246467991473532`*^-16, -1., 0.}, {0., 0., 
      1.}}], {{-1., -1.2246467991473532`*^-16, 0.}, {
     1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}], {{1, 0, 0}, {0, 1, 
    0}, {0, 0, 1}}], {{-1., -1.2246467991473532`*^-16, 0.}, {
   1.2246467991473532`*^-16, -1., 0.}, {0., 0., 1.}}],
  Axes->True,
  AxesLabel->{
    FormBox["\"x\"", TraditionalForm], 
    FormBox["\"y\"", TraditionalForm], 
    FormBox["\"z\"", TraditionalForm]},
  Boxed->True,
  ImageSize->Automatic,
  Lighting->"Neutral",
  PlotRange->{{-1, 1}, {-1, 1}, {-1, 1}},
  ViewPoint->{-0.6666876191590254, 2.815790084965577, 1.7540962960651898`},
  ViewVertical->{-0.09172160537216928, 0.06976373138490677, 
   0.9933378926081531}]], "Output",
 CellChangeTimes->{3.6330179061651287`*^9, 3.633018203512767*^9, 
  3.667737877539607*^9}],

Cell[CellGroupData[{

Cell["\<\
Simulate a few hundred steps of the free rotation of a quaternion\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.387809251678432*^9, 3.387809270897182*^9}, 
   3.3878133736940565`*^9}],

Cell[BoxData[
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"$i", "=", "1"}], ",", 
   RowBox[{"$i", "<", "globalNsteps"}], ",", 
   RowBox[{"$i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"q", "[", "$i", "]"}], "=", 
    RowBox[{"qnRK", "[", 
     RowBox[{
      RowBox[{"q", "[", 
       RowBox[{"$i", "-", "1"}], "]"}], ",", 
      RowBox[{"w", "[", 
       RowBox[{"$i", "-", "1"}], "]"}], ",", "globalTimeStep"}], "]"}]}]}], 
  "]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.63301792434798*^9}],

Cell[TextData[{
 "Apply this quaternion to the test object ",
 StyleBox["rw",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 " in an animation to see the effect of the rotation. Notice that if the \
rotation begins as primarily about the intermediate axis of the body, in its \
principal-axis frame, that the rotation will cause the object to tumble, \
whereas if the rotation begins about the major or minor axis, then the object \
will not tumble."
}], "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.3878092788190565`*^9, 3.3878093199440565`*^9}, {
   3.3878094106003065`*^9, 3.3878094823190565`*^9}, {3.387810678397182*^9, 
   3.3878106825378065`*^9}, 3.3878133736940565`*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Animate", "[", 
   RowBox[{
    RowBox[{"s3l2", "[", 
     RowBox[{"rot\[Omega]", "[", 
      RowBox[{
       RowBox[{"wm", "[", 
        RowBox[{"q", "[", "t", "]"}], "]"}], ",", "rw"}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "0", ",", 
      RowBox[{"globalNsteps", "-", "1"}], ",", "1"}], "}"}]}], "]"}], 
  "*)"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],

Cell["Free rotation (no torques)", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.3878133736940565`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"tumble1", "[", "w0_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "i", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"w", "[", "0", "]"}], "=", "w0"}], ";", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"q", "[", "0", "]"}], "=", 
       RowBox[{"N", "[", 
        RowBox[{"rQ", "[", 
         RowBox[{
          FractionBox["\[Pi]", "4"], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "<", "globalNsteps"}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"w", "[", "i", "]"}], "=", 
         RowBox[{"wnRK", "[", 
          RowBox[{
           RowBox[{"w", "[", 
            RowBox[{"i", "-", "1"}], "]"}], ",", "globalTimeStep"}], 
          "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "<", "globalNsteps"}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q", "[", "i", "]"}], "=", 
         RowBox[{"qnRK", "[", 
          RowBox[{
           RowBox[{"q", "[", 
            RowBox[{"i", "-", "1"}], "]"}], ",", 
           RowBox[{"w", "[", 
            RowBox[{"i", "-", "1"}], "]"}], ",", "globalTimeStep"}], 
          "]"}]}]}], "]"}], ";", 
      RowBox[{"Animate", "[", 
       RowBox[{
        RowBox[{"s3l2", "[", 
         RowBox[{"rot\[Omega]", "[", 
          RowBox[{
           RowBox[{"wm", "[", 
            RowBox[{"q", "[", "t", "]"}], "]"}], ",", "rw"}], "]"}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", 
          RowBox[{"globalNsteps", "-", "1"}], ",", "1"}], "}"}]}], "]"}]}]}], 
    "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],

Cell["Apply a torque constant in the world frame:", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.3878133736940565`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"tumble2", "[", 
    RowBox[{"w0_", ",", "mo_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "i", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"w", "[", "0", "]"}], "=", "w0"}], ";", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"q", "[", "0", "]"}], "=", 
       RowBox[{"N", "[", 
        RowBox[{"rQ", "[", 
         RowBox[{
          FractionBox["\[Pi]", "4"], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "<", "globalNsteps"}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"w", "[", "i", "]"}], "=", 
          RowBox[{"wnRKmo", "[", 
           RowBox[{
            RowBox[{"w", "[", 
             RowBox[{"i", "-", "1"}], "]"}], ",", "globalTimeStep", ",", 
            RowBox[{"rf", "[", 
             RowBox[{
              RowBox[{"q", "[", 
               RowBox[{"i", "-", "1"}], "]"}], ",", "mo"}], "]"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"q", "[", "i", "]"}], "=", 
          RowBox[{"qnRK", "[", 
           RowBox[{
            RowBox[{"q", "[", 
             RowBox[{"i", "-", "1"}], "]"}], ",", 
            RowBox[{"w", "[", 
             RowBox[{"i", "-", "1"}], "]"}], ",", "globalTimeStep"}], 
           "]"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Animate", "[", 
       RowBox[{
        RowBox[{"s3l2", "[", 
         RowBox[{"rot\[Omega]", "[", 
          RowBox[{
           RowBox[{"wm", "[", 
            RowBox[{"q", "[", "t", "]"}], "]"}], ",", "rw"}], "]"}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", 
          RowBox[{"globalNsteps", "-", "1"}], ",", "1"}], "}"}]}], "]"}]}]}], 
    "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],

Cell["Spinning, massive top:", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.3878133736940565`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"tumble3", "[", 
    RowBox[{"w0_", ",", "mo_", ",", 
     RowBox[{"n_:", "globalNsteps"}]}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"mor", "=", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{
           "mo", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "2"],
           "+", 
          SuperscriptBox[
           RowBox[{
           "mo", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
           "2"]}]]}], ",", "i"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"w", "[", "0", "]"}], "=", "w0"}], ";", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"q", "[", "0", "]"}], "=", 
       RowBox[{"N", "[", 
        RowBox[{"rQ", "[", 
         RowBox[{
          FractionBox["\[Pi]", "4"], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "<", "n"}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"w", "[", "i", "]"}], "=", 
          RowBox[{"wnRKmo", "[", 
           RowBox[{
            RowBox[{"w", "[", 
             RowBox[{"i", "-", "1"}], "]"}], ",", "\[IndentingNewLine]", 
            "globalTimeStep", ",", "\[IndentingNewLine]", 
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\[Phi]x", "=", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"q", "[", 
                    RowBox[{"i", "-", "1"}], "]"}], "\[LeftDoubleBracket]", 
                    "4", "\[RightDoubleBracket]"}], "\[Equal]", "0"}], ",", 
                  "\[IndentingNewLine]", "0", ",", 
                  RowBox[{"ArcTan", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"q", "[", 
                    RowBox[{"i", "-", "1"}], "]"}], "\[LeftDoubleBracket]", 
                    "2", "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    RowBox[{"q", "[", 
                    RowBox[{"i", "-", "1"}], "]"}], "\[LeftDoubleBracket]", 
                    "3", "\[RightDoubleBracket]"}]}], "]"}]}], "]"}]}], "}"}],
               ",", 
              RowBox[{"rf", "[", 
               RowBox[{
                RowBox[{"q", "[", 
                 RowBox[{"i", "-", "1"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "mor"}], " ", 
                   RowBox[{"Sin", "[", "\[Phi]x", "]"}]}], ",", 
                  RowBox[{"mor", " ", 
                   RowBox[{"Cos", "[", "\[Phi]x", "]"}]}], ",", 
                  RowBox[{
                  "mo", "\[LeftDoubleBracket]", "3", 
                   "\[RightDoubleBracket]"}]}], "}"}]}], "]"}]}], "]"}]}], 
           "]"}]}], ";", 
         RowBox[{
          RowBox[{"q", "[", "i", "]"}], "=", 
          RowBox[{"qnRK", "[", 
           RowBox[{
            RowBox[{"q", "[", 
             RowBox[{"i", "-", "1"}], "]"}], ",", 
            RowBox[{"w", "[", 
             RowBox[{"i", "-", "1"}], "]"}], ",", "globalTimeStep"}], 
           "]"}]}]}]}], "]"}], ";", 
      RowBox[{"Animate", "[", 
       RowBox[{
        RowBox[{"s3l2", "[", 
         RowBox[{"rot\[Omega]", "[", 
          RowBox[{
           RowBox[{"wm", "[", 
            RowBox[{"q", "[", "t", "]"}], "]"}], ",", "rw"}], "]"}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", 
          RowBox[{"n", "-", "1"}], ",", "1"}], "}"}]}], "]"}]}]}], "]"}]}], 
  ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"tumble2", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "8"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", ".5"}], ",", "0", ",", "0"}], "}"}]}], "]"}], 
  "*)"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.387368420255435*^9, 3.3878133736940565`*^9, 
  3.633018260143839*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tumble1", "[", 
  RowBox[{"{", 
   RowBox[{".25", ",", "0", ",", "8"}], "}"}], "]"}]], "Input"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`t$$ = 390, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`t$$], 0, 599, 1}}, Typeset`size$$ = {
    450., {249., 256.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`t$18289$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`t$$ = 0}, 
      "ControllerVariables" :> {
        Hold[$CellContext`t$$, $CellContext`t$18289$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> $CellContext`s3l2[
        $CellContext`rot\[Omega][
         $CellContext`wm[
          $CellContext`q[$CellContext`t$$]], $CellContext`rw]], 
      "Specifications" :> {{$CellContext`t$$, 0, 599, 1, 
         AppearanceElements -> {
          "ProgressSlider", "PlayPauseButton", "FasterSlowerButtons", 
           "DirectionButton"}}}, 
      "Options" :> {
       ControlType -> Animator, AppearanceElements -> None, DefaultBaseStyle -> 
        "Animate", DefaultLabelStyle -> "AnimateLabel", SynchronousUpdating -> 
        True, ShrinkingDelay -> 10.}, "DefaultOptions" :> {}],
     ImageSizeCache->{505., {295., 302.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Animate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.633018208210732*^9, 3.667737879167365*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"tumble1", "[", 
   RowBox[{"{", 
    RowBox[{"1", ",", "8", ",", "0"}], "}"}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{3.633018289831791*^9}],

Cell[BoxData[
 RowBox[{"tumble1", "[", 
  RowBox[{"{", 
   RowBox[{"8", ",", ".1", ",", "0"}], "}"}], "]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.3873685265582914`*^9, 3.3878133736940565`*^9}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`t$$ = 134, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`t$$], 0, 599, 1}}, Typeset`size$$ = {
    450., {249., 256.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`t$18414$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`t$$ = 0}, 
      "ControllerVariables" :> {
        Hold[$CellContext`t$$, $CellContext`t$18414$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> $CellContext`s3l2[
        $CellContext`rot\[Omega][
         $CellContext`wm[
          $CellContext`q[$CellContext`t$$]], $CellContext`rw]], 
      "Specifications" :> {{$CellContext`t$$, 0, 599, 1, 
         AppearanceElements -> {
          "ProgressSlider", "PlayPauseButton", "FasterSlowerButtons", 
           "DirectionButton"}}}, 
      "Options" :> {
       ControlType -> Animator, AppearanceElements -> None, DefaultBaseStyle -> 
        "Animate", DefaultLabelStyle -> "AnimateLabel", SynchronousUpdating -> 
        True, ShrinkingDelay -> 10.}, "DefaultOptions" :> {}],
     ImageSizeCache->{505., {295., 302.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Animate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.633018211749305*^9, 3.667737880122161*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"tumble1", "[", 
   RowBox[{"{", 
    RowBox[{"8", ",", "1", ",", "0"}], "}"}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{3.633018377542444*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Quaternions, Twist Vectors, Rotation Matrices", "Chapter",
 CellChangeTimes->{{3.6330184966506767`*^9, 3.633018513937162*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "twistVectorFromRotationMatrix", ",", 
    "twistVectorDirectionFromRotationMatrix", ",", 
    "twistAngleFromRotationMatrix"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.6330189544582043`*^9, 3.633018977337553*^9}, {
  3.633019102662714*^9, 3.6330191281483*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"twistVectorDirectionFromRotationMatrix", "[", "R_", "]"}], ":=", 
  RowBox[{"(", GridBox[{
     {
      RowBox[{
       RowBox[{
        RowBox[{"R", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], 
        RowBox[{"R", "\[LeftDoubleBracket]", 
         RowBox[{"2", ",", "3"}], "\[RightDoubleBracket]"}]}], "-", 
       RowBox[{
        RowBox[{"R", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"R", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], "-", "1"}], 
         ")"}]}]}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"R", "\[LeftDoubleBracket]", 
         RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], 
        RowBox[{"R", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}]}], "-", 
       RowBox[{
        RowBox[{"R", "\[LeftDoubleBracket]", 
         RowBox[{"2", ",", "3"}], "\[RightDoubleBracket]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"R", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "-", "1"}], 
         ")"}]}]}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"R", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "-", "1"}], 
         ")"}], 
        RowBox[{"(", 
         RowBox[{"R", "\[LeftDoubleBracket]", 
          RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], ")"}]}], "-", 
       RowBox[{
        RowBox[{"R", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], 
        RowBox[{"R", "\[LeftDoubleBracket]", 
         RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}]}]}
    }], ")"}]}]], "Input",
 CellChangeTimes->{{3.6330185231285458`*^9, 3.633018675548482*^9}, {
  3.633018865865041*^9, 3.6330189362835712`*^9}, {3.633019138269011*^9, 
  3.633019139220427*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"twistAngleFromRotationMatrix", "[", "R_", "]"}], ":=", 
  RowBox[{"ArcCos", "[", 
   FractionBox[
    RowBox[{
     RowBox[{"R", "\[LeftDoubleBracket]", 
      RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "+", 
     RowBox[{"R", "\[LeftDoubleBracket]", 
      RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], "+", 
     RowBox[{"R", "\[LeftDoubleBracket]", 
      RowBox[{"3", ",", "3"}], "\[RightDoubleBracket]"}], "-", "1"}], "2"], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6330191510993567`*^9, 3.633019218321117*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1280, 1396},
WindowMargins->{{Automatic, 597}, {Automatic, 0}},
Magnification:>1.25 Inherited,
FrontEndVersion->"10.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (December 10, \
2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 167, 2, 114, "Title"],
Cell[CellGroupData[{
Cell[772, 28, 97, 1, 81, "Chapter"],
Cell[872, 31, 168, 3, 37, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1077, 39, 98, 1, 81, "Chapter"],
Cell[1178, 42, 122, 2, 35, "Input"],
Cell[1303, 46, 150, 3, 35, "Input"],
Cell[1456, 51, 553, 14, 78, "Input"],
Cell[CellGroupData[{
Cell[2034, 69, 186, 4, 36, "Input"],
Cell[2223, 75, 781, 21, 94, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3041, 101, 229, 5, 35, "Input"],
Cell[3273, 108, 963, 26, 94, "Output"]
}, Open  ]],
Cell[4251, 137, 175, 4, 37, "Text"],
Cell[CellGroupData[{
Cell[4451, 145, 246, 5, 35, "Input"],
Cell[4700, 152, 887, 23, 102, "Output"]
}, Open  ]],
Cell[5602, 178, 102, 1, 37, "Item"],
Cell[5707, 181, 293, 7, 36, "Input"],
Cell[6003, 190, 449, 8, 61, "Text"],
Cell[CellGroupData[{
Cell[6477, 202, 232, 5, 35, "Input"],
Cell[6712, 209, 962, 26, 94, "Output"]
}, Open  ]],
Cell[7689, 238, 266, 5, 37, "Text"],
Cell[CellGroupData[{
Cell[7980, 247, 281, 6, 35, "Input"],
Cell[8264, 255, 959, 26, 94, "Output"]
}, Open  ]],
Cell[9238, 284, 187, 4, 37, "Text"],
Cell[CellGroupData[{
Cell[9450, 292, 285, 6, 35, "Input"],
Cell[9738, 300, 967, 26, 94, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10742, 331, 103, 1, 78, "Subchapter"],
Cell[CellGroupData[{
Cell[10870, 336, 32, 0, 80, "Section"],
Cell[10905, 338, 447, 17, 132, "Text"],
Cell[11355, 357, 230, 7, 35, "Input"],
Cell[11588, 366, 248, 6, 36, "Input"],
Cell[11839, 374, 226, 6, 35, "Input"],
Cell[12068, 382, 248, 7, 36, "Input"],
Cell[12319, 391, 775, 15, 120, "Input"],
Cell[13097, 408, 649, 14, 99, "Input"],
Cell[13749, 424, 953, 20, 141, "Input"],
Cell[14705, 446, 290, 5, 37, "Text"],
Cell[14998, 453, 3392, 88, 204, "Input"],
Cell[18393, 543, 2500, 64, 162, "Input"],
Cell[20896, 609, 2197, 56, 162, "Input"],
Cell[23096, 667, 1532, 43, 57, "Input"],
Cell[24631, 712, 1091, 30, 57, "Input"],
Cell[25725, 744, 952, 26, 35, "Input"],
Cell[CellGroupData[{
Cell[26702, 774, 168, 2, 54, "Subsection"],
Cell[26873, 778, 430, 13, 35, "Input"],
Cell[27306, 793, 347, 7, 36, "Input"],
Cell[27656, 802, 443, 13, 36, "Input"],
Cell[28102, 817, 353, 7, 36, "Input"],
Cell[28458, 826, 277, 6, 36, "Input"],
Cell[28738, 834, 273, 6, 36, "Input"],
Cell[29014, 842, 277, 6, 36, "Input"],
Cell[29294, 850, 272, 6, 36, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29603, 861, 93, 1, 54, "Subsection"],
Cell[CellGroupData[{
Cell[29721, 866, 553, 18, 120, "Item"],
Cell[30277, 886, 200, 3, 37, "Item"]
}, Open  ]],
Cell[30492, 892, 219, 4, 37, "Text"],
Cell[30714, 898, 987, 23, 183, "Input"],
Cell[31704, 923, 1974, 50, 225, "Input"],
Cell[CellGroupData[{
Cell[33703, 977, 225, 4, 36, "Input"],
Cell[33931, 983, 12401, 216, 519, "Output"]
}, Open  ]],
Cell[46347, 1202, 2636, 67, 183, "Input"],
Cell[CellGroupData[{
Cell[49008, 1273, 175, 3, 35, "Input"],
Cell[49186, 1278, 782, 17, 519, "Output"]
}, Open  ]],
Cell[49983, 1298, 543, 16, 35, "Input"],
Cell[CellGroupData[{
Cell[50551, 1318, 128, 2, 36, "Input"],
Cell[50682, 1322, 12984, 226, 519, "Output"]
}, Open  ]],
Cell[63681, 1551, 1828, 46, 183, "Input"],
Cell[CellGroupData[{
Cell[65534, 1601, 125, 2, 35, "Input"],
Cell[65662, 1605, 9825, 186, 519, "Output"]
}, Open  ]],
Cell[75502, 1794, 334, 8, 35, "Input"],
Cell[CellGroupData[{
Cell[75861, 1806, 126, 2, 36, "Input"],
Cell[75990, 1810, 13447, 230, 468, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[89486, 2046, 104, 1, 54, "Subsection"],
Cell[89593, 2049, 396, 14, 99, "Item",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[89992, 2065, 150, 3, 37, "Text"],
Cell[90145, 2070, 171, 3, 61, "Text"],
Cell[90319, 2075, 40, 0, 37, "Text"],
Cell[90362, 2077, 473, 11, 156, "Text"],
Cell[90838, 2090, 2815, 70, 225, "Input"],
Cell[CellGroupData[{
Cell[93678, 2164, 128, 2, 36, "Input"],
Cell[93809, 2168, 987, 21, 519, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[94833, 2194, 1894, 46, 120, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[96730, 2242, 3238, 84, 162, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[99971, 2328, 2367, 61, 120, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[102341, 2391, 2046, 53, 99, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[104390, 2446, 338, 8, 36, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[104731, 2456, 338, 8, 36, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[105072, 2466, 338, 8, 36, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[105413, 2476, 1898, 46, 120, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Open  ]],
Cell[107326, 2525, 510, 13, 36, "Input"],
Cell[CellGroupData[{
Cell[107861, 2542, 130, 2, 36, "Input"],
Cell[107994, 2546, 13221, 225, 519, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[121252, 2776, 1324, 33, 162, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[122579, 2811, 1230, 30, 141, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[123812, 2843, 307, 6, 35, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Open  ]],
Cell[124134, 2852, 13232, 225, 523, "Output"],
Cell[137369, 3079, 1812, 48, 162, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[CellGroupData[{
Cell[139206, 3131, 396, 11, 36, "Input"],
Cell[139605, 3144, 13918, 231, 523, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[153560, 3380, 449, 14, 35, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[154012, 3396, 349, 11, 35, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[154364, 3409, 590, 14, 36, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[155039, 3432, 105, 1, 81, "Chapter"],
Cell[CellGroupData[{
Cell[155169, 3437, 836, 23, 99, "Item",
 CellGroupingRules->{GroupTogetherGrouping, 10002.}],
Cell[156008, 3462, 205, 4, 37, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10002.}],
Cell[156216, 3468, 1140, 30, 109, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10002.}],
Cell[157359, 3500, 670, 17, 61, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10002.}],
Cell[158032, 3519, 909, 26, 78, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.}],
Cell[158944, 3547, 1091, 34, 61, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10002.}],
Cell[160038, 3583, 460, 10, 35, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.}]
}, Open  ]],
Cell[160513, 3596, 998, 22, 303, "Output"],
Cell[161514, 3620, 118, 1, 37, "Text"],
Cell[CellGroupData[{
Cell[161657, 3625, 1127, 31, 85, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10002.}],
Cell[162787, 3658, 918, 33, 61, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10002.}],
Cell[163708, 3693, 735, 19, 36, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.}],
Cell[164446, 3714, 987, 37, 61, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10002.}],
Cell[165436, 3753, 1155, 31, 67, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.}],
Cell[166594, 3786, 1635, 44, 93, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.}],
Cell[168232, 3832, 381, 7, 61, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10002.}]
}, Open  ]],
Cell[CellGroupData[{
Cell[168650, 3844, 300, 9, 36, "Input"],
Cell[168953, 3855, 17636, 291, 490, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[186626, 4151, 286, 4, 37, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10002.}],
Cell[186915, 4157, 560, 13, 57, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.}]
}, Open  ]],
Cell[187490, 4173, 17622, 291, 494, "Output"],
Cell[CellGroupData[{
Cell[205137, 4468, 289, 4, 37, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10002.}],
Cell[205429, 4474, 501, 12, 36, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.}]
}, Open  ]],
Cell[205945, 4489, 17644, 291, 506, "Output"],
Cell[223592, 4782, 1427, 36, 203, "Input"],
Cell[225022, 4820, 1369, 35, 203, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[226428, 4860, 120, 1, 81, "Chapter"],
Cell[CellGroupData[{
Cell[226573, 4865, 2085, 57, 248, "Item",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[228661, 4924, 162, 2, 37, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[228826, 4928, 1124, 31, 153, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[229953, 4961, 122, 2, 37, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[230078, 4965, 510, 13, 36, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[230591, 4980, 286, 8, 35, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[230880, 4990, 317, 7, 35, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[231200, 4999, 446, 12, 61, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[231649, 5013, 263, 7, 36, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[231915, 5022, 226, 5, 37, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[232144, 5029, 1127, 28, 139, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Open  ]],
Cell[CellGroupData[{
Cell[233308, 5062, 34, 0, 43, "Subsubsection"],
Cell[CellGroupData[{
Cell[233367, 5066, 311, 10, 36, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[233681, 5078, 203, 3, 35, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Open  ]],
Cell[233899, 5084, 142, 1, 37, "Text"],
Cell[CellGroupData[{
Cell[234066, 5089, 403, 10, 58, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[234472, 5101, 395, 9, 54, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Open  ]],
Cell[234882, 5113, 218, 4, 37, "Text"],
Cell[CellGroupData[{
Cell[235125, 5121, 388, 9, 43, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[235516, 5132, 371, 7, 35, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Open  ]],
Cell[235902, 5142, 104, 1, 37, "Text"],
Cell[CellGroupData[{
Cell[236031, 5147, 364, 8, 43, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[236398, 5157, 367, 8, 35, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[236768, 5167, 311, 5, 37, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[237082, 5174, 1273, 33, 123, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Open  ]],
Cell[238370, 5210, 586, 11, 29, "Message"],
Cell[CellGroupData[{
Cell[238981, 5225, 128, 2, 37, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[239112, 5229, 1269, 32, 123, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Open  ]],
Cell[240396, 5264, 588, 11, 29, "Message"],
Cell[CellGroupData[{
Cell[241009, 5279, 203, 3, 37, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[241215, 5284, 491, 14, 57, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[241709, 5300, 176, 3, 36, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Open  ]],
Cell[241900, 5306, 14463, 237, 438, "Output"],
Cell[256366, 5545, 315, 11, 37, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[CellGroupData[{
Cell[256706, 5560, 1264, 39, 128, "Input"],
Cell[257973, 5601, 786, 20, 94, "Output"]
}, Open  ]],
Cell[258774, 5624, 201, 6, 35, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[258978, 5632, 798, 20, 94, "Output"],
Cell[CellGroupData[{
Cell[259801, 5656, 389, 10, 37, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[260193, 5668, 497, 13, 36, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[260693, 5683, 551, 18, 39, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[261247, 5703, 346, 10, 36, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[261596, 5715, 539, 18, 39, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[262138, 5735, 1711, 48, 141, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[263852, 5785, 705, 24, 39, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[264560, 5811, 1733, 49, 141, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[266296, 5862, 585, 15, 37, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[266884, 5879, 998, 37, 37, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[267885, 5918, 617, 16, 59, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[268505, 5936, 217, 3, 37, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[268725, 5941, 360, 10, 57, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[269088, 5953, 223, 3, 37, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[269314, 5958, 1686, 50, 141, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[271003, 6010, 197, 3, 37, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[271203, 6015, 192, 4, 36, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[271398, 6021, 230, 5, 36, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[271631, 6028, 446, 17, 37, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[272080, 6047, 211, 6, 35, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[272294, 6055, 220, 3, 37, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[272517, 6060, 133, 3, 36, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[272653, 6065, 158, 4, 59, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[272814, 6071, 207, 3, 37, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[273024, 6076, 448, 13, 57, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[273475, 6091, 321, 9, 37, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[273799, 6102, 342, 10, 36, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Open  ]],
Cell[274156, 6115, 245, 6, 35, "Output"],
Cell[274404, 6123, 406, 10, 36, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[274813, 6135, 18002, 295, 489, "Output"],
Cell[CellGroupData[{
Cell[292840, 6434, 236, 5, 37, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[293079, 6441, 560, 16, 57, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[293642, 6459, 715, 14, 85, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[294360, 6475, 444, 13, 36, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[294807, 6490, 139, 2, 37, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[294949, 6494, 2053, 58, 229, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[297005, 6554, 156, 2, 37, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[297164, 6558, 2099, 59, 208, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[299266, 6619, 135, 2, 37, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[299404, 6623, 3980, 106, 300, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[303387, 6731, 401, 12, 35, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Open  ]],
Cell[CellGroupData[{
Cell[303825, 6748, 119, 3, 35, "Input"],
Cell[303947, 6753, 2032, 41, 617, "Output"]
}, Open  ]],
Cell[305994, 6797, 186, 5, 35, "Input"],
Cell[306183, 6804, 239, 5, 35, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[306425, 6811, 2032, 41, 617, "Output"],
Cell[308460, 6854, 186, 5, 35, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[308695, 6865, 132, 1, 81, "Chapter"],
Cell[308830, 6868, 334, 8, 36, "Input"],
Cell[309167, 6878, 2060, 53, 80, "Input"],
Cell[311230, 6933, 569, 13, 93, "Input"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
